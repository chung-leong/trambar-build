webpackJsonp([6],[,,,,function(e,t,n){"use strict";function r(e){this.languageCode=e.getLanguageCode(),this.lang=this.languageCode.substr(0,2),this.directory=e.getDirectory(),this.translate=function(t){return t instanceof Object?e.pick(t):e.translate.apply(e,arguments)},this.pick=function(t,n){return e.pick(t,n)},this.name=function(t,n,r){var i=e.pick(t,r),s=new String(i||"");return s.gender=n,s},this.change=function(t){return e.change(t)}}e.exports=r},function(e,t,n){"use strict";function r(e){this.mode=e.getMode(),this.modes=e.getModes(),this.details=e.getDetails(),this.change=function(t){return e.change(t)},this.isAboveMode=function(e){var t=_.indexOf(this.modes,e);return _.indexOf(this.modes,this.mode)>=t},this.isBelowMode=function(e){return!this.isAboveMode(e)},this.getImageUrl=function(t,n){return e.getImageUrl(t,n)},this.getImageFile=function(t){return e.getImageFile(t)},this.getVideoUrl=function(t,n){return e.getVideoUrl(t,n)},this.getAudioUrl=function(t,n){return e.getAudioUrl(t,n)},this.getUrl=function(t,n){return e.getUrl(t,n)}}e.exports=r},function(e,t,n){"use strict";function r(e,t){t||(t={}),this.context=t;var n=this;this.find=function(n){return n=i(t,n),e.find(n)},this.findOne=function(e){return e=s.extend({expected:1},e),n.find(e).then(function(e){return e[0]||null})},this.save=function(n,r){return n=i(t,n),e.save(n,r)},this.saveOne=function(e,t){return n.save(e,[t]).then(function(e){return e.length>0?e[0]:null})},this.remove=function(n,r){return n=i(t,n),e.remove(n,r)},this.removeOne=function(e,t){return n.remove(e,[t]).then(function(e){return e.length>0?e[0]:null})},this.use=function(){var n={};s.assign(n,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return s.each(o,function(e){s.assign(n,e)}),new r(e,n)},this.start=function(n){return n=i(t,n),e.start(n)},this.beginAuthorization=function(n){return e.beginAuthorization(t,n)},this.checkAuthorizationStatus=function(){return e.checkAuthorizationStatus(t)},this.hasAuthorization=function(){return e.hasAuthorization(t)},this.addAuthorization=function(n){e.addAuthorization(t,n)},this.submitPassword=function(n,r){return e.submitPassword(t,n,r)},this.endAuthorization=function(){return e.endAuthorization(t)},this.getOAuthUrl=function(n,r){return e.getOAuthUrl(t,n,r)}}function i(e,t){return s.assign({},e,t)}var s=n(3);n(9),n(54);e.exports=r},function(e,t,n){"use strict";function r(e){this.url=e.getUrl(),this.path=s.replace(this.url,/[?#].*/,""),this.component=e.getComponent(),this.parameters=e.getParameters(),this.query=e.getQuery(),this.hash=e.getHash();var t=[],n=this;this.change=function(t,r){if("string"!=typeof t)throw new Error("Invalid argument");return n.ask(t,!0).then(function(n){return!!n&&e.change(t,r)})},this.find=function(t,n){return e.find(t,n)},this.push=function(t,n){var r=e.find(t,n);return this.change(r,!1)},this.replace=function(t,n){var r=e.find(t,n);return this.change(r,!0)},this.loosen=function(){e.loosen()},this.ask=function(e,n){return n?o.reduce(t,function(t,n){try{if(!t)return!1;var r=n(e,!0);return o.resolve(r)}catch(e){return console.error(e),!0}},!0).then(function(e){return e}):s.reduce(t,function(e,t){try{if(!e)return!1;var n=t(!1);if("boolean"!=typeof n)throw new Error("Callback passed to keep() should return a boolean when interactive (2nd argument) is true");return n}catch(e){return console.error(e),!0}},!0)},this.keep=function(e){t.push(e)},this.free=function(e){s.pull(t,e)}}function i(e){var t=a[e];if(!t){var n=[],r=e.replace(/(:\w+)/g,function(e){return n.push(e),"([^\\/]+)"});t=a[e]=new RegExp("^"+r),t.names=n}return t}var s=("function"==typeof Symbol&&Symbol.iterator,n(3)),o=n(9);e.exports=r,r.match=function(e,t,n){for(var r=0;r<t.length;r++){var o=i(t[r]),a=o.exec(e);if(a){var c={};return s.each(o.names,function(e,t){c[e.substr(1)]=a[t+1]}),n&&(c=n(c)),c&&(c.match=a[0]),c}}},r.prototype.toString=function(){return this.url};var a={}},,,function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(!e||!t)return!1;for(var n in t){var r=e[n];if(t[n]!==r)return!1}return!0}e.exports={shouldComponentUpdate:function(e,t){return!r(this.props,e)||!r(this.state,t)}}},,,,,,,function(e,t,n){"use strict";function r(e){if(e.hidden)return null;var t=["push-button"];return e.emphasized&&t.push("emphasized"),s.createElement("button",{className:t.join(" "),disabled:e.disabled,onClick:e.onClick},e.label)}function i(e){if(e.hidden)return null;var t={type:"file",value:"",disabled:e.disabled,multiple:e.multiple,onChange:e.onChange},n=["push-button"];return e.emphasized&&n.push("emphasized"),s.createElement("label",{className:n.join(" "),disabled:e.disabled,onClick:e.onClick},e.label,s.createElement("input",t))}var s=n(0),o=s.PropTypes;n(645),e.exports=r,e.exports.File=i,i.propTypes={label:o.string,icon:o.string,hidden:o.bool,disabled:o.bool,multiple:o.bool,onChange:o.func}},function(e,t,n){"use strict";function r(e){this.uploading=e.getUploadProgress(),this.queue=function(t,n){return e.queue(t,n)},this.find=function(t,n){return e.find(t,n)},this.send=function(t,n){return e.send(t,n)},this.stream=function(t){return e.stream(t)},this.reattach=function(e,t){var n=this,r=_.get(t,"details.resources",[]);_.each(r,function(t){var r=_.pick(t,"payload_id","url","poster_url"),i=n.find(e,r);i&&_.forIn(i,function(e,n){e instanceof Blob&&(t[n]=e)})})},this.prepare=function(e,t,n){var r=this,s=_.get(t,"details.resources",[]);return i.each(s,function(t){if(!t.payload_id){var i=_.get(n,t.type);return r.queue(e,t,i).then(function(e){e&&(t.payload_id=e)})}})},this.dispatch=function(e,t){var n=this,r=_.get(t,"details.resources",[]),s=_.filter(_.map(r,"payload_id"));return i.each(s,function(t){return n.send(e,t),null})},this.inquire=function(e,t){var n=this,r=_.get(t,"details.resources",[]),i=[];if(_.each(r,function(t){if(t.payload_id){var r=n.find(e,{payload_id:t.payload_id});r&&i.push(r)}}),_.isEmpty(i))return null;var s=_.sum(_.map(i,"total")),o=_.sum(_.map(i,"transferred")),a=Math.round(o/s*100)||0,c="uploading";if(100===a){var l=_.filter(i,function(e){return/transcode/.test(e.action)});if(_.isEmpty(l))return null;var u=_.sum(_.map(l,"total")),p=_.sum(_.map(l,function(e){var t=e.total/u;return e.backendProgress*t}));a=Math.round(p),c="transcoding"}return{action:c,progress:a}}}var i=n(9);e.exports=r},function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=null);var n=i(e);return function(){return null!=arguments[0]?n.apply(null,arguments):t}}var i=n(482);e.exports=r},,,,,,function(e,t,n){"use strict";function r(e){var t=["overlay",e.show?"show":"hide"];return e.className&&t.push(e.className),i.createElement("div",{className:t.join(" "),onClick:e.onClick},i.createElement("div",{className:"background"}),i.createElement("div",{className:"foreground"},e.children))}var i=n(0),s=i.PropTypes,o=n(27);n(658),e.exports=i.createClass({displayName:"exports",display:"OverlayProxy",propTypes:{className:s.string,show:s.bool,onBackgroundClick:s.func},getDefaultProps:function(){return{show:!1}},render:function(){return null},componentDidMount:function(){this.props.show&&this.show()},componentDidUpdate:function(e){e.show!==this.props.show?this.props.show?this.show():this.hide():e.children!==this.props.children&&this.props.show&&this.redraw()},componentWillUnmount:function(){this.hide()},show:function(){var e=this;this.containerNode?this.containerRemovalTimeout&&(clearTimeout(this.containerRemovalTimeout),this.containerRemovalTimeout=0):(this.containerNode=document.createElement("DIV"),document.body.appendChild(this.containerNode),document.body.addEventListener("keydown",this.handleKeyDown));var t={show:!1,onClick:this.handleClick,children:this.props.children};o.render(i.createElement(r,t),this.containerNode),this.shown=!1,setTimeout(function(){var t={show:!0,onClick:e.handleClick,children:e.props.children};o.render(i.createElement(r,t),e.containerNode),e.shown=!0},10)},redraw:function(){var e={show:this.shown,onClick:this.handleClick,children:this.props.children};o.render(i.createElement(r,e),this.containerNode)},hide:function(){var e=this;if(this.containerNode){this.containerRemovalTimeout||(this.containerRemovalTimeout=setTimeout(function(){o.unmountComponentAtNode(e.containerNode),document.body.removeChild(e.containerNode),document.body.removeEventListener("keydown",e.handleKeyDown),e.containerNode=null,e.containerRemovalTimeout=0},1e3));var t={show:!1,children:this.props.children};o.render(i.createElement(r,t),this.containerNode),this.shown=!1}},handleClick:function(e){var t=e.target.className;"foreground"!==t&&"background"!==t||this.props.onBackgroundClick&&this.props.onBackgroundClick(e)},handleKeyDown:function(e){27===e.keyCode&&this.props.onBackgroundClick&&this.props.onBackgroundClick(e)}})},,,function(e,t,n){"use strict";function r(e){if(e.hidden)return null;var t={id:e.id,href:e.url,target:e.target,className:i(e),onClick:e.disabled?null:e.onClick};return o.createElement("a",t,o.createElement("i",{className:s(e)}),o.createElement("span",{className:"label"},e.label))}function i(e){var t=["option-button"];return e.className&&t.push(e.className),e.selected&&t.push("selected"),e.disabled&&t.push("disabled"),t.join(" ")}function s(e){var t=["fa"];return e.icon?t.push("fa-"+e.icon):e.selected?t.push("fa-"+e.iconOn):t.push("fa-"+e.iconOff),t.join(" ")}var o=n(0),a=o.PropTypes;e.exports=r,n(642),r.propTypes={label:a.node,id:a.string,icon:a.string,iconOn:a.string,iconOff:a.string,url:a.string,target:a.string,hidden:a.bool,selected:a.bool,disabled:a.bool,onClick:a.func},r.defaultProps={iconOn:"check-circle",iconOff:"circle-o"}},function(e,t,n){"use strict";function r(e){var t,r=["profile-image",e.size];if(e.user){var s=_.get(e.user,"details.resources"),o=_.find(s,{type:"image"});if(o){var c=a[e.size];t=e.theme.getImageUrl(o,{width:c,height:c})}}if(t)return i.createElement("img",{className:r.join(" "),src:t});var l=n(128);return i.createElement(l,{className:r.join(" ")})}var i=n(0),s=i.PropTypes,o=n(5);e.exports=r,n(644),r.propTypes={user:s.object,size:s.oneOf(["small","medium","large"]),theme:s.instanceOf(o)},r.defaultProps={size:"small"};var a={small:24,medium:48,large:96}},function(e,t,n){"use strict";function r(e){if(!this)return new r(e);var t=this,n={};_.forIn(e,function(e,r){var i=function(e){if(!(arguments.length>0))return t[r];t[r]=e};n[r]=i}),this.setters=n,_.forIn(e,function(e,n){t[n]=null})}e.exports=r},,,,function(e,t,n){"use strict";function r(e){return e.hidden?null:a.createElement("label",{className:s(e),onClick:e.disabled?null:e.onClick},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label))}function i(e){if(e.hidden)return null;var t={type:"file",value:"",disabled:e.disabled,multiple:e.multiple,onChange:e.onChange};return a.createElement("label",{className:s(e)},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label),a.createElement("input",t))}function s(e){var t=["header-button"];return e.className&&t.push(e.className),e.highlighted&&t.push("highlighted"),e.disabled&&t.push("disabled"),t.join(" ")}function o(e){var t=[];return e.icon&&t.push("fa","fa-"+e.icon),t.join(" ")}var a=n(0),c=a.PropTypes;e.exports=r,e.exports.File=i,n(638),r.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,onClick:c.func},i.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,multiple:c.bool,onChange:c.func}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0);s.PropTypes;n(650),e.exports=s.createClass({displayName:"SettingsSection",propTypes:{},render:function(){var e=["settings-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});return n?s.createElement("div",r({className:e},n.props),n.props.children):null}})},,function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0);s.PropTypes;n(651),e.exports=s.createClass({displayName:"StorySection",propTypes:{},render:function(){var e=["story-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});if(!n)return null;var o=s.Children.toArray(n.props.children);return i.isEmpty(o)?null:s.createElement("div",r({className:e},n.props),o)}})},,,,,,function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(16),a=n(15),c=n(96),l=n(6),u=n(18),p=n(7),d=n(4),h=n(5),m=n(10),f=n(135),g=n(141);n(213),e.exports=a.createClass({displayName:"PersonPage",propTypes:{database:s.instanceOf(l).isRequired,payloads:s.instanceOf(u).isRequired,route:s.instanceOf(p).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(h).isRequired},statics:{parseUrl:function(e,t,n){return p.match(e,["/:schema/people/:role/:user/:date/?","/:schema/people/:role/:user/?"],function(e){return e.user=r.strictParseInt(e.user),e.story=n?parseInt(r.replace(n,/\D/g,"")):void 0,e})},getUrl:function(e){var t,n,i="/"+e.schema+"/people/";return r.isEmpty(e.roles)?i+="all/":i+=e.roles.join("+")+"/",i+=e.user+"/",e.date&&(i+=e.date+"/"),e.search&&(t={search:e.search}),e.story&&(n="story-"+e.story),{path:i,query:t,hash:n}},getOptions:function(e){return{navigation:{top:{dateSelection:!0,roleSelection:!1,textSearch:!0},bottom:{section:"people"}}}}},renderAsync:function(e,t){var s=this,a=this.props.route.parameters,c=this.props.database.use({schema:a.schema,by:this}),l=(this.props.route,t.route,{stories:null,user:null,roles:null,dailyActivities:null,currentUser:null,project:null,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme});return e.show(i.createElement(v,l),250),c.start().then(function(e){var t={id:e};return c.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){return l.currentUser=t,e.show(i.createElement(v,l))}).then(function(){var e={name:a.schema};return c.findOne({schema:"global",table:"project",criteria:e,required:!0})}).then(function(t){return l.project=t,e.show(i.createElement(v,l))}).then(function(){var e={id:a.user};return c.findOne({schema:"global",table:"user",criteria:e,required:!0})}).then(function(t){return l.user=t,e.show(i.createElement(v,l))}).then(function(){var e={id:l.user.role_ids};return c.find({schema:"global",table:"role",criteria:e})}).then(function(t){return l.roles=t,e.show(i.createElement(v,l))}).then(function(){var e=o(),t=e.clone().endOf("month"),n=e.clone().startOf("month").subtract(1,"month"),r="["+n.toISOString()+","+t.toISOString()+"]",i={type:"daily-activities",filters:{user_ids:[l.user.id],time_range:r}};return c.findOne({table:"statistics",criteria:i})}).then(function(t){return l.dailyActivities=t,e.show(i.createElement(v,l))}).then(function(){if(a.date||a.search){var e={user_ids:[a.user]};if(a.date){var t=o(a.date),i=t.clone().endOf("day"),u=t.toISOString(),p=i.toISOString(),d="["+u+","+p+"]";e.time_range=d}return a.search?(e.search={lang:s.props.locale.lang,text:a.search},e.limit=100):e.limit=500,c.find({table:"story",criteria:e})}var e={type:"news",target_user_id:l.currentUser.id,filters:{user_ids:[a.user]}};return c.findOne({table:"listing",criteria:e}).then(function(e){if(!e)return[];var t={};return t.id=e.story_ids,c.find({table:"story",criteria:t})}).then(function(e){if(a.story&&!r.find(e,{id:a.story})){var t={id:a.story};return c.findOne({table:"story",criteria:t}).then(function(t){return t?s.props.route.replace(n(43),{date:o(t.ptime).format("YYYY-MM-DD"),user:a.user,story:a.story}).return([]):e})}return e})}).then(function(e){return l.stories=e,i.createElement(v,l)})}});var v=e.exports.Sync=i.createClass({displayName:"PersonPage.Sync",mixins:[m],propTypes:{stories:s.arrayOf(s.object),user:s.object,roles:s.arrayOf(s.object),dailyActivities:s.object,currentUser:s.object,project:s.object,database:s.instanceOf(l).isRequired,payloads:s.instanceOf(u).isRequired,route:s.instanceOf(p).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(h).isRequired},getAccessLevel:function(){var e=this.props,t=e.project,n=e.currentUser;return c.getUserAccessLevel(t,n)||"read-only"},render:function(){return i.createElement("div",{className:"person-page"},this.renderUserView(),this.renderList())},renderUserView:function(){var e={user:this.props.user,roles:this.props.roles,dailyActivities:this.props.dailyActivities,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(g,e)},renderList:function(){var e={access:this.getAccessLevel(),stories:this.props.stories,currentUser:this.props.currentUser,project:this.props.project,selectedStoryId:this.props.route.parameters.story,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.handleSelectionClear};return i.createElement(f,e)},handleSelectionClear:function(){this.props.route.loosen()}})},function(e,t,n){"use strict";function r(e){var t="scrollable";return e.className&&(t+=" "+e.className),e=i.clone(e),e.className=t,s.createElement("div",e,e.children)}var i=n(3),s=n(0);e.exports=r,n(648)},,,,,,,,,function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=(n(27),n(16)),a=n(15),c=n(96),l=n(6),u=n(18),p=n(7),d=n(4),h=n(5),m=n(10),f=n(135);n(213),e.exports=a.createClass({displayName:"NewsPage",propTypes:{database:s.instanceOf(l).isRequired,payloads:s.instanceOf(u).isRequired,route:s.instanceOf(p).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(h).isRequired},statics:{parseUrl:function(e,t,n){return p.match(e,["/:schema/news/:roles/:date/?","/:schema/news/:roles/?","/:schema/news/?"],function(e){return e.roles=r.filter(r.map(r.split(e.roles,"+"),parseInt)),e.search=t.search,e.story=n?parseInt(r.replace(n,/\D/g,"")):void 0,e})},getUrl:function(e){var t,n,i="/"+e.schema+"/news/";return r.isEmpty(e.roles)?e.date&&(i+="all/"):i+=e.roles.join("+")+"/",e.date&&(i+=e.date+"/"),e.search&&(t={search:e.search}),e.story&&(n="story-"+e.story),{path:i,query:t,hash:n}},getOptions:function(e){return{navigation:{top:{dateSelection:!0,roleSelection:!0,textSearch:!0},bottom:{section:"news"}}}}},renderAsync:function(e,t){var s=this,a=this.props.route.parameters,c=!(!a.date&&r.isEmpty(a.roles)&&!a.search),l=this.props.database.use({schema:a.schema,by:this}),u=this.props.route!==t.route?100:1e3,p={listing:null,stories:null,draftStories:null,pendingStories:null,currentUser:null,project:null,acceptNewStory:!c,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(g,p),u),l.start().then(function(e){var t={id:e};return l.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){return p.currentUser=t,e.show(i.createElement(g,p))}).then(function(){var e={name:a.schema};return l.findOne({schema:"global",table:"project",criteria:e,required:!0})}).then(function(t){return p.project=t,e.show(i.createElement(g,p))}).then(function(){if(c){var e={};if(a.date){var t=o(a.date),i=t.clone().endOf("day"),u=t.toISOString(),d=i.toISOString(),h="["+u+","+d+"]";e.time_range=h}return r.isEmpty(a.roles)||(e.role_ids=a.roles),a.search?(e.search={lang:s.props.locale.lang,text:a.search},e.limit=100):e.limit=500,"guest"===p.currentUser.type&&(e.public=!0),l.find({table:"story",criteria:e})}var e={type:"news",target_user_id:p.currentUser.id,filters:{}};return r.isEmpty(a.roles)||(e.filters.role_ids=a.roles),"guest"===p.currentUser.type&&(e.filters.public=!0),l.findOne({table:"listing",criteria:e}).then(function(e){if(!e)return[];p.listing=e;var t={id:e.story_ids};return"guest"===p.currentUser.type&&(t.public=!0),l.find({table:"story",criteria:t})}).then(function(e){if(a.story&&!r.find(e,{id:a.story})){var t={id:a.story};return l.findOne({table:"story",criteria:t}).then(function(t){var i=!1;if(t&&t.ptime&&t.published&&!1!==t.ready){o()-o(t.ptime)>6e4&&(i=!0)}if(i){var c=r.clone(a);return c.date=o(t.ptime).format("YYYY-MM-DD"),s.props.route.replace(n(53),c).then(function(){return[]})}return e})}return e})}).then(function(t){return p.stories=t,e.show(i.createElement(g,p))}).then(function(){if(!c){var e={published:!1,user_ids:[p.currentUser.id]};return l.find({table:"story",criteria:e})}}).then(function(t){if(t)return r.each(t,function(e){p.payloads.reattach(a.schema,e)}),p.draftStories=t,e.show(i.createElement(g,p))}).then(function(){if(!c){var e=r.map(p.stories,"id"),t={published:!0,exclude:e,user_ids:[p.currentUser.id]};return l.find({table:"story",criteria:t})}}).then(function(e){return e&&(r.each(e,function(e){p.payloads.reattach(a.schema,e)}),p.pendingStories=e),i.createElement(g,p)})}});var g=e.exports.Sync=i.createClass({displayName:"NewsPage.Sync",mixins:[m],propTypes:{acceptNewStory:s.bool,listing:s.object,stories:s.arrayOf(s.object),draftStories:s.arrayOf(s.object),pendingStories:s.arrayOf(s.object),currentUser:s.object,project:s.object,database:s.instanceOf(l).isRequired,payloads:s.instanceOf(u).isRequired,route:s.instanceOf(p).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(h).isRequired},getAccessLevel:function(){var e=this.props,t=e.project,n=e.currentUser;return c.getUserAccessLevel(t,n)||"read-only"},render:function(){return i.createElement("div",{className:"news-page"},this.renderList())},renderList:function(){var e=this.getAccessLevel(),t={access:e,acceptNewStory:this.props.acceptNewStory&&"read-write"===e,stories:this.props.stories,draftStories:this.props.draftStories,pendingStories:this.props.pendingStories,currentUser:this.props.currentUser,project:this.props.project,selectedStoryId:this.props.route.parameters.story,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.handleSelectionClear};return i.createElement(f,t)},handleSelectionClear:function(){this.props.route.loosen()}})},function(e,t,n){"use strict";function r(e,t){e||(e=500);var n=i[e];this.statusCode=e,this.name=n,this.message=n;for(var r in t)this[r]=t[r]}e.exports=r;var i={400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"};r.prototype=Object.create(Error.prototype)},function(e,t,n){"use strict";function r(e,t){if(!(t instanceof Blob))return t}var i=n(3),s=n(9),o=n(54);t.fetch=function(e,t,n,a){var c=new XMLHttpRequest,l=new s(function(s,l){var u=i.get(a,"username",null),p=i.get(a,"password",null),d=i.get(a,"contentType",null);if("GET"===(e=i.toUpper(e))&&!i.isEmpty(n)){var h=[];i.forIn(n,function(e,t){t=encodeURIComponent(t),void 0!==(e=encodeURIComponent(e))&&h.push(t+"="+e)}),-1===i.indexOf(t,"?")?t+="?":t+="&",t+=i.join(h,"&"),n=null}"json"===d&&(d="application/json"),"application/json"===d&&i.isObject(n)&&(n=JSON.stringify(n,r)),c.timeout=i.get(a,"timeout"),c.withCredentials=i.get(a,"crossSite",!1),c.responseType=i.get(a,"responseType",""),c.open(e,t,!0,u,p),d&&c.setRequestHeader("Content-Type",d),c.onload=function(e){if(c.status>=400){var t=new o(c.status,c.response);l(t)}else{var n=c.response;s(n)}},c.ontimeout=function(e){l(new Error("Request timed out"))},c.onerror=function(e){l(new Error(e.message))},c.onabort=function(e){l(new Error("Transfer aborted: "+t))};var m=i.get(a,"onDownloadProgress"),f=i.get(a,"onUploadProgress");c.onprogress=function(e){m&&m(e)},c.upload.onprogress=function(e){f&&f(e)},c.send(n)});return l.cancel=function(){c.abort()},l}},function(e,t,n){"use strict";function r(e){e=e||"";for(var t,n=[],r=0,i=null,s=1,o=1;t=l.exec(e);){var a=e.substring(r,t.index);if(a)if(i)if(c.trim(a))i=null,o++,n.push(a);else{var u=c.last(i);u.after+=a}else n.push(a);var p=t[1],d=t[2],h=!!c.trim(d),m=t[3],f=t[4],g=t[5],v={label:f,checked:h,answer:d,before:p,between:m,after:g,list:o,key:s};i?i.push(v):(i=[v],n.push(i)),r=t.index+t[0].length,s++}var y=e.substring(r);return y&&n.push(y),n}function i(e){if("object"===(void 0===e?"undefined":a(e)))return c.some(e,i);var t=r(e);return c.some(t,function(e){return e instanceof Array})}function s(e,t,n,i,s){"number"!=typeof t&&(t=Number(t)),"number"!=typeof n&&(n=Number(n));var a=r(e);a=c.flattenDeep(a);var l=c.filter(a,{list:t});return c.each(l,function(t){t.key===n?(t.checked=i,o(t,e)):i&&s&&(t.checked=!1,o(t,e))}),c.reduce(a,function(e,t){return t instanceof Object?e+t.before+"["+t.answer+"]"+t.between+t.label+t.after:e+t},"")}function o(e,t){if(e.checked){var n;switch(n=/[\u0x0400-\u0x04ff]/.test(t)?"х":/[\u0x0370-\u0x03ff]/.test(t)?"χ":"x",e.answer.length){case 0:case 1:case 2:e.answer=n;break;case 3:e.answer=" "+n+" "}}else switch(e.answer.length){case 0:e.answer="";break;case 1:e.answer=" ";break;case 2:e.answer="  ";break;case 3:e.answer="   "}}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(3);t.extract=r,t.detect=i,t.update=s;var l=/^([ \t]*)\[([ xхχ]{0,3})\]([ \t]*)(.*?)([ \t]*?)$/gim},function(e,t,n){"use strict";function r(e,t){if("object"===(void 0===e?"undefined":f(e)))return g.some(e,r);var n=l(t),i=n.extractBlocks(e);return g.some(i,function(e){switch(e.type){case"space":return!1;case"paragraph":case"text_block":var t,r=n.inlineLexer;for(r.start(e.markdown);t=r.captureToken();)switch(t.type){case"url":case"text":case"autolink":case"br":break;default:return!0}break;default:return!0}})}function i(e,t){var n=l(t),r=u(),i=n.parse(e);return r.render(i)}function s(e,t,n,r){var i=b.extract(e),s=c(i,r);return g.map(i,function(e,r){if(e instanceof Array){var i=g.map(e,function(e,i){var o=e.checked,a=s[r][i];if(t){var c=t[e.list];void 0!==c&&(o=e.key==c)}return v.createElement("div",{className:"list-item",key:i},v.createElement("label",null,v.createElement("input",{type:"radio",name:e.list,value:e.key,checked:o,readOnly:!n,onChange:n})," ",a))});return v.createElement("div",{key:r},i)}return s[r]})}function o(e,t,n){var r=b.extract(e),i=c(r,n);return g.map(r,function(e,n){if(e instanceof Array){var r=g.map(e,function(e,r){var s=i[n][r],o=t[e.list],a=g.get(o,"total",0),c=g.get(o,["answers",e.key],0),l=Math.round(a>0?c/a*100:0)+"%",u="color-"+e.key%10;return v.createElement("div",{className:"vote-count",key:r},v.createElement("div",{className:"label"},s),v.createElement("div",{className:"bar"},v.createElement("span",{className:"filled "+u,style:{width:l}}),v.createElement("span",{className:"percent"},l),v.createElement("span",{className:"count"},c+"/"+a)))});return v.createElement("div",{key:n},r)}return i[n]})}function a(e,t,n,r){var i=b.extract(e),s=c(i,r);return g.map(i,function(e,r){if(e instanceof Array){var i=g.map(e,function(e,i){var o=e.checked,a=s[r][i];if(t){var c=t[e.list];if(void 0!==c){var l=c[e.key];void 0!==l&&(o=l)}}return v.createElement("div",{className:"list-item",key:i},v.createElement("label",null,v.createElement("input",{type:"checkbox",name:e.list,value:e.key,checked:o,readOnly:!n,onChange:n})," ",a))});return v.createElement("div",{key:r},i)}return s[r]})}function c(e,t){var n=l(t),r=g.map(e,function(e,t){return e instanceof Array?g.map(e,function(e){return n.extractBlocks(e.label)}):n.extractBlocks(e)});g.each(e,function(e,t){var i=r[t];e instanceof Array?g.each(i,function(e){n.processInline(e)}):n.processInline(i)});var i=u();return g.map(e,function(e,t){var n=r[t];return e instanceof Array?g.map(e,function(e,t){var r=g.first(i.render(n[t]));return r&&r.props&&"p"===r.type&&(r=r.props.children),r}):i.render(n)})}function l(e){var t=new y.BlockLexer,n=new y.InlineLexer({links:t.links,findRefLink:d,onReference:e});return new y.Parser({blockLexer:t,inlineLexer:n})}function u(){return new y.Renderer({renderImage:p})}function p(e,t){var n=e.href,r=e.title,i=e.text;if(/^blob:/.test(n)){var s,o=n.indexOf("?");if(-1!==o){var a=g.split(n.substr(o+1),"&");s=g.transform(a,function(e,t){var n=g.split(t,"="),r=n[0],i=parseInt(n[1]);e[r]=i},{}),n=n.substr(0,o)}return v.createElement(k,{key:t,url:n,clippingRect:s,alt:i,title:r})}return v.createElement("img",{key:t,src:n,alt:i,title:r})}function d(e,t){var n=this.links[e];return n||(this.onReference&&(n=this.onReference({type:"reference",target:this,name:e,forImage:t})),n)}function h(e,t){var n=/^(picture|image|photo|video|audio|website)(-(\d+))?$/.exec(t);if(n){var r=n[1];"picture"!==r&&"photo"!==r||(r="image");var i=g.filter(e,{type:r}),s=parseInt(n[3])||0,o=i[s-1];if(o)return o}return null}function m(e,t){if(e){var n=URL.createObjectURL(e);if(t){n+="?"+g.join(g.map(t,function(e,t){return t+"="+e}),"&")}return n}}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g=n(3),v=n(0),y=n(106),b=n(56),k=(n(5),n(95));t.detect=r,t.parse=i,t.parseSurvey=s,t.parseSurveyResults=o,t.parseTaskList=a,t.createParser=l,t.createRenderer=u,t.findReferencedResource=h,t.createBlobUrl=m},function(e,t,n){"use strict";function r(){u=c(),p=u.clone().startOf("day")}function i(){r(),s.each(d,function(e){e.update()})}var s=n(3),o=n(0),a=o.PropTypes,c=n(16),l=n(4);e.exports=o.createClass({displayName:"Time",propTypes:{locale:a.instanceOf(l).isRequired,time:a.string},getInitialState:function(){var e=c(this.props.time),t={time:e,day:e.clone().startOf("day")};return this.updateClassName(t),this.updateText(t),t},updateClassName:function(e){var t;if(e.time.isValid()){var n=(p-e.day)/864e5;t=0===n?"today":1===n?"yesterday":"older"}else t="invalid";e.className=t},updateText:function(e){var t,n=this.props.locale.languageCode,r=e.time.clone().locale(n);if("today"===e.className)t=s.capitalize(r.fromNow());else if("yesterday"===e.className){var i=this.props.locale.translate;t=i("time-yesterday")}else t="older"===e.className?r.format("ll"):"";e.text=t},update:function(){var e=s.clone(this.state);this.updateClassName(e),this.updateText(e);var t=s.shallowDiff(e,this.state);s.isEmpty(t)||this.setState(t)},componentWillReceiveProps:function(e){var t=s.clone(this.state),n=c(e.time);t.time=n,t.day=n.clone().startOf("day"),this.updateClassName(t),this.updateText(t);var r=s.shallowDiff(t,this.state);s.isEmpty(r)||this.setState(r)},render:function(){return o.createElement("span",{className:"time "+this.state.className},this.state.text)},componentDidMount:function(){this.componentDidUpdate()},componentDidUpdate:function(e,t){"today"===this.state.className||"yesterday"===this.state.className?s.includes(d,this)||d.push(this):s.pull(d,this)},componentWillUnmount:function(){s.pull(d,this)}});var u,p,d=[];setInterval(i,3e4),r()},,,,,,,,function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(3);t.match=function(e,t,n){var s=!0;for(var o in n){var a=n[o];if(t.hasOwnProperty(o)){var c=t[o];if(a instanceof Array){if(c instanceof Array){if(0===i.intersection(a,c).length){s=!1;break}}else if(!i.includes(a,c)){s=!1;break}}else if(c!==a){if("object"===(void 0===c?"undefined":r(c))&&"object"===(void 0===a?"undefined":r(a))){if(!i.isEqual(c,a))return!1}else s=!1;break}}else if("time_range"===o){if(a){var l=a.substr(1,a.length-2).split(","),u=l[0],p=l[1];u<=t.ptime&&t.ptime<p||(s=!1)}}else"exclude"===o&&i.includes(a,t.id)&&(s=!1)}return s}},function(e,t,n){"use strict";function r(e,t,n,s){var o={},c=l.union(l.keys(e),l.keys(t));return l.each(c,function(c){var u,p=e?e[c]:void 0,d=t?t[c]:void 0,h=n?n[c]:void 0;if(l.isEqual(p,d))u=l.cloneDeep(p);else if(l.isEqual(p,h))u=l.cloneDeep(d);else if(l.isEqual(d,h))u=l.cloneDeep(p);else{var m=s?s[c]:void 0;u=a(p)&&a(d)?r(p,d,h,m):"string"==typeof p||"string"==typeof d?i(p,d,h):"function"==typeof m?m(p,d,h):d}void 0!==u&&(o[c]=u)}),o}function i(e,t,n){"string"!=typeof e&&(e=""),"string"!=typeof t&&(t=""),"string"!=typeof n&&(n="");for(var r=u.diffSentences(e,t),i=s(n,t),a=[],c=0;c<r.length;c++){var l=r[c];if(l.removed){var e=l.value,t="";r[c+1]&&r[c+1].added&&(t=r[c+1].value,c++),a.push({a:e,b:t})}else if(l.added){var e="",t=l.value;a.push({a:e,b:t})}else a.push(l.value)}for(var p=0,d=0,h=[],c=0;c<a.length;c++){var m=a[c];"string"==typeof m?(h.push(m),p+=m.length,d+=m.length):(o(d,m.b.length,i)?h.push(m.a):h.push(m.b),p+=m.a.length,d+=m.b.length)}return h.join("")}function s(e,t){for(var n=[],r=u.diffSentences(e,t),i=0,s=0,o=0;o<r.length;o++){var a=r[o],c=a.value.length;a.removed?s+=c:a.added?i+=c:(n.push({index:i,length:c}),s+=c,i+=c)}return n}function o(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(i.index<=e&&e+t<=i.index+i.length)return!0}return!1}function a(e){return"object"===(void 0===e?"undefined":c(e))&&e.constructor===Object}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(3),u=n(378);t.mergeObjects=r,t.mergeStrings=i},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(27);e.exports=r.createClass({displayName:"SmartList",propTypes:{items:i.arrayOf(i.object),behind:i.number,ahead:i.number,anchor:i.string,offset:i.number,onIdentity:i.func.isRequired,onRender:i.func.isRequired,onAnchorChange:i.func,onBeforeAnchor:i.func},getDefaultProps:function(){return{behind:5,ahead:10,offset:0}},getInitialState:function(){return this.itemHeights={},this.itemNodes={},this.anchorOffset=this.props.offset,{currentAnchor:this.props.anchor,estimatedHeight:void 0}},componentWillReceiveProps:function(e){this.props.anchor!==e.anchor&&(this.setState({currentAnchor:e.anchor}),this.anchorOffset=e.offset)},render:function(){var e=this,t=this.props.items,n=this.props.onIdentity,i=_.map(t,function(t,r){return n({type:"identity",target:e,item:t,currentIndex:r})}),s=this.state.currentAnchor?_.indexOf(i,this.state.currentAnchor):0;if(-1===s&&t){for(var o=_.keys(this.itemNodes),a=_.indexOf(o,this.state.currentAnchor),c=a+1;c<o.length;c++){var l=_.indexOf(i,o[c]);if(-1!==l){s=l,this.state.currentAnchor=i[l],this.triggerAnchorChangeEvent(i[l]);break}}-1===s&&(this.state.currentAnchor=void 0,this.triggerAnchorChangeEvent(void 0))}var u=Math.max(0,s-this.props.behind),p=Math.min(_.size(t),s+this.props.ahead+1),d=this.props.onRender,h=_.map(this.props.items,function(t,n){var s=i[n],o={type:"render",target:e,item:t,needed:u<=n&&n<p,startIndex:u,currentIndex:n,endIndex:p,previousHeight:e.itemHeights[s],estimatedHeight:e.state.estimatedHeight},a=d(o);return r.createElement("div",{key:s,id:s},a)});return this.startIndex=u,this.endIndex=p,r.createElement("div",{className:"smart-list"},h)},componentDidMount:function(){this.container=s.findDOMNode(this);for(var e=this.container.parentNode;e;e=e.offsetParent){var t=getComputedStyle(e);if("auto"===t.overflowY||"scroll"===t.overflowY){this.scrollContainer=e;break}}this.scrollContainerWidth=this.scrollContainer.clientWidth,this.scrollContainer.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleWindowResize),this.scanItemNodes()},componentDidUpdate:function(e,t){var n=this,r=!_.isEmpty(this.itemNodes),i=this.scanItemNodes();if(this.state.currentAnchor&&r){var s=_.keys(this.itemNodes),o=_.indexOf(s,this.state.currentAnchor),a=_.transform(i,function(e,t){t<o&&e.push(n.props.items[t])},[]);_.isEmpty(a)||this.triggerBeforeAnchorEvent(a)}},componentWillUnmount:function(){this.scrollContainer.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleWindowResize)},scanItemNodes:function(){var e=this.startIndex,t=this.endIndex,n=0,r=this.itemNodes,i=[];this.itemNodes={};for(var s=this.container.firstChild;s;s=s.nextSibling){var o=s.id;this.itemNodes[o]=s,e<=n&&n<t&&(this.itemHeights[o]=s.offsetHeight),r[o]||i.push(n),n++}if(void 0===this.state.estimatedHeight){var a=_.values(this.itemHeights);if(!_.isEmpty(a)){var c=_.sum(a)/a.length,l=Math.round(c);this.setState({estimatedHeight:l})}}else if(!this.scrolling&&this.state.currentAnchor){var u=this.itemNodes[this.state.currentAnchor],p=this.anchorOffset;if(u&&void 0!==p){var d=this.scrollContainer.offsetTop,h=u.offsetTop-d,m=h-this.scrollContainer.scrollTop;if(m!==p){var f=h-p;this.scrollContainer.scrollTop=Math.max(0,f)}}}return i},resetHeights:function(){this.itemHeights={},this.setState({estimatedHeight:void 0})},triggerAnchorChangeEvent:function(e){if(this.props.onAnchorChange){var t=_.keys(this.itemNodes),n=_.indexOf(t,this.state.currentAnchor),r=this.props.items[n];this.props.onAnchorChange({type:"anchorchange",target:this,anchor:e,item:r})}},triggerBeforeAnchorEvent:function(e){this.props.onBeforeAnchor&&this.props.onBeforeAnchor({type:"beforeanchor",target:this,items:e})},handleScroll:function(e){var t,n,r=this,i=this.scrollContainer.scrollTop,s=this.scrollContainer.offsetTop;if(i>0)for(var o in this.itemNodes)if(t=this.itemNodes[o],(n=t.offsetTop-s)>i)break;var a=t?t.id:void 0;this.anchorOffset=t?n-i:void 0,this.state.currentAnchor!==a&&(this.setState({currentAnchor:a}),this.triggerAnchorChangeEvent(a)),this.scrolling=!0,this.scrollingEndTimeout&&clearTimeout(this.scrollingEndTimeout),this.scrollingEndTimeout=setTimeout(function(){r.scrolling=!1,r.scrollingEndTimeout=0},500)},handleWindowResize:function(){this.scrollContainerWidth!==this.scrollContainer.clientWidth&&(this.scrollContainerWidth=this.scrollContainer.clientWidth,this.resetHeights())}})},,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){var t=["thumbnail"];return e.selected&&t.push("selected"),c.createElement("div",{className:t.join(" "),id:e.id,onClick:e.onClick},c.createElement("img",{src:e.url}))}function i(e,t){var n=e.versions?e.versions[t]:null;if(!n)return{};var r=e.width,i=e.height,s=n.videoScaling.width,o=n.videoScaling.height,a=Math.min(s/r,o/i);return{width:Math.round(r*a),height:Math.round(i*a)}}function s(e){var t=screen.width,n=screen.height,r=t*n,s=_.map(_.keys(e.versions),function(t){var n=i(e,t),s=n.width*n.height;return{name:t,diff:Math.abs(r-s)}}),o=_.first(_.sortBy(s,"diff"));return o?o.name:null}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(9),c=n(0),l=c.PropTypes,u=n(4),p=n(5),d=n(25),h=n(17);n(583),e.exports=c.createClass({displayName:"MediaDialogBox",propTypes:{show:l.bool,resources:l.arrayOf(l.object).isRequired,selectedIndex:l.number.isRequired,locale:l.instanceOf(u).isRequired,theme:l.instanceOf(p).isRequired,onClose:l.func},getInitialState:function(){return{selectedIndex:this.props.selectedIndex}},getResourceCount:function(){return this.props.resources.length},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1;return _.min([this.state.selectedIndex,e])},selectResource:function(e){var t=this;return new a(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},componentWillMount:function(){this.props.show&&document.body.addEventListener("keydown",this.handleKeyDown)},componentWillReceiveProps:function(e){if(this.props.show!==e.show)if(e.show)this.setState({selectedIndex:e.selectedIndex}),document.body.addEventListener("keydown",this.handleKeyDown);else{var t=this.refs.video;t&&t.pause(),document.body.removeEventListener("keydown",this.handleKeyDown)}},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return c.createElement(d,e,c.createElement("div",{className:"media-dialog-box"},this.renderView(),c.createElement("div",{className:"controls"},this.renderThumbnails(),this.renderButtons())))},renderView:function(){var e=this.getSelectedResourceIndex(),t=this.props.resources[e];if(t){var n=document.body.parentNode,r=n.clientWidth,o=n.clientHeight;"columns-1"===this.props.theme.mode?(r-=20,o-=100):(r-=100,o-=200);var a,l,u=r/o;_.each(this.props.resources,function(e){var t;if("video"===e.type){t=i(e,s(e))}else t=e;a>=t.width||(a=t.width),l>=t.height||(l=t.height)});var p=a/l;u>p?l>o&&(l=o,a=Math.round(l*p)):a>r&&(a=r,l=Math.round(a/p));var d,h={width:a,height:l};switch(t.type){case"image":d=this.renderImage(t,a,l);break;case"video":d=this.renderVideo(t,a,l)}return c.createElement("div",{className:"container",style:h},d)}},renderImage:function(e,t,n){var r,i;e.width>t?r=t:e.height>n&&(i=n);var s=this.props.theme,o=_.omit(e,"clip"),a={src:s.getImageUrl(o,{width:r,height:i})};return c.createElement("img",a)},renderVideo:function(e){var t=e,n=this.props.theme,r=s(e),o=i(e,r),a={ref:"video",src:n.getVideoUrl(t,{version:r}),controls:!0,autoPlay:!0,poster:n.getImageUrl(t,{width:o.width,height:o.height,clip:null,quality:60})};return c.createElement("video",a)},renderThumbnails:function(){var e=this,t=(this.props.locale.translate,this.props.theme,this.getSelectedResourceIndex()),n=_.map(this.props.resources,function(n,i){var s={url:e.props.theme.getImageUrl(n,{width:28,height:28}),selected:i===t,"data-index":i,onClick:e.handleThumbnailClick};return c.createElement(r,o({key:i},s))});return c.createElement("div",{className:"links"},n)},renderButtons:function(){var e=this.props.locale.translate,t={label:e("media-download-original"),emphasized:!1,onClick:this.handleDownloadClick},n={label:e("media-close"),emphasized:!0,onClick:this.props.onClose};return c.createElement("div",{className:"buttons"},c.createElement(h,t),c.createElement(h,n))},componentWillUnmount:function(){document.body.removeEventListener("keydown",this.handleKeyDown)},handleThumbnailClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-index"));return this.selectResource(t)},handleDownloadClick:function(e){var t=this.getSelectedResourceIndex(),n=this.props.resources[t];if(n){var r,i=document.createElement("A"),s=this.props.theme;switch(n.type){case"image":r=s.getImageUrl(n,{clip:null});break;case"video":r=s.getVideoUrl(n)}i.href=r,i.download=n.filename||!0,i.click()}},handleKeyDown:function(e){var t=0;if(39===e.keyCode?t=1:37==e.keyCode&&(t=-1),t){var n=this.getResourceCount(),r=this.getSelectedResourceIndex()+t;r>=n?r=0:r<0&&(r=n-1),this.selectResource(r),e.preventDefault()}}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=(n(15),n(6)),o=n(7),a=n(4),c=n(5),l=n(25),u=n(17),p=n(44),d=n(244);n(588),e.exports=r.createClass({displayName:"UserSelectionDialogBox",propTypes:{show:i.bool,selection:i.arrayOf(i.number).isRequired,disabled:i.arrayOf(i.number),database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onSelect:i.func,onCancel:i.func},getInitialState:function(){return{selection:this.props.selection}},componentWillReceiveProps:function(e){this.props.selection!==e.selection&&this.setState({selection:e.selection})},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return r.createElement(l,e,r.createElement("div",{className:"user-selection-dialog-box"},this.renderList(),this.renderButtons()))},renderList:function(){var e={selection:this.state.selection,disabled:this.props.disabled,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleListSelect};return r.createElement(p,null,r.createElement(d,e))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("selection-cancel"),onClick:this.handleCancelClick},n={label:e("selection-ok"),onClick:this.handleOKClick,emphasized:!0};return r.createElement("div",{className:"buttons"},r.createElement(u,t),r.createElement(u,n))},handleListSelect:function(e){var t=e.selection;_.isEqual(t,this.props.selection)&&(t=this.props.selection),this.setState({selection:t})},handleOKClick:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,selection:this.state.selection})},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})}})},function(e,t,n){"use strict";function r(e,t,n){var r=0,i=0,s=Math.min(e,t);return"center"!==n&&n||(e>s?r=Math.floor((e-s)/2):t>s&&(i=Math.floor((t-s)/2))),{left:r,top:i,width:s,height:s}}var i=n(3),s=(n(9),n(16),n(0)),o=s.PropTypes,a=n(4),c=n(5),l=n(10),u=n(279);n(591),e.exports=s.createClass({displayName:"ImageEditor",mixins:[l],propTypes:{resource:o.object,locale:o.instanceOf(a).isRequired,theme:o.instanceOf(c).isRequired,previewWidth:o.number,previewHeight:o.number,onChange:o.func},getDefaultProps:function(){return{previewWidth:512,previewHeight:512}},getInitialState:function(){var e={};return this.updateUrls(e,this.props),e},componentWillReceiveProps:function(e){var t=i.clone(this.state);this.props.resource!==e.resource&&this.updateUrls(t,e);var n=i.shallowDiff(t,this.state);i.isEmpty(n)||this.setState(n)},updateUrls:function(e,t){var n=e.imageUrl,i=t.resource,s=t.theme,o=s.getImageFile(i);o?(e.imageUrl=URL.createObjectURL(o),e.previewUrl=null):(e.imageUrl=s.getImageUrl(i,{clip:null}),e.previewUrl=s.getImageUrl(i,{width:this.props.previewWidth,height:this.props.previewHeight,clip:i.clip||r(i.width,i.height)})),e.imageUrl!==n&&(e.imageLoaded=p[e.imageUrl])},render:function(){return s.createElement("div",{className:"image-editor"},this.renderPlaceholder(),this.renderImageCropper(),this.renderPreview(),this.props.children)},renderPreview:function(){return!this.state.previewUrl||this.state.imageLoaded?null:s.createElement("img",{className:"preview",src:this.state.previewUrl})},renderImageCropper:function(){if(!this.state.imageUrl)return null;var e=this.props.resource,t={url:this.state.imageUrl,clippingRect:e.clip||r(e.width,e.height),onChange:this.handleClipRectChange,onLoad:this.handleImageLoad};return s.createElement(u,t)},renderPlaceholder:function(){if(this.state.imageUrl)return null;var e=this.props.locale.translate;return s.createElement("div",{className:"placeholder"},s.createElement("div",{className:"message"},e("image-editor-upload-in-progress")))},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,resource:e})},handleClipRectChange:function(e){var t=i.clone(this.props.resource);return t.clip=e.rect,this.triggerChangeEvent(t)},handleImageLoad:function(e){var t=e.target.props.url;this.state.imageUrl===t&&this.setState({imageLoaded:!0}),p[t]=!0}});var p={}},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(15),a=n(96),c=n(6),l=n(18),u=n(7),p=n(4),d=n(5),h=n(240);n(605),e.exports=o.createClass({displayName:"BookmarksPage",propTypes:{database:s.instanceOf(c).isRequired,payloads:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(p).isRequired,theme:s.instanceOf(d).isRequired},statics:{parseUrl:function(e,t,n){return u.match(e,["/:schema/bookmarks/?"],function(e){return e.story=n?parseInt(r.replace(n,/\D/g,"")):void 0,e})},getUrl:function(e){var t,n="/"+e.schema+"/bookmarks/";return e.story&&(t="story-"+e.story),{path:n,query:void 0,hash:t}},getOptions:function(e){return{navigation:{top:{dateSelection:!1,roleSelection:!1,textSearch:!1},bottom:{section:"bookmarks"}}}}},renderAsync:function(e,t){var n=this.props.route.parameters,r=this.props.database.use({schema:n.schema,by:this}),s=this.props.route!==t.route?100:1e3,o={bookmarks:null,currentUser:null,project:null,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(m,o),s),r.start().then(function(e){var t={};return t.id=e,r.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){o.currentUser=t,e.check()}).then(function(){var e={name:n.schema};return r.findOne({schema:"global",table:"project",criteria:e,required:!0})}).then(function(t){return o.project=t,e.show(i.createElement(m,o))}).then(function(){var e={target_user_id:o.currentUser.id};return r.find({table:"bookmark",criteria:e})}).then(function(e){return o.bookmarks=e,i.createElement(m,o)})}});var m=e.exports.Sync=i.createClass({displayName:"BookmarksPage.Sync",propTypes:{bookmarks:s.arrayOf(s.object),currentUser:s.object,project:s.object,database:s.instanceOf(c).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(p).isRequired,theme:s.instanceOf(d).isRequired},getAccessLevel:function(){var e=this.props,t=e.project,n=e.currentUser;return a.getUserAccessLevel(t,n)||"read-only"},render:function(){return i.createElement("div",{className:"bookmarks-page"},this.renderList())},renderList:function(){var e={access:this.getAccessLevel(),bookmarks:this.props.bookmarks,currentUser:this.props.currentUser,project:this.props.project,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.handleSelectionClear};return i.createElement(h,e)},handleSelectionClear:function(){this.props.route.loosen()}})},function(e,t,n){"use strict";var r=(n(3),n(0)),i=r.PropTypes,s=n(15),o=n(16),a=n(6),c=n(7),l=n(4),u=n(5),p=n(242);n(607),e.exports=s.createClass({displayName:"NotificationsPage",propTypes:{database:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired},statics:{parseUrl:function(e,t,n){return c.match(e,["/:schema/notifications/:date/?","/:schema/notifications/?"],function(e){return e.search=t.search,e})},getUrl:function(e){var t,n="/"+e.schema+"/notifications/";return e.date&&(n+=e.date+"/"),e.search&&(t={search:e.search}),{path:n,query:t,hash:void 0}},getOptions:function(e){return{navigation:{top:{dateSelection:!0,roleSelection:!1,textSearch:!0},bottom:{section:"notifications"}}}}},renderAsync:function(e,t){var n=this,i=this.props.route.parameters,s=this.props.database.use({schema:i.schema,by:this}),a=this.props.route!==t.route?100:1e3,c={currentUser:null,notifications:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(r.createElement(d,c),a),s.start().then(function(e){var t={id:e};return s.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){return c.currentUser=t,e.show(r.createElement(d,c))}).then(function(){var e={};if(e.target_user_id=c.currentUser.id,i.date){var t=o(i.date),r=t.clone().endOf("day"),a=t.toISOString(),l=r.toISOString(),u="["+a+","+l+"]";e.time_range=u}return i.search?(e.search={lang:n.props.locale.lang,text:i.search},e.limit=100):e.limit=500,s.find({table:"notification",criteria:e})}).then(function(e){return c.notifications=e,r.createElement(d,c)})}});var d=e.exports.Sync=r.createClass({displayName:"NotificationsPage.Sync",propTypes:{notifications:i.arrayOf(i.object),currentUser:i.object,database:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired},render:function(){return r.createElement("div",{className:"notifications-page"},this.renderList())},renderList:function(){var e={notifications:this.props.notifications,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.handleSelectionClear};return r.createElement(p,e)},handleSelectionClear:function(){this.props.route.loosen()}})},function(e,t,n){"use strict";var r=(n(3),n(0)),i=r.PropTypes,s=n(15),o=n(6),a=n(18),c=n(7),l=n(4),u=n(5),p=n(249),d=n(252),h=n(251),m=n(248),f=n(253),g=n(247),v=n(250),y=n(246);n(609),e.exports=s.createClass({displayName:"SettingsPage",propTypes:{database:i.instanceOf(o).isRequired,payloads:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired},statics:{parseUrl:function(e,t,n){return c.match(e,["/global/settings/?","/:schema/settings/?"],function(e){return e})},getUrl:function(e){var t="/"+(e.schema||"global")+"/settings/";return{path:t,query:void 0,hash:void 0}},getOptions:function(e){return{navigation:{top:{},bottom:{section:"settings"}}}}},renderAsync:function(e,t){var n=this,i=this.props.route.parameters,s=this.props.database.use({schema:i.schema,by:this}),o=this.props.route!==t.route?100:1e3,a={currentUser:null,currentProject:null,projectLinks:null,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(r.createElement(b,a),o),s.start().then(function(e){var t={id:e};return s.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){return n.props.payloads.reattach("global",t),a.currentUser=t,e.show(r.createElement(b,a),250)}).then(function(){var e={name:i.schema};return s.findOne({schema:"global",table:"project",criteria:e,required:!0})}).then(function(t){return a.currentProject=t,e.show(r.createElement(b,a),250)}).then(function(){var e={};return s.find({schema:"local",table:"project_link",criteria:e})}).then(function(e){return a.projectLinks=e,r.createElement(b,a)})}});var b=e.exports.Sync=r.createClass({displayName:"SettingsPage.Sync",propTypes:{currentUser:i.object,currentProject:i.object,projectLinks:i.arrayOf(i.object),database:i.instanceOf(o).isRequired,payloads:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired},getInitialState:function(){return{user:null}},getUser:function(){return this.state.user||this.props.currentUser},componentWillReceiveProps:function(e){this.props.currentUser!==e.currentUser&&this.setState({user:null})},render:function(){this.getUser(),this.props.currentProject,this.props.database,this.props.route,this.props.locale,this.props.theme,this.handleChange;return r.createElement("div",{className:"settings-page"},r.createElement("div",{className:"panels"},this.renderProjectPanel(),this.renderUserInfoPanel(),this.renderUserImagePanel(),this.renderSocialNetworkPanel(),this.renderLanguagePanel(),this.renderNotificationPanel(),this.renderWebAlertPanel(),this.renderMobileAlertPanel()))},renderProjectPanel:function(){var e={currentProject:this.props.currentProject,projectLinks:this.props.projectLinks,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(p,e)},renderUserInfoPanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,onChange:this.handleChange};return r.createElement(d,e)},renderUserImagePanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange};return r.createElement(h,e)},renderSocialNetworkPanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,onChange:this.handleChange};return r.createElement(v,e)},renderNotificationPanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,onChange:this.handleChange};return r.createElement(m,e)},renderWebAlertPanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,onChange:this.handleChange};return r.createElement(f,e)},renderMobileAlertPanel:function(){var e={currentUser:this.getUser(),locale:this.props.locale,onChange:this.handleChange};return r.createElement(g,e)},renderLanguagePanel:function(){var e={locale:this.props.locale};return r.createElement(y,e)},componentWillUnmount:function(){this.autosaveTimeout&&this.state.user&&(clearTimeout(this.autosaveTimeout),this.saveUser(this.state.user))},autosaveUser:function(e){var t=this;this.autosaveTimeout&&clearTimeout(this.autosaveTimeout),this.autosaveTimeout=setTimeout(function(){t.saveUser(e),t.autosaveTimeout=null},2e3)},saveUser:function(e){var t=this,n=this.props.payloads;return n.prepare("global",e).then(function(){return t.props.database.use({schema:"global",by:t}).saveOne({table:"user"},e).then(function(e){return n.dispatch("global",e).return(e)})})},handleChange:function(e){var t=this,n=e.user;this.setState({user:n},function(){t.autosaveUser(n)})}})},function(e,t,n){"use strict"},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=i.PropTypes,o=n(144);n(635),e.exports=i.createClass({displayName:"CornerPopUp",propType:{onOpen:s.func,onClose:s.func},getInitialState:function(){return{open:!1}},render:function(){var e={onOpen:this.handleOpen,onClose:this.handleClose},t=this.state.open?"left":"down";return i.createElement(o,r({className:"corner-pop-up"},e),i.createElement("button",null,i.createElement("i",{className:"fa fa-chevron-circle-"+t})),i.createElement("menu",null,this.props.children))},handleOpen:function(e){this.setState({open:!0}),this.props.onOpen&&this.props.onOpen({type:open,target:this})},handleClose:function(e){this.setState({open:!1}),this.props.onClose&&this.props.onClose({type:open,target:this})}})},function(e,t,n){"use strict";function r(e){if("number"!=typeof e)return"";var t=String(Math.floor(e/36e5)),n=String(Math.floor(e/6e4)%60),r=String(Math.round(e/1e3)%60);return 1===n.length&&(n="0"+n),1===r.length&&(r="0"+r),t+":"+n+":"+r}var i=n(0),s=i.PropTypes,o=n(10);n(637),e.exports=i.createClass({displayName:"DurationIndicator",mixins:[o],propTypes:{duration:s.number,startTime:s.instanceOf(Date)},calculateDuration:function(){var e=this.props.duration;if(this.props.startTime){e+=new Date-this.props.startTime}return e},componentWillMount:function(){this.props.startTime&&this.startTimer()},componentWillReceiveProps:function(e){!this.props.startTime&&e.startTime?this.startTimer():this.props.startTime&&!e.startTime&&this.stopTimer()},render:function(){var e=this.calculateDuration(),t="icon";return this.props.startTime&&(t+=" blinking"),i.createElement("div",{className:"duration-indiactor"},i.createElement("span",{className:t},i.createElement("i",{className:"fa fa-circle"})),i.createElement("span",{className:"duration"},r(e)))},componentWillUnmount:function(){this.stopTimer()},startTimer:function(){var e=this;this.interval||(this.interval=setInterval(function(){e.forceUpdate()},500))},stopTimer:function(){this.interval&&(clearInterval(this.interval),this.interval=null)}}),e.exports.format=r},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes;e.exports=i.createClass({displayName:"Link",propTypes:{url:s.string,alwaysAsLink:s.bool},getDefaultProps:function(){return{alwaysAsLink:!1}},getInitialState:function(){return{hasFocus:!1}},render:function(){var e=r.omit(this.props,"url","alwaysAsLink");return this.props.url&&(this.props.alwaysAsLink?e.href=this.props.url:(this.state.hasFocus?e.href=this.props.url:e["data-url"]=this.props.url,void 0===e.tabIndex&&(e.tabIndex=0),e.onFocus=this.handleFocus,e.onBlur=this.handleBlur)),i.createElement("a",e,this.props.children)},handleFocus:function(e){this.setState({hasFocus:!0})},handleBlur:function(e){this.setState({hasFocus:!1})}})},function(e,t,n){"use strict";function r(e){var t=["user"],n={user:e.user,theme:e.theme,size:"small"},r=e.locale.pick,i=r(e.user.details.name);return o.createElement("div",{className:t.join(" ")},o.createElement(h,n),o.createElement("span",{className:"name"},i))}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(3),o=n(0),a=o.PropTypes,c=n(4),l=n(5),u=n(25),p=n(17),d=n(44),h=n(29);n(640),e.exports=o.createClass({displayName:"MultipleUserNames",propTypes:{label:a.string,title:a.string,users:a.arrayOf(a.object).isRequired,popupLimit:a.number,locale:a.instanceOf(c),theme:a.instanceOf(l)},getDefaultProps:function(){return{popupLimit:8}},getInitialState:function(){return{showingPopUp:!1,showingDialogBox:!1,renderingDialogBox:!1}},render:function(){var e=["multiple-user-names"];this.props.className&&e.push(this.props.className);var t={className:e.join(" "),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n={className:"label",onClick:this.handleClick};return o.createElement("span",t,o.createElement("span",n,this.props.label),this.renderPopUp(),this.renderDialogBox())},renderPopUp:function(){return this.state.showingPopUp?o.createElement("div",{className:"popup-container"},o.createElement("div",{className:"popup"},this.renderUserList(this.props.popupLimit))):null},renderDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e={show:this.state.showingDialogBox,onBackgroundClick:this.handleDialogBoxClose},t={label:"OK",emphasized:!0,onClick:this.handleDialogBoxClose};return o.createElement(u,e,o.createElement("div",{className:"multiple-user-names-dialog-box"},o.createElement(d,null,o.createElement("div",{className:"list"},this.renderUserList())),o.createElement("div",{className:"buttons"},o.createElement(p,t))))},renderUserList:function(e){var t=this.props.locale.pick,n=s.sortBy(this.props.users,function(e){return t(e.details.name)});if(n.length>e){var r=this.props.locale.translate,i=s.slice(n,e),a=s.map(i,this.renderUser);return a.push(o.createElement("div",{key:0,className:"more"},r("list-$count-more",n.length-i.length))),a}return s.map(n,this.renderUser)},renderUser:function(e,t){var n={user:e,theme:this.props.theme,locale:this.props.locale};return o.createElement(r,i({key:e.id},n))},handleMouseEnter:function(e){this.setState({showingPopUp:!0})},handleMouseLeave:function(e){this.setState({showingPopUp:!1})},handleClick:function(e){e.target&&this.setState({showingPopUp:!1,showingDialogBox:!0,renderingDialogBox:!0})},handleDialogBoxClose:function(e){var t=this;this.setState({showingDialogBox:!1},function(){setTimeout(function(){t.setState({renderingDialogBox:!1})},1e3)})}})},function(e,t,n){"use strict";function r(e){var t=["new-items-alert",e.show?"show":"hide"];return i.createElement("div",{className:t.join(" "),onClick:e.onClick},i.createElement("i",{className:"fa fa-arrow-up"}),e.children)}var i=(n(3),n(0)),s=i.PropTypes,o=n(27);n(641),e.exports=i.createClass({displayName:"NewItemsAlertProxy",propTypes:{show:s.bool,onClick:s.func},getDefaultProps:function(){return{show:!1}},render:function(){return null},componentDidMount:function(){this.props.show&&this.show()},componentDidUpdate:function(e){e.show!==this.props.show?this.props.show?this.show():this.hide():e.children!==this.props.children&&this.props.show&&this.redraw()},componentWillUnmount:function(){this.hide()},show:function(){var e=this;if(this.containerNode)this.containerRemovalTimeout&&(clearTimeout(this.containerRemovalTimeout),this.containerRemovalTimeout=0);else{this.containerNode=document.createElement("DIV");document.getElementById("page-view-port").appendChild(this.containerNode)}var t={show:!1,onClick:this.props.onClick,children:this.props.children};o.render(i.createElement(r,t),this.containerNode),setTimeout(function(){t.show=!0,o.render(i.createElement(r,t),e.containerNode)},10)},redraw:function(){var e={show:!0,onClick:this.props.onClick,children:this.props.children};o.render(i.createElement(r,e),this.containerNode)},hide:function(){var e=this;if(this.containerNode){this.containerRemovalTimeout||(this.containerRemovalTimeout=setTimeout(function(){o.unmountComponentAtNode(e.containerNode),document.getElementById("page-view-port").removeChild(e.containerNode),e.containerNode=null,e.containerRemovalTimeout=0},500));var t={show:!1,children:this.props.children};o.render(i.createElement(r,t),this.containerNode)}}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0);s.PropTypes;n(654),e.exports=s.createClass({displayName:"UserSection",propTypes:{},render:function(){var e=["user-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});if(!n)return null;var o=s.Children.toArray(n.props.children);return i.isEmpty(o)?null:s.createElement("div",r({className:e},n.props),o)}})},function(e,t,n){"use strict";function r(e){return new p(function(t,n){var r=document.createElement("IMG");r.src=e,r.onload=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function i(e){var t={responseType:"arraybuffer"};return m.fetch("GET",e,null,t).then(function(e){return new Uint8Array(e)})}function s(e){var t=l(e,6),n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],c=n*s-r*i;return[s/c,-r/c,-i/c,n/c,(i*a-s*o)/c,-(n*a-r*o)/c]}function o(e,t){var n=l(e,6),r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],c=n[5],u=l(t,2),p=u[0],d=u[1];return[r*p+s*d+a,i*p+o*d+c]}function a(e,t){var n=[t.left,t.top],r=[t.left+t.width,t.top+t.height];return n=o(e,n),r=o(e,r),{width:Math.abs(r[0]-n[0]),height:Math.abs(r[1]-n[1]),left:Math.min(r[0],n[0]),top:Math.min(r[1],n[1])}}function c(e){/^blob:/.test(e)&&(URL.revokeObjectURL(e),console.log("Revoking: "+e))}var l=function(){function e(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=n(9),d=n(0),h=d.PropTypes,m=n(55),f=n(280),g=n(30);e.exports=d.createClass({displayName:"ImageView",propTypes:{url:h.string,clippingRect:h.object,revokeBlobUrl:h.bool,onLoad:h.func},getDefaultProps:function(){return{revokeBlobUrl:!0}},getInitialState:function(){return this.components=g({canvas:HTMLCanvasElement}),{}},componentWillMount:function(){this.load(this.props.url)},componentWillReceiveProps:function(e){this.props.url!==e.url&&(this.props.revokeBlobUrl&&c(this.props.url),this.load(e.url)),this.clippingRect!==e.clippingRect&&this.image&&this.drawImage(e.clippingRect)},render:function(){var e=this.components.setters,t=_.omit(this.props,"onLoad","url","clippingRect","revokeBlobUrl");return d.createElement("canvas",u({ref:e.canvas},t))},componentDidMount:function(){this.image&&this.redrawNeeded&&this.drawImage(this.props.clippingRect)},componentWillUnmount:function(){this.props.revokeBlobUrl&&c(this.props.url)},triggerLoadEvent:function(){this.props.onLoad&&this.props.onLoad({type:"load",target:this})},load:function(e){var t=this;return e?p.join(r(e),i(e),function(e,n){var r=f.getOrientation(n)||1;t.image=e,t.orientation=r,r<5?(t.naturalWidth=e.naturalWidth,t.naturalHeight=e.naturalHeight):(t.naturalWidth=e.naturalHeight,t.naturalHeight=e.naturalWidth);var i=t.props.clippingRect;i||(i={left:0,top:0,width:t.naturalWidth,height:t.naturalHeight}),t.drawImage(i),t.triggerLoadEvent()}):(this.clearCanvas(),p.resolve())},drawImage:function(e){var t=this.image;if(t){var n=this.components.canvas;if(!n)return void(this.redrawNeeded=!0);var r,i=this.orientation,o=t.naturalWidth,c=t.naturalHeight;switch(i){case 1:r=[1,0,0,1,0,0];break;case 2:r=[-1,0,0,1,o,0];break;case 3:r=[-1,0,0,-1,o,c];break;case 4:r=[1,0,0,-1,0,c];break;case 5:r=[0,1,1,0,0,0];break;case 6:r=[0,1,-1,0,c,0];break;case 7:r=[0,-1,-1,0,c,o];break;case 8:r=[0,-1,1,0,0,o]}e||(e={left:0,top:0,width:i<5?o:c,height:i<5?c:o}),this.width=e.width,this.height=e.height;var l=s(r),u=a(l,e),p=a(l,{left:0,top:0,width:e.width,height:e.height});n.width=p.width,n.height=p.height;var d=n.getContext("2d");d.transform.apply(d,r),d.drawImage(t,u.left,u.top,u.width,u.height,p.left,p.top,p.width,p.height)}},clearCanvas:function(){var e=this.components.canvas;e&&(e.width=0,e.height=0),this.width=0,this.height=0,this.orientation=void 0}})},function(e,t,n){"use strict";function r(e,t){if(e&&t&&!t.disabled){if("admin"===t.type||s.includes(e.user_ids,t.id))return e.archived?"read-only":"read-write";if(s.get(e,"settings.access_control.grant_view_access"))return e.archived?"read-only":s.get(e,"settings.access_control.grant_comment_access")?"read-comment":"read-only"}return null}function i(e,t){if(r(e,t))return!0;if("guest"===t.type){if(s.get(e,"settings.membership.allow_guest_request"))return!0}else if(s.get(e,"settings.membership.allow_user_request"))return!0;return!1}var s=n(3);t.default={},t.isVisibleToUser=i,t.getUserAccessLevel=r},function(e,t,n){"use strict";e.exports=t=["like","comment","task-completion","vote","coauthor","bookmark","note","assignment","issue","push","merge","survey","join-request"],t.admin=["join-request"]},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=(i.PropTypes,n(30));n(656),e.exports=i.createClass({displayName:"AutosizeTextArea",getInitialState:function(){return this.components=s({actual:HTMLTextAreaElement,shadow:HTMLTextAreaElement}),{requiredHeight:void 0}},render:function(){var e=this.components.setters,t=_.extend({height:this.state.requiredHeight},this.props.style),n=_.omit(this.props,"style");return i.createElement("div",{className:"autosize-text-area"},i.createElement("textarea",{ref:e.shadow,style:t,className:"shadow",value:n.value,readOnly:!0}),i.createElement("textarea",r({ref:e.actual,style:t},n)))},componentDidMount:function(){window.removeEventListener("resize",this.handleDocumentResize),this.updateSize()},componentDidUpdate:function(e,t){e.value!==this.props.value&&this.updateSize()},componentWillUnmount:function(){window.removeEventListener("resize",this.handleDocumentResize)},focus:function(){var e=this.components.actual;e&&e.focus()},updateSize:function(){var e=this.components.shadow,t=this.components.actual;if(e&&t){var n=e.offsetHeight,r=e.scrollHeight,i=e.clientHeight,s=t.offsetHeight,o=r+(n-i);if(this.state.height!==o){if(s>o&&s>this.state.requiredHeight)return;this.setState({requiredHeight:o})}}},handleResize:function(e){console.log("resize")},handleDocumentResize:function(e){this.updateSize()}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(4),o=n(25),a=n(17);n(582),e.exports=r.createClass({displayName:"ConfirmationDialogBox",propTypes:{show:i.bool,locale:i.instanceOf(s).isRequired,onClose:i.func,onConfirm:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(o,e,r.createElement("div",{className:"confirmation-dialog-box"},this.renderMessage(),this.renderButtons()))},renderMessage:function(){return r.createElement("div",{className:"message"},this.props.children)},renderButtons:function(){var e=this.props.locale.translate,t={label:e("confirmation-cancel"),onClick:this.props.onClose},n={label:e("confirmation-confirm"),onClick:this.props.onConfirm,emphasized:!0};return r.createElement("div",{className:"buttons"},r.createElement(a,t),r.createElement(a,n))}})},function(e,t,n){"use strict"},function(e,t,n){"use strict";function r(e,t,n){var r=0,i=0,s=Math.min(e,t);return"center"!==n&&n||(e>s?r=Math.floor((e-s)/2):t>s&&(i=Math.floor((t-s)/2))),{left:r,top:i,width:s,height:s}}function i(e){return new c(function(t,n){e.getAsString(t)})}function s(e){if(e){var t=document.createElement("DIV");t.innerHTML=e.replace(/<.*?>/g,""),website.title=t.innerText}}function o(e){return a.toUpper(l().format("YYYY-MMM-DD-hhA"))+e}var a=n(3),c=n(9),l=n(16),u=n(0),p=u.PropTypes,d=n(148),h=n(288),m=n(289),f=n(278),g=n(281),v=n(150),y=n(4),b=n(5),k=n(18),x=n(10),w=n(143),C=n(132),E=n(227),S=n(232),R=n(84),N=n(239),O=n(233);n(592),e.exports=u.createClass({displayName:"MediaEditor",mixins:[x],propTypes:{resources:p.arrayOf(p.object),initialResourceIndex:p.number,locale:p.instanceOf(y).isRequired,theme:p.instanceOf(b).isRequired,payloads:p.instanceOf(k).isRequired,onChange:p.func.isRequired,onEmbed:p.func},getInitialState:function(){return{capturing:null,selectedResourceIndex:this.props.initialResourceIndex||0}},capture:function(e){this.setState({capturing:e})},importDataItems:function(e){var t=this,n=a.filter(e,function(e){if("string"===e.kind)return/^text\/(html|uri-list)/.test(e.type)}),o={};return a.each(n,function(e){o[e.type]=i(e)}),c.props(o).then(function(e){var t=e["text/html"],n=e["text/uri-list"];if(n){return/<img\b/i.test(t)?d.loadImage(n).then(function(e){var t=n.replace(/.*\/([^\?#]*).*/,"$1")||void 0;return{type:"image",external_url:n,filename:t,width:e.naturalWidth,height:e.naturalHeight,clip:r(e.naturalWidth,e.naturalHeight)}}):{type:"website",url:n,title:s(t)}}}).then(function(e){if(e)return t.addResources([e])})},getResourceCount:function(){var e=this.props.resources;return e?e.length:0},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1,t=this.state.selectedResourceIndex;return t>e&&(t=e),t},render:function(){var e="media-editor";return-1===this.getSelectedResourceIndex()&&(e+=" inactive"),u.createElement("div",{className:e},this.renderResource(),this.renderNavigation(),this.renderDialogBox())},renderResource:function(e){var t=this.getSelectedResourceIndex();if(-1===t)return this.props.children;var n={resource:this.props.resources[t],locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleResourceChange};switch(n.resource.type){case"image":case"website":return u.createElement(R,n);case"video":return u.createElement(N,n);case"audio":return u.createElement(O,n)}},renderNavigation:function(){var e=this.props.locale.translate,t=this.getSelectedResourceIndex(),n=this.getResourceCount();if(0===n)return null;var r={label:e("media-editor-remove"),icon:"remove",onClick:this.handleRemoveClick},i={label:e("media-editor-embed"),icon:"code",onClick:this.handleEmbedClick},s={label:e("media-editor-shift"),icon:"chevron-left",hidden:!(n>1),disabled:!(t>0),onClick:this.handleShiftClick},o={index:t,count:n,hidden:!(n>1),onBackwardClick:this.handleBackwardClick,onForwardClick:this.handleForwardClick};return u.createElement("div",{className:"navigation"},u.createElement("div",{className:"left"},u.createElement(w,r),u.createElement(w,i),u.createElement(w,s)),u.createElement("div",{className:"right"},u.createElement(w.Direction,o)))},renderDialogBox:function(){return null},renderPhotoDialog:function(){var e={show:"image"===this.state.capturing,locale:this.props.locale,onCapture:this.handlePhotoCapture,onCancel:this.handleCaptureCancel};return u.createElement(C,e)},renderVideoDialog:function(){var e={show:"video"===this.state.capturing,payloads:this.props.payloads,locale:this.props.locale,onCapture:this.handleVideoCapture,onCancel:this.handleCaptureCancel};return u.createElement(S,e)},renderAudioDialog:function(){var e={show:"audio"===this.state.capturing,payloads:this.props.payloads,locale:this.props.locale,onCapture:this.handleAudioCapture,onCancel:this.handleCaptureCancel};return u.createElement(E,e)},triggerChangeEvent:function(e){return this.props.onChange({type:"change",target:this,resources:e})},triggerEmbedEvent:function(e){this.props.onEmbed&&this.props.onEmbed({type:"embed",target:this,resource:e})},selectResource:function(e){var t=this;return new c(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedResourceIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},addResources:function(e){var t=this;if(a.isEmpty(e))return c.resolve();var n=this.props.resources||[],r=a.concat(n,e),i=n.length;return this.triggerChangeEvent(r).then(function(){return t.selectResource(i)})},importFiles:function(e){var t=this;e=a.slice(e);var n=[];return c.map(e,function(e,t){var i=a.last(a.split(e.type,"/"));if(/^image\//.test(e.type)){var s=n[t]=URL.createObjectURL(e);return d.loadImage(s).then(function(t){return{type:"image",format:i,filename:e.name,file:e,width:t.naturalWidth,height:t.naturalHeight,clip:r(t.naturalWidth,t.naturalHeight)}})}if(/^video\//.test(e.type))return g.process(e).then(function(s){s||(s=e);var o=n[t]=URL.createObjectURL(s);return d.loadVideo(o).then(function(t){return f.capture(t).then(function(n){var o=new v;return o.pipe(s),{type:"video",format:i,filename:e.name,file:s,stream:o,poster_file:n,width:t.videoWidth,height:t.videoHeight,clip:r(t.videoWidth,t.videoHeight),duration:Math.round(1e3*t.duration)}})})});if(/^audio\//.test(e.type)){var s=n[t]=URL.createObjectURL(e);return d.loadAudio(s).then(function(t){var n=new v;return n.pipe(e),{type:"audio",format:i,filename:e.name,file:e,stream:n,duration:Math.round(1e3*t.duration)}})}return/^application\/(x-mswinurl|x-desktop)/.test(e.type)?h.loadText(e).then(function(t){var n=m.parse(t);if(n)return{type:"website",url:n.url,title:n.name||a.replace(e.name,/\.\w+$/,"")}}):void 0}).then(function(e){return t.addResources(a.filter(e))}).finally(function(){a.each(n,function(e){URL.revokeObjectURL(e)})})},handlePhotoCapture:function(e){var t=a.clone(e.image);t.type="image",t.filename=o(".jpg"),t.clip=r(t.width,t.height),this.addResources([t]),this.handleCaptureCancel(e)},handleVideoCapture:function(e){var t=a.clone(e.video);t.type="video",t.filename=o("."+t.format),t.clip=r(t.width,t.height),this.addResources([t]),this.handleCaptureCancel(e)},handleAudioCapture:function(e){var t=a.clone(e.audio);t.type="audio",t.filename=o("."+t.format),this.addResources([t]),this.handleCaptureCancel(e)},handleCaptureCancel:function(e){this.setState({capturing:null})},handleShiftClick:function(e){var t=this,n=this.getSelectedResourceIndex();if(n<1)return 0;var r=a.slice(this.props.resources),i=r[n];return r.splice(n,1),r.splice(n-1,0,i),this.triggerChangeEvent(r).then(function(){return t.selectResource(n-1)})},handleRemoveClick:function(e){var t=this,n=this.getSelectedResourceIndex();if(n<0)return c.resolve(n);var r=a.slice(this.props.resources);return r.splice(n,1),this.triggerChangeEvent(r).then(function(){return n>=r.length?t.selectResource(r.length-1):n})},handleEmbedClick:function(e){var t=this.getSelectedResourceIndex();if(!(t<0)){var n=this.props.resources[t];this.triggerEmbedEvent(n)}},handleBackwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t-1)},handleForwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t+1)},handleResourceChange:function(e){var t=this.getSelectedResourceIndex(),n=a.slice(this.props.resources);n[t]=e.resource,this.triggerChangeEvent(n)}})},function(e,t,n){"use strict";function r(e){return i.some(e,function(e){if(!e.url&&!e.payload_id)return!0})}var i=n(3),s=n(9),o=n(0),a=o.PropTypes,c=n(19),l=n(67),u=n(6),p=n(18),d=n(7),h=n(4),m=n(5),f=n(10),g=n(237),v=n(236),y=n(238),b=n(235),k=n(89),x=n(131);n(594);e.exports=o.createClass({displayName:"StoryEditor",mixins:[f],propTypes:{story:a.object,authors:a.arrayOf(a.object),recommendations:a.arrayOf(a.object),recipients:a.arrayOf(a.object),currentUser:a.object,isStationary:a.bool,database:a.instanceOf(u).isRequired,payloads:a.instanceOf(p).isRequired,route:a.instanceOf(d).isRequired,locale:a.instanceOf(h).isRequired,theme:a.instanceOf(m).isRequired},getDefaultProps:function(){return{isStationary:!1}},getInitialState:function(){var e={options:w,selectedResourceIndex:void 0,draft:null,confirming:!1,action:null};return this.updateDraft(e,this.props),this.updateOptions(e,this.props),this.updateLeadAuthor(e,this.props),e},isCoauthoring:function(){var e=i.get(this.props.story,"user_ids"),t=i.get(this.props.currentUser,"id");return i.indexOf(e,t)>0},componentWillReceiveProps:function(e){var t=i.clone(this.state);this.props.story!==e.story&&this.updateDraft(t,e),this.props.currentUser!==e.currentUser&&this.updateLeadAuthor(t,e),this.props.story===e.story&&this.props.recommendations===e.recommendations&&this.props.locale===e.locale||this.updateOptions(t,e);var n=i.shallowDiff(t,this.state);i.isEmpty(n)||this.setState(n)},updateDraft:function(e,t){if(t.story){var n=this.props.story||C(this.props.currentUser),r=e.draft,i=t.story;r!==n&&r&&(i=l.mergeObjects(r,i,n)),e.draft=i}else e.draft=C(t.currentUser)},updateLeadAuthor:function(e,t){if(!e.story){var n=i.get(t.currentUser,"id");e.draft.user_ids||(e.draft=i.decouple(e.draft,"user_ids",[]),e.draft.user_ids[0]=n)}},updateOptions:function(e,t){var n=e.options;t.story||(n=w),n=e.options=i.clone(n),n.hidePost=!e.draft.public,n.bookmarkRecipients=i.map(t.recommendations,"target_user_id"),n.preview||(n.preview=this.choosePreview(e.draft)),n.languageCode||(n.languageCode=this.chooseLanguage(e.draft,t.locale))},choosePreview:function(e){return"survey"===e.type||"task-list"===e.type?"text":i.get(e,"details.markdown",!1)?"text":""},chooseLanguage:function(e,t){var n=t.languageCode,r=i.get(e,"details.text");if(!i.isEmpty(r)){var s=i.first(i.keys(r));n.substr(0,2)!==s&&(n=s)}return n},render:function(){return"columns-1"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-1"},this.renderTextEditor(),this.renderSupplementalEditor(),this.renderConfirmationDialogBox()):"columns-2"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-2"},o.createElement("div",{className:"column-1"},this.renderTextEditor()),o.createElement("div",{className:"column-2"},this.renderSupplementalEditor()),this.renderConfirmationDialogBox()):"columns-3"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-3"},o.createElement("div",{className:"column-1"},this.renderTextEditor()),o.createElement("div",{className:"column-2"},this.renderSupplementalEditor()),o.createElement("div",{className:"column-3"},this.renderOptions()),this.renderConfirmationDialogBox()):void 0},renderTextEditor:function(){var e={story:this.state.draft,authors:this.props.authors,coauthoring:this.isCoauthoring(),options:this.state.options,cornerPopUp:this.renderPopUpMenu("main"),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange,onPublish:this.handlePublish,onCancel:this.handleCancel};return o.createElement(g,e)},renderSupplementalEditor:function(){return"text"===this.state.options.preview?this.renderTextPreview():this.renderMediaPreview()},renderTextPreview:function(){var e={story:this.state.draft,options:this.state.options,cornerPopUp:this.renderPopUpMenu("supplemental"),database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange,onResourceClick:this.handleResourceClick};return o.createElement(y,e)},renderMediaPreview:function(){var e={story:this.state.draft,cornerPopUp:this.renderPopUpMenu("supplemental"),selectedResourceIndex:this.state.selectedResourceIndex,options:this.state.options,showHints:this.props.showHints,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange};return o.createElement(v,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:o.createElement(k,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,story:this.state.draft,options:this.state.options,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleOptionsChange};return o.createElement(b,n)},renderConfirmationDialogBox:function(){var e,t=this.props.locale.translate,n={show:this.state.confirming,locale:this.props.locale,onClose:this.handleDialogClose};return"delete-post"===this.state.action?(e=t("story-cancel-are-you-sure"),n.onConfirm=this.handleCancelConfirm):(e=t("story-remove-yourself-are-you-sure"),n.onConfirm=this.handleRemoveConfirm),o.createElement(x,n,e)},changeDraft:function(e){var t=this;return new s(function(n,r){var s=t.state.options;if(!s.preview){var o=t.choosePreview(e);o&&(s=i.decoupleSet(s,"preview",o))}t.setState({draft:e,options:s},function(){n(e)})})},changeOptions:function(e){var t=this;return new s(function(n,r){t.setState({options:e},function(){n(e)})})},autosaveStory:function(e,t){var n=this;t?(this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveStory(e)},t),this.autosaveUnloadHandler=function(){n.saveStory(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)):this.saveStory(e)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveStory:function(e){var t=this;this.cancelAutosave();var n=this.props.route.parameters,r=(e.details.resources,this.props.payloads);return r.prepare(n.schema,e).then(function(){var i=t.props.database.use({schema:n.schema,by:t});return i.start().then(function(){return i.saveOne({table:"story"},e).then(function(e){return r.dispatch(n.schema,e).return(e)})})})},removeStory:function(e){var t=this.props.route,n=t.parameters.schema;return this.props.database.use({schema:n,by:this}).removeOne({table:"story"},e)},removeSelf:function(){var e=this.props.story,t=i.without(e.user_ids,this.props.currentUser.id),n={id:e.id,user_ids:t},r=this.props.route.parameters,s=this.props.database.use({schema:r.schema,by:this});return s.start().then(function(){return s.saveOne({table:"story"},n)})},saveBookmarks:function(e){if(i.isEmpty(e))return s.resolve([]);var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.save({table:"bookmark"},e)})},removeBookmarks:function(e){if(i.isEmpty(e))return s.resolve([]);var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.remove({table:"bookmark"},e)})},sendBookmarks:function(e,t){var n=this,r=this.props.recommendations,s=[];i.each(t,function(t){if(!i.some(r,{target_user_id:t})){var o={story_id:e.published_version_id||e.id,user_ids:[n.props.currentUser.id],target_user_id:t};s.push(o)}});var o=[];return i.each(r,function(e){i.includes(t,e.target_user_id)||o.push(e)}),this.saveBookmarks(s).then(function(e){return n.removeBookmarks(o).then(function(t){return i.concat(e,t)})})},handleChange:function(e){var t=this;return this.changeDraft(e.story).then(function(n){var i;switch(e.path){case"details.resources":r(n.details.resources)&&(i=0);break;case"user_ids":i=0;break;default:i=2e3}return t.autosaveStory(n,i),null})},handlePublish:function(e){var t=this,n=i.clone(this.state.draft),r=this.state.options;if(n.type||(n.type="story"),i.isEmpty(n.role_ids)){var s=i.map(this.props.authors,"role_ids");n.role_ids=i.uniq(i.flatten(s))}return n.public=!r.hidePost,n.published=!0,this.changeDraft(n).then(function(){return t.saveStory(n).then(function(e){return t.sendBookmarks(e,r.bookmarkRecipients).then(function(){var e=C(t.props.currentUser);return t.changeDraft(e)})})})},handleCancel:function(e){var t;t=this.isCoauthoring()?"remove-self":"delete-post",this.setState({confirming:!0,action:t})},handleOptionsChange:function(e){return this.changeOptions(e.options)},handleResourceClick:function(e){var t=this.state.draft.details.resources,n=i.indexOf(t,e.resource),r=i.decoupleSet(this.state.options,"preview","media");this.setState({selectedResourceIndex:n,options:r})},handleDialogClose:function(e){this.setState({confirming:!1})},handleCancelConfirm:function(e){var t=this;this.setState({confirming:!1});var n=this.state.draft;if(this.props.isStationary){var r=C(this.props.currentUser);this.changeDraft(r).then(function(){return n.id?t.removeStory(n):n})}else this.removeStory(n)},handleRemoveConfirm:function(e){this.setState({confirming:!1}),this.removeSelf()}});var w={languageCode:"",addIssue:!1,hidePost:!1,bookmarkRecipients:[],preview:""},C=c(function(e){return{user_ids:[e.id],details:{},public:!0}},{user_ids:[],details:{},public:!0})},function(e,t,n){"use strict";function r(e){var t=i.flatten(i.map(e,"user_ids"));return i.uniq(t)}var i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=n(15),c=n(19),l=n(6),u=n(18),p=n(7),d=n(4),h=n(5),m=n(10),f=n(68),g=n(140),v=n(134),y=n(93);n(602),e.exports=a.createClass({displayName:"StoryList",propTypes:{access:o.oneOf(["read-only","read-comment","read-write"]).isRequired,acceptNewStory:o.bool,stories:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),pendingStories:o.arrayOf(o.object),currentUser:o.object,project:o.object,selectedStoryId:o.number,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onSelectionClear:o.func},getDefaultProps:function(){return{acceptNewStory:!1}},renderAsync:function(e,t){var n=this.props.route.parameters,o=this.props.database.use({schema:n.schema,by:this}),a=k(this.props.currentUser),c=this.props.route!==t.route?100:1e3,l={authors:a,draftAuthors:a,pendingAuthors:a,reactions:null,respondents:null,recommendations:null,recipients:null,repos:null,selectedStoryId:this.props.selectedStoryId,access:this.props.access,acceptNewStory:this.props.acceptNewStory,stories:this.props.stories,draftStories:this.props.draftStories,pendingStories:this.props.pendingStories,currentUser:this.props.currentUser,project:this.props.project,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.props.onSelectionClear};return e.show(s.createElement(b,l),c),o.start().then(function(e){if(!i.isEmpty(l.stories)){var t={id:r(l.stories)};return o.find({schema:"global",table:"user",criteria:t})}}).then(function(t){if(t)return l.authors=t,e.show(s.createElement(b,l))}).then(function(){var e=l.stories||[];if(l.pendingStories&&(e=i.concat(l.pendingStories,e)),!i.isEmpty(e)){var t={story_id:i.map(i.concat(l.pendingStories,l.stories),"id")};return"guest"===l.currentUser.type&&(t.public=!0),o.find({table:"reaction",criteria:t})}}).then(function(t){if(t){var r=i.filter(t,{ptime:null});return i.each(r,function(e){l.payloads.reattach(n.schema,e)}),l.reactions=t,e.show(s.createElement(b,l))}}).then(function(){if(!i.isEmpty(l.reactions)){var e={id:i.uniq(i.map(l.reactions,"user_id"))};return o.find({schema:"global",table:"user",criteria:e})}}).then(function(t){if(t)return l.respondents=t,e.show(s.createElement(b,l))}).then(function(){if(l.draftStories){var e=r(l.draftStories),t=i.difference(e,[l.currentUser.id]);if(t.length>0){var n={id:i.union(t,[l.currentUser.id])};return o.find({schema:"global",table:"user",criteria:n})}}}).then(function(t){if(t)return l.draftAuthors=t,e.show(s.createElement(b,l))}).then(function(){if(l.pendingStories){var e=r(l.pendingStories);if(i.difference(e,[l.currentUser.id]).length>0){var t={id:e};return o.find({schema:"global",table:"user",criteria:t})}}}).then(function(t){if(t)return l.pendingAuthors=t,e.show(s.createElement(b,l))}).then(function(){if(l.currentUser){var e={story_id:i.map(l.stories,"id"),user_ids:[l.currentUser.id]};return o.find({table:"bookmark",criteria:e})}}).then(function(e){if(e)return l.recommendations=e,s.createElement(b,l)}).then(function(){if(l.recommendations){var e={id:i.map(l.recommendations,"target_user_id")};return o.find({schema:"global",table:"user",criteria:e})}}).then(function(e){e&&(l.recipients=e)}).then(function(){if(l.project){var e={id:i.get(l.project,"repo_ids",[])};return o.find({schema:"global",table:"repo",criteria:e})}}).then(function(e){return e&&(l.repos=e),s.createElement(b,l)})}});var b=e.exports.Sync=s.createClass({displayName:"StoryList.Sync",mixins:[m],propTypes:{access:o.oneOf(["read-only","read-comment","read-write"]).isRequired,acceptNewStory:o.bool,stories:o.arrayOf(o.object),authors:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),draftAuthors:o.arrayOf(o.object),pendingStories:o.arrayOf(o.object),pendingAuthors:o.arrayOf(o.object),reactions:o.arrayOf(o.object),respondents:o.arrayOf(o.object),recommendations:o.arrayOf(o.object),recipients:o.arrayOf(o.object),currentUser:o.object,project:o.object,repos:o.arrayOf(o.object),selectedStoryId:o.number,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onSelectionClear:o.func},getInitialState:function(){return{hiddenStoryIds:[],selectedStoryId:null}},componentWillReceiveProps:function(e){if(this.props.stories!==e.stories&&!i.isEmpty(this.state.hiddenStoryIds)){var t=i.filter(this.state.hiddenStoryIds,function(t){return i.some(e.stories,{id:t})});this.setState({hiddenStoryIds:t})}this.props.route!==e.route&&this.setState({selectedStoryId:null})},render:function(){var e=x(this.props.stories,this.props.pendingStories,this.props.draftStories,this.props.currentUser,this.props.acceptNewStory),t=this.state.selectedStoryId||this.props.selectedStoryId,n={items:e,offset:20,behind:4,ahead:8,anchor:t?"story-"+t:void 0,onIdentity:this.handleStoryIdentity,onRender:this.handleStoryRender,onAnchorChange:this.handleStoryAnchorChange,onBeforeAnchor:this.handleStoryBeforeAnchor};return s.createElement("div",{className:"story-list"},s.createElement(f,n),this.renderNewStoryAlert())},renderNewStoryAlert:function(){var e=this.props.locale.translate,t=i.size(this.state.hiddenStoryIds),n=t>0;t?this.previousHiddenStoryCount=t:t=this.previousHiddenStoryCount||0;var r={show:n,onClick:this.handleNewStoryAlertClick};return s.createElement(y,r,e("alert-$count-new-stories",t))},handleStoryIdentity:function(e){return this.props.acceptNewStory&&0===e.currentIndex?"story-top":"story-"+e.item.id},handleStoryRender:function(e){var t=e.item,n=!1;if(t){if("read-write"===this.props.access)if(t.published){var r=i.find(this.props.draftStories,{published_version_id:t.id});r&&(t=r,n=!0)}else n=!0}else n=!0;if(n){var o=E(this.props.draftAuthors,t),a=R(this.props.recommendations,t),c=N(this.props.recipients,a);t||(o=k(this.props.currentUser));var l={story:t,authors:o,recommendations:a,recipients:c,isStationary:0===e.currentIndex,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(v,l)}if(e.needed){var u=C(this.props.reactions,t),o=E(this.props.authors,t),p=S(this.props.respondents,u),a=R(this.props.recommendations,t),c=N(this.props.recipients,a),d={access:this.props.access,story:t,reactions:u,authors:o,respondents:p,recommendations:a,recipients:c,repos:this.props.repos,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(g,d)}var h=e.previousHeight||e.estimatedHeight||100;return s.createElement("div",{className:"story-view",style:{height:h}})},handleStoryAnchorChange:function(e){var t=i.get(e.item,"id");t&&!i.includes(this.state.hiddenStoryIds,t)||this.setState({hiddenStoryIds:[]}),this.props.selectedStoryId&&t!==this.props.selectedStoryId&&this.props.onSelectionClear&&this.props.onSelectionClear({type:"selectionclear",target:this})},handleStoryBeforeAnchor:function(e){var t=i.map(e.items,"id"),n=i.union(t,this.state.hiddenStoryIds);this.setState({hiddenStoryIds:n})},handleNewStoryAlertClick:function(e){this.setState({hiddenStoryIds:[],selectedStoryId:i.first(this.state.hiddenStoryIds)})}}),k=c(function(e){return[e]}),x=c(function(e,t,n,r,s){if(i.isEmpty(t)||(e=i.slice(e),i.each(t,function(t){t.published_version_id||e.push(t)})),e=i.orderBy(e,[w],["desc"]),s){var o=i.filter(n,function(e){return!e.published_version_id}),a=function(e){return e.user_ids[0]===r.id};o=i.orderBy(o,[a,"id"],["desc","desc"]);i.find(o,function(e){if(e.user_ids[0]===r.id)return!0})||(o=i.concat(null,o)),e=i.concat(o,e)}return e}),w=function(e){return e.btime||e.ptime},C=c(function(e,t){return t?i.filter(e,{story_id:t.id}):[]}),E=c(function(e,t){if(t){var n=i.keyBy(e,"id");return i.filter(i.map(t.user_ids,function(e){return n[e]}))}return[]}),S=c(function(e,t){var n=i.uniq(i.map(t,"user_id")),r=i.keyBy(e,"id");return i.filter(i.map(n,function(e){return r[e]}))}),R=c(function(e,t){if(t){var n=t.published_version_id||t.id;return i.filter(e,{story_id:n})}return[]}),N=c(function(e,t){return i.filter(e,function(e){return i.some(t,{target_user_id:e.id})})})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(54),o=n(6),a=n(7),c=n(4),l=n(5);n(606),e.exports=r.createClass({displayName:"ErrorPage",propTypes:{database:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},statics:{parseUrl:function(e,t,n){return a.match(e,["/error/:code"],function(e){return e.code=parseInt(e.code),e})},getUrl:function(e){var t="/error/"+e.code;return{path:t,query:void 0,hash:void 0}},getOptions:function(e){return{}}},render:function(){var e,t=this.props.route.parameters,i=new s(t.code),o=n(660);return e=404===t.code?"The page you're trying to reach doesn't exist. But then again, who does?":"The application is behaving in ways its maker never intended.",r.createElement("div",{className:"error-page"},r.createElement("div",null,r.createElement("div",{className:"graphic"},r.createElement(o,null)),r.createElement("div",{className:"text"},r.createElement("h1",{className:"title"},i.statusCode," ",i.message),r.createElement("p",null,e))))}})},function(e,t,n){"use strict";function r(e,t){if(e instanceof Object)for(var n in e)if(r(e[n],t))return!0;var s=i.split(i.toLower(i.trim(e)),/\s+/);return i.every(t,function(e){return i.some(s,function(t){return i.startsWith(t,e)})})}var i=n(3),s=n(0),o=s.PropTypes,a=n(15),c=n(19),l=n(6),u=n(7),p=n(4),d=n(5),h=n(243);n(608),e.exports=a.createClass({displayName:"PeoplePage",propTypes:{database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired},statics:{parseUrl:function(e,t,n){return u.match(e,["/:schema/people/:roles/?","/:schema/people/?"],function(e){return e.roles=i.filter(i.map(i.split(e.roles,"+"),parseInt)),e.search=t.search,e})},getUrl:function(e){var t,n="/"+e.schema+"/people/";return i.isEmpty(e.roles)||(url+=e.roles.join("+")+"/"),e.search&&(t={search:e.search}),{path:n,query:t,hash:void 0}},getOptions:function(e){return{navigation:{top:{dateSelection:!1,roleSelection:!0,textSearch:!0},bottom:{section:"people"}}}}},renderAsync:function(e,t){var n=this.props.route.parameters,r=this.props.database.use({schema:n.schema,by:this}),o=this.props.route!==t.route?100:1e3,a={project:null,users:null,currentUserId:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(s.createElement(m,a),o),r.start().then(function(e){var t={id:e};return r.findOne({schema:"global",table:"user",criteria:t,required:!0})}).then(function(t){a.currentUser=t,e.check()}).then(function(){var e={name:n.schema};return r.findOne({schema:"global",table:"project",criteria:e,required:!0})}).then(function(t){return a.project=t,e.show(s.createElement(m,a))}).then(function(){var e={id:a.project.user_ids,hidden:!1};return i.isEmpty(n.roles)||(e.role_ids=n.roles),r.find({schema:"global",table:"user",criteria:e})}).then(function(e){return n.search&&(e=f(e,n.search)),a.users=e,s.createElement(m,a)})}});var m=e.exports.Sync=s.createClass({displayName:"PeoplePageSync",propTypes:{users:o.arrayOf(o.object),listings:o.arrayOf(o.object),stories:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired},render:function(){return s.createElement("div",{className:"people-page"},this.renderList())},renderList:function(){if(!this.props.currentUser||!this.props.users)return null;var e={users:this.props.users,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(h,e)}}),f=c(function(e,t){var n=i.split(i.toLower(t),/\+/);return i.filter(e,function(e){return!!r(e.details.name,n)||(!!r(e.username,n)||(!!r(e.details.email,n)||void 0))})})},function(e,t,n){"use strict";function r(e){return _.first(_.keys(e.versions))||null}var i=n(0),s=i.PropTypes,o=(n(55),n(19)),a=n(30),c=n(4),l=n(5),u=(n(25),n(143)),p=n(82),d=n(95),h=n(90),m=n(10);n(622),e.exports=i.createClass({displayName:"MediaView",mixins:[m],propTypes:{resources:s.arrayOf(s.object).isRequired,locale:s.instanceOf(c).isRequired,theme:s.instanceOf(l).isRequired},getInitialState:function(){return this.components=a({audioPlayer:HTMLAudioElement}),{selectedIndex:0,renderingDialogBox:!1,showingDialogBox:!1,audioUrl:null}},getResourceCount:function(){return this.props.resources.length},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1;return _.min([this.state.selectedIndex,e])},getSelectedResource:function(){var e=this.getSelectedResourceIndex();return-1!==e?this.props.resources[e]:null},selectResource:function(e){var t=this;return new Promise(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},render:function(){return i.createElement("div",{className:"media-view"},this.renderResource(),this.renderNavigation(),this.renderAudioPlayer(),this.renderDialogBox())},renderNavigation:function(){var e=this.getResourceCount();if(e<=1)return null;var t=_.min([e-1,this.state.selectedIndex]),n={index:t,count:e,onBackwardClick:this.handleBackwardClick,onForwardClick:this.handleForwardClick};return i.createElement("div",{className:"navigation"},i.createElement("div",{className:"right"},i.createElement(u.Direction,n)))},renderAudioPlayer:function(){if(!this.state.audioUrl)return null;var e={ref:this.components.setters.audioPlayer,src:this.state.audioUrl,autoPlay:!0,controls:!0,onEnded:this.handleAudioEnded};return i.createElement("audio",e)},renderDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e=f(this.props.resources),t=this.getSelectedResourceIndex(),n=_.indexOf(e,this.props.resources[t]),r={show:this.state.showingDialogBox,resources:e,selectedIndex:n,locale:this.props.locale,theme:this.props.theme,onClose:this.handleDialogClose};return i.createElement(p,r)},renderResource:function(){var e=this.props.resources.length,t=_.min([e-1,this.state.selectedIndex]),n=this.props.resources[t];switch(n.type){case"image":return this.renderImage(n);case"video":return this.renderVideo(n);case"audio":return this.renderAudio(n);case"website":return this.renderWebsite(n)}},renderImage:function(e){return i.createElement("div",{className:"image",onClick:this.handleImageClick},this.renderImageElement(e))},renderVideo:function(e){return i.createElement("div",{className:"video",onClick:this.handleVideoClick},this.renderImageElement(e),i.createElement("div",{className:"overlay hidden"},i.createElement("div",{className:"icon"},i.createElement("i",{className:"fa fa-play-circle-o"})),i.createElement("div",{className:"duration"},h.format(e.duration))))},renderAudio:function(e){return i.createElement("div",{className:"audio",onClick:this.handleAudioClick},i.createElement("div",{className:"overlay"},i.createElement("div",{className:"icon"},i.createElement("i",{className:"fa fa-play-circle"})),i.createElement("div",{className:"duration"},h.format(e.duration))))},renderWebsite:function(e){return i.createElement("div",{className:"website"},i.createElement("a",{href:e.url,target:"_blank"},this.renderImageElement(e),i.createElement("div",{className:"overlay hidden"},i.createElement("div",{className:"icon"},i.createElement("i",{className:"fa fa-external-link"})))))},renderImageElement:function(e){var t,n=e.clip,r=this.props.theme;t=n?Math.round(512*n.height/n.width):Math.round(512*e.height/e.width);var s=r.getImageUrl(e,{width:512,height:t}),o=r.getImageFile(e);return s?i.createElement("img",{src:s,width:512,height:t}):o instanceof Blob?(s=URL.createObjectURL(o),i.createElement(d,{url:s,clippingRect:n})):null},pauseAudio:function(){var e=this.components.audioPlayer;e&&e.pause()},handleBackwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t-1)},handleForwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t+1)},handleImageClick:function(e){this.setState({showingDialogBox:!0,renderingDialogBox:!0})},handleVideoClick:function(e){this.pauseAudio(),this.setState({showingDialogBox:!0,renderingDialogBox:!0})},handleAudioClick:function(e){var t=this.getSelectedResource(),n=r(t),i=this.props.theme.getAudioUrl(t,{version:n});this.setState({audioUrl:i})},handleAudioEnded:function(e){this.setState({audioUrl:null})},handleDialogClose:function(e){var t=this;this.setState({showingDialogBox:!1},function(){setTimeout(function(){t.setState({renderingDialogBox:!1})},1e3)})}});var f=o(function(e){return _.filter(e,function(e){switch(e.type){case"image":case"video":return!0}})})},function(e,t,n){"use strict";function r(e,t){var r=_.clone(t.parameters);switch(e.type){case"like":case"comment":case"issue":case"vote":case"task-completion":case"coauthor":case"note":case"assignment":case"push":case"merge":case"survey":case"issue":return r.story=e.story_id,t.find(n(53),r);case"bookmark":return r.story=e.story_id,t.find(n(85),r);case"join_request":return"/admin"}}function i(e){switch(e.type){case"join_request":return"admin"}return""}var s=n(0),o=s.PropTypes,a=n(6),c=n(7),l=n(4),u=n(5),p=n(10),d=n(91),h=n(58),m=n(29);n(623),e.exports=s.createClass({displayName:"NotificationView",mixins:[p],propTypes:{notification:o.object.isRequired,user:o.object,database:o.instanceOf(a).isRequired,route:o.instanceOf(c).isRequired,locale:o.instanceOf(l).isRequired,theme:o.instanceOf(u).isRequired,onClick:o.func},render:function(){var e={className:"notification-view "+this.props.theme.mode,url:this.getNotificationUrl(),target:this.getNotificationTarget(),onClick:this.handleClick};return this.props.notification.seen||(e.className+=" unread"),s.createElement(d,e,s.createElement("div",{className:"event"},this.renderProfileImage(),this.renderText()),s.createElement("div",{className:"date"},this.renderTime(),this.renderIcon()))},renderProfileImage:function(){var e={user:this.props.user,theme:this.props.theme,size:"small"};return s.createElement(m,e)},renderText:function(){var e=this.getNotificationText();return s.createElement("span",{className:"text"},e)},renderTime:function(){var e={time:this.props.notification.ctime,locale:this.props.locale};return s.createElement(h,e)},renderIcon:function(){return s.createElement("i",{className:"fa fa-"+this.getNotificationIcon()+" fa-fw"})},getNotificationUrl:function(){return r(this.props.notification,this.props.route)},getNotificationTarget:function(){return i(this.props.notification)},getNotificationText:function(){var e=this.props.locale.translate,t=this.props.locale.name,n=this.props.user,r=this.props.notification,i=n?t(n.details.name,n.details.gender):"";switch(r.type){case"like":return e("notification-$user-likes-your-$story",i,r.details.story_type);case"comment":return e("notification-$user-commented-on-your-$story",i,r.details.story_type);case"issue":return e("notification-$user-opened-an-issue",i);case"vote":return e("notification-$user-voted-in-your-survey",i);case"task-completion":return e("notification-$user-completed-task",i);case"coauthor":return e("notification-$user-added-you-as-coauthor",i);case"note":return e("notification-$user-posted-a-note-about-your-$story",i,r.details.story_type);case"assignment":return e("notification-$user-is-assigned-to-your-issue",i);case"push":return e("notification-$user-pushed-code-to-$branch",i,r.details.branch);case"merge":return e("notification-$user-merged-code-to-$branch",i,r.details.branch);case"survey":return e("notification-$user-posted-a-survey",i);case"bookmark":return e("notification-$user-sent-bookmark-to-$story",i,r.details.story_type);case"join_request":return e("notification-$user-requested-to-join",i)}},getNotificationIcon:function(){switch(this.props.notification.type){case"like":return"thumbs-up";case"comment":return"comment";case"issue":return"exclamation-circle";case"vote":return"check-square-o";case"task-completion":return"star";case"note":return"sticky-note";case"assignment":return"hand-o-right";case"push":case"merge":case"coauthor":return"handshake-o";case"survey":return"list-url";case"bookmark":return"bookmark";case"join_request":return"user-circle"}},handleClick:function(e){this.props.onClick&&this.props.onClick({type:"click",target:this})}}),e.exports.getNotificationUrl=r,e.exports.getNotificationTarget=i},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(19),a=n(6),c=n(18),l=n(7),u=n(4),p=n(5),d=n(10),h=n(259),m=n(258),f=n(260),g=n(89);n(627),e.exports=i.createClass({displayName:"StoryView",mixins:[d],propTypes:{access:s.oneOf(["read-only","read-comment","read-write"]).isRequired,story:s.object.isRequired,authors:s.arrayOf(s.object),reactions:s.arrayOf(s.object),respondents:s.arrayOf(s.object),recommendations:s.arrayOf(s.object),recipients:s.arrayOf(s.object),repos:s.arrayOf(s.object),currentUser:s.object.isRequired,database:s.instanceOf(a).isRequired,payloads:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(p).isRequired},getInitialState:function(){var e={options:v};return this.updateOptions(e,this.props),e},componentWillReceiveProps:function(e){var t=this,n=r.clone(this.state);this.props.story===e.story&&this.props.recommendations===e.recommendations||this.updateOptions(n,e);var i=r.pickBy(n,function(e,n){return t.state[n]!==e});r.isEmpty(i)||this.setState(i)},updateOptions:function(e,t){var n=e.options=r.clone(e.options);n.hidePost=!t.story.public,n.bookmarkRecipients=r.map(t.recommendations,"target_user_id")},render:function(){return"columns-1"===this.props.theme.mode?i.createElement("div",{className:"story-view columns-1"},this.renderContents(),this.renderComments()):"columns-2"===this.props.theme.mode?i.createElement("div",{className:"story-view columns-2"},i.createElement("div",{className:"column-1"},this.renderContents()),i.createElement("div",{className:"column-2"},this.renderComments())):"columns-3"===this.props.theme.mode?i.createElement("div",{className:"story-view columns-3"},i.createElement("div",{className:"column-1"},this.renderContents()),i.createElement("div",{className:"column-2"},this.renderComments()),i.createElement("div",{className:"column-3"},this.renderOptions())):void 0},renderContents:function(){var e=this.props.route.parameters.schema,t=this.props.payloads.inquire(e,this.props.story),n={access:this.props.access,story:this.props.story,authors:this.props.authors,currentUser:this.props.currentUser,reactions:this.props.reactions,repo:y(this.props.repos,this.props.story),cornerPopUp:this.renderPopUpMenu("main"),status:t,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleStoryChange,onReaction:this.handleStoryReaction};return i.createElement(h,n)},renderComments:function(){var e={access:this.props.access,story:this.props.story,reactions:this.props.reactions,respondents:this.props.respondents,repo:y(this.props.repos,this.props.story),currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(m,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:i.createElement(g,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,access:this.props.access,story:this.props.story,repos:this.props.repos,currentUser:this.props.currentUser,options:this.state.options,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleOptionsChange};return i.createElement(f,n)},autosaveStory:function(e,t){var n=this;this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveStory(e)},t),this.autosaveUnloadHandler=function(){n.saveStory(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveStory:function(e){this.cancelAutosave();var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.saveOne({table:"story"},e)})},removeStory:function(e){var t=this.props.route.parameters;return this.props.database.use({schema:t.schema,by:this}).removeOne({table:"story"},e)},saveReaction:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.saveOne({table:"reaction"},e)})},saveBookmarks:function(e){if(r.isEmpty(e))return Promise.resolve([]);var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.save({table:"bookmark"},e)})},removeBookmarks:function(e){if(r.isEmpty(e))return Promise.resolve([]);var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.remove({table:"bookmark"},e)})},sendBookmarks:function(e,t){var n=this,i=this.props.recommendations,s=[];r.each(t,function(t){if(!r.some(i,{target_user_id:t})){var o={story_id:e.published_version_id||e.id,user_ids:[n.props.currentUser.id],target_user_id:t};s.push(o)}});var o=[];return r.each(i,function(e){r.includes(t,e.target_user_id)||o.push(e)}),this.saveBookmarks(s).then(function(e){return n.removeBookmarks(o).then(function(t){return r.concat(e,t)})})},setOptions:function(e){var t=this,n=this.state.options;this.setState({options:e},function(){if(e.editPost&&!n.editPost){var i=r.omit(t.props.story,"id","published","ptime");i.published_version_id=t.props.story.id,t.saveStory(i)}if(e.removePost&&!n.removePost&&t.removeStory(t.props.story),e.bumpPost&&!n.bumpPost){var s=r.clone(t.props.story);s.bump=!0,t.saveStory(s)}if(e.hidePost!==n.hidePost){var s=r.clone(t.props.story);s.public=!e.hidePost,t.saveStory(s)}r.isEqual(e.bookmarkRecipients,n.bookmarkRecipients)||t.sendBookmarks(t.props.story,e.bookmarkRecipients)})},handleStoryChange:function(e){this.autosaveStory(e.story,1e3)},handleStoryReaction:function(e){this.saveReaction(e.reaction)},handleOptionsChange:function(e){this.setOptions(e.options)}});var v={addIssue:!1,hidePost:!1,editPost:!1,removePost:!1,bumpPost:!1,bookmarkRecipients:[]},y=o(function(e,t){return t&&t.external?r.find(e,function(e){return r.some(e.external,function(e){return r.some(t.external,e)})}):null})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(7),a=n(4),c=n(5),l=n(10),u=n(262),p=n(261),d=n(263),h=n(89);n(631),e.exports=r.createClass({displayName:"UserView",mixins:[l],propTypes:{user:i.object,roles:i.arrayOf(i.object),stories:i.arrayOf(i.object),currentUser:i.object,dailyActivities:i.object,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){return"columns-1"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-1"},this.renderSummary(),this.renderStatistics()):"columns-2"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-2"},r.createElement("div",{className:"column-1"},this.renderSummary()),r.createElement("div",{className:"column-2"},this.renderStatistics())):"columns-3"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-3"},r.createElement("div",{className:"column-1"},this.renderSummary()),r.createElement("div",{className:"column-2"},this.renderStatistics()),r.createElement("div",{className:"column-3"},this.renderOptions())):void 0},renderSummary:function(){var e={user:this.props.user,roles:this.props.roles,stories:this.props.stories,cornerPopUp:this.renderPopUpMenu("main"),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(u,e)},renderStatistics:function(){var e={user:this.props.user,story:this.props.story,dailyActivities:this.props.dailyActivities,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(p,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:r.createElement(h,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,user:this.props.user,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(d,n)}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=i.PropTypes;n(636),e.exports=i.createClass({displayName:"DropZone",propTypes:{onDrop:s.func},getInitialState:function(){return{active:!1}},render:function(){return i.createElement("div",{className:"drop-zone",onDragEnter:this.handleDragEnter},this.props.children,this.renderOverlay())},renderOverlay:function(){if(!this.state.active)return null;var e={onDragLeave:this.handleDragLeave,onDragOver:this.handleDragOver,onDrop:this.handleDrop};return i.createElement("div",r({className:"overlay"},e))},handleDragEnter:function(e){this.setState({active:!0})},handleDragLeave:function(e){this.setState({active:!1})},handleDragOver:function(e){e.preventDefault()},handleDrop:function(e){return e.preventDefault(),this.state.active&&this.props.onDrop&&this.props.onDrop({type:"drop",files:e.dataTransfer.files,items:e.dataTransfer.items}),this.setState({active:!1}),null}})},function(e,t,n){"use strict";function r(e){return e.hidden?null:a.createElement("label",{className:s(e),onClick:e.disabled?null:e.onClick},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label))}function i(e){if(e.hidden)return null;var t=e.index+1+" / "+e.count;return a.createElement("div",{className:"media-direction"},a.createElement("label",{className:"backward-button",onClick:e.onBackwardClick},a.createElement("i",{className:"fa fa-caret-left"})),a.createElement("span",{className:"position"},t),a.createElement("label",{className:"forward-button",onClick:e.onForwardClick},a.createElement("i",{className:"fa fa-caret-right"})))}function s(e){var t=["media-button"];return e.className&&t.push(e.className),e.disabled&&t.push("disabled"),t.join(" ")}function o(e){var t=[];return e.icon&&t.push("fa","fa-"+e.icon),t.join(" ")}var a=n(0),c=a.PropTypes;e.exports=r,e.exports.Direction=i,n(639),i.propTypes={index:c.number,count:c.number,hidden:c.bool,onBackwardClick:c.func,onForwardClick:c.func},i.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,onChange:c.func}},function(e,t,n){"use strict";function r(e,t){for(var n=e;n!==document.body.parentNode;n=n.parentNode)if(n===t)return!0;return!1}function i(e,t){for(var n=e.offsetLeft,r=e.offsetTop,i=e.offsetParent;i&&i!==t;i=i.offsetParent)n+=i.offsetLeft,r+=i.offsetTop;return{left:n,top:r}}function s(){return document.getElementById("app-container").getElementsByClassName("page-view-port")[0]}var o=n(0),a=o.PropTypes,c=n(27);n(643),e.exports=o.createClass({displayName:"PopUpMenu",propTypes:{disabled:a.bool,popOut:a.bool},getDefaultProps:function(){return{disabled:!1,popOut:!1}},getInitialState:function(){return{open:!1}},getContents:function(e){var t=o.Children.toArray(this.props.children),n=_.find(t,{type:e});if(n)return n.props.children},render:function(){var e="pop-up-menu";return this.props.className&&(e+=" "+this.props.className),o.createElement("span",{className:e},this.renderButton(),this.props.popOut?null:this.renderMenu())},renderButton:function(){var e="button";return this.props.disabled||(e+=" active"),o.createElement("span",{className:e,onClick:this.handleButtonClick},this.getContents("button"))},renderMenu:function(){return this.state.open?o.createElement("div",{className:"container"},o.createElement("div",{className:"menu",onClick:this.handleMenuClick},this.getContents("menu"))):null},redrawPopOutMenu:function(){var e=c.findDOMNode(this),t=s(),n=i(e,t),r={position:"absolute",left:n.left+e.offsetWidth,top:n.top},a="pop-up-menu";this.props.className&&(a+=" "+this.props.className);var l=o.createElement("div",{className:a,style:r},o.createElement("div",{className:"container"},o.createElement("div",{className:"menu",onClick:this.handleMenuClick},this.getContents("menu"))));c.render(l,this.popOutContainer)},componentDidUpdate:function(e,t){var n=document.getElementById("app-container");if(!t.open&&this.state.open){if(n.addEventListener("mousedown",this.handleBodyMouseDown),this.props.popOut){var r=s();this.popOutContainer=document.createElement("DIV"),this.popOutContainer.style.left="0",this.popOutContainer.style.top="0",r.appendChild(this.popOutContainer),this.popOutContainer.style.position="absolute"}}else t.open&&!this.state.open&&(n.removeEventListener("mousedown",this.handleBodyMouseDown),this.props.popOut&&this.popOutContainer.parentNode.removeChild(this.popOutContainer));this.state.open&&this.props.popOut&&this.redrawPopOutMenu()},componentWillUnmount:function(){document.getElementById("app-container").removeEventListener("mousedown",this.handleBodyMouseDown)},triggerEvent:function(e){e?this.props.onOpen&&this.props.onOpen({type:"open",target:this}):this.props.onClose&&this.props.onClose({type:"close",target:this})},handleButtonClick:function(e){this.props.disabled||(this.triggerEvent(!this.state.open),this.setState({open:!this.state.open}))},handleMenuClick:function(e){this.setState({open:!1}),this.triggerEvent(!1)},handleBodyMouseDown:function(e){var t=c.findDOMNode(this),n=r(e.target,t);!n&&this.popOutContainer&&(n=r(e.target,this.popOutContainer)),n||this.setState({open:!1})}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(484);e.exports=r.createClass({displayName:"QRCode",propTypes:{text:i.string.isRequired,scale:i.number},getDefaultProps:function(){return{scale:4}},render:function(){return r.createElement("canvas",{ref:"canvas",className:"qr-code"})},componentDidMount:function(){this.redraw()},componentDidUpdate:function(e,t){this.redraw()},redraw:function(){var e=this.refs.canvas,t={scale:this.props.scale};s.toCanvas(e,this.props.text,t,function(e){e&&console.error(e)})}})},function(e,t,n){"use strict";function r(e){var t=["text-field"],n="input",r=_.omit(e,"children","locale");if("textarea"===e.type&&(n=a,r=_.omit(r,"type")),e.readOnly){t.push("readonly");var s=e.locale.translate;r.placeholder=s("text-field-placeholder-none"),r.spellCheck=!1}return r.value=r.value||"",r.value&&!1===r.spellCheck&&(r.value+="\ufeff"),i.createElement("div",{className:t.join(" ")},i.createElement("label",{htmlFor:e.id},e.children),i.createElement(n,r))}var i=n(0),s=i.PropTypes,o=n(4),a=n(98);n(652),e.exports=r,r.defaultProps={type:"text"},r.propTypes={locale:s.instanceOf(o).isRequired}},function(e,t,n){"use strict";(function(e){function r(e){return e?c.filter(u,{kind:e}):u}function i(e){return r(e).length>0}function s(e,t){"change"===e&&p.push(t)}function o(e,t){"change"===e&&(p=c.pull(p,t))}function a(){return l.try(function(){return navigator.mediaDevices.enumerateDevices()}).then(function(t){u=t,c.each(p,function(t){t.call(e,{type:"change",target:e})})}).catch(function(e){})}var c=n(3),l=n(9);t.getDevices=r,t.hasDevice=i,t.addEventListener=s,t.removeEventListener=o;var u=[],p=[];a().then(function(){navigator.mediaDevices.addEventListener("devicechange",a)})}).call(t,n(130)(e))},function(e,t,n){"use strict";function r(e){return new o(function(t,n){var r=document.createElement("IMG");r.src=e,r.onload=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function i(e){return new o(function(t,n){var r=document.createElement("VIDEO");r.src=e,r.preload=!0,r.onloadeddata=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function s(e){return new o(function(t,n){var r=document.createElement("AUDIO");r.src=e,r.preload=!0,r.onloadeddata=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}var o=n(9);t.loadImage=r,t.loadVideo=i,t.loadAudio=s},function(e,t,n){"use strict";(function(r){e.exports=t=["push","merge","branch","issue","milestone","merge-request","wiki","member","repo","story","survey","task-list"],t.editable=["story","task-list","survey"],t.trackable=["story","task-list"],t.git=["push","merge","branch","issue","milestone","merge-request","wiki","member","repo"],"[object process]"===Object.prototype.toString.call(void 0!==r?r:0)||(t.icons={push:n(671),merge:n(663),branch:n(662),issue:n(214),"issue.opened":n(214),"issue.closed":n(665),"issue.reopened":n(666),milestone:n(669),"merge-request":n(664),wiki:n(661),member:n(128),repo:n(672),story:n(670),survey:n(668),"task-list":n(667)})}).call(t,n(45))},function(e,t,n){"use strict";function r(){this.parts=[],this.closed=!1,this.error=null,this.pullResult=null,this.waitResult=null,this.id=null,this.size=0}function i(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}var s=n(3);e.exports=r,r.prototype.toBlob=function(){var e=s.map(this.parts,"blob");if(e.length>1){var t=e[0].type;return new Blob(e,{type:t})}return 1===e.length?e[0]:new Blob},r.prototype.toJSON=function(){return this.id},r.prototype.push=function(e){this.parts.push({blob:e,sent:!1}),this.size+=e.size,this.pullResult&&(this.pullResult.resolve(e),this.pullResult=null)},r.prototype.close=function(){this.closed=!0,s.find(this.parts,{sent:!1})||(this.pullResult&&(this.pullResult.resolve(null),this.pullResult=null),this.waitResult&&(this.waitResult.resolve(),this.waitResult=null))},r.prototype.pull=function(){var e=s.find(this.parts,{sent:!1});return e?Promise.resolve(e.blob):this.closed?Promise.resolve(null):(this.pullResult||(this.pullResult=i()),this.pullResult.promise)},r.prototype.finalize=function(e){var t=s.find(this.parts,{blob:e});if(t&&(t.sent=!0),this.waitResult){!s.find(this.parts,{sent:!1})&&this.closed&&this.waitResult.resolve()}},r.prototype.abandon=function(e){this.error=e,this.waitResult&&this.waitResult.reject(e)},r.prototype.wait=function(){if(this.closed){if(this.error)return Promise.reject(this.error);if(!s.find(this.parts,{sent:!1}))return Promise.resolve()}return this.waitResult||(this.waitResult=i()),this.waitResult.promise},r.prototype.pipe=function(e,t){t||(t=1048576);for(var n=e.size,r=e.type,i=0;i<n;i+=t){var s=Math.min(t,n-i),o=e.slice(i,i+s,r);this.push(o)}this.close()}},function(e,t,n){"use strict";function r(e,t){"change"===e&&t&&l.push(t)}function i(e,t){"change"===e&&t&&o.pull(l,t)}function s(e){return e.format("YYYY-MM-DD")}var o=n(3),a=n(16),c=a();t.addEventListener=r,t.removeEventListener=i,t.today=s(c);var l=[];setInterval(function(){var e=a(),n=s(e);if(n!==t.today){t.today=n;var r={type:"change",target:t};o.each(l,function(e){e(r)})}},1e3)},function(e,t,n){"use strict";function r(e,t,n){var r=c.extract(e);return o.map(r,function(e,r){return e instanceof Array?o.map(e,function(e,r){var i=e.checked;if(t){var s=t[e.list];void 0!==s&&(i=e.key==s)}return a.createElement("span",null,e.before,a.createElement("label",null,a.createElement("input",{type:"radio",name:e.list,value:e.key,checked:i,readOnly:!n,onChange:n}),e.between,e.label),e.after)}):e})}function i(e,t){var n=c.extract(e);return o.map(n,function(e,n){return e instanceof Array?o.map(e,function(e,n){var r=t[e.list],i=o.get(r,"total",0),s=o.get(r,["answers",e.key],0),c=Math.round(i>0?s/i*100:0)+"%",l="color-"+e.key%10;return a.createElement("span",null,e.before,a.createElement("span",{className:"vote-count"},a.createElement("span",{className:"label"},e.label),a.createElement("span",{className:"bar"},a.createElement("span",{className:"filled "+l,style:{width:c}}),a.createElement("span",{className:"percent"},c),a.createElement("span",{className:"count"},s+"/"+i))),e.after)}):e})}function s(e,t,n){var r=c.extract(e);return o.map(r,function(e,r){return e instanceof Array?o.map(e,function(e,r){var i=e.checked;if(t){var s=t[e.list];if(void 0!==s){var o=s[e.key];void 0!==o&&(i=o)}}return a.createElement("span",null,e.before,a.createElement("label",null,a.createElement("input",{type:"checkbox",name:e.list,value:e.key,checked:i,readOnly:!n,onChange:n}),e.between,e.label),e.after)}):e})}var o=n(3),a=n(0),c=n(56);t.parseSurvey=r,t.parseSurveyResults=i,t.parseTaskList=s},function(e,t,n){"use strict";function r(e){var t;return"string"==typeof e?t=e.match(a):e instanceof Object&&(t=s.flatten(s.map(e,function(e){return String(e).match(a)}))),s.map(s.uniq(t),s.toLower).sort()}function i(e){return c.test(e)}var s=n(3);t.findTags=r,t.isTag=i;var o="[@#][a-zA-Z][0-9a-zA-Z]*",a=new RegExp(""+o,"g"),c=new RegExp("^"+o+"$")},,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"b8cf38e314f988b7f61c7ab27df43fc2.png"},function(e,t,n){e.exports=n.p+"e0e2ff0632486f60e9b6109f86eda583.png"},function(e,t,n){e.exports=n.p+"e03f845f146f2247a0aecb2978e5d253.png"},function(e,t,n){e.exports=n.p+"2b3a29cc6c30c32393c237e567ca6cf5.png"},function(e,t,n){e.exports=n.p+"5c44ab6d22ae6c0a10765769f60d720e.png"},function(e,t,n){e.exports=n.p+"e6aea96cc3f2a144a6cf53c838b55e4b.png"},function(e,t,n){e.exports=n.p+"6c1a9a9c48487ce503a4dfbdb9b711a6.png"},function(e,t,n){e.exports=n.p+"337aa694f21523c7e2dc0ada09f20ec2.png"},function(e,t,n){e.exports=n.p+"ee581f2d338f7b9d3e386c79be970831.png"},function(e,t,n){e.exports=n.p+"5a6cd044c3abe571bd76c150bee839ff.png"},function(e,t,n){e.exports=n.p+"d1bdaed46ab1125c0e77d9f92299d78e.png"},function(e,t,n){e.exports=n.p+"91d27ccd154fa929e7458b4afe06f9de.png"},function(e,t,n){e.exports=n.p+"a3fb4fe34192a7a90a8ed4f371bbabf1.png"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(323);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},,,function(e,t,n){"use strict";function r(e){for(;e&&"A"!==e.tagName;)e=e.parentNode;return e}var i,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(3),a=n(9),c=n(0),l=(c.PropTypes,n(30)),u=(n(54),n(283)),p=n(273),d=n(6),h=n(284),m=n(7),f=n(286),g=n(18),v=n(276),y=n(4),b=n(285),k=n(5),x=n(88),w=n(53),C=n(137),E=n(43),S=n(86),R=n(85),N=n(87),O=n(136),U=n(270),P=n(264),T=n(293),_=n(139),j=n(271),I=n(275),A=n(272);j.isAvailable()?i=j:I.isAvailable()?i=I:A.isAvailable()&&(i=A);var D=n(287),q=D,B=[x,w,C,E,S,R,N,O];n(290),n(580),n(458),e.exports=c.createClass({displayName:"Application",getInitialState:function(){return this.components=l({remoteDataSource:p,routeManager:h,localeManager:v,themeManager:b,payloadManager:f,cache:i,notifier:q}),{database:null,payloads:null,route:null,locale:null,theme:null,canAccessServer:!1,canAccessSchema:!1,subscriptionId:null,subscriptionError:null,connectionId:null,pushRelay:q==D?null:void 0,renderingStartPage:!1,showingUploadProgress:!1}},isReady:function(){return!!(this.state.database&&this.state.payloads&&this.state.route&&this.state.locale&&this.state.theme)},isShowingStartPage:function(){return this.state.route.component===x||this.state.route.component!==O&&(!this.state.canAccessServer||!this.state.canAccessSchema)},render:function(){return c.createElement("div",{onClick:this.handleClick},this.renderUserInterface(),this.renderConfiguration())},renderUserInterface:function(){if(!this.isReady())return null;var e=this.state.route.component.getOptions(this.state.route),t={database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme,hidden:!o.get(e,"navigation.top")},n={database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme,hidden:!o.get(e,"navigation.bottom")};return this.isShowingStartPage()&&(t.hidden=n.hidden=!0),c.createElement("div",{className:"application"},c.createElement(U,t),c.createElement("section",{className:"page-view-port",id:"page-view-port"},c.createElement("div",{className:"scroll-box",id:"scroll-box"},c.createElement("div",{className:"contents"},this.renderCurrentPage()))),c.createElement(P,n),this.renderStartPage(),this.renderUploadProgress())},renderCurrentPage:function(){var e=this.state.route.component;if(this.isShowingStartPage())return null;var t={database:this.state.database,route:this.state.route,payloads:this.state.payloads,locale:this.state.locale,theme:this.state.theme};return c.createElement(e,t)},renderStartPage:function(){if(!this.isShowingStartPage()&&!this.state.renderingStartPage)return null;var e={canAccessServer:this.state.canAccessServer,canAccessSchema:this.state.canAccessSchema,database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme,onEntry:this.handleStartPageEntry,onExit:this.handleStartPageExit,onAvailableSchemas:this.handleAvailableSchemas};return c.createElement(x,e)},renderConfiguration:function(){var e=this.components.setters,t=this.state.route,r=t?t.parameters.address:null,a={ref:e.remoteDataSource,locale:this.state.locale,onChange:this.handleDatabaseChange,onAuthorization:this.handleAuthorization,onExpiration:this.handleExpiration,onViolation:this.handleViolation,onStupefaction:this.handleStupefaction},l={ref:e.payloadManager,database:this.state.database,route:this.state.route,onChange:this.handlePayloadsChange},u={ref:e.routeManager,pages:B,database:this.state.database,rewrite:this.rewriteUrl,onChange:this.handleRouteChange,onRedirectionRequest:this.handleRedirectionRequest},d={ref:e.localeManager,database:this.state.database,directory:n(277),onChange:this.handleLocaleChange,onModuleRequest:this.handleLanguageModuleRequest},m={ref:e.themeManager,database:this.state.database,modes:{"columns-1":0,"columns-2":700,"columns-3":1300},serverAddress:r,onChange:this.handleThemeChange},g={ref:e.cache,databaseName:"trambar"},y={ref:e.notifier,serverAddress:r,onConnect:this.handleConnection,onDisconnect:this.handleDisconnection,onNotify:this.handleChangeNotification,onAlertClick:this.handleAlertClick};return null===q?o.assign(y,{locale:this.state.locale,defaultProfileImage:n(453)}):q===D&&"string"==typeof this.state.pushRelay&&o.assign(y,{relayAddress:this.state.pushRelay}),c.createElement("div",null,c.createElement(i,g),c.createElement(q,y),c.createElement(p,s({},a,{cache:this.components.cache})),c.createElement(f,l),c.createElement(h,u),c.createElement(v,d),c.createElement(b,m))},renderUploadProgress:function(){if(!this.state.showingUploadProgress)return null;var e={payloads:this.state.payloads,locale:this.state.locale};return c.createElement(T,e)},componentDidMount:function(){window.addEventListener("beforeunload",this.handleBeforeUnload)},componentDidUpdate:function(e,t){var n=this;if(!this.splashScreenHidden&&this.isReady()&&(this.splashScreenHidden=!0,setTimeout(function(){n.hideSplashScreen()},100)),this.state.subscriptionId||this.state.canAccessServer&&(this.state.connectionId?this.createSubscription():q===D&&null===this.state.pushRelay&&this.discoverPushRelay()),t.route!==this.state.route){var r=o.get(t.route,"parameters.address"),i=o.get(this.state.route,"parameters.address"),s=o.get(this.state.route,"parameters.schema"),a=o.get(t.route,"parameters.schema");if((r!==i||a!==s)&&(s&&this.state.canAccessServer&&this.state.canAccessSchema&&this.addProjectLink(i,s),r===i&&this.updateSubscription(),r&&a)){this.components.remoteDataSource.clear(r,a)}}this.state.locale!==t.locale&&this.updateSubscription()},componentWillUnmount:function(){window.removeEventListener("beforeunload",this.handleBeforeUnload)},createSubscription:function(){var e=this;if(!this.creatingSubscription){this.creatingSubscription=!0;var t=this.state.database.use({schema:"global",by:this});t.start().then(function(n){var r;null===q?r="websocket":q===D&&(r=e.state.pushRelay);var i={user_id:n,address:r,token:e.state.connectionId,schema:e.state.route.parameters.schema||"global",area:"client",locale:e.state.locale.languageCode,details:{user_agent:navigator.userAgent}};return t.saveOne({table:"subscription"},i).then(function(t){e.setState({subscriptionId:t.id})})}).catch(function(t){e.setState({subscriptionError:t})}).finally(function(){e.creatingSubscription=!1})}},updateSubscription:function(){var e=this;if(this.state.subscriptionId&&!this.updatingSubscription){this.updatingSubscription=!0;var t=this.state.database.use({schema:"global",by:this});t.start().then(function(n){var r={id:e.state.subscriptionId,schema:e.state.route.parameters.schema||"global",locale:e.state.locale.languageCode};return t.saveOne({table:"subscription"},r).then(function(t){e.setState({subscriptionId:t.id})})}).catch(function(t){e.setState({subscriptionError:t})}).finally(function(){e.updatingSubscription=!1})}},discoverPushRelay:function(){var e=this;if(!this.discoveringPushRelay){this.discoveringPushRelay=!0;var t=this.state.database.use({schema:"global",by:this});t.start().then(function(n){return t.findOne({table:"system"}).then(function(t){var n=o.get(t,"settings.push_relay","");return e.setState({pushRelay:n}),null})}).catch(function(t){e.setState({pushRelay:t})}).finally(function(){e.discoveringPushRelay=!1})}},loadCredentialsFromCache:function(e){var t=this.state.database.use({schema:"local",by:this}),n={key:e};return t.findOne({table:"user_credentials",criteria:n})},saveCredentialsToCache:function(e,t){var n=this.state.database.use({schema:"local",by:this}),r=o.extend({key:e},t);return n.saveOne({table:"user_credentials"},r)},removeCredentialsFromCache:function(e){var t=this.state.database.use({schema:"local",by:this}),n={key:e};return t.removeOne({table:"user_credentials"},n)},addProjectLink:function(e,t){var n=this.state.database.use({by:this}),r={name:t};return n.findOne({schema:"global",table:"project",criteria:r}).then(function(r){if(r){var i=new Date,s={key:e+"/"+t,address:e,schema:t,name:r.details.title,atime:i.toISOString()};return n.saveOne({schema:"local",table:"project_link"},s)}})},rewriteUrl:function(e,t,n){"parse"===n?u.extract(e,t):(this.state.route&&(t=o.defaults(t,this.state.route.parameters)),u.insert(e,t))},handleDatabaseChange:function(e){var t;this.state.route&&(t={address:this.state.route.parameters.address,schema:this.state.route.parameters.schema});var n=new d(e.target,t);this.setState({database:n})},handleAuthorization:function(e){this.saveCredentialsToCache(e.address,e.credentials);var t=this.state.route.parameters.address;e.address===t&&this.setState({canAccessServer:!0,canAccessSchema:!0})},handleExpiration:function(e){this.removeCredentialsFromCache(e.address);var t=this.state.route.parameters.address;e.address===t&&this.setState({canAccessServer:!1,canAccessSchema:!1})},handleViolation:function(e){var t=this.state.route.parameters.address,n=this.state.route.parameters.schema;e.address===t&&e.schema===n&&this.setState({canAccessSchema:!1})},handleStupefaction:function(e){this.state.route.replace(n(136),{code:404})},handlePayloadsChange:function(e){var t=new g(e.target),n=this.state.showingUploadProgress;t.uploading||(n=!1),this.setState({payloads:t,showingUploadProgress:n})},handleLocaleChange:function(e){var t=new y(e.target);this.setState({locale:t}),document.title=t.translate("app-name")},handleLanguageModuleRequest:function(e){var t=e.languageCode.substr(0,2);return new a(function(e,r){window.Promise||n(9);switch(t){case"en":n.e(0).then(function(){try{e(n(217))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"fi":n.e(5).then(function(){try{e(n(218))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"nb":n.e(4).then(function(){try{e(n(219))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"pl":n.e(3).then(function(){try{e(n(220))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"ru":n.e(2).then(function(){try{e(n(221))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"zh":n.e(1).then(function(){try{e(n(222))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;default:r(new Error("No module for language: "+t))}})},handleRouteChange:function(e){var t=this,n=new m(e.target),r=n.parameters.address,i=this.state.database;if(r!=this.state.database.context.address){var s=this.components.remoteDataSource;i=new d(s,{address:r})}i.hasAuthorization()?this.setState({route:n,database:i,canAccessServer:!0,canAccessSchema:!0}):this.loadCredentialsFromCache(r).then(function(e){e&&i.addAuthorization(e),i.hasAuthorization(r)?t.setState({route:n,database:i,canAccessServer:!0,canAccessSchema:!0}):t.setState({route:n,database:i,canAccessServer:!1,canAccessSchema:!1})})},handleAvailableSchemas:function(e){var t=this.state.route.parameters.schema;o.includes(e.schemas,t)&&this.setState({canAccessSchema:!0})},handleStartPageEntry:function(e){this.setState({renderingStartPage:!0})},handleStartPageExit:function(e){this.setState({renderingStartPage:!1})},handleRedirectionRequest:function(e){var t=e.target,n=t.find(O,{code:404});return a.resolve(n)},handleClick:function(e){var t=this;if(0===e.button){var n=r(e.target);if(n){var i=n.getAttribute("href")||n.getAttribute("data-url");i&&-1===i.indexOf(":")&&(this.state.route.change(i).then(function(){if(!t.state.route.hash){document.getElementById("scroll-box").scrollTop=0}}),e.preventDefault(),n.blur())}}},handleThemeChange:function(e){var t=new k(e.target);this.setState({theme:t})},handleConnection:function(e){this.setState({connectionId:e.token,subscriptionId:null})},handleDisconnection:function(e){this.setState({connectionId:null,subscriptionId:null})},handleChangeNotification:function(e){this.components.remoteDataSource.invalidate(e.address,e.changes),o.forIn(e.changes,function(e,t){console.log("Change notification: ",t,e)})},handleAlertClick:function(e){var t=e.alert,n={id:t.notification_id,type:t.type,user_id:t.user_id,reaction_id:t.reaction_id,story_id:t.story_id},r=_.getNotificationUrl(n,this.state.route),i=_.getNotificationTarget(n);if(i){var s=document.createElement("A");s.href=r,s.target=i,s.click()}else this.state.route.change(r),window.focus();var o=this.state.route.parameters,a=this.state.database.use({schema:o.schema,by:this});a.start().then(function(e){var n={id:t.notification_id,seen:!0};return a.saveOne({table:"notification"},n)})},handleBeforeUnload:function(e){if(this.state.payloads&&this.state.payloads.uploading)return this.setState({showingUploadProgress:!0}),e.returnValue="Are you sure?"},hideSplashScreen:function(){}})},,,,,,,function(e,t,n){function r(e){return n(i(e))}function i(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var s={"./apple-touch-icon-114x114.png":435,"./apple-touch-icon-120x120.png":436,"./apple-touch-icon-144x144.png":437,"./apple-touch-icon-152x152.png":438,"./apple-touch-icon-57x57.png":439,"./apple-touch-icon-60x60.png":440,"./apple-touch-icon-72x72.png":441,"./apple-touch-icon-76x76.png":442,"./favicon-128.png":443,"./favicon-16x16.png":444,"./favicon-196x196.png":445,"./favicon-32x32.png":446,"./favicon-96x96.png":447,"./mstile-144x144.png":448,"./mstile-150x150.png":449,"./mstile-310x150.png":450,"./mstile-310x310.png":451,"./mstile-70x70.png":452};r.keys=function(){return Object.keys(s)},r.resolve=i,e.exports=r,r.id=223},function(e,t,n){function r(e){return n(i(e))}function i(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var s={"./apple-touch-icon-114x114.png":166,"./apple-touch-icon-120x120.png":167,"./apple-touch-icon-144x144.png":168,"./apple-touch-icon-152x152.png":169,"./apple-touch-icon-57x57.png":170,"./apple-touch-icon-60x60.png":171,"./apple-touch-icon-72x72.png":172,"./apple-touch-icon-76x76.png":173,"./favicon-128.png":174,"./favicon-16x16.png":175,"./favicon-196x196.png":176,"./favicon-32x32.png":177,"./favicon-96x96.png":178};r.keys=function(){return Object.keys(s)},r.resolve=i,e.exports=r,r.id=224},function(e,t,n){function r(e){return n(i(e))}function i(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var s={"./apple-touch-icon-114x114.png":166,"./apple-touch-icon-120x120.png":167,"./apple-touch-icon-144x144.png":168,"./apple-touch-icon-152x152.png":169,"./apple-touch-icon-57x57.png":170,"./apple-touch-icon-60x60.png":171,"./apple-touch-icon-72x72.png":172,"./apple-touch-icon-76x76.png":173,"./favicon-128.png":174,"./favicon-16x16.png":175,"./favicon-196x196.png":176,"./favicon-32x32.png":177,"./favicon-96x96.png":178};r.keys=function(){return Object.keys(s)},r.resolve=i,e.exports=r,r.id=225},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(106),o=n(4),a=n(5),c=n(25),l=n(17);n(581),e.exports=r.createClass({displayName:"AppComponentDialogBox",propTypes:{show:i.bool,component:i.object.isRequired,locale:i.instanceOf(o).isRequired,theme:i.instanceOf(a).isRequired,onClose:i.func},render:function(){if(!this.props.component)return null;var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(c,e,r.createElement("div",{className:"app-component-dialog-box"},r.createElement("div",{className:"contents"},this.renderPicture(),this.renderText()),this.renderButtons()))},renderPicture:function(){var e=this.props.component;if(e.image){var t=this.props.theme.getImageUrl(e.image);return r.createElement("div",{className:"picture"},r.createElement("img",{src:t}))}var n=e.icon||{},i=n.class||"fa-cubes",s={color:n.color,backgroundColor:n["background-color"]};return r.createElement("div",{className:"picture"},r.createElement("div",{className:"icon",style:s},r.createElement("i",{className:"fa fa-fw "+i})))},renderText:function(){var e=this.props.locale.pick,t=e(this.props.component.text),n=s.parse(t);return r.createElement("div",{className:"text"},n)},renderButtons:function(){var e={label:"OK",onClick:this.props.onClose};return r.createElement("div",{className:"buttons"},r.createElement(l,e))}})},function(e,t,n){"use strict"},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(7),a=n(4),c=n(25),l=n(17),u=n(145);n(584),e.exports=r.createClass({displayName:"MobileSetupDialogBox",propTypes:{show:i.bool,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,onClose:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(c,e,r.createElement("div",{className:"mobile-setup-dialog-box"},this.renderContents(),this.renderButtons()))},renderContents:function(){this.props.number;return r.createElement("div",{className:"contents"},r.createElement(u,{text:"https://",scale:6}),r.createElement("div",{className:"info"},"Something"))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("mobile-setup-close"),onClick:this.props.onClose};return r.createElement("div",{className:"buttons"},r.createElement(l,t))}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(4),o=n(5),a=n(25),c=n(17),l=n(44);n(585),e.exports=r.createClass({displayName:"ProjectDescriptionDialogBox",propTypes:{show:i.bool,project:i.object.isRequired,locale:i.instanceOf(s).isRequired,theme:i.instanceOf(o).isRequired,onClose:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCloseClick};return r.createElement(a,e,r.createElement("div",{className:"project-description-dialog-box"},this.renderText(),this.renderButtons()))},renderText:function(){var e,t=this.props.locale.pick,n=this.props.project,i=t(n.details.title)||n.name,s=t(n.details.description),o=_.find(n.details.resources,{type:"image"});if(o){var a=this.props.theme.getImageUrl(o,{width:160});e=r.createElement("img",{src:a})}return r.createElement(l,null,r.createElement("div",{className:"title"},i),r.createElement("div",{className:"description"},e,s))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("project-description-close"),onClick:this.handleCloseClick};return r.createElement("div",{className:"buttons"},r.createElement(c,t))},handleCloseClick:function(e){this.props.onClose&&this.props.onClose({type:"cancel",target:this})}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=i.PropTypes,o=(n(15),n(7)),a=n(4),c=n(25),l=n(17),u=n(44),p=n(28);n(586),e.exports=i.createClass({displayName:"ProjectManagementDialogBox",propTypes:{show:s.bool,projectLinks:s.arrayOf(s.object).isRequired,route:s.instanceOf(o).isRequired,locale:s.instanceOf(a).isRequired,onDelete:s.func,onCancel:s.func},getInitialState:function(){return{selection:[]}},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return i.createElement(c,e,i.createElement("div",{className:"project-management-dialog-box"},this.renderList(),this.renderButtons()))},renderList:function(){return i.createElement(u,null,_.map(this.props.projectLinks,this.renderProjectButton))},renderProjectButton:function(e,t){var n=this.props.locale.pick,s=this.props.route.parameters,o=e.address===s.address&&e.schema===s.schema,a={id:e.key,label:n(e.name),iconOn:o?"check-circle":"times-circle",selected:_.includes(this.state.selection,e.key)||o,disabled:o,onClick:this.handleProjectClick};return i.createElement(p,r({key:t},a))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("project-management-cancel"),onClick:this.handleCancelClick},n={label:e("project-management-remove"),onClick:this.handleRemoveClick,emphasized:!0,disabled:_.isEmpty(this.state.selection)};return i.createElement("div",{className:"buttons"},i.createElement(l,t),i.createElement(l,n))},handleProjectClick:function(e){var t=e.currentTarget.id,n=_.slice(this.state.selection);_.includes(n,t)?_.pull(n,t):n.push(t),this.setState({selection:n})},handleRemoveClick:function(e){this.props.onDelete&&this.props.onDelete({type:"delete",target:this,selection:this.state.selection})},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(4),o=n(25),a=n(17),c=n(145);n(587),e.exports=r.createClass({displayName:"TelephoneNumberDialogBox",propTypes:{show:i.bool,number:i.string,locale:i.instanceOf(s).isRequired,onClose:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(o,e,r.createElement("div",{className:"telephone-number-dialog-box"},this.renderContents(),this.renderButtons()))},renderContents:function(){var e=this.props.number,t="tel:"+e;return r.createElement("div",{className:"contents"},r.createElement(c,{text:t,scale:6}),r.createElement("div",{className:"number"},e))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("telephone-dialog-close"),onClick:this.props.onClose};return r.createElement("div",{className:"buttons"},r.createElement(a,t))}})},function(e,t,n){"use strict"},function(e,t,n){"use strict";var r=(n(3),n(9),n(16),n(0)),i=r.PropTypes,s=(n(4),n(5)),o=n(10),a=n(90);n(589),e.exports=r.createClass({displayName:"AudioEditor",mixins:[o],propTypes:{resource:i.object,theme:i.instanceOf(s).isRequired,onChange:i.func},render:function(){var e=this.props.resource.duration;return r.createElement("div",{className:"audio-editor"},r.createElement("div",{className:"graphic"},r.createElement("div",{className:"icon"},r.createElement("i",{className:"fa fa-microphone"})),r.createElement("div",{className:"duration"},a.format(e))))}})},function(e,t,n){"use strict";function r(e){return i.some(e,function(e){if(!e.url&&!e.payload_id)return!0})}var i=n(3),s=n(9),o=n(0),a=o.PropTypes,c=n(19),l=n(147),u=n(30),p=n(153),d=n(57),h=n(6),m=n(18),f=n(7),g=n(4),v=n(5),y=n(10),b=n(98),k=n(17),x=n(34),w=n(29),C=(n(142),n(133));n(590);e.exports=o.createClass({displayName:"CommentEditor",mixins:[y],propTypes:{reaction:a.object,story:a.object.isRequired,currentUser:a.object,database:a.instanceOf(h).isRequired,payloads:a.instanceOf(m).isRequired,route:a.instanceOf(f).isRequired,locale:a.instanceOf(g).isRequired,theme:a.instanceOf(v).isRequired,onFinish:a.func},getInitialState:function(){this.components=u({mediaEditor:C});var e={draft:null,hasCamera:l.hasDevice("videoinput"),hasMicrophone:l.hasDevice("audioinput")};return this.updateDraft(e,this.props),e},componentWillMount:function(){l.addEventListener("change",this.handleDeviceChange)},componentWillReceiveProps:function(e){var t=i.clone(this.state);this.props.reaction!==e.reaction&&this.updateDraft(t,e);var n=i.shallowDiff(t,this.state);i.isEmpty(n)||this.setState(n)},updateDraft:function(e,t){t.reaction?e.draft=t.reaction:e.draft=E(t.story,t.currentUser)},render:function(){return o.createElement("div",{className:"comment-editor"},o.createElement("div",{className:"profile-image-column"},this.renderProfileImage()),o.createElement("div",{className:"editor-column"},o.createElement("div",{className:"controls"},o.createElement("div",{className:"textarea"},this.renderTextArea()),o.createElement("div",{className:"buttons"},this.renderMediaButtons(),this.renderActionButtons())),o.createElement("div",{className:"media"},this.renderMedia())))},renderProfileImage:function(){var e={user:this.props.currentUser,theme:this.props.theme,size:"small"};return o.createElement(w,e)},renderTextArea:function(){var e=this.props.locale.languageCode,t=e.substr(0,2),n=i.get(this.state.draft,["details","text",t],""),r={ref:"textarea",value:n,lang:t,onChange:this.handleTextChange};return o.createElement(b,r)},renderMediaButtons:function(){var e=this.props.locale.translate,t={tooltip:e("story-photo"),icon:"camera",hidden:!this.state.hasCamera,onClick:this.handlePhotoClick},n={tooltip:e("story-video"),icon:"video-camera",hidden:!this.state.hasCamera,onClick:this.handleVideoClick},r={tooltip:e("story-audio"),icon:"microphone",hidden:!this.state.hasMicrophone,onClick:this.handleAudioClick},s={tooltip:e("story-file"),icon:"file",onChange:this.handleFileSelect},a=i.get(this.state.draft,"details.markdown",!1),c={tooltip:e("story-markdown"),icon:"pencil-square",highlighted:a,onClick:this.handleMarkdownClick};return o.createElement("div",{className:"media-buttons"},o.createElement(x,t),o.createElement(x,n),o.createElement(x,r),o.createElement(x.File,s),o.createElement(x,c),this.props.cornerPopUp)},renderActionButtons:function(){var e=this.props.locale.translate,t=i.isEmpty(i.get(this.state.draft,"details.text")),n=i.isEmpty(i.get(this.state.draft,"details.resources")),r=i.get(this.state.draft,"published",!1),s={label:e("story-cancel"),onClick:this.handleCancelClick,disabled:r},a={label:e("story-post"),onClick:this.handlePublishClick,emphasized:!0,disabled:t&&n||r};return o.createElement("div",{className:"action-buttons"},o.createElement(k,s),o.createElement(k,a))},renderMedia:function(){var e=(this.props.locale.translate,{ref:this.components.setters.mediaEditor,resources:i.get(this.state.draft,"details.resources"),locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleResourcesChange});return o.createElement(C,e)},componentWillUnmount:function(){l.removeEventListener("change",this.handleDeviceChange)},focus:function(){var e=this.refs.textarea;e&&e.focus()},changeDraft:function(e){var t=this;return new s(function(n,r){t.setState({draft:e},function(){n(e)})})},autosaveReaction:function(e,t){var n=this;t?(this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveReaction(e)},t),this.autosaveUnloadHandler=function(){n.saveReaction(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)):this.saveReaction(e)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveReaction:function(e){var t=this;this.cancelAutosave();var n=this.props.route.parameters,r=this.props.payloads;return r.prepare(n.schema,e).then(function(){var i=t.props.database.use({schema:n.schema,by:t});return i.start().then(function(){return i.saveOne({table:"reaction"},e).then(function(e){return r.dispatch(n.schema,e).return(e)})})})},removeReaction:function(e){var t=this.props.route,n=t.parameters.schema;return this.props.database.use({schema:n,by:this}).removeOne({table:"reaction"},e)},triggerFinishEvent:function(){this.props.onFinish&&this.props.onFinish({type:"finish",target:this})},handleTextChange:function(e){var t=this,n=e.currentTarget.value,r=this.props.locale.languageCode,s=r.substr(0,2),o="details.text."+s,a=i.decoupleSet(this.state.draft,o,n);return void 0===a.details.markdown&&d.detect(n,this.handleReference)&&(a.details.markdown=!0),a.tags=p.findTags(a.details.text),this.changeDraft(a).then(function(){return t.autosaveReaction(a,5e3),null})},handlePublishClick:function(e){var t=this,n=i.clone(this.state.draft);return n.published=!0,this.changeDraft(n).then(function(){return t.saveReaction(n)}).then(function(){t.triggerFinishEvent()})},handleCancelClick:function(e){var t=this;return s.try(function(){t.cancelAutosave();var e=t.props.reaction;return e.id?e.ptime?(e=i.clone(e),e.published=!0,t.saveReaction(e)):t.removeReaction(e):e}).then(function(e){return t.triggerFinishEvent(),e})},handlePhotoClick:function(e){this.components.mediaEditor.capture("image")},handleVideoClick:function(e){this.components.mediaEditor.capture("video")},handleAudioClick:function(e){this.components.mediaEditor.capture("audio")},handleFileSelect:function(e){var t=e.target.files;return this.components.mediaEditor.importFiles(t),null},handleResourcesChange:function(e){var t=this,n=i.decoupleSet(this.state.draft,"details.resources",e.resources);return this.changeDraft(n).then(function(n){var i=5e3;return r(e.resources)&&(i=0),t.autosaveReaction(n,i),null})},handleMarkdownClick:function(e){var t=this,n="details.markdown",r=!i.get(this.state.draft,n,!1),s=i.decoupleSet(this.state.draft,n,r);return this.changeDraft(s).then(function(e){return t.autosaveReaction(e,5e3),null})},handleReference:function(e){var t=this.state.draft.details.resources,n=d.findReferencedResource(t,e.name);if(n){var r;return r=e.forImage?this.props.theme.getImageUrl(n,{height:24}):this.props.theme.getUrl(n),{href:r,title:void 0}}},handleDeviceChange:function(e){this.setState({hasCamera:l.hasDevice("videoinput"),hasMicrophone:l.hasDevice("audioinput")})}});var E=c(function(e,t){return{type:"comment",story_id:e.id,user_id:t?t.id:null,details:{}}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(7),a=n(4),c=n(5),l=n(37),u=n(34),p=n(28),d=n(83);n(593),e.exports=r.createClass({displayName:"StoryEditorOptions",propTypes:{inMenu:i.bool,section:i.oneOf(["main","supplemental","both"]),story:i.object.isRequired,options:i.object.isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onChange:i.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{selectingRecipients:!1,renderingDialogBox:!1}},canHideStory:function(){if(this.props.currentUser){var e=this.props.story,t=this.props.currentUser.type;if("guest"!==t){if("admin"===t)return!0;var n=this.props.currentUser.id;if(_.includes(e.user_ids,n))return!0}}return!1},canAddIssue:function(){if(this.props.currentUser){if("guest"!==this.props.currentUser.type)return!0}return!1},canSendBookmarks:function(){return!0},render:function(){if(this.props.inMenu)return r.createElement("div",{className:"editor-options in-menu"},this.renderButtons(this.props.section));var e=this.props.locale.translate;return r.createElement(l,{className:"editor-options"},r.createElement("header",null,r.createElement(u,{icon:"chevron-circle-right",label:e("story-options"),disabled:!0})),r.createElement("body",null,this.renderButtons("main"),this.renderButtons("supplemental")))},renderButtons:function(e){var t=this.props.locale.translate,n=this.props.options;if("main"===e){var i=_.get(this.props.currentUser,"id"),s=_.includes(n.bookmarkRecipients,i),o=_.without(n.bookmarkRecipients,i),a={label:t("option-bookmark-story"),selected:s,onClick:this.handleBookmarkClick},c={label:_.isEmpty(o)?t("option-send-bookmarks"):t("option-send-bookmarks-to-$count-users",_.size(o)),hidden:!this.canSendBookmarks(),selected:!_.isEmpty(o),onClick:this.handleSendBookmarkClick},l={label:t("option-add-issue"),selected:n.addIssue,hidden:this.canAddIssue(),onClick:this.handleAddIssueClick},u={label:t("option-hide-post"),selected:n.hidePost,hidden:this.canHideStory(),onClick:this.handleHidePostClick};return r.createElement("div",{className:e},r.createElement(p,a),r.createElement(p,c),r.createElement(p,l),r.createElement(p,u),this.renderUserSelectionDialogBox())}if("supplemental"===e){var d={label:t("option-show-media-preview"),selected:"media"===n.preview||!n.preview,onClick:this.handleShowMediaPreviewClick},h={label:t("option-show-text-preview"),selected:"text"===n.preview,onClick:this.handleShowTextPreviewClick};return r.createElement("div",{className:e},r.createElement(p,d),r.createElement(p,h))}},renderUserSelectionDialogBox:function(){var e={show:this.state.selectingRecipients,selection:this.props.options.bookmarkRecipients,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleRecipientsSelect,onCancel:this.handleRecipientsCancel};return r.createElement(d,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,options:e})},openSelectionDialogBox:function(e){this.state.selectingRecipients||(this.setState({selectingRecipients:!0,renderingDialogBox:!0}),e.stopPropagation(),this.sendBookmakTarget=e.target)},closeSelectionDialogBox:function(){var e=this;this.state.selectingRecipients&&(this.setState({selectingRecipients:!1}),setTimeout(function(){e.state.selectingRecipients||e.setState({renderingDialogBox:!1})},1e3),this.sendBookmakTarget&&(this.sendBookmakTarget.click(),this.sendBookmakTarget=null))},handleBookmarkClick:function(e){var t=_.clone(this.props.options),n=this.props.currentUser.id;_.includes(t.bookmarkRecipients,n)?t.bookmarkRecipients=_.difference(t.bookmarkRecipients,[n]):t.bookmarkRecipients=_.union(t.bookmarkRecipients,[n]),this.triggerChangeEvent(t)},handleSendBookmarkClick:function(e){this.openSelectionDialogBox(e)},handleAddIssueClick:function(e){var t=_.clone(this.props.options);t.addIssue=!t.addIssue,this.triggerChangeEvent(t)},handleHidePostClick:function(e){var t=_.clone(this.props.options);t.hidePost=!t.hidePost,this.triggerChangeEvent(t)},handleRecipientsSelect:function(e){var t=_.clone(this.props.options);t.bookmarkRecipients=e.selection,this.triggerChangeEvent(t),this.closeSelectionDialogBox()},handleRecipientsCancel:function(e){this.closeSelectionDialogBox()},handleShowMediaPreviewClick:function(e){var t=_.clone(this.props.options);t.preview="media",this.triggerChangeEvent(t)},handleShowTextPreviewClick:function(e){var t=_.clone(this.props.options);t.preview="text",this.triggerChangeEvent(t)}})},function(e,t,n){"use strict";var r=n(3),i=(n(9),n(0)),s=i.PropTypes,o=n(147),a=n(30),c=n(6),l=n(7),u=n(4),p=n(5),d=n(18),h=n(10),m=n(37),f=n(34),g=n(142),v=n(133);n(595),e.exports=i.createClass({displayName:"StoryMediaPreview",mixins:[h],propTypes:{story:s.object.isRequired,cornerPopUp:s.element,selectedResourceIndex:s.number,options:s.object.isRequired,showHints:s.bool,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(p).isRequired,payloads:s.instanceOf(d).isRequired,onChange:s.func.isRequired},getInitialState:function(){return this.components=a({mediaEditor:v}),{hasCamera:o.hasDevice("videoinput"),hasMicrophone:o.hasDevice("audioinput")}},componentWillMount:function(){document.addEventListener("paste",this.handlePaste),o.addEventListener("change",this.handleDeviceChange)},render:function(){return i.createElement(m,{className:"media-preview"},i.createElement("header",null,this.renderButtons()),i.createElement("body",null,this.renderResources()))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("story-photo"),icon:"camera",hidden:!this.state.hasCamera,onClick:this.handlePhotoClick},n={label:e("story-video"),icon:"video-camera",hidden:!this.state.hasCamera,onClick:this.handleVideoClick},r={label:e("story-audio"),icon:"microphone",hidden:!this.state.hasMicrophone,onClick:this.handleAudioClick},s={label:e("story-file"),icon:"file",multiple:!0,onChange:this.handleFileSelect};return i.createElement("div",null,i.createElement(f,t),i.createElement(f,n),i.createElement(f,r),i.createElement(f.File,s),this.props.cornerPopUp)},renderResources:function(){var e=(r.get(this.props.story,"details.resources"),{ref:this.components.setters.mediaEditor,resources:r.get(this.props.story,"details.resources"),locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,initialResourceIndex:this.props.selectedResourceIndex,onChange:this.handleResourcesChange,onEmbed:this.handleResourceEmbed});return i.createElement(g,{onDrop:this.handleDrop},i.createElement(v,e,this.renderPlaceholder()))},renderPlaceholder:function(){if("columns-1"===this.props.theme.mode)return null;var e,t=this.props.locale.translate;this.props.showHints&&(e=["story-drop-files-here","story-paste-image-here"]);var n=r.map(e,function(e,n){var r=10*n;return i.createElement("div",{key:n,className:"message",style:{animationDelay:r+"s"}},t(e))});return i.createElement("div",{className:"placeholder"},n)},componentWillUnmount:function(){document.removeEventListener("paste",this.handlePaste),o.removeEventListener("change",this.handleDeviceChange)},handlePhotoClick:function(e){this.components.mediaEditor.capture("image")},handleVideoClick:function(e){this.components.mediaEditor.capture("video")},handleAudioClick:function(e){this.components.mediaEditor.capture("audio")},handleFileSelect:function(e){var t=e.target.files;return this.components.mediaEditor.importFiles(t),null},handleDrop:function(e){return this.components.mediaEditor.importFiles(e.files),this.components.mediaEditor.importDataItems(e.items),null},handlePaste:function(e){var t=e.clipboardData.files;return r.isEmpty(t)||(e.preventDefault(),this.components.mediaEditor.importFiles(t)),null},triggerChangeEvent:function(e,t){return this.props.onChange({type:"change",target:this,story:e,path:t})},handleResourcesChange:function(e){var t="details.resources",n=r.decoupleSet(this.props.story,t,e.resources);return r.isEmpty(n.details.resources)&&delete n.details.resources,this.triggerChangeEvent(n,t)},handleResourceEmbed:function(e){var t=e.resource,n=this.props.story.details.resources,i=r.filter(n,{type:t.type}),s=r.indexOf(i,t);if(-1!==s){var o="!["+t.type+"-"+(s+1)+"]",a=this.props.options.languageCode,c=a.substr(0,2),l="details.text."+c,u=r.get(this.props.story,l,"")+o,p=r.decoupleSet(this.props.story,l,u);r.get(p.details.markdown)||(p.details.markdown=!0),this.triggerChangeEvent(p,l)}},handleDeviceChange:function(e){this.setState({hasCamera:o.hasDevice("videoinput"),hasMicrophone:o.hasDevice("audioinput")})}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=i.PropTypes,o=n(153),a=n(56),c=n(57),l=n(6),u=n(7),p=n(4),d=n(5),h=n(10),m=n(37),f=n(92),g=(n(58),n(17)),v=n(29),y=n(83),b=n(98);n(596),e.exports=i.createClass({displayName:"StoryTextEditor",mixins:[h],propTypes:{story:s.object.isRequired,authors:s.arrayOf(s.object),currentUser:s.object,options:s.object.isRequired,cornerPopUp:s.element,coauthoring:s.bool,database:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(p).isRequired,theme:s.instanceOf(d).isRequired,onChange:s.func,onPublish:s.func,onCancel:s.func},getInitialState:function(){return{selectingCoauthor:!1}},render:function(){return i.createElement(m,{className:"text-editor"},i.createElement("header",null,this.renderProfileImage(),this.renderAuthorNames(),this.props.cornerPopUp),i.createElement("subheader",null,this.renderCoauthoringButtons(),this.renderUserSelectionDialogBox()),i.createElement("body",null,this.renderTextArea()),i.createElement("footer",null,this.renderButtons()))},renderProfileImage:function(){var e={user:_.get(this.props.authors,0),theme:this.props.theme,size:"medium"};return i.createElement(v,e)},renderAuthorNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,s=this.props.authors,o=_.map(s,function(e){return n(e.details.name,e.details.gender)});switch(o.length){case 0:e=" ";break;case 1:e=""+o[0];break;case 2:e=t("story-author-$name1-and-$name2",o[0],o[1]);break;default:var a=_.slice(s,1),c={users:a,label:t("story-author-$count-others",a.length),title:t("story-coauthors"),locale:this.props.locale,theme:this.props.theme},l=i.createElement(f,r({key:1},c));e=t("story-author-$name-and-$users",o[0],l,a.length)}return i.createElement("span",{className:"name"},e)},renderCoauthoringButtons:function(){var e=this.props.locale.translate;if(this.props.coauthoring)return i.createElement("div",null,i.createElement("span",{className:"button",onClick:this.props.onCancel},i.createElement("i",{className:"fa fa-minus-square"}),i.createElement("span",{className:"label"},e("story-remove-yourself"))));var t;return t=e(this.props.story.user_ids.length>1?"story-add-remove-coauthor":"story-add-coauthor"),i.createElement("div",null,i.createElement("span",{className:"button",onClick:this.handleCoauthoringClick},i.createElement("i",{className:"fa fa-plus-square"}),i.createElement("span",{className:"label"},t)))},renderUserSelectionDialogBox:function(){var e={show:this.state.selectingCoauthor,selection:this.props.story.user_ids,disabled:_.slice(this.props.story.user_ids,0,1),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleCoauthoringSelect,onCancel:this.handleCoauthoringCancel};return i.createElement(y,e)},renderTextArea:function(){var e=this.props.options.languageCode,t=e.substr(0,2),n=_.get(this.props.story,["details","text",t],""),r={value:n,lang:t,onChange:this.handleTextChange};return i.createElement(b,r)},renderButtons:function(){var e=this.props.locale.translate,t=_.isEmpty(_.get(this.props.story,"details.text")),n=_.isEmpty(_.get(this.props.story,"details.resources")),r=_.get(this.props.story,"published",!1),s={label:e("story-cancel"),onClick:this.props.onCancel,disabled:t&&n||r},o={label:e("story-post"),onClick:this.props.onPublish,emphasized:!0,disabled:t&&n||r};return i.createElement("div",{className:"buttons"},i.createElement(g,s),i.createElement(g,o))},triggerChangeEvent:function(e,t){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e,path:t})},handleCoauthoringClick:function(e){this.setState({selectingCoauthor:!0})},handleCoauthoringCancel:function(e){this.setState({selectingCoauthor:!1})},handleCoauthoringSelect:function(e){var t=_.decoupleSet(this.props.story,"user_ids",e.selection);this.triggerChangeEvent(t,"user_ids"),this.setState({selectingCoauthor:!1})},handleTextChange:function(e){var t=e.currentTarget.value,n=this.props.options.languageCode,r=n.substr(0,2),i="details.text."+r,s=_.decoupleSet(this.props.story,i,t);s.details.text=_.pickBy(s.details.text,"length"),_.isEmpty(s.details.text)&&(s.details=_.omit(s.details,"text")),void 0===s.details.markdown&&c.detect(t)&&(s.details.markdown=!0),s.type||a.detect(s.details.text)&&(s.type="task-list"),s.tags=o.findTags(s.details.text),this.triggerChangeEvent(s,i)}})},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i,s=n(0),o=s.PropTypes,a=n(56),c=n(57),l=n(152),u=n(6),p=n(7),d=n(4),h=n(5),m=n(10),f=n(37),g=n(34);n(597),e.exports=s.createClass((i={displayName:"StoryTextPreview",mixins:[m],propTypes:{story:o.object.isRequired,authors:o.arrayOf(o.object),options:o.object.isRequired,cornerPopUp:o.element,database:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onChange:o.func,onResourceClick:o.func},render:function(){return s.createElement(f,{className:"contents text-preview"},s.createElement("header",null,this.renderButtons()),s.createElement("body",null,this.renderText()))},renderButtons:function(){var e=this.props.locale.translate,t=this.props.story,n={label:e("story-markdown"),icon:"pencil-square",highlighted:t.details.markdown,onClick:this.handleMarkdownClick},r={label:e("story-task-list"),icon:"list-ol",highlighted:"task-list"===t.type,onClick:this.handleTaskListClick},i={label:e("story-survey"),icon:"list-ul",highlighted:"survey"===t.type,onClick:this.handleSurveyClick};return s.createElement("div",null,s.createElement(g,n),s.createElement(g,r),s.createElement(g,i),this.props.cornerPopUp)},renderText:function(){switch(this.resourcesReferenced={},this.props.story.type){case void 0:case"":case"story":return this.renderRegularPost();case"task-list":return this.renderTaskListText();case"survey":return this.renderSurveyText()}},renderRegularPost:function(){var e=this.props.locale.pick,t=this.props.story,n=e(t.details.text);if(t.details.markdown){var r=c.parse(n,this.handleReference);return s.createElement("div",{className:"text story markdown",onClick:this.handleMarkdownClick},r)}return s.createElement("div",{className:"text story plain-text"},s.createElement("p",null,n))},renderTaskListText:function(){var e=this.props.locale.pick,t=this.props.story,n=e(t.details.text);if(t.details.markdown){var r=c.parseTaskList(n,null,this.handleItemChange,this.handleReference);return s.createElement("div",{className:"text task-list markdown",onClick:this.handleMarkdownClick},r)}var r=l.parseTaskList(n,null,this.handleItemChange);return s.createElement("div",{className:"text task-list plain-text"},s.createElement("p",null,r))},renderSurveyText:function(){var e=this.props.locale.pick,t=this.props.story,n=e(t.details.text);if(t.details.markdown){var r=(t.details.resources,this.props.theme,c.parseSurvey(n,null,this.handleItemChange,this.handleReference));return s.createElement("div",{className:"text survey markdown",onClick:this.handleMarkdownClick},r)}var r=l.parseSurvey(n,null,this.handleItemChange);return s.createElement("div",{className:"text survey plain-text"},s.createElement("p",null,r))},triggerChangeEvent:function(e,t){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e,path:t})},attachListTemplate:function(e){if("task-list"===e.type||"survey"===e.type){var t=e.details.text||{};if(!a.detect(t)){var n=this.props.locale.translate,r=this.props.locale.lang,i=t[r]||"";_.trimEnd(i)&&(i=_.trimEnd(i)+"\n\n");i+=_.map(_.range(1,4),function(t){return"[ ] "+n(e.type+"-item-$number",t)}).join("\n"),e.details=_.decoupleSet(e.details,["text",r],i)}}},handleMarkdownClick:function(e){var t=_.decouple(this.props.story,"details");t.details.markdown=!t.details.markdown,this.triggerChangeEvent(t,"story.details.markdown")},handleReference:function(e){var t=this.props.story.details.resources,n=c.findReferencedResource(t,e.name);if(n){var r,i=this.props.theme;if(e.forImage){if(!(r=i.getImageUrl(n,{height:24}))){var s=i.getImageFile(n);r=c.createBlobUrl(s,n.clip)}}else r=i.getUrl(n);return this.resourcesReferenced[r]=n,{href:r,title:void 0}}},handleTaskListClick:function(e){var t=_.clone(this.props.story);t.type="task-list"!==t.type?"task-list":"story",this.attachListTemplate(t),this.triggerChangeEvent(t,"story.details.markdown")},handleSurveyClick:function(e){var t=_.clone(this.props.story);t.type="survey"!==t.type?"survey":"story",this.attachListTemplate(t),this.triggerChangeEvent(t,"story.type")}},r(i,"handleMarkdownClick",function(e){var t=e.target;if("IMG"===t.tagName){var n=t.getAttribute("src"),r=this.resourcesReferenced[n];r&&this.props.onResourceClick&&this.props.onResourceClick({type:"resourceclick",target:this,resource:r})}}),r(i,"handleItemChange",function(e){var t=e.currentTarget,n=t.name,r=t.value,i=t.checked,s=_.decouple(this.props.story,"details"),o="survey"===s.type;s.details.text=_.mapValues(s.details.text,function(e){return a.update(e,n,r,i,o)}),this.triggerChangeEvent(s,"story.details.text")}),i))},function(e,t,n){"use strict";function r(e){var t=e.resource.duration;return i.createElement(s,e,i.createElement("div",{className:"video-duration"},o.format(t)))}var i=n(0),s=(i.PropTypes,n(84)),o=n(90);e.exports=r,n(598),r.propTypes=s.propTypes},function(e,t,n){"use strict";function r(e,t){var n=i.flatten(i.map(e,"user_ids"));return t&&n.push(t.id),i.uniq(n)}var i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=n(15),c=n(19),l=(n(67),n(6)),u=n(18),p=n(7),d=n(4),h=n(5),m=n(10),f=n(68),g=n(255),v=n(140),y=n(134),b=n(93);n(599),e.exports=a.createClass({displayName:"BookmarkList",propTypes:{access:o.oneOf(["read-only","read-comment","read-write"]).isRequired,bookmarks:o.arrayOf(o.object),currentUser:o.object,project:o.object,selectedStoryId:o.number,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onSelectionClear:o.func},renderAsync:function(e,t){var n=this.props.route.parameters,o=this.props.database.use({schema:n.schema,by:this}),a=x(this.props.currentUser),c=this.props.route!==t.route?100:1e3,l={stories:null,authors:a,draftStories:null,draftAuthors:a,senders:null,reactions:null,respondents:null,recommendations:null,recipients:null,repos:null,selectedStoryId:this.props.selectedStoryId,access:this.props.access,bookmarks:this.props.bookmarks,currentUser:this.props.currentUser,project:this.props.project,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.props.onSelectionClear};return e.show(s.createElement(k,l),c),o.start().then(function(e){var t={id:i.map(l.bookmarks,"story_id")};return o.find({table:"story",criteria:t})}).then(function(e){l.stories=e}).then(function(){var e={id:i.uniq(i.flatten(i.map(l.stories,"user_ids")))};return o.find({schema:"global",table:"user",criteria:e})}).then(function(t){return l.authors=t,e.show(s.createElement(k,l))}).then(function(){var e={id:i.flatten(i.map(l.bookmarks,"user_ids"))};return o.find({schema:"global",table:"user",criteria:e})}).then(function(t){return l.senders=t,e.show(s.createElement(k,l))}).then(function(){var e={story_id:i.map(l.stories,"id")};return"guest"===l.currentUser.type&&(e.filters.public=!0),o.find({table:"reaction",criteria:e})}).then(function(t){return l.reactions=t,e.show(s.createElement(k,l))}).then(function(){var e={id:i.map(l.reactions,"user_id")};return o.find({schema:"global",table:"user",criteria:e})}).then(function(t){return l.respondents=t,e.show(s.createElement(k,l))}).then(function(){if(l.currentUser){var e={published:!1,user_ids:[l.currentUser.id]};return o.find({table:"story",criteria:e})}}).then(function(t){if(t)return l.draftStories=t,e.show(s.createElement(k,l))}).then(function(){var e=r(l.draftStories,l.currentUser);if(e.length>1){var t={id:e};return o.find({schema:"global",table:"user",criteria:t})}}).then(function(e){e&&(l.draftAuthors=e)}).then(function(){if(l.currentUser){var e={story_id:i.map(l.stories,"id"),user_ids:[l.currentUser.id]};return o.find({table:"bookmark",criteria:e})}}).then(function(t){return l.recommendations=t,e.show(s.createElement(k,l))}).then(function(){if(l.recommendations){var e={id:i.map(l.recommendations,"target_user_id")};return o.find({schema:"global",table:"user",criteria:e})}}).then(function(t){return l.recipients=t,e.show(s.createElement(k,l))}).then(function(){var e={id:i.get(l.project,"repo_ids",[])};return o.find({schema:"global",table:"repo",criteria:e})}).then(function(e){return l.repos=e,s.createElement(k,l)})}});var k=e.exports.Sync=s.createClass({displayName:"BookmarkList.Sync",mixins:[m],propTypes:{access:o.oneOf(["read-only","read-comment","read-write"]).isRequired,bookmarks:o.arrayOf(o.object),senders:o.arrayOf(o.object),stories:o.arrayOf(o.object),authors:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),draftAuthors:o.arrayOf(o.object),reactions:o.arrayOf(o.object),respondents:o.arrayOf(o.object),recommendations:o.arrayOf(o.object),recipients:o.arrayOf(o.object),currentUser:o.object,project:o.object,repos:o.arrayOf(o.object),selectedStoryId:o.number,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onSelectionClear:o.func},getInitialState:function(){return{hiddenStoryIds:[],selectedStoryId:null}},componentWillReceiveProps:function(e){if(this.props.stories!==e.stories&&!i.isEmpty(this.state.hiddenStoryIds)){var t=i.filter(this.state.hiddenStoryIds,function(t){return i.some(e.stories,{id:t})});this.setState({hiddenStoryIds:t})}this.props.route!==e.route&&this.setState({selectedStoryId:null})},render:function(){var e=w(this.props.bookmarks),t=this.state.selectedStoryId||this.props.selectedStoryId,n={items:e,behind:4,ahead:8,anchor:t?"story-"+t:void 0,offset:20,onIdentity:this.handleBookmarkIdentity,onRender:this.handleBookmarkRender,onAnchorChange:this.handleBookmarkAnchorChange,onBeforeAnchor:this.handleBookmarkBeforeAnchor};return s.createElement("div",{className:"bookmark-list"},s.createElement(f,n),this.renderNewStoryAlert())},renderStory:function(e){if(e){var t=i.find(this.props.draftStories,{published_version_id:e.id});if(t)return this.renderEditor(t);var n=E(this.props.reactions,e),r=S(this.props.authors,e),o=N(this.props.respondents,n),a=O(this.props.recommendations,e),c=U(this.props.recipients,a),l={story:e,reactions:n,authors:r,respondents:o,recommendations:a,recipients:c,repos:this.props.repos,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(v,l)}},renderEditor:function(e,t){var n=S(this.props.draftAuthors,e),r=O(this.props.recommendations,e),i=U(this.props.recipients,r);e||(n=x(this.props.currentUser));var o={story:e,authors:n,recommendations:r,recipients:i,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(y,o)},renderNewStoryAlert:function(){var e=this.props.locale.translate,t=i.size(this.state.hiddenStoryIds),n=t>0;t?this.previousHiddenStoryCount=t:t=this.previousHiddenStoryCount||0;var r={show:n,onClick:this.handleNewBookmarkAlertClick};return s.createElement(b,r,e("alert-$count-new-bookmarks",t))},handleBookmarkIdentity:function(e){return"story-"+e.item.story_id},handleBookmarkRender:function(e){var t=e.item,n=C(this.props.stories,t);if(!n)return null;var r=!1;if(n&&"read-write"===this.props.access)if(n.published){var o=i.find(this.props.draftStories,{published_version_id:n.id});o&&(n=o,r=!0)}else r=!0;if(r||e.needed)var a=R(this.props.senders,t),c={bookmark:t,senders:a,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};if(r){var l=S(this.props.draftAuthors,n),u=O(this.props.recommendations,n),p=U(this.props.recipients,u);n||(l=x(this.props.currentUser));var d={story:n,authors:l,recommendations:u,recipients:p,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(g,c,s.createElement(y,d))}if(e.needed){var h=E(this.props.reactions,n),l=S(this.props.authors,n),m=N(this.props.respondents,h),u=O(this.props.recommendations,n),p=U(this.props.recipients,u),f={access:this.props.access,story:n,reactions:h,authors:l,respondents:m,recommendations:u,recipients:p,repos:this.props.repos,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(g,c,s.createElement(v,f))}var b=e.previousHeight||e.estimatedHeight||100;return s.createElement("div",{className:"bookmark-view",style:{height:b}})},handleBookmarkAnchorChange:function(e){var t=i.get(e.item,"story_id");t&&!i.includes(this.state.hiddenStoryIds,t)||this.setState({hiddenStoryIds:[]}),this.props.selectedStoryId&&t!==this.props.selectedStoryId&&this.props.onSelectionClear&&this.props.onSelectionClear({type:"selectionclear",target:this})},handleBookmarkBeforeAnchor:function(e){var t=i.map(e.items,"story_id"),n=i.union(t,this.state.hiddenStoryIds);this.setState({hiddenStoryIds:n})},handleNewBookmarkAlertClick:function(e){this.setState({hiddenStoryIds:[],selectedStoryId:i.first(this.state.hiddenStoryIds)})}}),x=c(function(e){return[e]}),w=c(function(e){return i.orderBy(e,["id"],["desc"])}),C=c(function(e,t){return t?i.find(e,{id:t.story_id}):null}),E=c(function(e,t){return t?i.filter(e,{story_id:t.id}):[]}),S=c(function(e,t){return t?i.filter(i.map(t.user_ids,function(t){return i.find(e,{id:t})})):[]}),R=S,N=c(function(e,t){var n=i.uniq(i.map(t,"user_id"));return i.filter(i.map(n,function(t){return i.find(e,{id:t})}))}),O=c(function(e,t){if(t){var n=t.published_version_id||t.id;return i.filter(e,{story_id:n})}return[]}),U=c(function(e,t){return i.filter(e,function(e){return i.some(t,{target_user_id:e.id})})})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0),o=s.PropTypes,a=n(27),c=n(19),l=(n(67),n(6)),u=n(18),p=n(7),d=n(4),h=n(5),m=n(10),f=n(257),g=n(234),v=n(44);n(600),e.exports=s.createClass({displayName:"CommentList",mixins:[m],propTypes:{access:o.oneOf(["read-only","read-comment","read-write"]).isRequired,showingEditor:o.bool,story:o.object.isRequired,reactions:o.arrayOf(o.object),respondents:o.arrayOf(o.object),repo:o.object,currentUser:o.object,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(h).isRequired,onFinish:o.func},getDefaultProps:function(){return{showingEditor:!0}},render:function(){return s.createElement("div",{className:"comment-list"},s.createElement(v,null,this.renderReactions()))},renderReactions:function(){var e=this,t=y(this.props.reactions,this.props.currentUser);if(t=i.filter(t,function(e){return!e.published_version_id}),this.props.showEditor){i.some(this.props.reactions,function(t){if(t.user_id===e.props.currentUser.id&&!t.published)return!0})||t.unshift(null)}return i.map(t,this.renderReaction)},renderReaction:function(e,t,n){var r=!1,i=!1;return e?e.published||e.user_id===this.props.currentUser.id&&(r=!0,e.ptime||(i=!0)):(r=!0,i=!0),r?this.renderEditor(e,i):this.renderView(e)},renderView:function(e){var t=b(this.props.respondents,e),n={access:this.props.access,reaction:e,respondent:t,story:this.props.story,repo:this.props.repo,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(f,r({key:e.id},n))},renderEditor:function(e,t){var n=t?0:e.id,i={reaction:e,story:this.props.story,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onFinish:this.props.onFinish};return s.createElement(g,r({key:n},i))},componentDidUpdate:function(e,t){var n=a.findDOMNode(this),r=n.getElementsByTagName("TEXTAREA");r=i.filter(r,{readOnly:!1});var s=i.first(i.difference(r,this.textAreas));s&&s.focus(),this.textAreas=r}});var y=c(function(e,t){var n=i.orderBy(e,["ptime","id"],["desc","desc"]),r=i.remove(n,{user_id:t,ptime:null});return i.each(r,function(e){n.unshift(e)}),n}),b=c(function(e,t){return t?i.find(e,{id:t.user_id}):null})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0),o=s.PropTypes,a=n(15),c=n(19),l=(n(67),n(6)),u=n(7),p=n(4),d=n(5),h=n(10),m=n(68),f=n(139),g=n(93);n(601),e.exports=a.createClass({displayName:"NotificationList",propTypes:{notifications:o.arrayOf(o.object),selectedNotificationId:o.number,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired,onSelectionClear:o.func},renderAsync:function(e,t){var n=this.props.route.parameters,r=this.props.database.use({schema:n.schema,by:this}),o=this.props.route!==t.route?100:1e3,a={users:null,selectedNotificationId:this.props.selectedNotificationId,notifications:this.props.notifications,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelectionClear:this.props.onSelectionClear};return e.show(s.createElement(v,a),o),r.start().then(function(e){var t={};return t.id=i.uniq(i.map(a.notifications,"user_id")),r.find({schema:"global",table:"user",criteria:t})}).then(function(t){return a.users=t,e.show(s.createElement(v,a))}).then(function(){var e={};return e.id=i.uniq(i.map(a.notifications,"story_id")),r.find({table:"story",criteria:e})}).then(function(e){return a.stories=e,s.createElement(v,a)})}});var v=e.exports.Sync=s.createClass({displayName:"NotificationList.Sync",mixins:[h],propTypes:{notifications:o.arrayOf(o.object),users:o.arrayOf(o.object),selectedNotificationId:o.number,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired,onSelectionClear:o.func},getInitialState:function(){return{hiddenNotificationIds:[],selectedNotificationId:null}},render:function(){var e=y(this.props.notifications),t=this.state.selectedNotificationId||this.props.selectedNotificationId,n={items:e,behind:20,ahead:40,anchor:t?"notification-"+t:void 0,offset:10,onIdentity:this.handleNotificationIdentity,onRender:this.handleNotificationRender,onAnchorChange:this.handleNotificationAnchorChange,onBeforeAnchor:this.handleNotificationBeforeAnchor};return s.createElement("div",{className:"notification-list"},s.createElement(m,n),this.renderNewNotificationAlert())},renderNewNotificationAlert:function(){var e=this.props.locale.translate,t=i.size(this.state.hiddenNotificationIds),n=t>0;t?this.previousHiddenNotificationCount=t:t=this.previousHiddenNotificationCount||0;var r={show:n,onClick:this.handleNewNotificationAlertClick};return s.createElement(g,r,e("alert-$count-new-notifications",t))},componentDidUpdate:function(e,t){var n=this;e.notifications===this.props.notifications&&t.hiddenNotificationIds===this.state.hiddenNotificationIds||setTimeout(function(){var e=i.filter(n.props.notifications,function(e){if(!e.seen&&!i.includes(n.state.hiddenNotificationIds,e.id))return!0});if(!i.isEmpty(e)){var t=Math.min(10,2*e.length);clearTimeout(n.markAsSeenTimeout),n.markAsSeenTimeout=setTimeout(function(){n.markAsSeen(e)},1e3*t)}},50)},componentWillUnmount:function(){clearTimeout(this.markAsSeenTimeout)},handleNotificationIdentity:function(e){return"notification-"+e.item.id},handleNotificationRender:function(e){if(e.needed){var t=e.item,n=b(this.props.users,t),i={notification:t,user:n,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onClick:this.handleNotificationClick};return s.createElement(f,r({key:t.id},i))}var o=e.previousHeight||e.estimatedHeight||25;return s.createElement("div",{className:"notification-view",style:{height:o}})},markAsSeen:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this}),r=i.map(e,function(e){return{id:e.id,seen:!0}});return n.save({table:"notification"},r)},handleNotificationClick:function(e){var t=e.target.props.notification;t.seen||this.markAsSeen([t])},handleNotificationAnchorChange:function(e){var t=i.get(e.item,"id");t&&!i.includes(this.state.hiddenNotificationIds,t)||this.setState({hiddenNotificationIds:[]}),this.props.selectedNotificationId&&t!==this.props.selectedNotificationId&&this.props.onSelectionClear&&this.props.onSelectionClear({type:"selectionclear",target:this})},handleNotificationBeforeAnchor:function(e){var t=i.map(e.items,"id"),n=i.union(t,this.state.hiddenNotificationIds);this.setState({hiddenNotificationIds:n})},handleNewNotificationAlertClick:function(e){this.setState({hiddenNotificationIds:[],selectedNotificationId:i.first(this.state.hiddenNotificationIds)})}}),y=c(function(e){return i.orderBy(e,["ctime"],["desc"])}),b=c(function(e,t){return t?i.find(e,{id:t.user_id}):null})},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(15),a=n(19),c=n(16),l=n(6),u=n(7),p=n(4),d=n(5),h=n(10),m=n(68),f=n(141);n(603),e.exports=o.createClass({displayName:"UserList",propTypes:{users:s.arrayOf(s.object).isRequired,currentUser:s.object.isRequired,database:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(p).isRequired,theme:s.instanceOf(d).isRequired},renderAsync:function(e,t){var n=this.props.route.parameters,s=this.props.database.use({schema:n.schema,by:this}),o=this.props.route!==t.route?100:1e3,a={roles:null,dailyActivities:null,listings:null,stories:null,users:this.props.users,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(g,a),o),s.start().then(function(e){var t=r.flatten(r.map(a.users,"role_ids")),n={id:r.uniq(t)};return s.find({schema:"global",table:"role",criteria:n})}).then(function(t){return a.roles=t,e.show(i.createElement(g,a))}).then(function(){var e=c(),t=e.clone().endOf("month"),n=e.clone().startOf("month").subtract(1,"month"),i="["+n.toISOString()+","+t.toISOString()+"]",o={type:"daily-activities",filters:r.map(a.users,function(e){return{user_ids:[e.id],time_range:i}})};return s.find({table:"statistics",criteria:o})}).then(function(t){return a.dailyActivities=t,e.show(i.createElement(g,a))}).then(function(){var e={type:"news",target_user_id:a.currentUser.id,filters:r.map(a.users,function(e){return{user_ids:[e.id]}})};return s.find({table:"listing",criteria:e})}).then(function(e){a.listings=e}).then(function(){var e=r.flatten(r.map(a.listings,"story_ids")),t={id:r.uniq(e)};return s.find({table:"story",criteria:t})}).then(function(e){return a.stories=e,i.createElement(g,a)})}});var g=e.exports.Sync=i.createClass({displayName:"UserList.Sync",mixins:[h],propTypes:{users:s.arrayOf(s.object).isRequired,roles:s.arrayOf(s.object),dailyActivities:s.arrayOf(s.object),listings:s.arrayOf(s.object),stories:s.arrayOf(s.object),currentUser:s.object.isRequired,database:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(p).isRequired,theme:s.instanceOf(d).isRequired,loading:s.bool},render:function(){var e=v(this.props.users,this.props.locale),t={items:e,behind:4,ahead:8,onIdentity:this.handleUserIdentity,onRender:this.handleUserRender};return i.createElement("div",{className:"user-list"},i.createElement(m,t))},handleUserIdentity:function(e){return"user-"+e.item.id},handleUserRender:function(e){if(e.needed){var t=e.item,n=y(this.props.roles,t),r=b(this.props.dailyActivities,t),s=k(this.props.listings,t),o=x(this.props.stories,s),a={user:t,roles:n,dailyActivities:r,stories:o,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(f,a)}var c=e.previousHeight||e.estimatedHeight||100;return i.createElement("div",{className:"user-view",style:{height:c}})}}),v=a(function(e,t){var n=t.pick,i=function(e){return n(e.details.name)};return r.orderBy(e,[i],["asc"])}),y=a(function(e,t){return t?r.filter(r.map(t.role_ids,function(t){return r.find(e,{id:t})})):[]}),b=a(function(e,t){return t?r.find(e,function(e){return e.filters.user_ids[0]===t.id}):null}),k=a(function(e,t){return t?r.find(e,function(e){if(e.filters.user_ids[0]===t.id)return!0}):null}),x=a(function(e,t){if(t){var n=r.keyBy(e,"id");return r.filter(r.map(t.story_ids,function(e){return n[e]}))}return[]})},function(e,t,n){"use strict";function r(e){var t=e.locale.pick,n=["user"];e.selected&&n.push("selected"),e.disabled&&n.push("disabled");var r=t(e.user.details.name),i={className:n.join(" "),"data-user-id":e.user.id,onClick:e.disabled?null:e.onClick},s={user:e.user,theme:e.theme,size:"small"};return o.createElement("div",i,o.createElement(m,s),o.createElement("span",{className:"name"},r),o.createElement("i",{className:"fa fa-check-circle"}))}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(3),o=n(0),a=o.PropTypes,c=n(15),l=n(19),u=n(6),p=n(7),d=n(4),h=n(5),m=n(29);n(604),e.exports=c.createClass({displayName:"UserSelectionList",propTypes:{selection:a.arrayOf(a.number),disabled:a.arrayOf(a.number),database:a.instanceOf(u).isRequired,route:a.instanceOf(p).isRequired,locale:a.instanceOf(d).isRequired,theme:a.instanceOf(h).isRequired,onSelect:a.func},renderAsync:function(e){var t=this.props.database.use({by:this}),n={users:null,selection:this.props.selection,disabled:this.props.disabled,locale:this.props.locale,theme:this.props.theme,onSelect:this.props.onSelect,loading:!0};return e.show(o.createElement(f,n),1e3),t.start().then(function(e){var n={hidden:!1};return t.find({schema:"global",table:"user",criteria:n})}).then(function(e){return n.users=e,n.loading=!1,o.createElement(f,n)})}});var f=e.exports.Sync=o.createClass({displayName:"UserSelectionList.Sync",propTypes:{users:a.arrayOf(a.object),selection:a.arrayOf(a.number),disabled:a.arrayOf(a.number),locale:a.instanceOf(d).isRequired,theme:a.instanceOf(h).isRequired,onSelect:a.func},render:function(){var e=g(this.props.users,this.props.locale);return o.createElement("div",{className:"user-selection-list"},s.map(e,this.renderUser))},renderUser:function(e){var t={user:e,selected:s.includes(this.props.selection,e.id),disabled:s.includes(this.props.disabled,e.id),locale:this.props.locale,theme:this.props.theme,onClick:this.handleUserClick};return o.createElement(r,i({key:e.id},t))},triggerSelectEvent:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,selection:e})},handleUserClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-user-id")),n=this.props.selection;n=s.includes(n,t)?s.difference(n,[t]):s.union(n,[t]),this.triggerSelectEvent(n)}}),g=l(function(e,t){var n=t.pick,r=function(e){return n(e.details.name)};return s.orderBy(e,[r],["asc"])})},function(e,t,n){"use strict";function r(e){var t=document.getElementById("app-container");if(!t)throw new Error("Unable to find app element in DOM");var n=i.createElement(o);s.render(n,t)}var i=n(0),s=n(27),o=n(216);window.cordova?document.addEventListener("deviceready",r):window.addEventListener("load",r)},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=(n(15),n(4)),c=n(10),l=n(35),u=n(28);n(610),e.exports=s.createClass({displayName:"LanguagePanel",mixins:[c],propTypes:{locale:o.instanceOf(a).isRequired},getSelectedLanguageCode:function(){var e=i.split(this.props.locale.languageCode,"-");return i.lowerCase(e[0])},getSelectedCountryCode:function(){var e=i.split(this.props.locale.languageCode,"-");return i.lowerCase(e[1])},render:function(){var e=this.props.locale.translate;return s.createElement(l,{className:"language"},s.createElement("header",null,s.createElement("i",{className:"fa fa-language"})," ",e("settings-language")),s.createElement("body",null,this.renderList()))},renderList:function(){var e=i.filter(this.props.locale.directory,{locales:{client:!0}});return i.map(e,this.renderButton)},renderButton:function(e){var t=this.getSelectedLanguageCode(),n={label:[e.name,this.renderCountrySelect(e)],selected:e.code===t,onClick:this.handleLanguageClick,id:e.code};return s.createElement(u,r({key:e.code},n))},renderCountrySelect:function(e){var t=this.getSelectedLanguageCode(),n=this.getSelectedCountryCode();n||(n=e.defaultCountry);var r,o=i.map(e.countries,function(e,t){return s.createElement("option",{key:t,value:t},e)});return(e.code!==t||i.size(e.countries)<=1)&&(r={visibility:"hidden"}),s.createElement("select",{key:1,value:n,style:r,onChange:this.handleCountryChange},o)},handleLanguageClick:function(e){var t=e.currentTarget.id;if(t!==this.getSelectedLanguageCode()){var n=i.find(this.props.locale.directory,{code:t}),r=n.code+"-"+n.defaultCountry;this.props.locale.change(r)}},handleCountryChange:function(e){var t=e.currentTarget.value;if(t!==this.getSelectedCountryCode()){var n=this.getSelectedLanguageCode(),r=n+"-"+t;this.props.locale.change(r)}}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=n(97),c=n(4),l=n(10),u=n(35),p=n(28);n(611),e.exports=s.createClass({displayName:"WebAlertPanel",mixins:[l],propTypes:{currentUser:o.object,locale:o.instanceOf(c).isRequired,onChange:o.func},setUserProperty:function(e,t){if(this.props.currentUser){var n=i.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},render:function(){var e=this.props.locale.translate;return s.createElement(u,{className:"mobile-alert"},s.createElement("header",null,s.createElement("i",{className:"fa fa-tablet"})," ",e("settings-mobile-alert")),s.createElement("body",null,this.renderOptions()))},renderOptions:function(){var e=a;return"admin"!==i.get(this.props.currentUser,"type")&&(e=i.without(e,a.admin)),e=i.concat(e,"web-session"),i.map(e,this.renderOption)},renderOption:function(e,t){var n=this.props.locale.translate,o=i.snakeCase(e),a=i.get(this.props.currentUser,"settings",{}),c=!!i.get(a,"notification."+o),l=!!i.get(a,"mobile_alert."+o),u={label:n("notification-option-"+e),selected:l&&(c||"web-session"===e),disabled:!(c||"web-session"===e),onClick:this.handleOptionClick,id:o};return s.createElement(p,r({key:t},u))},handleOptionClick:function(e){var t=e.currentTarget.id,n=i.clone(i.get(this.props.currentUser,"settings",{}));!i.get(n,"mobile_alert."+t)?i.set(n,"mobile_alert."+t,!0):i.unset(n,"mobile_alert."+t),this.setUserProperty("settings",n)}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=n(97),c=n(4),l=n(10),u=n(35),p=n(28);n(612),e.exports=s.createClass({displayName:"NotificationPanel",mixins:[l],propTypes:{currentUser:o.object,locale:o.instanceOf(c).isRequired,onChange:o.func},setUserProperty:function(e,t){if(this.props.currentUser){var n=i.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},render:function(){var e=this.props.locale.translate;return s.createElement(u,{className:"notification"},s.createElement("header",null,s.createElement("i",{className:"fa fa-exclamation-circle"})," ",e("settings-notification")),s.createElement("body",null,this.renderOptions()))},renderOptions:function(){var e=a;return"admin"!==i.get(this.props.currentUser,"type")&&(e=i.without(e,a.admin)),i.map(e,this.renderOption)},renderOption:function(e,t){var n=this.props.locale.translate,o=i.snakeCase(e),a=i.get(this.props.currentUser,"settings",{}),c=!!i.get(a,"notification."+o),l={label:n("notification-option-"+e),selected:c,onClick:this.handleOptionClick,id:o};return s.createElement(p,r({key:t},l))},handleOptionClick:function(e){var t=e.currentTarget.id,n=i.clone(i.get(this.props.currentUser,"settings",{})),r=!!i.get(n,"notification."+t);r?(i.unset(n,"notification."+t),i.unset(n,"web_alert."+t),i.unset(n,"mobile_alert."+t)):(i.set(n,"notification."+t,"merge"!==t||"master"),i.set(n,"web_alert."+t,!0),i.set(n,"mobile_alert."+t,!0)),console.log(r,n),this.setUserProperty("settings",n)}})},function(e,t,n){"use strict";var r=n(3),i=(n(9),n(0)),s=i.PropTypes,o=n(6),a=n(7),c=n(4),l=n(5),u=n(10),p=n(35),d=n(17),h=n(229),m=n(228),f=n(131),g=n(230);n(613),e.exports=i.createClass({displayName:"ProjectPanel",mixins:[u],propTypes:{currentProject:s.object,projectLinks:s.arrayOf(s.object),database:s.instanceOf(o).isRequired,route:s.instanceOf(a).isRequired,locale:s.instanceOf(c).isRequired,theme:s.instanceOf(l).isRequired},getInitialState:function(){return{showingDialog:null}},render:function(){var e=this.props.locale.translate;return i.createElement(p,{className:"project"},i.createElement("header",null,i.createElement("i",{className:"fa fa-database"})," ",e("settings-projects")),i.createElement("body",null,this.renderProjects(),this.renderDialogBox()),i.createElement("footer",null,this.renderButtons()))},renderProjects:function(){return r.map(this.props.projectLinks,this.renderProject)},renderProject:function(e,t){var n=this.props.locale.translate,r=this.props.locale.pick,s=this.props.route.parameters;return e.schema===s.schema&&e.address==s.address?i.createElement("div",{key:t,className:"project-option-button selected"},i.createElement("i",{className:"icon fa fa-check-circle"}),i.createElement("div",{className:"text"},i.createElement("span",{className:"name"},r(e.name)),i.createElement("div",{className:"supplemental"},i.createElement("div",{className:"item"},i.createElement("span",{className:"button"},i.createElement("i",{className:"fa fa-fw fa-home"}),i.createElement("span",{className:"label"},e.address))),i.createElement("div",{className:"item"},i.createElement("span",{className:"button",onClick:this.handleDescriptionClick},i.createElement("i",{className:"fa fa-fw fa-info-circle"}),i.createElement("span",{className:"label"},n("project-panel-description")))),i.createElement("div",{className:"item"},i.createElement("span",{className:"button",onClick:this.handleMobileSetupClick},i.createElement("i",{className:"fa fa-fw fa-qrcode"}),i.createElement("span",{className:"label"},n("project-panel-mobile-set-up")))),i.createElement("div",{className:"item"},i.createElement("span",{className:"button",onClick:this.handleSignOutClick},i.createElement("i",{className:"fa fa-fw fa-sign-out"}),i.createElement("span",{className:"label"},n("project-panel-sign-out"))))))):i.createElement("div",{key:t,"data-key":e.key,className:"project-option-button",onClick:this.handleProjectClick},i.createElement("i",{className:"icon fa fa-circle-o"}),i.createElement("div",{className:"text"},i.createElement("span",{className:"name"},r(e.name))))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("project-panel-add"),onClick:this.handleAddClick},n={label:e("project-panel-manage"),onClick:this.handleManageClick,disabled:r.size(this.props.projectLinks)<2};return i.createElement("div",{className:"buttons"},i.createElement(d,n),i.createElement(d,t))},renderDialogBox:function(){return this.props.currentProject?i.createElement("div",null,this.renderDescriptionDialogBox(),this.renderMobileSetupDialogBox(),this.renderSignOutDialogBox(),this.renderProjectManagementDialogBox()):null},renderDescriptionDialogBox:function(){var e={show:"description"===this.state.showingDialog,project:this.props.currentProject,locale:this.props.locale,theme:this.props.theme,onClose:this.handleDialogClose};return i.createElement(h,e)},renderMobileSetupDialogBox:function(){var e={show:"mobile-setup"===this.state.showingDialog,database:this.props.database,route:this.props.route,locale:this.props.locale,onClose:this.handleDialogClose};return i.createElement(m,e)},renderSignOutDialogBox:function(){var e=this.props.locale.translate,t={show:"sign-out"===this.state.showingDialog,locale:this.props.locale,onClose:this.handleDialogClose,onConfirm:this.handleSignOutConfirm};return i.createElement(f,t,e("project-panel-sign-out-are-you-sure"))},renderProjectManagementDialogBox:function(){var e={show:"management"===this.state.showingDialog,projectLinks:this.props.projectLinks,route:this.props.route,locale:this.props.locale,onDelete:this.handleProjectDelete,onCancel:this.handleDialogClose};return i.createElement(g,e)},handleProjectClick:function(e){var t=e.currentTarget.getAttribute("data-key"),i=r.find(this.props.projectLinks,{key:t});if(i){var s={address:i.address,schema:i.schema};this.props.route.replace(n(87),s)}},handleAddClick:function(e){this.props.route.push(n(88),{add:!0})},handleManageClick:function(e){this.setState({showingDialog:"management"})},handleDescriptionClick:function(e){this.setState({showingDialog:"description"})},handleMobileSetupClick:function(e){this.setState({showingDialog:"mobile-setup"})},handleSignOutClick:function(e){this.setState({showingDialog:"sign-out"})},handleDialogClose:function(e){this.setState({showingDialog:null})},handleProjectDelete:function(e){var t=this,n=r.map(e.selection,function(e){return{key:e}});this.props.database.use({by:this}).remove({schema:"local",table:"project_link"},n).then(function(){t.setState({showingDialog:null})})},handleSignOutConfirm:function(e){var t=this;this.props.database.use({by:this}).endAuthorization().then(function(){return t.props.route.replace(n(88))})}})},function(e,t,n){"use strict";function r(e,t){if(/https?:/.test(e)){e=i.trim(e.replace(/\?.*/,""));var n=i.filter(e.split("/"));return n[n.length-1]}return e}var i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=(n(15),n(4)),c=n(10),l=n(35),u=(n(17),n(146));n(614),e.exports=s.createClass({displayName:"UserPanel",mixins:[c],propTypes:{currentUser:o.object,locale:o.instanceOf(a).isRequired,onChange:o.func},getUserProperty:function(e){return i.get(this.props.currentUser,e)},setUserProperty:function(e,t){if(this.props.currentUser){var n=i.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},render:function(){var e=this.props.locale.translate;return s.createElement(l,{className:"user"},s.createElement("header",null,s.createElement("i",{className:"fa fa-globe"})," ",e("settings-social-networks")),s.createElement("body",null,this.renderSkypeNameInput(),this.renderSlackTeamInput(),this.renderSlackIdInput(),this.renderIChatInput(),this.renderTwitterInput(),this.renderGithubUrlInput(),this.renderGitlabUrlInput(),this.renderLinkedInUrlInput(),this.renderStackoverflowUrlInput()))},renderSkypeNameInput:function(){var e=this.props.locale.translate,t={id:"skype",value:this.getUserProperty("details.skype_username"),locale:this.props.locale,onChange:this.handleSkypeUsernameChange};return s.createElement(u,t,e("social-network-skype"))},renderSlackTeamInput:function(){var e=this.props.locale.translate,t={id:"slack-team",value:this.getUserProperty("details.slack_team_id"),locale:this.props.locale,onChange:this.handleSlackTeamIDChange};return s.createElement(u,t,e("social-network-slack-team"))},renderSlackIdInput:function(){var e=this.props.locale.translate,t={id:"slack-user",value:this.getUserProperty("details.slack_user_id"),locale:this.props.locale,onChange:this.handleSlackUserIDChange};return s.createElement(u,t,e("social-network-slack"))},renderIChatInput:function(){var e=this.props.locale.translate,t={id:"ichat",value:this.getUserProperty("details.ichat_username"),locale:this.props.locale,onChange:this.handleIchatUsernameChange};return s.createElement(u,t,e("social-network-ichat"))},renderTwitterInput:function(){var e=this.props.locale.translate,t={id:"twitter",value:this.getUserProperty("details.twitter_username"),locale:this.props.locale,onChange:this.handleTwitterUsernameChange};return s.createElement(u,t,e("social-network-twitter"))},renderGithubUrlInput:function(){var e=this.props.locale.translate,t={id:"github",value:this.getUserProperty("details.github_url"),locale:this.props.locale,onChange:this.handleGitHubUrlChange};return s.createElement(u,t,e("social-network-github"))},renderGitlabUrlInput:function(){var e=this.props.locale.translate,t={id:"github",value:this.getUserProperty("details.gitlab_url"),locale:this.props.locale,onChange:this.handleGitlabUrlChange};return s.createElement(u,t,e("social-network-gitlab"))},renderLinkedInUrlInput:function(){var e=this.props.locale.translate,t={id:"linkedin",value:this.getUserProperty("details.linkedin_url"),locale:this.props.locale,onChange:this.handleLinkedinUrlChange};return s.createElement(u,t,e("social-network-linkedin"))},renderStackoverflowUrlInput:function(){var e=this.props.locale.translate,t={id:"stackoverflow",value:this.getUserProperty("details.stackoverflow_url"),locale:this.props.locale,onChange:this.handleStackoverflowUrlChange};return s.createElement(u,t,e("social-network-stackoverflow"))},handleSkypeUsernameChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.skype_username",t)},handleSlackUserIDChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.slack_user_id",t)},handleSlackTeamIDChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.slack_team_id",t)},handleIchatUsernameChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.ichat_username",t)},handleTwitterUsernameChange:function(e){var t=r(e.target.value);this.setUserProperty("details.twitter_username",t)},handleLinkedinUrlChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.linkedin_url",t)},handleGitHubUrlChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.github_url",t)},handleGitlabUrlChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.gitlab_url",t)},handleStackoverflowUrlChange:function(e){var t=i.trim(e.target.value);this.setUserProperty("details.stackoverflow_url",t)}})},function(e,t,n){"use strict";function r(e,t,n){var r=0,i=0,s=Math.min(e,t);return"center"!==n&&n||(e>s?r=Math.floor((e-s)/2):t>s&&(i=Math.floor((t-s)/2))),{left:r,top:i,width:s,height:s}}function i(e){return s.toUpper(o().format("YYYY-MMM-DD-hhA"))+e}var s=n(3),o=(n(9),n(16)),a=n(0),c=a.PropTypes,l=(n(15),n(148)),u=n(4),p=n(5),d=n(10),h=n(35),m=n(17),f=n(84),g=n(132);n(615),e.exports=a.createClass({displayName:"UserImagePanel",mixins:[d],propTypes:{currentUser:c.object,locale:c.instanceOf(u).isRequired,theme:c.instanceOf(p).isRequired,onChange:c.func},getInitialState:function(){return{capturing:!1}},getUserProperty:function(e){return s.get(this.props.currentUser,e)},setUserProperty:function(e,t){if(this.props.currentUser){var n=s.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},setImage:function(e){var t=this.getUserProperty("details.resources"),n=s.slice(t),r=s.findIndex(n,{type:"image"});-1!==r?n[r]=e:n.push(e),this.setUserProperty("details.resources",n)},render:function(){var e=this.props.locale.translate;return a.createElement(h,{className:"user-image"},a.createElement("header",null,a.createElement("i",{className:"fa fa-image"})," ",e("settings-profile-image")),a.createElement("body",null,this.renderProfilePicture(),this.renderDialogBox()),a.createElement("footer",null,this.renderButtons()))},renderProfilePicture:function(){var e=this.getUserProperty("details.resources"),t=s.find(e,{type:"image"});if(t){var r={resource:t,locale:this.props.locale,theme:this.props.theme,previewWidth:256,previewHeight:256,onChange:this.handleImageChange};return a.createElement(f,r)}var i=n(128);return a.createElement("div",{className:"no-image"},a.createElement(i,{className:""}))},renderDialogBox:function(){var e={show:this.state.capturing,locale:this.props.locale,onCapture:this.handlePhotoCapture,onCancel:this.handleCaptureCancel};return a.createElement(g,e)},renderButtons:function(){var e={label:"Remove",onClick:this.handleRemoveClick},t={label:"Take picture",onClick:this.handleTakeClick},n={label:"Select picture",onChange:this.handleFileChange};return a.createElement("div",{className:"buttons"},a.createElement("div",{className:"left"},a.createElement(m,e)),a.createElement("div",{className:"right"},a.createElement(m,t),a.createElement(m.File,n)))},handleRemoveClick:function(e){var t=this.getUserProperty("details.resources"),n=s.findIndex(t,{type:"image"}),r=s.slice(t);r.splice(n,1),this.setUserProperty("details.resources",r)},handleTakeClick:function(e){this.setState({capturing:!0})},handlePhotoCapture:function(e){var t=e.image,n=s.assign({type:"image",clip:r(t.width,t.height),filename:i(".jpg")},t);this.setImage(n),this.setState({capturing:!1})},handleCaptureCancel:function(e){this.setState({capturing:!1})},handleImageChange:function(e){this.setImage(e.resource)},handleFileChange:function(e){var t=this,n=e.target.files[0];if(n){var i=s.last(s.split(n.type,"/")),o=URL.createObjectURL(n);return l.loadImage(o).then(function(e){var s={type:"image",format:i,filename:n.name,file:n,width:e.naturalWidth,height:e.naturalHeight,clip:r(e.naturalWidth,e.naturalHeight)};return t.setImage(s),null}).finally(function(){URL.revokeObjectURL(o)})}}})},function(e,t,n){"use strict";var r=n(3),i=(n(9),n(0)),s=i.PropTypes,o=(n(15),n(4)),a=n(10),c=n(35),l=(n(17),n(146));n(616),e.exports=i.createClass({displayName:"UserInfoPanel",mixins:[a],propTypes:{currentUser:s.object,locale:s.instanceOf(o).isRequired,onChange:s.func},getUserProperty:function(e){return r.get(this.props.currentUser,e)},setUserProperty:function(e,t){if(this.props.currentUser){var n=r.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},render:function(){var e=this.props.locale.translate;return i.createElement(c,{className:"user-info"},i.createElement("header",null,i.createElement("i",{className:"fa fa-user-circle"})," ",e("settings-user-information")),i.createElement("body",null,this.renderNameInput(),this.renderEmailInput(),this.renderPhoneInput(),this.renderGenderSelector()))},renderNameInput:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.getUserProperty("details.name"),r={id:"name",value:t(n),locale:this.props.locale,onChange:this.handleNameChange};return i.createElement(l,r,e("user-info-name"))},renderEmailInput:function(){var e=this.props.locale.translate,t={id:"email",value:this.getUserProperty("details.email"),locale:this.props.locale,onChange:this.handleEmailChange};return i.createElement(l,t,e("user-info-email"))},renderPhoneInput:function(){var e=this.props.locale.translate,t={id:"email",value:this.getUserProperty("details.phone"),locale:this.props.locale,onChange:this.handlePhoneChange};return i.createElement(l,t,e("user-info-phone"))},renderGenderSelector:function(){var e=this.props.locale.translate,t={id:"gender",value:this.getUserProperty("details.gender")||"",size:3,onChange:this.handleGenderChange};return i.createElement("div",{className:"gender-selector"},i.createElement("label",{htmlFor:"gender"},e("user-info-gender")),i.createElement("select",t,i.createElement("option",{value:"male"},e("user-info-gender-male")),i.createElement("option",{value:"female"},e("user-info-gender-female")),i.createElement("option",{value:""},e("user-info-gender-unspecified"))))},handleNameChange:function(e){var t=e.target.value;this.setUserProperty("details.name",t)},handleEmailChange:function(e){var t=e.target.value;this.setUserProperty("details.email",t)},handlePhoneChange:function(e){var t=e.target.value;this.setUserProperty("details.phone",t)},handleGenderChange:function(e){var t=e.target.value;this.setUserProperty("details.gender",t||void 0)}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=(n(9),n(0)),o=s.PropTypes,a=n(97),c=n(4),l=n(10),u=n(35),p=n(28);n(617),e.exports=s.createClass({displayName:"WebAlertPanel",mixins:[l],propTypes:{currentUser:o.object,locale:o.instanceOf(c).isRequired,onChange:o.func},setUserProperty:function(e,t){if(this.props.currentUser){var n=i.decoupleSet(this.props.currentUser,e,t);this.props.onChange&&this.props.onChange({type:"change",target:this,user:n})}},render:function(){var e=this.props.locale.translate;return s.createElement(u,{className:"web-alert"},s.createElement("header",null,s.createElement("i",{className:"fa fa-id-card"})," ",e("settings-web-alert")),s.createElement("body",null,this.renderOptions()))},renderOptions:function(){var e=a;return"admin"!==i.get(this.props.currentUser,"type")&&(e=i.without(e,a.admin)),i.map(e,this.renderOption)},renderOption:function(e,t){var n=this.props.locale.translate,o=i.snakeCase(e),a=i.get(this.props.currentUser,"settings",{}),c=!!i.get(a,"notification."+o),l=!!i.get(a,"web_alert."+o),u={label:n("notification-option-"+e),selected:l&&c,disabled:!c,onClick:this.handleOptionClick,id:o};return s.createElement(p,r({key:t},u))},handleOptionClick:function(e){var t=e.currentTarget.id,n=i.clone(i.get(this.props.currentUser,"settings",{}));!i.get(n,"web_alert."+t)?i.set(n,"web_alert."+t,!0):i.unset(n,"web_alert."+t),this.setUserProperty("settings",n)}})},function(e,t,n){"use strict";var r=(n(3),n(0)),i=r.PropTypes,s=n(106),o=n(5),a=n(4);n(618),e.exports=r.createClass({displayName:"AppComponent",propTypes:{component:i.object.isRequired,theme:i.instanceOf(o),locale:i.instanceOf(a),onSelect:i.func},render:function(){return r.createElement("div",{className:"app-component",onClick:this.handleClick},this.renderPicture(),this.renderText())},renderPicture:function(){var e=this.props.component;if(e.image){var t=this.props.theme.getImageUrl(e.image);return r.createElement("div",{className:"picture"},r.createElement("img",{src:t}))}var n=e.icon||{},i=n.class||"fa-cubes",s={color:n.color,backgroundColor:n["background-color"]};return r.createElement("div",{className:"picture"},r.createElement("div",{className:"icon",style:s},r.createElement("i",{className:"fa fa-fw "+i})))},renderText:function(){var e=this.props.locale.pick,t=e(this.props.component.text),n=s.parse(t);return r.createElement("div",{className:"text"},r.createElement("div",{className:"text-contents"},n,r.createElement("div",{className:"ellipsis"},"...")))},handleClick:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,component:this.props.component})}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0),o=s.PropTypes,a=n(6),c=n(7),l=n(4),u=n(5),p=n(92);n(619),e.exports=s.createClass({displayName:"BookmarkView",propTypes:{bookmark:o.object,senders:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(a).isRequired,route:o.instanceOf(c).isRequired,locale:o.instanceOf(l).isRequired,theme:o.instanceOf(u).isRequired},render:function(){return s.createElement("div",{className:"bookmark-view"},s.createElement("div",{className:"title"},this.renderSenderNames(),this.renderCloseButton()),s.createElement("div",{className:"contents"},this.props.children))},renderSenderNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,o=i.get(this.props.currentUser,"id"),a=i.some(this.props.senders,{id:o}),c=i.filter(this.props.senders,function(e){return e.id!==o});if(a)switch(c.length){case 0:e=t("bookmark-you-bookmarked-it");break;case 1:var l=n(c[0].details.name,c[0].details.gender);e=t("bookmark-you-bookmarked-it-and-$name-recommends-it",l);break;default:var u={users:c,label:t("bookmark-$count-users",c.length),title:t("bookmark-recommendations"),locale:this.props.locale,theme:this.props.theme},d=s.createElement(p,r({key:1},u));e=t("bookmark-you-bookmarked-it-and-$users-recommends-it",d,c.length)}else switch(c.length){case 0:e=" ";break;case 1:var l=n(c[0].details.name,c[0].details.gender);e=t("bookmark-$name-recommends-this",l);break;case 2:var h=n(c[0].details.name,c[0].details.gender);n(c[1].details.name,c[1].details.gender);e=t("bookmark-$name1-and-$name2-recommend-this",h);break;default:var l=n(c[0].details.name,c[0].details.gender),m=i.slice(c,1),u={users:m,label:t("bookmark-$count-other-users",m.length),title:t("bookmark-recommendations"),locale:this.props.locale,theme:this.props.theme},d=s.createElement(p,r({key:1},u));e=t("bookmark-$name-and-$users-recommend-this",l,d,m.length)}return s.createElement("span",{className:"name"},e)},renderCloseButton:function(){return s.createElement("div",{className:"close-btn",onClick:this.handleCloseClick},s.createElement("i",{className:"fa fa-close"}))},removeBookmark:function(e){var t=this.props.route.parameters;return this.props.database.use({schema:t.schema,by:this}).removeOne({table:"bookmark"},e)},handleCloseClick:function(e){this.removeBookmark(this.props.bookmark)}})},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(16),a=n(282),c=n(4),l=n(5),u=n(144),p=n(28);n(620),e.exports=i.createClass({displayName:"CommentViewOptions",propTypes:{access:s.oneOf(["read-only","read-comment","read-write"]).isRequired,currentUser:s.object.isRequired,reaction:s.object.isRequired,story:s.object.isRequired,options:s.object.isRequired,locale:s.instanceOf(c),theme:s.instanceOf(l)},getInitialState:function(){return{open:!1}},canWrite:function(){return"read-write"===this.props.access},canComment:function(){var e=this.props.access;return"read-comment"===e||"read-write"===e},canEditReaction:function(){if(!this.canComment())return!1;var e=this.props.reaction,t=this.props.currentUser;return!!(r.includes(a.editable,e.type)&&e.user_id===t.id&&o()<o(e.ptime).add(3,"day"))},canRemoveReaction:function(){if(!this.canComment())return!1;var e=this.props.reaction,t=this.props.story,n=this.props.currentUser;return"admin"===n.type||(e.user_id===n.id&&o()<o(e.ptime).add(3,"day")||!!(r.includes(t.user_ids,n.id)&&o()<o(t.ptime).add(7,"day")))},canHideReaction:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;if("guest"!==t.type){if("admin"===t.type)return!0;if(r.includes(e.user_ids,t.id))return!0}return!1},render:function(){var e=this.canEditReaction()||this.canRemoveReaction()||this.canHideReaction(),t={className:"comment-view-options",disabled:!e,popOut:!0,onOpen:this.handleOpen,onClose:this.handleClose};return i.createElement(u,t,i.createElement("button",null,i.createElement("i",{className:"fa fa-ellipsis-v"})),i.createElement("menu",null,this.renderOptions()))},renderOptions:function(){if(!this.state.open)return null;var e=this.props.locale.translate,t=this.props.options,n={label:e("option-hide-comment"),hidden:!this.canHideReaction(),selected:t.hideReaction,onClick:this.handleHideClick},r={label:e("option-edit-comment"),hidden:!this.canEditReaction(),selected:t.editReaction,onClick:this.handleEditClick},s={label:e("option-remove-comment"),hidden:!this.canRemoveReaction(),selected:t.removeReaction,onClick:this.handleRemoveClick};return i.createElement("div",{className:"view-options in-menu"},i.createElement(p,n),i.createElement(p,r),i.createElement(p,s))},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,options:e})},handleOpen:function(e){this.setState({open:!0})},handleClose:function(e){this.setState({open:!1})},handleHideClick:function(e){var t=r.clone(this.props.options);t.hideReaction=!t.hideReaction,this.triggerChangeEvent(t)},handleEditClick:function(e){var t=r.clone(this.props.options);t.editReaction=!0,this.triggerChangeEvent(t)},handleRemoveClick:function(e){var t=r.clone(this.props.options);t.removeReaction=!0,this.triggerChangeEvent(t)}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(57),o=n(19),a=n(6),c=n(7),l=n(4),u=n(5),p=n(10),d=n(29),h=n(138),m=n(82),f=n(58),g=n(256);n(621),e.exports=r.createClass({displayName:"CommentView",mixins:[p],propTypes:{access:i.oneOf(["read-only","read-comment","read-write"]).isRequired,reaction:i.object.isRequired,respondent:i.object,story:i.object.isRequired,currentUser:i.object.isRequired,repo:i.object,database:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired},getInitialState:function(){var e={options:v,selectedResourceUrl:null,showingReferencedMediaDialog:!1,renderingReferencedMediaDialog:!1};return this.updateOptions(e,this.props),e},componentWillReceiveProps:function(e){var t=this,n=_.clone(this.state);this.props.reaction!==e.reaction&&this.updateOptions(n,e);var r=_.pickBy(n,function(e,n){return t.state[n]!==e});_.isEmpty(r)||this.setState(r)},updateOptions:function(e,t){(e.options=_.clone(e.options)).hideReaction=!t.reaction.public},render:function(){return r.createElement("div",{className:"comment-view"},r.createElement("div",{className:"profile-image-column"},this.renderProfileImage()),r.createElement("div",{className:"contents-column"},r.createElement("div",{className:"text"},this.renderOptionButton(),this.renderTime(),this.renderText(),this.renderReferencedMediaDialog()),this.renderMedia()))},renderProfileImage:function(){var e={user:this.props.respondent,theme:this.props.theme,size:"small"};if(this.props.respondent)var t=this.props.route.find(n(43),{schema:this.props.route.parameters.schema,user:this.props.respondent.id});return r.createElement("a",{href:t},r.createElement(d,e))},renderText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.reaction,i=this.props.story,o=t(_.get(this.props.respondent,"details.name"));if(this.resourcesReferenced={},!n.published){var a=n.ptime?"editing":"writing";return r.createElement("span",{className:"in-progress"},e("comment-$user-is-"+a,o))}switch(n.type){case"like":return r.createElement("span",{className:"like"},e("comment-$user-likes-this",o));case"comment":var c=_.get(n,"details.text");if(_.get(n,"details.markdown",!1)){var l=s.parse(t(c),this.handleReference);return"p"===l[0].type&&(l[0]=r.createElement("span",{key:0},l[0].props.children)),r.createElement("span",{className:"comment markdown",onClick:this.handleMarkdownClick},o,": ",l)}return r.createElement("span",{className:"comment"},o,": ",t(c));case"vote":return r.createElement("span",{className:"vote"},e("comment-$user-cast-a-vote",o));case"task-completion":return r.createElement("span",{className:"task-completion"},e("comment-$user-completed-a-task",o));case"note":var u,p,d=_.get(this.props.repo,"details.web_url"),h=_.find(n.external,function(e){return!!e.note});if(d&&h)switch(p=h.type,i.type){case"push":case"merge":if(h.note&&h.commit){var m=h.note.id;u=d+"/commit/"+h.commit.id+"#note_"+m}break;case"issue":if(h.note){var m=h.note.id,f=this.props.story.details.number;u=d+"/issues/"+f+"#note_"+m}break;case"merge-request":if(h.note){var m=h.note.id,g=this.props.story.details.number;u=d+"/merge_requests/"+g+"#note_"+m}}return r.createElement("a",{className:"note",href:u,target:p},e("comment-$user-commented-on-"+i.type,o));case"assignment":var d=_.get(this.props.repo,"details.web_url");if("issue"===i.type){var u,p,h=_.find(n.external,function(e){return!!e.issue});if(d&&h){var f=this.props.story.details.number;u=d+"/issues/"+f,p=h.type}return r.createElement("a",{className:"issue-assignment",href:u,target:p},e("comment-$user-is-assigned-to-issue",o))}if("merge-request"===i.type){var u,p,h=_.find(n.external,function(e){return!!e.merge_request});if(d){var g=this.props.story.details.number;u=d+"/merge_requests/"+g,p=h.type}return r.createElement("a",{className:"issue-assignment",href:u,target:p},e("comment-$user-is-assigned-to-merge-request",o))}}},renderOptionButton:function(){var e={access:this.props.access,currentUser:this.props.currentUser,reaction:this.props.reaction,story:this.props.story,locale:this.props.locale,theme:this.props.theme,options:this.state.options,onChange:this.handleOptionsChange};return r.createElement(g,e)},renderTime:function(){var e={time:this.props.reaction.ptime,locale:this.props.locale};return r.createElement(f,e)},renderMedia:function(){var e=_.get(this.props.reaction,"details.resources");if(_.isEmpty(this.resourcesReferenced)||(e=_.difference(e,_.values(this.resourcesReferenced))),_.isEmpty(e))return null;var t={locale:this.props.locale,theme:this.props.theme,resources:e};return r.createElement("div",{className:"media"},r.createElement(h,t))},renderReferencedMediaDialog:function(){if(!this.state.renderingReferencedMediaDialog)return null;var e=this.resourcesReferenced[this.state.selectedResourceUrl],t=y(this.resourcesReferenced),n=_.indexOf(t,e);if(-1===n)return null;var i={show:this.state.showingReferencedMediaDialog,resources:t,selectedIndex:n,locale:this.props.locale,theme:this.props.theme,onClose:this.handleReferencedMediaDialogClose};return r.createElement(m,i)},saveReaction:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this});return n.start().then(function(){return n.saveOne({table:"reaction"},e)})},removeReaction:function(e){var t=this.props.route.parameters;return this.props.database.use({schema:t.schema,by:this}).removeOne({table:"reaction"},e)},setOptions:function(e){var t=this,n=this.state.options;this.setState({options:e},function(){if(e.editReaction&&!n.editReaction){var r=_.clone(t.props.reaction);r.published=!1,t.saveReaction(r)}if(e.removeReaction&&!n.removeReaction&&t.removeReaction(t.props.reaction),e.hideReaction!==n.hideReaction){var r=_.clone(t.props.reaction);r.public=!e.hideReaction,t.saveReaction(r)}})},handleReference:function(e){var t=this.props.reaction.details.resources,n=s.findReferencedResource(t,e.name);if(n){var r,i=this.props.theme;if(e.forImage){if(!(r=i.getImageUrl(n,{height:24}))){var o=i.getImageFile(n);r=s.createBlobUrl(o,n.clip)}}else r=i.getUrl(n);return this.resourcesReferenced[r]=n,{href:r,title:void 0}}},handleMarkdownClick:function(e){var t=e.target;if("IMG"===t.tagName){var n=t.getAttribute("src"),r=this.resourcesReferenced[n];if(r)"image"===r.type||"video"===r.type?this.setState({selectedResourceUrl:n,renderingReferencedMediaDialog:!0,showingReferencedMediaDialog:!0}):"website"===r.type?window.open(r.url):r.type;else{var i=t.getBoundingClientRect(),s=t.naturalWidth+50,o=t.naturalHeight+50,a=i.left+window.screenLeft,c=i.top+window.screenTop;window.open(t.src,"_blank","width="+s+",height="+o+",left="+a+",top="+c+"status=no,menubar=no")}}},handleReferencedMediaDialogClose:function(e){var t=this;this.setState({showingReferencedMediaDialog:!1},function(){setTimeout(function(){t.state.showingReferencedMediaDialog||t.setState({renderingReferencedMediaDialog:!1,selectedResourceUrl:null})},500)})},handleOptionsChange:function(e){this.setOptions(e.options)}});var v={hideReaction:!1,editReaction:!1,removeReaction:!1},y=o(function(e){return _.filter(e,function(e){switch(e.type){case"image":case"video":return!0}})})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(18),a=n(7),c=n(4),l=n(5),u=n(10),p=n(37),d=n(34),h=n(241);n(624),e.exports=r.createClass({displayName:"StoryComments",mixins:[u],propTypes:{access:i.oneOf(["read-only","read-comment","read-write"]).isRequired,story:i.object.isRequired,currentUser:i.object.isRequired,reactions:i.arrayOf(i.object),respondents:i.arrayOf(i.object),repo:i.object,database:i.instanceOf(s).isRequired,payloads:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},getInitialState:function(){return{expanded:this.shouldExpandAutomatically(this.props),editing:_.some(this.props.reactions,{user_id:this.props.currentUserId,published:!1})}},shouldExpandAutomatically:function(e){if(e.reactions&&e.respondents){var t=_.get(this.props.currentUser,"id");return!!_.includes(e.story.user_ids,t)||!!_.some(e.reactions,{user_id:t})}},componentWillReceiveProps:function(e){if(void 0===this.state.expanded){var t=this.shouldExpandAutomatically(e);void 0!==t&&this.setState({expanded:t})}},render:function(){return r.createElement(p,{className:"comments"},r.createElement("header",null,this.renderButtons()),r.createElement("body",null,this.renderReactions()))},renderButtons:function(){var e=this.props.locale.translate,t=this.props.access,n="read-comment"===t||"read-write"===t,i={icon:"thumbs-up",label:e("story-like"),hidden:!n,highlighted:!!this.getCurrentUserLike(),onClick:this.handleLikeClick},s={icon:"comment",label:e("story-comment"),hidden:!n,highlighted:this.getCurrentUserComments().length>0||this.state.editing,onClick:this.handleCommentClick},o={className:"show-btn",hidden:!0,label:e("story-$count-user-reacted-to-story",_.size(this.props.respondents)),onClick:this.handleShowClick};return"columns-1"===this.props.theme.mode&&(this.state.expanded||_.isEmpty(this.props.reactions)||(o.hidden=!1)),r.createElement("div",null,r.createElement(d,i),r.createElement(d,s),r.createElement(d,o)," ")},renderReactions:function(){if("columns-1"===this.props.theme.mode&&!this.state.expanded)return null;if(!this.state.editing&&_.isEmpty(this.props.reactions))return null;var e={access:this.props.access,showEditor:this.state.editing,story:this.props.story,reactions:this.props.reactions,respondents:this.props.respondents,repo:this.props.repo,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onFinish:this.handleCommentFinish};return r.createElement(h,e)},getCurrentUserLike:function(){return _.find(this.props.reactions,{type:"like",user_id:_.get(this.props.currentUser,"id")})},getCurrentUserComments:function(){return _.filter(this.props.reactions,{type:"comment",user_id:_.get(this.props.currentUser,"id")})},handleLikeClick:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this}),r=this.getCurrentUserLike();r?n.removeOne({table:"reaction"},r):(r={type:"like",story_id:this.props.story.id,user_id:this.props.currentUser.id,published:!0,public:!0},n.saveOne({table:"reaction"},r))},handleCommentClick:function(e){this.setState({expanded:!0,editing:!0})},handleShowClick:function(e){this.setState({expanded:!0})},handleCommentFinish:function(e){var t=this;_.some(this.props.reactions,function(e){if(!e.published&&e.user_id===t.props.currentUser.id)return!0})||this.setState({editing:!1})}})},function(e,t,n){"use strict";function r(e){if(e=o.trim(e)){return l(e).format("ll")}}function i(e,t){return e&&t?o.find(e.external,function(e){return o.some(t.external,function(t){return o.isMatch(e,t)})}):null}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(3),a=n(0),c=a.PropTypes,l=n(16),u=n(19),p=n(56),d=n(57),h=n(152),m=n(6),f=n(7),g=n(4),v=n(5),y=n(149),b=n(10),k=n(37),x=n(29),w=n(138),C=n(82),E=n(92),S=n(254),R=n(226),N=n(44),O=n(58),U=n(17);n(625),e.exports=a.createClass({displayName:"StoryContents",mixins:[b],propTypes:{story:c.object.isRequired,authors:c.arrayOf(c.object),currentUser:c.object.isRequired,reactions:c.arrayOf(c.object),repo:c.object,status:c.object,cornerPopUp:c.element,database:c.instanceOf(m).isRequired,route:c.instanceOf(f).isRequired,locale:c.instanceOf(g).isRequired,theme:c.instanceOf(v).isRequired,onChange:c.func,onReaction:c.func},getInitialState:function(){var e={voteSubmitted:!1,selectedComponent:null,showingComponentDialog:!1,renderingComponentDialog:!1,selectedResourceUrl:null,showingReferencedMediaDialog:!1,renderingReferencedMediaDialog:!1};return this.updateUserAnswers({},e),e},componentWillReceiveProps:function(e){var t=o.clone(this.state);this.props.story!==e.story&&this.updateUserAnswers(t,e);var n=o.shallowDiff(t,this.state);o.isEmpty(n)||this.setState(n)},updateUserAnswers:function(e,t){if(t.story)if("survey"===t.story.type){var n=t.locale.pick,r=n(t.story.details.text),i=p.extract(r),s=e.userAnswers;o.each(i,function(e,t){o.each(e,function(e,t){e.checked&&(s&&void 0!==s[e.list]||(s=o.decoupleSet(s,[e.list],e.key)))})}),e.userAnswers=s}else"task-list"===t.story.type&&(e.userAnswers=null)},isCurrentUserAuthor:function(){var e=this.props.story.user_ids,t=this.props.currentUser.id;return o.includes(e,t)},hasUserVoted:function(){if(null!==this.props.reactions){return!!T(this.props.reactions,this.props.currentUser)}},render:function(){return a.createElement(k,{className:"contents"},a.createElement("header",null,this.renderProfileImage(),this.renderAuthorNames(),this.props.cornerPopUp),a.createElement("subheader",null,this.renderProgress(),this.renderEmblem()),a.createElement("body",null,this.renderText(),this.renderMedia(),this.renderReferencedMediaDialog(),this.renderAppComponents()),a.createElement("footer",null,this.renderButtons()))},renderProfileImage:function(){var e=o.get(this.props.authors,0),t={user:e,theme:this.props.theme,size:"medium"};if(e)var r=this.props.route.find(n(43),{schema:this.props.route.parameters.schema,user:e.id});return a.createElement("a",{href:r},a.createElement(x,t))},renderAuthorNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,r=this.props.authors,i=o.map(r,function(e){return n(e.details.name,e.details.gender)});switch(o.size(r)){case 0:e=" ";break;case 1:e=""+i[0];break;case 2:e=t("story-author-$name1-and-$name2",i[0],i[1]);break;default:var c=o.slice(r,1),l={users:c,label:t("story-author-$count-others",c.length),title:t("story-coauthors"),locale:this.props.locale,theme:this.props.theme},u=a.createElement(E,s({key:1},l));e=t("story-author-$name-and-$users",i[0],u,c.length)}return a.createElement("span",{className:"name"},e)},renderProgress:function(){var e=this.props.status;if(e){var t=this.props.locale.translate;return a.createElement("span",{className:"status"},t("story-status-"+e.action+"-$progress",e.progress))}var n={time:this.props.story.ptime,locale:this.props.locale};return a.createElement(O,n)},renderEmblem:function(){var e=this.props.story.type,t="graphic";if(!o.includes(y.git,e))return null;t+=" git";var n=y.icons[e];if("issue"===e){var r=this.props.story.details.state;n=y.icons[e+"."+r]}return n?a.createElement("div",{className:t},a.createElement(n,{className:e})):null},renderText:function(){switch(this.resourcesReferenced={},this.props.story.type){case"story":return this.renderStoryText();case"task-list":return this.renderTaskListText();case"survey":return this.renderSurveyText();case"repo":return this.renderRepoText();case"member":return this.renderMemberText();case"push":case"merge":case"branch":return this.renderPushText();case"issue":return this.renderIssueText();case"merge-request":return this.renderMergeRequestText();case"milestone":return this.renderMilestoneText();case"wiki":return this.renderWikiText()}},renderStoryText:function(){var e=this.props.locale.pick,t=this.props.story,n=o.trimEnd(e(t.details.text));if(!n)return null;if(t.details.markdown){var r=d.parse(n,this.handleReference);return a.createElement("div",{className:"text story markdown",onClick:this.handleMarkdownClick},r)}return a.createElement("div",{className:"text story plain-text"},a.createElement("p",null,n))},renderTaskListText:function(){var e=this.props.locale.pick,t=this.props.story,n=o.trimEnd(e(t.details.text));if(!n)return null;var r=this.state.userAnswers;if(t.details.markdown){var i=d.parseTaskList(n,r,this.handleTaskListItemChange,this.handleReference);return a.createElement("div",{className:"text task-list markdown",onClick:this.handleMarkdownClick},i)}var i=h.parseTaskList(n,r,this.handleTaskListItemChange);return a.createElement("div",{className:"text task-list plain-text"},a.createElement("p",null,i))},renderSurveyText:function(){var e=this.props.locale.pick,t=this.props.story,n=o.trimEnd(e(t.details.text));if(!n)return null;if(this.hasUserVoted()){var r=P(this.props.reactions);if(t.details.markdown){var i=d.parseSurveyResults(n,r,this.handleReference);return a.createElement("div",{className:"text survey markdown",onClick:this.handleMarkdownClick},i)}var i=h.parseSurveyResults(n,r);return a.createElement("div",{className:"text survey plain-text"},a.createElement("p",null,i))}var s=this.state.userAnswers;if(t.details.markdown){var c=d.parseSurvey(n,s,this.handleSurveyItemChange,this.handleReference);return a.createElement("div",{className:"text survey markdown",onClick:this.handleMarkdownClick},c)}var c=h.parseSurvey(n,s,this.handleSurveyItemChange);return a.createElement("div",{className:"text survey plain-text"},a.createElement("p",null,c))},renderRepoText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.story,r=n.details.action,i=this.props.repo,s=t(o.get(i,"details.title"))||o.get(i,"name"),c=o.get(i,"details.web_url");return a.createElement("div",{className:"text repo"},a.createElement("p",null,a.createElement("a",{href:c,target:"_blank"},e("story-repo-"+r+"-$name",s))))},renderMemberText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.story,r=n.details.action,i=this.props.repo,s=t(o.get(i,"details.title"))||o.get(i,"name"),c=o.get(i,"details.web_url");return a.createElement("div",{className:"text member"},a.createElement("p",null,a.createElement("a",{href:c,target:"_blank"},e("story-member-"+r+"-$repo",s))))},renderIssueText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,r=this.props.locale.name,s=this.props.story,c=s.details.number,l=s.details.title,u=this.props.repo,p=o.first(this.props.authors),d=p?r(p.details.name,p.details.gender):"",h=o.get(u,"details.web_url"),m=i(this.props.story,u);return h&&m&&(e=h+"/issues/"+m.issue.id),a.createElement("div",{className:"text issue"},a.createElement("p",null,a.createElement("a",{href:e,target:"_blank"},t("story-issue-$user-opened-$number-$title",d,c,n(l)))),this.renderStatus(),this.renderTags())},renderMilestoneText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,s=this.props.story,c=s.details.title,l=r(s.details.due_date),u=r(s.details.start_date)||"-",p=this.props.repo,d=o.get(p,"details.web_url"),h=i(this.props.story,p);return d&&h&&(e=d+"/milestones/"+h.milestone.id),a.createElement("div",{className:"text milestone"},a.createElement("p",null,a.createElement("a",{href:e,target:"_blank"},t("story-milestone-created-$name",n(c)))),a.createElement("p",{className:"start-date"},a.createElement("span",null,t("story-milestone-start-date"))," ",a.createElement("span",null,u)),a.createElement("p",{className:"due-date"},a.createElement("span",{className:"label"},t("story-milestone-due-date"))," ",a.createElement("span",null,l)))},renderMergeRequestText:function(){var e,t=this.props.locale.translate,n=(this.props.locale.pick,this.props.story),r=o.get(n,"details.source_branch"),s=o.get(n,"details.branch"),c=this.props.repo,l=o.get(c,"details.web_url"),u=i(this.props.story,c);return l&&u&&(e=l+"/merge_requests/"+u.merge_request.id),a.createElement("div",{className:"text merge-request"},a.createElement("p",null,a.createElement("a",{href:e,target:"_blank"},t("story-merge-request-$branch1-into-$branch2",r,s))),this.renderStatus(),this.renderTags())},renderWikiText:function(){var e=this.props.locale.translate,t=this.props.story,n=t.details.url,r=o.capitalize(t.details.title),i=t.details.action+"d";return"deleted"===i&&(n=void 0),a.createElement("div",{className:"text wiki"},a.createElement("p",null,a.createElement("a",{href:n,target:"_blank"},e("story-wiki-"+i+"-page-with-$title",r))))},renderPushText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,r=this.props.story,i=o.get(this.props.story,"details.files"),s=o.get(this.props.story,"details.lines"),c=(o.get(this.props.story,"details.commit_ids.length"),this.props.repo),l=n(o.get(c,"details.title"))||o.get(c,"name"),u=r.details.branch,p=["added","deleted","modified","renamed"],d=o.transform(p,function(e,n,r){var s=i[n];s>0&&e.push(a.createElement("li",{key:r,className:n},t("story-push-"+n+"-$count-files",s)))},[]),h=["added","deleted"],m=o.transform(h,function(e,n,r){var i=s[n];i>0&&e.push(a.createElement("li",{key:r,className:n},t("story-push-"+n+"-$count-lines",i)))},[]),f=o.get(c,"details.web_url");if(f)if("push"===r.type||"merge"===r.type){var g=r.details.commit_before,v=r.details.commit_after;e=g?f+"/compare/"+g+"..."+v:f+"/commit/"+v}else"branch"===r.type&&(e=f+"/commits/"+u);var y;if("push"===r.type)y=t("story-push-pushed-to-$branch-of-$repo",u,l);else if("merge"===r.type){var b=r.details.source_branches;y=t("story-push-merged-$branches-into-$branch-of-$repo",b,u,l)}else"branch"===r.type&&(y=t("story-push-created-$branch-in-$repo",u,l));return a.createElement("div",{className:"text push"},a.createElement("p",null,a.createElement("a",{href:e,target:"_blank"},y)),a.createElement("div",null,a.createElement("ul",{className:"files"},d),a.createElement("ul",{className:"lines"},m)))},renderStatus:function(){var e=this.props.locale.translate,t=this.props.story.details.state;return a.createElement("p",{className:"status-"+t},a.createElement("span",null,e("story-issue-current-status"))," ",a.createElement("span",null,e("story-issue-status-"+t)))},renderTags:function(){var e=this.props.story.details.labels;if(o.isEmpty(e))return null;for(var t=this.props.repo,n=o.map(e,function(e,n){var r;if(t){var i=o.indexOf(t.details.labels,e),s=o.get(t.details.label_colors,i);s&&(r={backgroundColor:s})}return a.createElement("span",{key:n,className:"tag",style:r},e)}),r=1;r<n.length;r+=2)n.splice(r,0," ");return a.createElement("p",null,n)},renderButtons:function(){if("survey"!==this.props.story.type)return null;if(!1!==this.hasUserVoted())return null;var e=this.props.locale.translate,t={label:e("story-vote-submit"),emphasized:!o.isEmpty(this.state.userAnswers),disabled:this.state.voteSubmitted||o.isEmpty(this.state.userAnswers),onClick:this.handleVoteSubmitClick};return a.createElement("div",{className:"buttons"},a.createElement(U,t))},renderMedia:function(){var e=o.get(this.props.story,"details.resources");if(o.isEmpty(this.resourcesReferenced)||(e=o.difference(e,o.values(this.resourcesReferenced))),o.isEmpty(e))return null;var t={locale:this.props.locale,theme:this.props.theme,resources:e};return a.createElement(w,t)},renderReferencedMediaDialog:function(){if(!this.state.renderingReferencedMediaDialog)return null;var e=this.resourcesReferenced[this.state.selectedResourceUrl],t=_(this.resourcesReferenced),n=o.indexOf(t,e);if(-1===n)return null;var r={show:this.state.showingReferencedMediaDialog,resources:t,selectedIndex:n,locale:this.props.locale,theme:this.props.theme,onClose:this.handleReferencedMediaDialogClose};return a.createElement(C,r)},renderAppComponents:function(){var e=this.props.locale.translate,t=o.get(this.props.story,"details.components");return o.isEmpty(t)?null:a.createElement("div",{className:"impact"},a.createElement("p",{className:"message"},e("story-push-components-changed")),a.createElement(N,null,o.map(t,this.renderAppComponent)),this.renderAppComponentDialog())},renderAppComponent:function(e,t){var n={component:e,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleComponentSelect};return a.createElement(S,s({key:t},n))},renderAppComponentDialog:function(){if(!this.state.renderingComponentDialog)return null;var e={show:this.state.showingComponentDialog,component:this.state.selectedComponent,locale:this.props.locale,theme:this.props.theme,onClose:this.handleComponentDialogClose};return a.createElement(R,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e})},triggerReactionEvent:function(e){this.props.onReaction&&this.props.onReaction({type:"reaction",target:this,reaction:e})},handleReference:function(e){var t=this.props.story.details.resources,n=d.findReferencedResource(t,e.name);if(n){var r,i=this.props.theme;if(e.forImage){if(!(r=i.getImageUrl(n,{height:24}))){var s=i.getImageFile(n);r=d.createBlobUrl(s,n.clip)}}else r=i.getUrl(n);return this.resourcesReferenced[r]=n,{href:r,title:void 0}}},handleMarkdownClick:function(e){var t=e.target;if("IMG"===t.tagName){var n=t.getAttribute("src"),r=this.resourcesReferenced[n];if(r)"image"===r.type||"video"===r.type?this.setState({selectedResourceUrl:n,renderingReferencedMediaDialog:!0,showingReferencedMediaDialog:!0}):"website"===r.type?window.open(r.url):r.type;else{var i=t.getBoundingClientRect(),s=t.naturalWidth+50,o=t.naturalHeight+50,a=i.left+window.screenLeft,c=i.top+window.screenTop;window.open(t.src,"_blank","width="+s+",height="+o+",left="+a+",top="+c+"status=no,menubar=no")}}},handleTaskListItemChange:function(e){var t=e.currentTarget,n=t.name,r=t.value,i=t.checked;if(!this.isCurrentUserAuthor())return!1;var s=o.decoupleSet(this.state.userAnswers,[n,r],i);this.setState({userAnswers:s});var a=this.props.story,c=o.mapValues(a.details.text,function(e){return p.update(e,n,r,i,!1)});a=o.decoupleSet(a,"details.text",c),this.triggerChangeEvent(a)},handleSurveyItemChange:function(e){var t=e.currentTarget,n=t.name,r=t.value,i=o.decoupleSet(this.state.userAnswers,[n],r);this.setState({userAnswers:i})},handleVoteSubmitClick:function(e){var t=this.props.story,n={type:"vote",story_id:t.id,user_id:this.props.currentUser.id,published:!0,details:{answers:this.state.userAnswers}};this.triggerReactionEvent(n),this.setState({voteSubmitted:!0})},handleComponentSelect:function(e){this.setState({renderingComponentDialog:!0,showingComponentDialog:!0,selectedComponent:e.component})},handleComponentDialogClose:function(e){var t=this;this.setState({showingComponentDialog:!1},function(){setTimeout(function(){t.state.showingComponentDialog||t.setState({renderingComponentDialog:!1,selectedComponent:null})},500)})},handleReferencedMediaDialogClose:function(e){var t=this;this.setState({showingReferencedMediaDialog:!1},function(){setTimeout(function(){t.state.showingReferencedMediaDialog||t.setState({renderingReferencedMediaDialog:!1,selectedResourceUrl:null})},500)})}});var P=u(function(e){var t={};return o.each(e,function(e){"vote"===e.type&&o.forIn(e.details.answers,function(e,n){var r=[n,"total"],i=o.get(t,r,0)+1;o.set(t,r,i);var s=[n,"answers",e],a=o.get(t,s,0)+1;o.set(t,s,a)})}),t}),T=u(function(e,t){return t?o.find(e,{type:"vote",user_id:t.id}):null}),_=u(function(e){return o.filter(e,function(e){switch(e.type){case"image":case"video":return!0}})})},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(16),a=n(149),c=n(6),l=n(7),u=n(4),p=n(5),d=n(37),h=n(34),m=n(28),f=n(83);n(626),e.exports=i.createClass({displayName:"StoryViewOptions",propTypes:{inMenu:s.bool,section:s.oneOf(["main","supplemental","both"]),access:s.oneOf(["read-only","read-comment","read-write"]).isRequired,story:s.object.isRequired,repos:s.arrayOf(s.object),currentUser:s.object.isRequired,options:s.object.isRequired,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(p).isRequired,onChange:s.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{selectingRecipients:!1,renderingDialogBox:!1}},canWrite:function(){return"read-write"===this.props.access},canComment:function(){var e=this.props.access;return"read-comment"===e||"read-write"===e},canHideStory:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;if("guest"!==t.type){if("admin"===t.type)return!0;if(r.includes(e.user_ids,t.id))return!0}return!1},canEditStory:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;return!!(r.includes(a.editable,e.type)&&r.includes(e.user_ids,t.id)&&o()<o(e.ptime).add(3,"day"))},canRemoveStory:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;return!!(r.includes(e.user_ids,t.id)&&o()<o(e.ptime).add(3,"day"))||"admin"===t.type},canBumpStory:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;return!(!r.includes(e.user_ids,t.id)&&"admin"!==t.type||!(o()>o(e.btime||e.ptime).add(1,"day")))},canAddIssue:function(){if(!this.canWrite())return!1;var e=this.props.story,t=this.props.currentUser;return!!r.includes(a.trackable,e.type)&&r.some(this.props.repos,function(e){if(r.includes(e.user_ids,t.id)&&e.details.issues_enabled)return!0})},canSendBookmarks:function(){return!!this.canWrite()},render:function(){if(this.props.inMenu)return i.createElement("div",{className:"view-options in-menu"},this.renderButtons(this.props.section));var e=this.props.locale.translate;return i.createElement(d,{className:"view-options"},i.createElement("header",null,i.createElement(h,{icon:"chevron-circle-right",label:e("story-options"),disabled:!0})),i.createElement("body",null,this.renderButtons("main")))},renderButtons:function(e){var t=this.props.locale.translate,n=this.props.options;if("main"===e){var s=this.props.currentUser.id,o=r.includes(n.bookmarkRecipients,s),a=r.without(n.bookmarkRecipients,s),c={label:t("option-bookmark-story"),selected:o,onClick:this.handleBookmarkClick},l={label:r.isEmpty(a)?t("option-send-bookmarks"):t("option-send-bookmarks-to-$count-users",r.size(a)),hidden:!this.canSendBookmarks(),selected:!r.isEmpty(a),onClick:this.handleSendBookmarkClick},u={label:t("option-add-issue"),hidden:!this.canAddIssue(),selected:n.addIssue,onClick:this.handleAddIssueClick},p={label:t("option-hide-post"),hidden:!this.canHideStory(),selected:n.hidePost,onClick:this.handleHideClick},d={label:t("option-edit-post"),hidden:!this.canEditStory(),selected:n.editPost,onClick:this.handleEditClick},h={label:t("option-remove-post"),hidden:!this.canRemoveStory(),selected:n.removePost,onClick:this.handleRemoveClick},f={label:t("option-bump-post"),hidden:!this.canBumpStory(),selected:n.bumpPost,onClick:this.handleBumpClick};return i.createElement("div",{className:e},i.createElement(m,c),i.createElement(m,l),i.createElement(m,u),i.createElement(m,p),i.createElement(m,d),i.createElement(m,h),i.createElement(m,f),this.renderUserSelectionDialogBox())}},renderUserSelectionDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e={show:this.state.selectingRecipients,selection:this.props.options.bookmarkRecipients,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleRecipientsSelect,onCancel:this.handleRecipientsCancel};return i.createElement(f,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,options:e})},openSelectionDialogBox:function(e){this.state.selectingRecipients||(this.setState({selectingRecipients:!0,renderingDialogBox:!0}),e.stopPropagation(),this.sendBookmakTarget=e.target)},closeSelectionDialogBox:function(){var e=this;this.state.selectingRecipients&&(this.setState({selectingRecipients:!1}),setTimeout(function(){e.state.selectingRecipients||e.setState({renderingDialogBox:!1})},1e3),this.sendBookmakTarget&&(this.sendBookmakTarget.click(),this.sendBookmakTarget=null))},handleBookmarkClick:function(e){var t=r.clone(this.props.options),n=this.props.currentUser.id;r.includes(t.bookmarkRecipients,n)?t.bookmarkRecipients=r.difference(t.bookmarkRecipients,[n]):t.bookmarkRecipients=r.union(t.bookmarkRecipients,[n]),this.triggerChangeEvent(t)},handleSendBookmarkClick:function(e){this.openSelectionDialogBox(e)},handleAddIssueClick:function(e){var t=r.clone(this.props.options);t.addIssue=!t.addIssue,this.triggerChangeEvent(t)},handleHideClick:function(e){var t=r.clone(this.props.options);t.hidePost=!t.hidePost,this.triggerChangeEvent(t)},handleEditClick:function(e){var t=r.clone(this.props.options);t.editPost=!0,this.triggerChangeEvent(t)},handleRemoveClick:function(e){var t=r.clone(this.props.options);t.removePost=!0,this.triggerChangeEvent(t)},handleBumpClick:function(e){var t=r.clone(this.props.options);t.bumpPost=!0,this.triggerChangeEvent(t)},handleRecipientsSelect:function(e){var t=r.clone(this.props.options);t.bookmarkRecipients=e.selection,this.triggerChangeEvent(t),this.closeSelectionDialogBox()},handleRecipientsCancel:function(e){this.closeSelectionDialogBox()}})},function(e,t,n){"use strict";function r(e){return o.createElement("div",{className:"item"},o.createElement("svg",{className:"ct-chart-bar",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg"},o.createElement("g",{className:"ct-series ct-series-"+e.series},o.createElement("line",{className:"ct-bar",x1:0,y1:5,x2:10,y2:5}))),o.createElement("span",{className:"label"},e.label))}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(3),o=n(0),a=o.PropTypes,c=n(291),l=n(16),u=n(151),p=n(19),d=n(6),h=n(7),m=n(4),f=n(5),g=n(94),v=n(34);n(628),e.exports=o.createClass({displayName:"UserStatistics",propTypes:{user:a.object,dailyActivities:a.object,database:a.instanceOf(d).isRequired,route:a.instanceOf(h).isRequired,locale:a.instanceOf(m).isRequired,theme:a.instanceOf(f).isRequired},getInitialState:function(){if(this.props.user){var e=y[this.props.user.id];if(e)return e}return{chartType:"bar",showingContents:!1}},isShowingContents:function(){return!(!this.state.showingContents&&"columns-1"===this.props.theme.mode)},render:function(){return o.createElement(g,{className:"statistics"},o.createElement("header",null,this.renderButtons()),o.createElement("body",null,this.renderLegend(),this.renderChart()))},renderButtons:function(){var e=this.props.locale.translate,t=this.isShowingContents(),n={label:e("statistics-bar"),icon:"bar-chart",highlighted:t&&"bar"===this.state.chartType,onClick:this.handleBarChartClick},r={label:e("statistics-line"),icon:"line-chart",highlighted:t&&"line"===this.state.chartType,onClick:this.handleLineChartClick},i={label:e("statistics-pie"),icon:"pie-chart",highlighted:t&&"pie"===this.state.chartType,onClick:this.handlePieChartClick};return o.createElement("div",null,o.createElement(v,n),o.createElement(v,r),o.createElement(v,i))},renderLegend:function(){if(!this.isShowingContents())return null;var e=this.props.locale.translate,t=s.get(this.props.dailyActivities,"details",{}),n=b(u.today,14),a=x(t,n),c=s.map(a,function(t,n){var s={series:String.fromCharCode("a".charCodeAt(0)+t),label:e("user-statistics-legend-"+n)};return o.createElement(r,i({key:t},s))});return s.isEmpty(c)&&(c=" "),o.createElement("div",{className:"legend"},c)},renderChart:function(){if(!this.isShowingContents())return null;switch(this.state.chartType){case"bar":return this.renderBarChart();case"line":return this.renderLineChart();case"pie":return this.renderPieChart()}},renderBarChart:function(){var e=s.get(this.props.dailyActivities,"details",{}),t=b(u.today,14),n=w(e,t),r=C(n,!0),i=E(t,this.props.locale.languageCode),a={type:"bar",data:{labels:i,series:n},options:{stackBars:!0,axisY:{labelInterpolationFnc:function(e){return e}},high:r,low:0}};return o.createElement(c,a)},renderLineChart:function(){var e=s.get(this.props.dailyActivities,"details",{}),t=b(u.today,14),n=w(e,t),r=C(n,!1),i=E(t,this.props.locale.languageCode),a={type:"line",data:{labels:i,series:n},options:{fullWidth:!0,chartPadding:{right:10},showPoint:!1,high:r,low:0}};return o.createElement(c,a)},renderPieChart:function(){var e=s.get(this.props.dailyActivities,"details",{}),t=b(u.today,14),n=w(e,t),r=s.map(n,s.sum),i={type:"pie",data:{series:r},options:{labelInterpolationFnc:function(e){if(e)return e}}};return o.createElement(c,i)},componentDidMount:function(){u.addEventListener("change",this.handleDateChange)},componentWillUnmount:function(){u.removeEventListener("change",this.handleDateChange),this.props.user&&(y[this.props.user.id]=this.state)},handleBarChartClick:function(e){var t=!0;"columns-1"===this.props.theme.mode&&"bar"===this.state.chartType&&(t=!this.state.showingContents),this.setState({chartType:"bar",showingContents:t})},handleLineChartClick:function(e){var t=!0;"columns-1"===this.props.theme.mode&&"line"===this.state.chartType&&(t=!this.state.showingContents),this.setState({chartType:"line",showingContents:t})},handlePieChartClick:function(e){var t=!0;"columns-1"===this.props.theme.mode&&"pie"===this.state.chartType&&(t=!this.state.showingContents),this.setState({chartType:"pie",showingContents:t})},handleDateChange:function(e){this.forceUpdate()}});var y={},b=function(e,t){var n=l(e),r=s.times(t,function(){var e=n.format("YYYY-MM-DD");return n.subtract(1,"day"),e});return s.reverse(r)},k=["push","merge","issue","wiki","milestone","story","survey","task-list"],x=p(function(e,t){var n={};s.each(t,function(t){var r=e[t];s.forIn(r,function(e,t){e&&(n[t]=!0)})});var r={};return s.each(k,function(e,t){n[e]&&(r[e]=t)}),r}),w=p(function(e,t){return s.map(k,function(n){var r=!0,i=s.map(t,function(t){var i=s.get(e,[t,n],0);return i&&(r=!1),i});return r?[]:i})}),C=p(function(e,t){var n=0;if(t){var r=[];s.each(e,function(e){s.each(e,function(e,t){r[t]=r[t]?r[t]+e:e})}),s.isEmpty(r)||(n=s.max(r))}else s.each(e,function(e){var t=s.max(e);t>n&&(n=t)});return n<=20?20:n<=50?50:100*Math.ceil(n/100)}),E=p(function(e,t){return s.map(e,function(e){return l(e).format("dd")})})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(7),a=n(4),c=n(5),l=n(10),u=n(94),p=n(29),d=n(58),h=n(91);n(629),e.exports=r.createClass({displayName:"UserSummary",mixins:[l],propTypes:{user:i.object,roles:i.arrayOf(i.object),stories:i.arrayOf(i.object),cornerPopUp:i.element,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},getUrl:function(e){var t=this.props.route.parameters;return this.props.route.find(n(43),{schema:t.schema,user:this.props.user.id,story:e?e.id:0})},render:function(){return r.createElement(u,{className:"summary"},r.createElement("header",null,this.renderProfileImage(),this.renderRoles(),this.props.cornerPopUp),r.createElement("subheader",null,this.renderName(),this.renderTag()),r.createElement("body",null,this.renderRecentActivities()),r.createElement("footer",null,this.renderMoreLink()))},renderProfileImage:function(){var e={user:this.props.user,theme:this.props.theme,size:"large"};return r.createElement(p,e)},renderRoles:function(){var e=this.props.locale.pick,t=_.map(this.props.roles,function(t){return e(t.details.title)||t.name});return r.createElement("span",{className:"roles"},t.join(", ")||" ")},renderName:function(){var e=this.props.user,t=this.props.locale.pick,n=e?t(e.details.name):" ";return r.createElement("h2",{className:"name"},n)},renderTag:function(){var e=(this.props.locale.translate,this.props.user),t=e?"@"+e.username:" ";return r.createElement("h3",{className:"tag",ref:"tag",onClick:this.handleTagClick},t)},renderRecentActivities:function(){var e=_.slice(this.props.stories).reverse();return e=_.slice(e,0,5),r.createElement("div",null,_.map(e,this.renderActivity))},renderActivity:function(e){var t,n=this.props.locale.translate,i=this.props.locale.name,s=this.props.user,o=i(_.get(s,"details.name"),_.get(s,"details.gender"));switch(e.type){case"push":t=n("user-summary-$name-pushed-code",o);break;case"merge":t=n("user-summary-$name-merged-code",o);break;case"issue":t=n("user-summary-$name-opened-an-issue",o);break;case"milestone":t=n("user-summary-$name-created-a-milestone",o);break;case"wiki":t=n("user-summary-$name-edited-wiki-page",o);break;case"member":case"repo":t=n("user-summary-$name-"+e.details.action+"-repo",o);break;case"story":var a=e.details.resources;t=_.some(a,{type:"image"})?n("user-summary-$name-posted-a-picture",o):_.some(a,{type:"video"})?n("user-summary-$name-posted-a-video-clip",o):_.some(a,{type:"audio"})?n("user-summary-$name-posted-an-audio-clip",o):_.some(a,{type:"website"})?n("user-summary-$name-posted-a-link",o):n("user-summary-$name-wrote-a-post",o);break;case"survey":t=n("user-summary-$name-started-survey",o);break;case"task-list":t=n("user-summary-$name-started-task-list",o)}var c=this.getUrl(e);return r.createElement("div",{className:"activity",key:e.id},r.createElement(h,{url:c},t),r.createElement(d,{time:e.ptime,locale:this.props.locale}))},renderMoreLink:function(){if(_.isEmpty(this.props.stories))return null;var e=this.props.locale.translate,t=this.getUrl();return r.createElement(h,{url:t},e("user-summary-more"))},handleTagClick:function(e){var t=document.createRange();t.selectNode(this.refs.tag),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)}})},function(e,t,n){"use strict";var r=n(0),i=r.PropTypes,s=n(6),o=n(7),a=n(4),c=n(5),l=n(94),u=n(34),p=n(28);n(231);n(630),e.exports=r.createClass({displayName:"UserViewOptions",propTypes:{inMenu:i.bool,section:i.oneOf(["main","supplemental","both"]),user:i.object,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onChange:i.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{showingPhoneDialog:!1,renderingPhoneDialog:!1}},render:function(){if(this.props.inMenu)return r.createElement("div",{className:"view-options in-menu"},this.renderButtons(this.props.section),this.renderPhoneDialog());var e=this.props.locale.translate;return r.createElement(l,{className:"view-options"},r.createElement("header",null,r.createElement(u,{icon:"chevron-circle-right",label:e("user-actions"),disabled:!0})),r.createElement("body",null,this.renderButtons("main"),this.renderPhoneDialog()))},renderButtons:function(e){var t=this.props.locale.translate,n=_.get(this.props.user,"details",{});if("main"===e){var i={label:t("action-contact-by-phone"),icon:"phone-square",url:"tel:"+n.phone,hidden:!n.phone,onClick:this.handlePhoneClick},s={label:t("action-contact-by-email"),icon:"envelope",url:"mailto:"+n.email,hidden:!n.email},o={label:t("action-contact-by-skype"),icon:"skype",url:"skype:"+n.skype_username,hidden:!n.phone},a={label:t("action-contact-by-slack"),icon:"slack",url:"slack://user?team="+n.slack_team_id+"&id="+n.slack_user_id,hidden:!n.slack_user_id},c={label:t("action-contact-by-ichat"),icon:"apple",url:"ichat:"+n.ichat_username,hidden:!n.ichat_username},l={label:t("action-contact-by-twitter"),icon:"apple",url:"https://twitter.com/"+n.twitter_username,target:"_blank",hidden:!n.twitter_username},u={label:t("action-view-gitlab-page"),icon:"gitlab",url:n.gitlab_url,target:"_blank",hidden:!n.gitlab_url},d={label:t("action-view-github-page"),icon:"github",url:n.github_url,target:"_blank",hidden:!n.linkedin_username},h={label:t("action-view-linkedin-page"),icon:"linkedin",url:n.linkedin_url,target:"_blank",hidden:!n.linkedin_url},m={label:t("action-view-stackoverflow-page"),icon:"stack-overflow",url:n.stackoverflow_url,target:"_blank",hidden:!n.stackoverflow_url};return r.createElement("div",{className:e},r.createElement(p,i),r.createElement(p,s),r.createElement(p,o),r.createElement(p,a),r.createElement(p,c),r.createElement(p,l),r.createElement(p,u),r.createElement(p,d),r.createElement(p,h),r.createElement(p,m))}},renderPhoneDialog:function(){return},handlePhoneClick:function(e){},handlePhoneDialogClose:function(e){}})},function(e,t,n){"use strict";function r(e){var t=["button"];return e.className&&t.push(e.className),e.active&&t.push("active"),i.createElement(v,{className:t.join(" "),url:e.url},i.createElement("i",{className:"fa fa-"+e.icon})," ",i.createElement("span",{className:"label"},e.label),e.children)}var i=n(0),s=i.PropTypes,o=n(15),a=n(6),c=n(7),l=n(4),u=n(5),p=n(53),d=n(137),h=n(86),m=n(85),f=n(87),g=n(10),v=n(91);n(632),e.exports=i.createClass({displayName:"BottomNavigation",mixins:[g],propTypes:{hidden:s.bool,database:s.instanceOf(a).isRequired,route:s.instanceOf(c).isRequired,locale:s.instanceOf(l).isRequired,theme:s.instanceOf(u).isRequired},getInitialState:function(){return{height:this.props.hidden?0:"auto"}},componentWillReceiveProps:function(e){var t=this;if(this.props.hidden!==e.hidden){var n=this.refs.container,r=n.offsetHeight;e.hidden?(this.setState({height:r}),setTimeout(function(){t.props.hidden&&t.setState({height:0})},0)):(this.setState({height:r}),setTimeout(function(){t.props.hidden||t.setState({height:"auto"})},1e3))}},render:function(){var e={height:this.state.height};return i.createElement("footer",{className:"bottom-navigation",style:e},this.renderButtons())},renderButtons:function(){var e=this.props.locale.translate,t=this.props.route,n=_.pick(t.parameters,"schema"),s=t.component.getOptions(t),o=_.get(s,"navigation.bottom.section"),a={label:e("bottom-nav-news"),icon:"newspaper-o",active:"news"===o,url:t.find(p,n),onClick:this.handleButtonClick},c={label:e("bottom-nav-notifications"),icon:"comments",active:"notifications"===o,url:t.find(h,n),onClick:this.handleButtonClick},l={label:e("bottom-nav-bookmarks"),icon:"bookmark",active:"bookmarks"===o,url:t.find(m,n),onClick:this.handleButtonClick},u={label:e("bottom-nav-people"),icon:"users",active:"people"===o,url:t.find(d,n),onClick:this.handleButtonClick},g={label:e("bottom-nav-settings"),icon:"gears",active:"settings"===o,url:t.find(f,n),onClick:this.handleButtonClick},v={database:this.props.database,route:this.props.route};return i.createElement("div",{ref:"container",className:"container"},i.createElement(r,a),i.createElement(r,c,i.createElement(y,v)),i.createElement(r,l),i.createElement(r,u),i.createElement(r,g))}});var y=o.createClass({displayName:"NewNotificationsBadge",propTypes:{database:s.instanceOf(a).isRequired,route:s.instanceOf(c).isRequired},renderAsync:function(e){var t=this,n=this.props.route.parameters;if(!n.schema)return null;var r=this.props.database.use({schema:n.schema,by:this});this.props.database,this.props.route,this.props.locale,this.props.theme;return r.start().then(function(e){var t={target_user_id:e,seen:!1,limit:100};return r.find({table:"notification",criteria:t})}).then(function(e){var n=e.length;return t.changeFavIcon(n),n?i.createElement("span",{className:"badge"},i.createElement("span",{className:"number"},n)):null})},changeFavIcon:function(e){var t=_.filter(document.head.getElementsByTagName("LINK"),function(e){if("icon"===e.rel||"apple-touch-icon-precomposed"===e.rel)return!0});_.each(t,function(t){var n=t.getAttribute("href");if(e>0){var r=_.find(k,{withoutBadge:n});r&&(t.href=r.withBadge)}else{var r=_.find(k,{withBadge:n});r&&(t.href=r.withoutBadge)}})}}),b=n(224).keys(),k=_.map(b,function(e){var t=e.substring(e.indexOf("/")+1,e.lastIndexOf("."));return{withoutBadge:n(223)("./"+t+".png"),withBadge:n(225)("./"+t+".png")}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0),o=s.PropTypes,a=n(15),c=n(16),l=n(6),u=n(7),p=n(4),d=n(53),h=n(86),m=n(43),f=n(10),g=n(266);n(633),e.exports=a.createClass({displayName:"CalendarBar",propTypes:{database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired},renderAsync:function(e){var t,n=this.props.route.component,r=this.props.route.parameters,o=this.props.database.use({schema:r.schema,by:this}),a={projectRange:null,dailyActivities:null,route:this.props.route,locale:this.props.locale};return e.show(s.createElement(v,a),1e3),o.start().then(function(e){var n={type:"story-date-range",filters:{}};return t=e,o.findOne({table:"statistics",criteria:n})}).then(function(t){return a.projectRange=t,e.show(s.createElement(v,a))}).then(function(){var e=i.get(a.projectRange,"details.start_time"),r=i.get(a.projectRange,"details.end_time");if(e&&r){for(var s=c(e).startOf("month"),l=c(r).endOf("month"),u=[],p=s.clone();p<=l;p.add(1,"month")){var f=p.toISOString(),g=p.clone().endOf("month").toISOString(),v="["+f+","+g+"]";u.push(v)}var y={};if(n===d){var b=s.utcOffset();y.type="daily-activities",y.filters=i.map(u,function(e){return{time_range:e,tz_offset:b}})}else if(n===h)y.type="daily-notifications",y.filters=i.map(u,function(e){return{target_user_id:t,time_range:e}});else if(n===m){var k=parseInt(route.parameters.userId);y.type="daily-activities",y.filters=i.map(u,function(e){return{user_ids:[k],time_range:e}})}return o.find({table:"statistics",criteria:y})}}).then(function(e){return a.dailyActivities=e,s.createElement(v,a)})}});var v=e.exports.Sync=s.createClass({displayName:"CalendarBar.Sync",mixins:[f],propTypes:{projectRange:o.object,dailyActivities:o.arrayOf(o.object),route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired},render:function(){var e=this,t=c().endOf("month"),n=[],o=!1,a=i.get(this.props.projectRange,"details.start_time"),l=i.get(this.props.projectRange,"details.end_time"),u=this.props.route.parameters.date;if(a&&l){var p=c(a).startOf("month"),d=c(l).endOf("month");p.year()!=d.year()&&(o=!0),t>d&&(d=t);for(var h=p.clone();h<=d;h.add(1,"month"))n.push({year:h.year(),month:h.month()+1})}else n.push({year:t.year(),month:t.month()+1});n.reverse();var m=i.map(n,function(t,n){var i={year:t.year,month:t.month,showYear:o,selection:u,locale:e.props.locale,onDateUrl:e.handleDateUrl};return s.createElement(g,r({key:n},i))});return s.createElement("div",{className:"calendar-bar"},m)},handleDateUrl:function(e){var t=e.date;if(i.some(this.props.dailyActivities,function(e){if(e.details[t])return!0})){var n=this.props.route,r=i.omit(n.parameters,"date","roles","search","story");return r.date=t,n.find(n.component,r)}}})},function(e,t,n){"use strict";function r(e,t,n){return e+"-"+i(t)+"-"+i(n)}function i(e){var t=String(e);return 1===t.length&&(t="0"+t),t}var s=n(0),o=s.PropTypes,a=n(16),c=n(151),l=n(4);n(634),e.exports=s.createClass({displayName:"Calendar",propTypes:{year:o.number.isRequired,month:o.number.isRequired,showYear:o.bool,selection:o.string,locale:o.instanceOf(l).isRequired,onDateUrl:o.func},getDefaultProps:function(){return{showYear:!1}},render:function(){var e=this,t=a.localeData(this.props.locale.languageCode),n=this.props.year,o=this.props.month,l=this.props.selection,u=a(r(n,o,1)),p=t.firstDayOfWeek(),d=u.daysInMonth(),h=u.day(),m=[[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null]],f=0,g=h-p;g<0&&(g+=7);for(var v=1;v<=d;v++)m[f][g++]=v,g>=7&&(g=0,f++);for(var y=t.weekdaysShort(),b=[!0,!1,!1,!1,!1,!1,!0],k=0;k<p;k++)y.push(y.shift()),b.push(b.shift());var x=this.props.showYear?"MMMM YYYY":"MMMM",w=u.format(x),C=_.map(y,function(e,t){var n=[b[t]?"weekend":"workweek"];return s.createElement("th",{className:n.join(" "),key:t},e)}),E=_.map(m,function(t){return _.map(t,function(t,r){var a,u,p,d=[b[r]?"weekend":"workweek"];return t?(u=n+"-"+i(o)+"-"+i(t),a=t,p=e.getDateUrl(u)):a=" ",l&&l===u&&d.push("selected"),u===c.today&&d.push("today"),s.createElement("td",{key:r,className:d.join(" ")},s.createElement("a",{href:p},a))})});return s.createElement("table",{className:"calendar"},s.createElement("thead",null,s.createElement("tr",{className:"title"},s.createElement("th",{colSpan:7},w)),s.createElement("tr",{className:"headings"},C)),s.createElement("tbody",null,s.createElement("tr",{className:"dates"},E[0]),s.createElement("tr",{className:"dates"},E[1]),s.createElement("tr",{className:"dates"},E[2]),s.createElement("tr",{className:"dates"},E[3]),s.createElement("tr",{className:"dates"},E[4]),s.createElement("tr",{className:"dates"},E[5])))},getDateUrl:function(e){if(this.props.onDateUrl)return this.props.onDateUrl({type:"dateurl",target:this,date:e})}})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(3),s=n(0),o=s.PropTypes,a=n(15),c=(n(16),n(19)),l=n(6),u=n(7),p=n(4),d=n(5),h=(n(10),n(268));n(646),e.exports=a.createClass({displayName:"RoleFilterBar",propTypes:{database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired},renderAsync:function(e){var t=this.props.route.parameters,n=this.props.database.use({schema:t.schema,by:this}),r={roles:null,users:null,project:null,locale:this.props.locale,route:this.props.route,theme:this.props.theme};return e.show(s.createElement(m,r),1e3),n.start().then(function(e){var r={name:t.schema};return n.findOne({schema:"global",table:"project",criteria:r})}).then(function(e){r.project=e}).then(function(){var e={id:r.project.user_ids};return n.find({schema:"global",table:"user",criteria:e})}).then(function(e){r.users=e}).then(function(){var e=i.flatten(i.map(r.users,"role_ids")),t={id:i.uniq(e)};return n.find({schema:"global",table:"role",criteria:t})}).then(function(e){return r.roles=e,s.createElement(m,r)})}});var m=e.exports.Sync=s.createClass({displayName:"RoleFilterBar.Sync",propTypes:{project:o.object,roles:o.arrayOf(o.object),users:o.arrayOf(o.object),route:o.instanceOf(u).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(d).isRequired},getRoleIds:function(){var e=this.props.route,t=i.map(i.split(e.parameters.roles,"+"),Number);return i.filter(t)},render:function(){return s.createElement("div",{className:"role-filter-bar"},this.renderButtons())},renderButtons:function(){var e=this.props.roles;if(i.isEmpty(e)){var t={role:null!==e?null:void 0,locale:this.props.locale,theme:this.props.theme};return s.createElement(h,t)}return i.map(e,this.renderButton)},renderButton:function(e){var t=this.getRoleIds(),n=f(this.props.users,e),o={role:e,users:n,locale:this.props.locale,theme:this.props.theme,selected:i.includes(t,e.id),onRoleClick:this.handleRoleClick};return s.createElement(h,r({key:e.id},o))},handleRoleClick:function(e){var t=e.role,n=this.getRoleIds();i.includes(n,t.id)?i.pull(n,t.id):n.push(t.id);var r=this.props.route,s=i.clone(r.parameters);s.roles=n,r.replace(r.component,s)}}),f=c(function(e,t){return i.filter(e,function(e){return i.includes(e.role_ids,t.id)})})},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=n(4),a=n(5),c=n(29);n(647),e.exports=i.createClass({displayName:"RoleFilterButton",propTypes:{role:s.object,users:s.arrayOf(s.object),selected:s.bool,locale:s.instanceOf(o).isRequired,theme:s.instanceOf(a).isRequired,onRoleClick:s.func},render:function(){var e="role-filter-button";return this.props.selected&&(e+=" selected"),this.props.role||(e+=" no-roles"),i.createElement("div",{className:e,onClick:this.handleClick},i.createElement("div",{className:"contents"},this.renderImageRow(0,4),this.renderImageRow(0,0),this.renderImageRow(4,4),this.renderTitle()))},renderImageRow:function(e,t){var n=r.filter(this.props.users,function(e){return r.some(e.details.resources,{type:"image"})});return n=r.slice(n,e,t),i.createElement("div",{className:"row"},r.map(n,this.renderProfileImage))},renderProfileImage:function(e,t){return i.createElement(c,{key:t,user:e,size:"medium",theme:this.props.theme})},renderTitle:function(){if(!this.props.role)return this.renderMessage();var e=this.props.locale.pick,t=this.props.role;return i.createElement("div",{className:"band"},i.createElement("div",{className:"title"},e(t.details.title)||t.name,this.renderUserCount()))},renderMessage:function(){if(void 0===this.props.role)return null;var e=this.props.locale.translate;return i.createElement("div",{className:"message"},e("role-filter-no-roles"))},renderUserCount:function(){if(!this.props.users)return null;var e=this.props.users.length;return i.createElement("div",{className:"user-count"},i.createElement("i",{className:"fa fa-male"}),i.createElement("span",{className:"number"},e))},handleClick:function(e){if(!this.props.role)return null;this.props.onRoleClick&&this.props.onRoleClick({type:"roleclick",target:this,role:this.props.role})}})},function(e,t,n){"use strict";function r(e){return e=i.replace(e,/\+/g,""),e=i.replace(e,/\s+/g," "),i.split(e).join(" ")}var i=n(3),s=n(0),o=s.PropTypes,a=n(7),c=n(4);n(10);n(649),e.exports=s.createClass({displayName:"SearchBar",propTypes:{route:o.instanceOf(a),locale:o.instanceOf(c)},getInitialState:function(){return{keywords:this.props.route.query.search||""}},componentWillReceiveProps:function(e){if(this.props.route!==e.route){var t=e.route,n=this.state.keyboards,s=t.query.search||"";i.isEqual(r(n),r(s))&&this.setState({keywords:s})}},render:function(){var e=this.props.locale.translate,t={type:"text",value:this.state.keywords,onChange:this.handleChange,onKeyDown:this.handleKeyDown};return s.createElement("div",{className:"search-bar"},s.createElement("label",null,e("search-bar-keywords")),s.createElement("input",t))},performSearch:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null);var e=this.props.route,t=i.clone(e.parameters);t.search=r(this.state.keywords),e.replace(e.component,t)},handleChange:function(e){var t=e.target.value;this.setState({keywords:t}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.performSearch,800)},handleKeyDown:function(e){13===e.keyCode&&this.performSearch()}})},function(e,t,n){"use strict";function r(e){var t=["button"],n=e.onClick;return e.className&&t.push(e.className),e.active&&t.push("active"),e.disabled&&(t.push("disabled"),n=null),s.createElement("div",{className:t.join(" "),onClick:n},s.createElement("i",{className:"fa fa-"+e.icon}))}var i=n(3),s=n(0),o=s.PropTypes,a=n(6),c=n(7),l=n(4),u=n(5),p=n(292),d=n(265),h=n(267),m=n(269);n(653),e.exports=s.createClass({displayName:"TopNavigation",propTypes:{hidden:o.bool,database:o.instanceOf(a).isRequired,route:o.instanceOf(c).isRequired,locale:o.instanceOf(l).isRequired,theme:o.instanceOf(u).isRequired},getInitialState:function(){var e=this.getRequiredControl(this.props.route);return{selectedControl:e,expanded:!!e,height:this.props.hidden?0:"auto"}},getRequiredControl:function(e){var t=e.parameters;return t.search?"search":t.date?"calendar":i.isEmpty(t.roles)?null:"filter"},componentWillReceiveProps:function(e){var t=this;if(this.props.hidden!==e.hidden){var n=this.refs.container,r=n.offsetHeight;e.hidden?(this.setState({height:r}),setTimeout(function(){t.props.hidden&&t.setState({height:0})},0)):(this.setState({height:r}),setTimeout(function(){t.props.hidden||t.setState({height:"auto"})},1e3))}if(this.props.route!==e.route){var i=this.getRequiredControl(e.route);this.state.selectedControl!==i&&this.setState({selectedControl:i,expanded:!0})}},render:function(){var e={height:this.state.height};return s.createElement("header",{className:"top-navigation",style:e},s.createElement("div",{ref:"container",className:"container"},this.renderSpacerBar(),this.renderButtonBar(),this.renderCollapsibleControl()))},renderSpacerBar:function(){return null},renderButtonBar:function(){var e=this.props.route.component.getOptions(),t=i.get(e,"navigation.top",{}),n=this.state.expanded?this.state.selectedControl:"",o={icon:"calendar",className:"calendar-btn",disabled:!t.dateSelection,active:"calendar"===n,onClick:this.handleCalendarClick},a={icon:"filter",className:"filter-btn",disabled:!t.roleSelection,active:"filter"===n,onClick:this.handleFilterClick},c={icon:"search",className:"search-btn",disabled:!t.textSearch,active:"search"===n,onClick:this.handleSearchClick};return s.createElement("div",null,s.createElement(r,o),s.createElement(r,a),s.createElement(r,c))},renderCollapsibleControl:function(){return s.createElement(p,{open:this.state.expanded},this.renderControl())},renderControl:function(){switch(this.state.selectedControl){case"calendar":return this.renderCalendarBar();case"filter":return this.renderRoleFilterBar();case"search":return this.renderSearchBar()}},renderCalendarBar:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,onSelect:this.handleCalendarSelect};return s.createElement(d,e)},renderRoleFilterBar:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(h,e)},renderSearchBar:function(){var e={route:this.props.route,locale:this.props.locale};return s.createElement(m,e)},toggleControl:function(e){var t=this;this.state.expanded&&e===this.state.selectedControl?this.setState({expanded:!1},function(){t.clearRouteParameters()}):this.setState({selectedControl:e,expanded:!0})},clearRouteParameters:function(){var e=this.props.route,t=i.omit(e.parameters,"date","roles","search","story");e.replace(e.component,t)},handleCalendarClick:function(e){this.toggleControl("calendar")},handleFilterClick:function(e){this.toggleControl("filter")},handleSearchClick:function(e){this.toggleControl("search")}})},function(e,t,n){"use strict";function r(e,t){return e+"/"+("0000000000"+t).slice(-10)}function i(e,t){return e+"/"+t}var s=n(3),o=n(9),a=n(0),c=a.PropTypes,l=n(66);e.exports=a.createClass({displayName:"IndexedDBCache",propTypes:{databaseName:c.string.isRequired},statics:{isAvailable:function(){return!!window.indexedDB}},getInitialState:function(){return{database:null}},find:function(e){return this.open().then(function(t){return new o(function(n,i){var o=e.address,a=e.schema,c=e.table,u="local"===a,p=u?"local-data":"remote-data",d=t.transaction(p,"readonly"),h=u?c:o+"/"+a+"/"+c,m=d.objectStore(p),f=[],g=e.criteria;if(g&&void 0!==g.id&&1===s.size(g)){var v=g.id;if(v instanceof Array)if(s.isEmpty(v))n(f);else{var y=s.max(v),b=s.min(v),k=r(h,y),x=r(h,b),w=IDBKeyRange.bound(x,k),C=m.openCursor(w);C.onsuccess=function(e){var t=e.target.result;if(t){var r=t.value,i=r.data;if(s.includes(v,i.id)){var o=s.sortedIndexBy(f,i,"id");f.splice(o,0,i)}t.continue()}else n(f)},C.onerror=function(e){n(f)}}else{var E=r(h,v),C=m.get(E);C.onsuccess=function(e){var t=e.target.result;t&&f.push(t.data),n(f)},C.onerror=function(e){n(f)}}}else{var S=m.index("location"),C=S.openCursor(h);C.onsuccess=function(e){var t=e.target.result;if(t){var r=t.value,i=r.data;if(l.match(c,i,g)){var o=s.sortedIndexBy(f,i,"id");f.splice(o,0,i)}t.continue()}else n(f)}}})})},save:function(e,t){return this.open().then(function(n){return new o(function(o,a){var c=e.address,l=e.schema,u=e.table,p="local"===l,d=p?"local-data":"remote-data",h=n.transaction(d,"readwrite"),m=p?u:c+"/"+l+"/"+u,f=h.objectStore(d);h.oncomplete=function(e){o(t)},h.onerror=function(e){a(new Error(e.message))},s.each(t,function(e){var t=p?i(m,e.key):r(m,e.id),n={address:c,location:m,data:e};f.put(n,t)})})})},remove:function(e,t){return this.open().then(function(n){return new o(function(o,a){var c=e.address,l=e.schema,u=e.table,p="local"===l,d=p?"local-data":"remote-data",h=n.transaction(d,"readwrite"),m=p?u:c+"/"+l+"/"+u,f=h.objectStore(d);h.oncomplete=function(e){o(t)},h.onerror=function(e){a(new Error(e.message))},s.each(t,function(e){var t=p?i(m,e.key):r(m,e.id);f.delete(t)})})})},clean:function(e){return this.open().then(function(t){return new o(function(n,r){var i=t.transaction("remote-data","readwrite"),s=i.objectStore("remote-data");if(void 0!==e.address){var o=s.index("address"),a=o.openCursor(e.address),c=0;a.onsuccess=function(e){var t=e.target.result;t?(c++,t.delete(),t.continue()):n(c)}}else if(void 0!==e.count){var o=s.index("rtime"),a=o.openCursor(),c=0;a.onsuccess=function(t){var r=t.target.result;r?(c++,r.delete(),c<e.count?r.continue():n(c)):n(c)}}else if(void 0!==e.before){var o=s.index("rtime"),a=o.openCursor(),c=0;a.onsuccess=function(t){var r=t.target.result;if(r){r.value.data.rtime<e.before?(c++,r.delete(),r.continue()):n(c)}else n(c)}}})})},open:function(){var e=this;return this.databasePromise||(this.databasePromise=new o(function(t,n){var r=window.indexedDB.open(e.props.databaseName,1);r.onsuccess=function(e){t(e.target.result)},r.onerror=function(e){n(new Error(e.message))},r.onupgradeneeded=function(e){var t=e.target.result;t.onerror=function(e){n(new Error(e.message))},t.createObjectStore("local-data").createIndex("location","location",{unique:!1});var r=t.createObjectStore("remote-data");r.createIndex("location","location",{unique:!1}),r.createIndex("address","address",{unique:!1}),r.createIndex("rtime","data.rtime",{unique:!1})}})),this.databasePromise},render:function(){return a.createElement("div",null)}})},function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}function i(e,t){var n=a.sortedIndexBy(e,{id:t},"id"),r=e[n];if(r&&r.id===t)return r}function s(e,t){var n=a.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id?e[n]=t:e.splice(n,0,t)}function o(e,t){var n=a.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id&&e.splice(n,1)}var a=n(3),c=n(9),l=n(0),u=l.PropTypes,p=n(66);e.exports=l.createClass({displayName:"LocalStorageCache",propTypes:{databaseName:u.string.isRequired},statics:{isAvailable:function(){return!!window.localStorage}},getInitialState:function(){var e=localStorage.getItem(this.props.databaseName);return this.localData=r(e)||{},this.remoteData={},{}},getRows:function(e,t,n){var r="local"===t?this.localData:this.remoteData,i=[e,t,n],s=a.get(r,i);return s||(s=[],a.set(r,i,s)),s},saveRows:function(e,t,n){if("local"===t){var r=JSON.stringify(this.localData);localStorage.setItem(this.props.databaseName,r)}},find:function(e){var t,n=e.server||"",r=e.schema,s=e.table,o=e.criteria,l=this.getRows(n,r,s);if(o&&void 0!==o.id&&1===a.size(o)){var u=o.id;u instanceof Array||(u=[u]),t=a.filter(a.map(u,function(e){return i(l,e)}))}else t=a.filter(l,function(e){return p.match(s,e,o)});return c.resolve(t)},save:function(e,t){var n=e.server||"",r=e.schema,i=e.table,o=this.getRows(n,r,i);return a.each(t,function(e){s(o,a.cloneDeep(e))}),this.saveRows(n,r,i),c.resolve(t)},remove:function(e,t){var n=e.server||"",r=e.schema,i=e.table,s=this.getRows(n,r,i);return a.each(t,function(e){o(s,e)}),this.saveRows(n,r,i),c.resolve(t)},clean:function(e){var t=this.remoteData,n=0;if(void 0!==e.server){var r=e.server,i=a.get(t,r);a.each(i,function(e){a.each(e,function(e){n+=e.length})}),a.set(t,r,void 0)}else if(void 0!==e.count){var s=[];a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=0;t<e.length;t++)s.push(e[t])})})}),s.sort(function(e,t){return e.rtime<t.rtime?-1:e.rtime>t.rtime?1:0}),s.splice(e.count),a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=e.length-1;t>=0;t--){var r=e[t];-1!==s.indexOf(r)&&(e.splice(t,1),n++)}})})})}else void 0!==e.before&&a.each(t,function(t){a.each(t,function(t){a.each(t,function(t){for(var r=t.length-1;r>=0;r--){t[r].rtime<e.before&&(t.splice(r,1),n++)}})})});return c.resolve(n)},render:function(){return l.createElement("div",null)}})},function(e,t,n){"use strict";function r(e,t,n){var r=[];return x.each(e,function(e,i){var s=t[i],o=x.sortedIndexBy(n,{id:e},"id"),a=n?n[o]:null;a&&a.id===e&&a.gn===s||r.push(e)}),r}function i(e,t,n){var r=[];return x.each(n,function(t){x.includes(e,t.id)||r.push(t.id)}),r}function s(e,t){return x.isEmpty(t)?e:(e=x.slice(e),x.each(t,function(t){var n=x.sortedIndexBy(e,{id:t},"id"),r=e?e[n]:null;r&&r.id===t&&e.splice(n,1)}),e)}function o(e,t){var n=[];return x.each(t,function(t){var r=x.sortedIndexBy(e,{id:t},"id"),i=e[r];i&&i.id===t&&n.push(i)}),n}function a(e,t){return e=x.slice(e),x.each(t,function(t){var n=x.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id?e[n]=t:e.splice(n,0,t)}),e}function c(){return(new Date).toISOString()}function l(e,t){if(!e)return 1/0;if(!t)return 0;var n="string"==typeof e?new Date(e):e;return("string"==typeof t?new Date(t):t)-n}function u(e){return"local"===e.schema?x.pick(e,"schema","table"):x.pick(e,"address","schema","table")}function p(e){return x.pick(e,"address","schema","table","criteria","minimum","expected")}function d(e){var t=P[e];return t||(t=P[e]={}),t}function h(){var e=S().toISOString();return x.pickBy(P,function(t){if(t&&!t.authorization&&t.authentication&&t.authentication.expire<e)return!0})}function m(e){P[e]=null}function f(e,t){return"local"===e.schema||!e.dirty&&!(.001*l(e.finish,new Date)>t)}function g(e){var t=e.minimum;return void 0===t&&(t=b(e)),void 0===t&&(t=1),!(e.results.length<t)}function v(e){var t=b(e);return!(e.results.length<t)}function y(e,t){if("local"===e.schema)return!0;var n=x.map(e.results,"rtime"),r=x.min(n);return!(r<U)&&(!(.001*l(r,new Date)>t)&&(e.finish=r,!0))}function b(e){return"number"==typeof e.expected?e.expected:e.criteria?k(e.criteria,"id")||k(e.criteria,"filters"):void 0}function k(e,t){var n=e[t];if(void 0!=n)return n instanceof Array?n.length:1}var x=n(3),w=n(9),C=n(0),E=C.PropTypes,S=n(16),R=n(55),N=n(54),O=n(66),U=n(274);e.exports=C.createClass({displayName:"RemoteDataSource",propTypes:{refreshInterval:E.number,basePath:E.string,discoveryFlags:E.object,retrievalFlags:E.object,cache:E.object,onChange:E.func,onAuthorization:E.func,onExpiration:E.func,onViolation:E.func,onStupefaction:E.func},getDefaultProps:function(){return{refreshInterval:900,basePath:""}},getInitialState:function(){return{recentSearchResults:[],recentStorageResults:[],recentRemovalResults:[]}},getServerAddress:function(e){return e.address},beginAuthorization:function(e,t){var n=this.getServerAddress(e),r=d(n);if(!r.authorizationPromise){var i=n+"/auth/session",s={responseType:"json",contentType:"json"};r.authorizationPromise=R.fetch("POST",i,{area:t},s).then(function(e){return r.authentication=e.authentication,{system:e.system,providers:e.providers}}).catch(function(e){throw r.authorizationPromise=null,e})}return r.authorizationPromise},checkAuthorizationStatus:function(e){var t=this,n=this.getServerAddress(e),r=d(n);if(!r.authentication)return w.resolve(!1);var i=r.authentication.token,s=n+"/auth/session/"+i,o={responseType:"json"};return R.fetch("GET",s,{},o).then(function(e){var i=e.authorization;if(i)return r.authorization=i,t.triggerAuthorizationEvent(n,i),!0;var s=x.get(e,"authentication.error");if(s)throw new N(s.statusCode,x.omit(s,"statusCode"));return!1}).catch(function(e){throw r.authorizationPromise=null,e})},submitPassword:function(e,t,n){var r=this,i=this.getServerAddress(e),s=d(i);if(!s.authentication)return w.resolve(!1);var o=s.authentication.token,a=i+"/auth/htpasswd",c={token:o,username:t,password:n},l={responseType:"json",contentType:"json"};return R.fetch("POST",a,c,l).then(function(e){var t=e.authorization;return!!t&&(s.authorization=t,r.triggerAuthorizationEvent(i,t),!0)}).catch(function(e){throw s.authorizationPromise=null,e})},endAuthorization:function(e){var t=this,n=this.getServerAddress(e),r=d(n);if(!r.authorization)return w.resolve(!1);var i=r.authorization.token,s=n+"/auth/session/"+i+"/end",o={responseType:"json",contentType:"json"};return R.fetch("POST",s,{},o).then(function(){return r.authentication=null,r.authorizationPromise=null,r.authorization=null,t.clearRecentSearches(n),t.clearCachedObjects(n),t.triggerExpirationEvent(n),!0})},getOAuthUrl:function(e,t,n){var r=this.getServerAddress(e),i=d(r);if(!i.authorization)return"";var s=i.authorization.token,o="sid="+t.id+"&token="+s;return"activation"===n?o+="&activation=1":"test"===n&&(o+="&test=1"),r+"/auth/"+t.type+"?"+o},hasAuthorization:function(e){return!!d(this.getServerAddress(e)).authorization},addAuthorization:function(e,t){d(this.getServerAddress(e)).authorization=t},start:function(e){var t=this;return w.resolve().then(function(){if("local"===e.schema)return 0;var n=t.getServerAddress(e),r=d(n);if(r.authorization)return r.authorization.user_id;throw new N(401)})},find:function(e){var t=this,n=x.get(e,"by.constructor.displayName"),r=e.required;e=p(e);var i=this.findRecentSearch(e);if(i)n&&(x.includes(i.by,n)||i.by.push(n)),i.promise.isFulfilled()?f(i)||i.updating||(i.updating=!0,this.searchRemoteDatabase(i).then(function(e){if(i.updating=!1,e)return t.triggerChangeEvent(),null})):i.promise.isRejected()&&(i.promise=this.searchRemoteDatabase(i).then(function(e){return e?(t.triggerChangeEvent(),null):i.results}));else{i=x.extend({},e,{start:null,finish:null,results:null,promise:null,by:n?[n]:[],dirty:!1,updating:!1});var s=this.searchLocalCache(i).then(function(){return!(!v(i)||!y(i,t.props.refreshInterval))}),o=s.then(function(e){return!e&&t.searchRemoteDatabase(i).then(function(e){if(e)return t.triggerChangeEvent(),null})});i.promise=s.then(function(e){return e?i.results:g(i)?i.results:o.then(function(){return i.results})});var a=x.slice(this.state.recentSearchResults);for(a.unshift(i);a.length>256;)a.pop();this.setState({recentSearchResults:a})}return r&&e.expected?i.promise.then(function(n){if(n.length<e.expected)throw t.triggerStupefactionEvent(e,n),new N(404);return n}):i.promise},save:function(e,t){var n=this,r=c(),i=x.get(e,"by.constructor.displayName");return e=u(e),"local"===e.schema?this.storeLocalObjects(e,t).then(function(t){return n.updateRecentSearchResults(e,t),n.triggerChangeEvent(),t}):this.storeRemoteObjects(e,t).then(function(t){var s=c();n.updateCachedObjects(e,t),n.updateRecentSearchResults(e,t),n.triggerChangeEvent();var o=x.clone(n.state.recentStorageResults);for(o.unshift({start:r,finish:s,duration:l(r,s),results:t,by:i});o.length>32;)o.pop();return n.setState({recentStorageResults:o}),t})},remove:function(e,t){var n=this,r=c(),i=x.get(e,"by.constructor.displayName");return e=u(e),"local"===e.schema?this.removeLocalObjects(e,t).then(function(t){return n.removeFromRecentSearchResults(e,t),n.triggerChangeEvent(),t}):(t=x.map(t,function(e){return{id:e.id,deleted:!0}}),this.storeRemoteObjects(e,t).then(function(t){var s=c();n.removeCachedObjects(e,t),n.removeFromRecentSearchResults(e,t),n.triggerChangeEvent();var o=x.clone(n.state.recentRemovalResults);for(o.unshift({start:r,finish:s,duration:l(r,s),results:t,by:i});o.length>32;)o.pop();return n.setState({recentRemovalResults:o}),t}))},invalidate:function(e,t){var n=this,r=!1;return x.forIn(t,function(t,i){var s=x.split(i,"."),o={address:e,schema:s[0],table:s[1]},a=n.getRelevantRecentSearches(o);x.each(a,function(e){var n=!1;b(e)===e.results.length?x.each(t,function(t){var r=x.sortedIndexBy(e.results,{id:t},"id"),i=e.results[r];if(i&&i.id===t)return n=!0,!1}):n=!0,n&&(e.dirty=!0,r=!0)})}),r&&this.triggerChangeEvent(),r},clear:function(e,t){var n=x.filter(this.state.recentSearchResults,function(n){return!x.isMatch(n,{address:e,schema:t})});this.setState({recentSearchResults:n})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerAuthorizationEvent:function(e,t){this.props.onAuthorization&&this.props.onAuthorization({type:"authorization",target:this,address:e,credentials:t})},triggerExpirationEvent:function(e){this.props.onExpiration&&this.props.onExpiration({type:"expiration",target:this,address:e})},triggerViolationEvent:function(e,t){this.props.onViolation&&this.props.onViolation({type:"violation",target:this,address:e,schema:t})},triggerStupefactionEvent:function(e,t){this.props.onStupefaction&&this.props.onStupefaction({type:"missingobject",target:this,query:e,results:t})},findRecentSearch:function(e){var t=x.findIndex(this.state.recentSearchResults,function(t){var n=p(t);return x.isEqual(e,n)});if(-1!==t){var n=x.slice(this.state.recentSearchResults),r=n[t];return n.splice(t,1),n.unshift(r),this.setState({recentSearchResults:n}),r}return null},searchRemoteDatabase:function(e){var t=this;if("local"===e.schema)return w.resolve(!1);var n=u(e),d=p(e);return e.start=c(),this.discoverRemoteObjects(d).then(function(c){var l=c.ids,u=c.gns,p=r(l,u,e.results),d=i(l,u,e.results);if(!x.isEmpty(d)){var h=o(e.results,d);t.removeCachedObjects(e,h)}if(x.isEmpty(p)){if(x.isEmpty(d))return null;return s(e.results,d)}return t.retrieveRemoteObjects(n,p).then(function(t){var n=t,r=a(e.results,n);return r=s(r,d)})}).then(function(r){r&&(e.results=r,e.promise=w.resolve(r)),e.finish=c(),e.duration=l(e.start,e.finish),e.dirty=!1;var i=x.slice(t.state.recentSearchResults);t.setState({recentSearchResults:i});var s=e.finish;return x.each(e.results,function(e){e.rtime=s}),t.updateCachedObjects(n,e.results),!!r})},discoverRemoteObjects:function(e){var t=u(e);return this.performRemoteAction(t,"discovery",e.criteria)},retrieveRemoteObjects:function(e,t){return this.performRemoteAction(e,"retrieval",{ids:t})},storeRemoteObjects:function(e,t){return this.performRemoteAction(e,"storage",{objects:t})},performRemoteAction:function(e,t,n){var r=this,i=this.getServerAddress(e),s=this.props.basePath,o=e.schema,a=e.table;if(!o)return w.reject(new Error("No schema specified"));if(!a)return w.reject(new Error("No table specified"));var c=""+i+s+"/data/"+t+"/"+o+"/"+a+"/",l=d(i);n=x.clone(n)||{},l.authorization&&(n.token=l.authorization.token),"retrieval"===t||"storage"===t?x.assign(n,this.props.retrievalFlags):"discovery"===t&&x.assign(n,this.props.discoveryFlags);var u={contentType:"json",responseType:"json"};return R.fetch("POST",c,n,u).then(function(e){return e}).catch(function(e){throw 401===e.statusCode?(m(i),r.clearRecentSearches(i),r.clearCachedObjects(i),r.triggerExpirationEvent(i),r.triggerChangeEvent()):403==e.statusCode&&(r.clearRecentSearches(i),r.clearCachedObjects(i),r.triggerViolationEvent(i,o),r.triggerChangeEvent()),e})},storeLocalObjects:function(e,t){var n=this.props.cache;return n?n.save(e,t):w.reject(new Error("No local cache"))},removeLocalObjects:function(e,t){var n=this.props.cache;return n?n.remove(e,t):w.reject(new Error("No local cache"))},searchLocalCache:function(e){var t=this.props.cache;if(!t)return!1;p(e);return t.find(e).then(function(t){return e.results=t,!0}).catch(function(e){return console.error(e),!1})},updateCachedObjects:function(e,t){var n=this.props.cache;return n?n.save(e,t).then(function(e){return!0}).catch(function(e){return console.error(e),!1}):w.resolve(!1)},removeCachedObjects:function(e,t){var n=this.props.cache;return n?n.remove(e,t).then(function(e){return!0}).catch(function(e){return console.error(e),!1}):w.resolve(!1)},clearCachedObjects:function(e){var t=this.props.cache;return t?t.clean({address:e}):w.resolve(0)},updateRecentSearchResults:function(e,t){var n=this.getRelevantRecentSearches(e),r="local"!==e.schema;x.each(n,function(e){var n=!1;x.each(t,function(t){var i;r?i=x.sortedIndexBy(e.results,t,"id"):-1===(i=x.findIndex(e.results,{key:t.key}))&&(i=e.results.length);var s=e.results[i],o=s&&s.id===t.id,a=O.match(e.table,t,e.criteria);a&&(n||(e.results=x.slice(e.results),e.promise=w.resolve(e.results),n=!0),a&&o?e.results[i]=t:a&&!o?e.results.splice(i,0,t):!a&&o&&e.results.splice(i,1))})})},removeFromRecentSearchResults:function(e,t){var n=this.getRelevantRecentSearches(e),r="local"!==e.schema;x.each(n,function(e){var n=!1;x.each(t,function(t){var i;i=r?x.sortedIndexBy(e.results,t,"id"):x.findIndex(e.results,{key:t.key});var s=e.results[i];s&&s.id===t.id&&(n||(e.results=x.slice(e.results),e.promise=w.resolve(e.results),n=!0),e.results.splice(i,1))})})},getRelevantRecentSearches:function(e){return x.filter(this.state.recentSearchResults,function(t){var n=u(t);if(t.results&&x.isEqual(e,n))return!0})},clearRecentSearches:function(e){var t=x.filter(this.state.recentSearchResults,function(t){return t.address!==e});this.setState({recentSearchResults:t})},componentWillMount:function(){var e=this;this.sessionCheckTimeout=setInterval(function(){var t=h();x.isEmpty(t)||(x.forIn(t,function(e,t){m(t)}),e.triggerChangeEvent())},3e5)},render:function(){return C.createElement("div",null)},componentDidMount:function(){this.triggerChangeEvent()},componentWillUnmount:function(){clearInterval(this.sessionExpirationCheckInterval)}});var P={}},function(e,t,n){"use strict";e.exports=(new Date).toISOString()},function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}var i=n(3),s=n(9),o=n(0),a=o.PropTypes,c=n(66),l=window.openDatabase;window.sqlitePlugin&&(l=window.sqlitePlugin.openDatabase),e.exports=o.createClass({displayName:"SQLiteCache",propTypes:{databaseName:a.string.isRequired},statics:{isAvailable:function(){return!!l}},find:function(e){var t,n,s=e.server||"",o=e.schema,a=e.table,l=e.criteria;if("local"===o)t="\n                SELECT json FROM local_data\n                WHERE table_name = ?\n            ",n=[a],l&&void 0!==l.key&&1===i.size(l)&&(t+=" AND key = ?",n.push(l.key),l=null),t+=" ORDER BY key";else{if(t="\n                SELECT json FROM remote_data\n                WHERE server_name = ?\n                AND schema_name = ?\n                AND table_name = ?\n            ",n=[s,o,a],l&&void 0!==l.id&&1===i.size(l)){var u=l.id;u instanceof Array?(t+=" AND id IN ("+i.fill(i.clone(u),"?").join(",")+")",n.push.apply(n,u)):(t+=" AND id = ?",n.push(u)),l=null}t+=" ORDER BY id"}return this.query(t,n).then(function(e){for(var t=[],n=0;n<e.length;n++){var i=r(e[n].json);i&&(l&&!c.match(a,i,l)||t.push(i))}return t})},save:function(e,t){var n=e.server||"",r=e.schema,s=e.table,o=[],a=[];return i.each(t,function(e){var t=JSON.stringify(e);if("local"===r)o.push("\n                    INSERT OR REPLACE INTO local_data\n                    (table_name, key, json)\n                    VALUES (?, ?, ?)\n                "),a.push([s,e.key,t]);else{var i=new Date(e.rtime).getTime();o.push("\n                    INSERT OR REPLACE INTO remote_data\n                    (server_name, schema_name, table_name, id, json, rtime)\n                    VALUES (?, ?, ?, ?, ?, ?)\n                "),a.push([n,r,s,e.id,t,i])}}),this.execute(o,a).return(t)},remove:function(e,t){var n=this,r=e.server||"",i=e.schema,o=e.table;return s.mapSeries(t,function(e){var t,s;return"local"===i?(t="\n                    DELETE FROM local_data\n                    WHERE table_name = ? AND key = ?\n                ",s=[o,e.key]):(t="\n                    DELETE FROM remote_data\n                    WHERE server_name = ?\n                    AND schema_name = ?\n                    AND table_name = ?\n                    AND id = ?\n                ",s=[r,i,o,e.id]),n.execute(t,s)})},clean:function(e){var t,n;if(void 0!==e.server)t="\n                DELETE FROM remote_data\n                WHERE server_name = ?\n            ",n=[e.server];else if(void 0!==e.count)t="\n                DELETE FROM remote_data\n                WHERE rowid IN (\n                    SELECT rowid FROM remote_data ORDER BY rtime LIMIT ?\n                )\n            ",n=[e.count];else if(void 0!==e.before){var r=new Date(e.before).getTime();t="\n                DELETE FROM remote_data\n                WHERE rtime < ?\n            ",n=[r]}return this.execute(t,n)},query:function(e,t){return this.open().then(function(n){return new s(function(r,i){var s=function(e){i(new Error(e.message))};n.transaction(function(n){n.executeSql(e,t,function(e,t){for(var n=[],i=0;i<t.rows.length;i++)n.push(t.rows.item(i));r(n)})},s)})})},execute:function(e,t){return this.open().then(function(n){return new s(function(r,i){var s=function(e){i(new Error(e.message))},o=function(){r(a)},a=0,c=function(e,t){a+=t.rowsAffected};n.transaction(function(n){if(e instanceof Array)for(var r=0;r<e.length;r++)n.executeSql(e[r],t[r],c);else n.executeSql(e,t,c)},s,o)})})},open:function(){var e=this;return this.databasePromise||(this.databasePromise=s.try(function(){var t=l(e.props.databaseName,"1.0","",52428800),n=["\n                        CREATE TABLE IF NOT EXISTS remote_data (\n                            server_name text,\n                            schema_name text,\n                            table_name text,\n                            id int,\n                            json text,\n                            rtime datetime\n                        )\n                    ","\n                        CREATE UNIQUE INDEX IF NOT EXISTS remote_data_idx_id\n                        ON remote_data (\n                            server_name,\n                            schema_name,\n                            table_name,\n                            id\n                        )\n                    ","\n                        CREATE INDEX IF NOT EXISTS remote_data_idx_location\n                        ON remote_data (\n                            server_name,\n                            schema_name,\n                            table_name\n                        )\n                    ","\n                        CREATE INDEX IF NOT EXISTS remote_data_idx_rtime\n                        ON remote_data (\n                            rtime\n                        )\n                    ","\n                        CREATE TABLE IF NOT EXISTS local_data (\n                            table_name text,\n                            key text,\n                            json text\n                        )\n                    ","\n                        CREATE UNIQUE INDEX IF NOT EXISTS local_data_idx_key\n                        ON local_data (\n                            table_name,\n                            key\n                        )\n                    "];return new s(function(e,r){var s=function(e){r(new Error(e.message))};t.transaction(function(e){i.each(n,function(t){e.executeSql(t)})},s,e)}).return(t)})),this.databasePromise},render:function(){return o.createElement("div",null)}})},function(e,t,n){"use strict";function r(){function e(e){void 0===n&&e&&e.length>=2&&(n=i.toLower(e))}i.each(navigator.languages,e);var t=["language","browserLanguage","systemLanguage","userLanguage"];i.each(t,function(t){e(navigator[t])});var n;return n}var i=n(3),s=n(0),o=s.PropTypes,a=n(6);e.exports=s.createClass({displayName:"LocaleManager",propTypes:{defaultLanguageCode:o.string,database:o.instanceOf(a),directory:o.arrayOf(o.object),onChange:o.func,onModuleRequest:o.func},getDefaultProps:function(){return{defaultLanguageCode:"en"}},getInitialState:function(){return{languageCode:"",phraseTable:{},missingPhrases:[]}},getLanguageCode:function(){return this.state.languageCode},getDirectory:function(){return this.props.directory},translate:function(e){var t=this.state.phraseTable[e];if(null==t)return e;if("function"!=typeof t)return t;try{var n=i.slice(arguments,1);return t.apply(this,n)}catch(t){return console.error(t),"["+e+": "+t.message+"]"}},pick:function(e,t){if("string"==typeof e)return e;var n=this.state.languageCode.substr(0,2);t&&(n=t.substr(0,2));var r="",s="",o=this.props.defaultLanguageCode.substr(0,2),a="";for(var c in e){var l=e[c],u=i.toLower(c);u===n&&(r=l),s||(s=l),u===o&&(a=l)}return r||(a||s)},change:function(e){var t=this;return e=i.toLower(e),e===this.state.languageCode?Promise.resolve(!0):this.load(e).then(function(n){var r;r="function"==typeof n?n(e):n;var i={languageCode:e,phraseTable:r};return t.setState(i,function(){t.triggerChangeEvent()}),!0})},load:function(e){var t=c[e];return t?Promise.resolve(t):this.triggerModuleRequest(e).then(function(t){return c[e]=t,t})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerModuleRequest:function(e){return this.props.onModuleRequest?this.props.onModuleRequest({type:"module_request",target:this,languageCode:e}):Promise.reject("onModuleRequest is not set")},render:function(){return null},componentDidMount:function(){var e=this,t=r()||this.props.defaultLanguageCode;this.change(t).catch(function(t){e.change(e.props.defaultLanguageCode)})},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var r=this.props.database.use({by:this,schema:"local"});r.start().then(function(){return r.findOne({table:"settings",key:"language"})}).then(function(e){e&&e.selectedLanguageCode&&n.change(e.selectedLanguageCode)})}}});var c={}},function(e,t,n){"use strict";e.exports=[{name:"Čeština",code:"cz",script:"latin",countries:{cz:"Česko",pl:"Polsko",sk:"Slovensko"},defaultCountry:"cz"},{name:"Dansk",code:"da",script:"latin",countries:{dk:"Danmark",fo:"Færøerne",gl:"Grønland",de:"Tyskland"},defaultCountry:"dk"},{name:"Deutsch",code:"de",script:"latin",countries:{at:"Österreich",be:"Belgien",de:"Deutschland",lu:"Luxemburg",ch:"Schweiz"},defaultCountry:"de"},{name:"Ελληνικά",code:"el",script:"greek",countries:{gr:"Ελλάδα",cy:"Κύπρος"},defaultCountry:"gr"},{name:"English",code:"en",script:"latin",countries:{au:"Australia",ca:"Canada",hk:"Hong Kong",ie:"Ireland",sg:"Singapore",gb:"United Kingdom",us:"United States"},defaultCountry:"us",locales:{admin:!0,client:!0}},{name:"Español",code:"es",script:"latin",countries:{ar:"Argentina",bo:"Bolivia",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",es:"España",ec:"Ecuador",sv:"El Salvador",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"México",ni:"Nicaragua",pa:"Panamá",py:"Paraguay",pe:"Perú",pr:"Puerto Rico",do:"República Dominicana",uy:"Uruguay",ve:"Venezuela"},defaultCountry:"es"},{name:"Français",code:"fr",script:"latin",countries:{be:"Belgique",bj:"Bénin",bf:"Burkina Faso",bi:"Burundi",cm:"Cameroun",ca:"Canada",cg:"Congo",ci:"Côte d'Ivoire",dj:"Djibouti",gq:"Guinée équatoriale",fr:"France",ga:"Gabon",gn:"Guinée",ht:"Haïti",lu:"Luxembourg",mg:"Madagascar",ml:"Mali",ne:"Niger",rw:"Rwanda",cf:"République centrafricaine",cd:"République démocratique du Congo",sn:"Sénégal",sc:"Seychelles",ch:"Suisse",td:"Tchad",tg:"Togo"},defaultCountry:"fr"},{name:"한국어",code:"ko",script:"hangul",countries:{kr:"한국",cn:"중국"},defaultCountry:"kr"},{name:"Hrvatski",code:"hr",script:"latin",countries:{ba:"Bosna i Hercegovina",hr:"Hrvatska",rs:"Srbija"},defaultCountry:"hr"},{name:"Italiano",code:"it",script:"latin",countries:{it:"Italia",ch:"Svizzera",hr:"Croazia",si:"Slovenia"},defaultCountry:"it"},{name:"Magyar",code:"hu",script:"latin",countries:{hr:"Magyarország",ro:"Románia"},defaultCountry:"hu"},{name:"Nederlands",code:"nl",script:"latin",countries:{be:"België",nl:"Nederland",sr:"Suriname"},defaultCountry:"nl"},{name:"日本語",code:"jp",script:"hiragana",countries:{jp:"日本"},defaultCountry:"jp"},{name:"Norsk",code:"nb",script:"latin",countries:{no:"Norge"},defaultCountry:"no",locales:{admin:!0,client:!0}},{name:"Polski",code:"pl",script:"latin",countries:{by:"Białoruś",lt:"Litwa",pl:"Polska",ua:"Ukraina"},defaultCountry:"pl",locales:{admin:!0,client:!0}},{name:"Português",code:"pt",script:"latin",countries:{ao:"Angola",br:"Brasil",tl:"Timor Leste",gq:"Guiné Equatorial",gw:"Guiné-Bissau",mz:"Moçambique",mo:"Macao",pt:"Portugal"},defaultCountry:"pt"},{name:"Русский",code:"ru",script:"cyrillic",countries:{am:"Армения",by:"Беларусь",ge:"Грузия",lv:"Латвия",kz:"Казахстан",kg:"Киргизия",lt:"Литва",ru:"Россия",tj:"Таджикистан",ua:"Украина",uz:"Узбекистан",es:"Эстония"},defaultCountry:"ru",locales:{admin:!0,client:!0}},{name:"Srpski",code:"sr",script:"latin",countries:{rs:"Srbija",hr:"Hrvatska",ba:"Bosna i Hercegovina"},defaultCountry:"sr"},{name:"Suomi",code:"fi",script:"latin",countries:{fi:"Suomi",se:"Ruotsi"},defaultCountry:"fi",locales:{admin:!0,client:!0}},{name:"Slovenčina",code:"sk",script:"latin",countries:{cz:"Česko",sk:"Slovensko"},defaultCountry:"sk"},{name:"Svenska",code:"sv",script:"latin",countries:{fi:"Finland",se:"Sverige"},defaultCountry:"se"},{name:"Tiếng Việt",code:"vi",script:"latin",countries:{vn:"Việt Nam"},defaultCountry:"vn"},{name:"Türkçe",code:"tr",script:"latin",countries:{cy:"Kıbrıs",tr:"Türkiye"},defaultCountry:"tr"},{name:"中文",code:"zh",script:"hanzi",countries:{cn:"中国",hk:"香港",mo:"澳門",sg:"新加坡",tw:"台灣"},defaultCountry:"cn",locales:{admin:!0,client:!0}}]},function(e,t,n){"use strict";function r(e,t){return t||(t=0),new i(function(n,r){function i(t){var n=l*u*3;t.size/n>.02?o(t):((!h||h.size<t.size)&&(h=t),d>10?o(h):(e.currentTime+=1e3,d++))}function s(t){try{p.getContext("2d").drawImage(e,0,0,l,u),p.toBlob(i,"image/jpeg",75)}catch(e){a(e)}}function o(e){c(),n(e)}function a(e){c(),h?n(h):r(e)}function c(){e.removeEventListener("seeked",s),clearTimeout(m)}var l=e.videoWidth,u=e.videoHeight,p=document.createElement("CANVAS");p.width=l,p.height=u;var d=1,h=null;e.addEventListener("seeked",s),e.addEventListener("ended",function(){a(new Error("Unable to obtain an image before video ended"))}),e.currentTime=t;var m=setTimeout(function(){a(new Error("Unable to obtain an image within time limit"))},1e3)})}var i=(n(3),n(9));t.capture=r},function(e,t,n){"use strict";function r(e,t,n){e.left<0?e.left=0:e.left+e.width>t&&(e.left=t-e.width),e.top<0?e.top=0:e.top+e.height>n&&(e.top=n-e.height)}var i=(n(9),n(0)),s=i.PropTypes,o=(n(27),n(463)),a=n(30),c=n(95);n(655),e.exports=i.createClass({displayName:"ImageCropper",propTypes:{url:s.string.isRequired,clippingRect:s.object,aspectRatio:s.number,onChange:s.func,onLoad:s.func},getDefaultProps:function(){return{aspectRatio:1}},getInitialState:function(){return this.components=a({container:HTMLElement,image:c}),{clippingRect:this.props.clippingRect}},componentWillReceiveProps:function(e){this.props.url===e.url&&this.props.clippingRect===e.clippingRect||(this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.props.url!==e.url&&this.triggerChangeEvent(this.state.clippingRect)),this.setState({clippingRect:e.clippingRect}))},render:function(){var e=this.components.setters,t={ref:e.container,className:"image-cropper",onMouseDown:this.handleMouseDown,onWheel:this.handleMouseWheel},n={ref:e.image,url:this.props.url,clippingRect:this.state.clippingRect,onLoad:this.props.onLoad};return i.createElement("div",t,i.createElement(c,n))},componentDidMount:function(){var e=this.components.container;this.hammer=new o(e);var t=this.hammer.get("pan").set({direction:o.DIRECTION_ALL,threshold:5});this.hammer.get("pinch").set({enable:!0}).recognizeWith(t),this.hammer.on("panstart",this.handlePanStart),this.hammer.on("panmove",this.handlePanMove),this.hammer.on("panend",this.handlePanEnd),this.hammer.on("pinchstart",this.handlePinchStart),this.hammer.on("pinchmove",this.handlePinchMove),this.hammer.on("pinchend",this.handlePinchEnd)},componentWillUnmount:function(){this.dragStart&&this.handleMouseUp(),this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.triggerChangeEvent(this.state.clippingRect)),this.hammer&&(this.hammer.off("panstart",this.handlePanStart),this.hammer.off("panmove",this.handlePanMove),this.hammer.off("panend",this.handlePanEnd),this.hammer.off("pinchstart",this.handlePinchStart),this.hammer.off("pinchmove",this.handlePinchMove),this.hammer.off("pinchend",this.handlePinchEnd))},triggerChangeEvent:function(e){_.isEqual(this.props.clippingRect,e)||this.props.onChange&&this.props.onChange({type:"change",target:this,rect:e})},handleMouseDown:function(e){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var r=n.getBoundingClientRect(),i=this.state.clippingRect;this.dragStart={clippingRect:i,boundingRect:r,pageX:e.pageX,pageY:e.pageY,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight},document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},handleMouseMove:function(e){if(e.preventDefault(),this.dragStart){var t={x:this.dragStart.pageX-e.pageX,y:this.dragStart.pageY-e.pageY},n=this.dragStart.boundingRect,i=_.clone(this.dragStart.clippingRect),s=t.x*i.width/n.width,o=t.y*i.height/n.height;i.left+=Math.round(s),i.top+=Math.round(o),r(i,this.dragStart.naturalWidth,this.dragStart.naturalHeight),this.setState({clippingRect:i})}},handleMouseUp:function(e){this.dragStart&&(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.triggerChangeEvent(this.state.clippingRect),this.dragStart=null)},handleMouseWheel:function(e){var t=this;e.preventDefault();var n=this.components.image,i=this.components.container;if(n&&i&&this.state.clippingRect){var s=4;e.shiftKey&&(s=1);var o=i.getBoundingClientRect(),a=_.clone(this.state.clippingRect),c=Math.round(e.deltaY*a.height/o.height/s),l=a.width+c;l>n.naturalWidth&&(l=n.naturalWidth,c=l-a.width);var u=a.height+c;u>n.naturalHeight&&(u=n.naturalHeight,c=u-a.height,l=a.width+c);var p={x:e.pageX-o.left,y:e.pageY-o.top},d=-p.x*c/o.width,h=-p.y*c/o.height;a.left+=Math.round(d),a.top+=Math.round(h),a.width=l,a.height=u,r(a,n.naturalWidth,n.naturalHeight),this.setState({clippingRect:a},function(){t.zoomChangeTimeout&&clearTimeout(t.zoomChangeTimeout),t.zoomChangeTimeout=setTimeout(function(){t.triggerChangeEvent(a),t.zoomChangeTimeout=0},1e3)}),this.dragStart&&(this.dragStart={clippingRect:a,boundingRect:o,pageX:e.pageX,pageY:e.pageY,naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight})}},handlePanStart:function(e){if("mouse"!==e.pointerType){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var r=n.getBoundingClientRect(),i=this.state.clippingRect;this.panStart={clippingRect:i,boundingRect:r,naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight},this.handlePanMove(e)}}},handlePanMove:function(e){if(this.panStart){var t=this.panStart.boundingRect,n=_.clone(this.panStart.clippingRect),i=-e.deltaX*n.width/t.width,s=-e.deltaY*n.height/t.height;n.left+=Math.round(i),n.top+=Math.round(s),r(n,this.panStart.naturalWidth,this.panStart.naturalHeight),this.setState({clippingRect:n})}},handlePanEnd:function(e){this.panStart&&(this.triggerChangeEvent(this.state.clippingRect),this.panStart=null)},handlePinchStart:function(e){if("mouse"!==e.pointerType){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var r=n.getBoundingClientRect(),i=this.state.clippingRect;this.pinchStart={clippingRect:i,boundingRect:r,pointers:_.map(e.pointers,function(e){return{pageX:e.pageX,pageY:e.pageY}})},this.handlePinchMove(e)}}},handlePinchMove:function(e){if(this.pinchStart){var t=this.components.image,n=_.clone(this.pinchStart.clippingRect),i=this.pinchStart.boundingRect,s=1/e.scale,o=Math.round(n.width*s);o>t.naturalWidth&&(o=t.naturalWidth,s=o/n.width);var a=Math.round(n.height*s);a>t.naturalHeight&&(a=t.naturalHeight,s=a/n.height,o=Math.round(n.width*s));var c={x:this.pinchStart.pointers[0].pageX-i.left,y:this.pinchStart.pointers[0].pageY-i.top},l={x:this.pinchStart.pointers[1].pageX-i.left,y:this.pinchStart.pointers[1].pageY-i.top},u={x:e.pointers[0].pageX-i.left,y:e.pointers[0].pageY-i.top},p={x:e.pointers[1].pageX-i.left,y:e.pointers[1].pageY-i.top},d=(c.x*n.width-u.x*o)/i.width,h=(l.x*n.width-p.x*o)/i.width,m=(c.y*n.height-u.y*a)/i.height,f=(l.y*n.height-p.y*a)/i.height;n.left+=Math.round((d+h)/2),n.top+=Math.round((m+f)/2),n.width=o,n.height=a,r(n,t.naturalWidth,t.naturalHeight),this.setState({clippingRect:n})}},handlePinchEnd:function(e){this.pinchStart&&(this.triggerChangeEvent(this.state.clippingRect),this.pinchStart=null)}})},function(e,t,n){"use strict";function r(e,t){return e<<8|t}function i(e,t){return t<<8|e}function s(e,t,n,r){return e<<24|t<<16|n<<8|r}function o(e,t,n,r){return r<<24|n<<16|t<<8|e}function a(e,t){var n=e.length,i=0;if(65496==r(e[i++],e[i++]))for(;i<n;){var s=r(e[i++],e[i++]),o=r(e[i++],e[i++]);if(65498==s)break;var a=t(s,i,o);if(void 0!==a&&!1!==a)return a;i+=o-2}return-1}function c(e){return a(e,function(t,n){if(65517==t&&80==e[n++]&&104==e[n++]&&111==e[n++]&&116==e[n++]&&111==e[n++]&&115==e[n++]&&104==e[n++]&&111==e[n++]&&112==e[n++]&&32==e[n++]&&51==e[n++]&&46==e[n++]&&48==e[n++])return n})}function l(e,t){for(var n=e.length,i=null,s=t;s+4<n;)if(56==e[s+0]&&66==e[s+1]&&73==e[s+2]&&77==e[s+3]){s+=4;for(var o=r(e[s++],e[s++]),a=e[s++],c="",l=0;l<a;l++)c+=String.fromCharCode(e[s++]);s++;var p=(r(e[s++],e[s++]),r(e[s++],e[s++]));o>=1999&&o<=2998&&(i||(i={}),i[c]=u(e,s,p)),s+=p}else s++;return i}function u(e,t,n){for(var i=n/26,o=0,a=[],c=[],l=t,u=0;u<i;u++){switch(r(e[l++],e[l++])){case 0:case 3:o=r(e[l++],e[l++]),l+=22;break;case 1:case 2:case 4:case 5:for(var p=0;p<3;p++){var d=s(e[l++],e[l++],e[l++],e[l++]),h=s(e[l++],e[l++],e[l++],e[l++]);d>=2147483648?d=(2147483647-d)/16777216:d/=16777216,h>=2147483648?h=(2147483647-h)/16777216:h/=16777216,c.push({x:h,y:d})}o--,0==o&&(c.push(c.shift()),c.push(c[0]),a.push(c),c=[]);break;default:l+=24}}return a}t.getDimensions=function(e){var t=a(e,function(e,t,n){if(65472===e||65474===e)return t});if(t>0){var n=(e[t++],r(e[t++],e[t++]));return{width:r(e[t++],e[t++]),height:n}}},t.getOrientation=function(e){var t=r,n=s,c=a(e,function(r,s,a){if(65505===r){var c=s,l=s+a;if(69==e[c++]&&120==e[c++]&&105==e[c++]&&102==e[c++]&&0==e[c++]&&0==e[c++]){var u=c;"II"===String.fromCharCode(e[c++])+String.fromCharCode(e[c++])&&(t=i,n=o);if(42!==t(e[c++],e[c++]))return;do{var p=n(e[c++],e[c++],e[c++],e[c++]);if(0===p)break;c=u+p;for(var d=t(e[c++],e[c++]),h=0;h<d;h++){var m=t(e[c++],e[c++]),f=t(e[c++],e[c++]),g=n(e[c++],e[c++],e[c++],e[c++]);if(274===m&&3===f&&1===g)return c;c+=4}}while(c<l)}}});if(c>0){return t(e[c++],e[c++])}},t.extractPaths=function(e){var t=c(e);return-1!==t?l(e,t):null}},function(e,t,n){"use strict";function r(e){return s(e).then(function(t){var n=p.findIndex(t,{name:"ftyp"}),r=p.findIndex(t,{name:"moov"});if(!(0===n&&r>1))return null;var s=t[n],o=t[r];return a(e,s).then(function(t){return a(e,o).then(function(n){var r=new Uint8Array(n);i(r,8,r.length,s.offset+s.size,o.offset,o.size);var a=e.slice(s.offset+s.size,o.offset),c=e.slice(o.offset+o.size),l=[t,n,a,c];return new Blob(l,{type:e.type})})})}).catch(function(e){return null})}function i(e,t,n,r,s,o){for(;t<n;){var a=c(e,t),p=u(e,t+4);if(a<8)break;switch(p){case"stco":for(var d=c(e,t+12),h=0;h<d;h++){var m=t+16+4*h,f=c(e,m);r<=f&&f<=s&&(f+=o,e[m+0]=f>>24&255,e[m+1]=f>>16&255,e[m+2]=f>>8&255,e[m+3]=f>>0&255)}break;case"co64":for(var d=c(e,t+12),h=0;h<d;h++){var m=t+16+8*h,f=l(e,m);r<=f&&f<=s&&(f+=o,e[m+0]=f>>56&255,e[m+1]=f>>48&255,e[m+2]=f>>40&255,e[m+3]=f>>32&255,e[m+4]=f>>24&255,e[m+5]=f>>16&255,e[m+6]=f>>8&255,e[m+7]=f>>0&255)}break;case"trak":case"mdia":case"minf":case"stbl":i(e,t+8,t+a,r,s,o)}t+=a}}function s(e){var t=[],n=0,r=e.size,i=!1,s=!1;return h.do(function(){return o(e,n).then(function(e){var o=!1;if(i?"moov"===e.name&&(s=!0):"ftyp"===e.name?i=!0:o=!0,n+=e.size,n>r&&(o=!0),o)throw new Error("File does not appear to a QuickTime container");t.push(e)})}),h.while(function(){return!(i&&s)}),h.return(function(){return t}),h.end()}function o(e,t){return new d(function(n,r){var i=e.slice(t,t+16),s=new FileReader;s.readAsArrayBuffer(i),s.onload=function(e){var i=new Uint8Array(e.target.result),s=c(i,0),o=8;1===s&&(s=l(i,8),o=16),s>=o||r(new Error("Invalid atom size"));var a=u(i,4);n({offset:t,size:s,name:a})},s.onerror=function(e){r(new Error("Unable to load data"))}})}function a(e,t){return new d(function(n,r){var i=e.slice(t.offset,t.offset+t.size),s=new FileReader;s.readAsArrayBuffer(i),s.onload=function(e){n(e.target.result)},s.onerror=function(e){r(new Error("Unable to load data"))}})}function c(e,t){return e[t+0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function l(e,t){return e[t+0]<<56|e[t+1]<<48|e[t+2]<<40|e[t+3]<<32|e[t+4]<<24|e[t+5]<<16|e[t+6]<<8|e[t+7]}function u(e,t){return String.fromCharCode(e[t+0])+String.fromCharCode(e[t+1])+String.fromCharCode(e[t+2])+String.fromCharCode(e[t+3])}var p=n(3),d=n(9),h=n(81);t.process=r},function(e,t,n){"use strict";e.exports=t=["like","comment","vote","task-completion","note","assignment"],t.editable=["comment"],t.git=["note","assignment"]},function(e,t,n){"use strict";function r(e,t){var n,r,i=new RegExp("^/(https?)/([^/]*)"),s=i.exec(e.path);s?(r=s[1]+":",n=s[2],e.path=e.path.substr(s[0].length),t.cors=!0):(n=window.location.host,r=window.location.protocol,t.cors=!1),t.address=r+"//"+n}function i(e,t){if(t.cors){var n=t.address;if(n){var r=n.indexOf("://"),i=n.substr(0,r),s=n.substr(r+3);e.path="/"+i+"/"+s+e.path}}}t.extract=r,t.insert=i},function(e,t,n){"use strict";function r(e){var t=e,n="",r=t.indexOf("#");-1!==r&&(n=t.substr(r+1),t=t.substr(0,r));var s={},o=t.indexOf("?");return-1!==o&&(s=i(t.substr(o+1)),t=t.substr(0,o)),{path:t,query:s,hash:n}}function i(e){var t={},n=o.split(e,"&");return o.each(n,function(e){var n=o.split(e,"="),r=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]||"");i=o.replace(i,/\+/g," "),t[r]=i}),t}function s(e){return e.pathname+e.search+e.hash}var o=n(3),a=n(0),c=a.PropTypes,l=n(6);e.exports=a.createClass({displayName:"RouteManager",propTypes:{pages:c.array.isRequired,database:c.instanceOf(l),rewrite:c.func,onChange:c.func,onRedirectionRequest:c.func},getInitialState:function(){return{basePath:this.getBasePath(),url:null,component:null,parameters:null,query:null,hash:""}},getBasePath:function(){return""},getUrl:function(){return this.state.url},getComponent:function(){return this.state.component},getParameters:function(){return this.state.parameters},getQuery:function(){return this.state.query},getHash:function(){return this.state.hash},goTo:function(e,t){var n=s(e);return this.change(n,t)},find:function(e,t){t=o.clone(t)||{};var n=e.getUrl(t),r=this.state.basePath;r&&(n.path=r+n.path),this.props.rewrite&&this.props.rewrite(n,t,"find");var i=n.path;if(!o.isEmpty(n.query)){var s="";o.forIn(n.query,function(e,t){s+=s?"&":"?",s+=t+"="+encodeURIComponent(e).replace(/%20/g,"+")}),i+=s}return n.hash&&(i+="#"+n.hash),i},parse:function(e){var t=this,n=r(e),i={};this.props.rewrite&&this.props.rewrite(n,i,"parse");var s=this.state.basePath;if(s){if(!o.startsWith(n.path,s))return null;n.path=n.path.substr(s.length)}var a,c=0;try{o.each(this.props.pages,function(e){if("function"!=typeof e.parseUrl){var r=o.get(e,"displayName","Page");throw new Error(r+" does not implement the static function parseUrl()")}var s=e.parseUrl(n.path,n.query,n.hash);if(s&&s.match.length>c){var l=o.assign(o.omit(s,"match"),i),u=t.find(e,l);a={url:u,component:e,parameters:l,query:n.query,hash:n.hash},c=s.match.length}})}catch(e){return console.error(e),null}return a},change:function(e,t,n){var r=this;if(this.state.url===e)return Promise.resolve(!1);var i=this.parse(e);return i?(this.setState(i,function(){r.triggerChangeEvent()}),Promise.resolve(!0)):n?Promise.reject(new Error("Unable to find page")):this.triggerRedirectionRequest(e).then(function(e){return r.change(e,t,!0)})},loosen:function(){},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerRedirectionRequest:function(e){if(this.props.onRedirectionRequest){var t=this.state.basePath;return t&&o.startsWith(e,t)&&(e=e.substr(t.length),o.startsWith(e,"/")||(e="/"+e)),this.props.onRedirectionRequest({type:"route_request",target:this,url:e})}return Promise.reject(new Error("Unable to route URL to a page: "+e))},render:function(){return null},componentDidMount:function(){this.componentDidUpdate({},{})},componentDidUpdate:function(e,t){!e.database&&this.props.database&&this.change("/",!0).catch(function(e){console.error(e)})},componentWillUnmount:function(){},handlePopState:function(e){return}})},function(e,t,n){"use strict";function r(e){var t;if("number"==typeof e)return e;if(t=/^(\d+)\s*vw/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetWidth/100)}if(t=/^(\d+)\s*vh/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetHeight/100)}}var i=n(3),s=n(0),o=s.PropTypes,a=n(6);e.exports=s.createClass({displayName:"ThemeManager",propTypes:{modes:o.object,serverAddress:o.string,database:o.instanceOf(a),onChange:o.func},getInitialState:function(){return{mode:this.selectMode(),devicePixelRatio:window.devicePixelRatio,details:null}},getMode:function(){return this.state.mode},getModes:function(){var e=i.sortBy(i.toPairs(this.props.modes),1);i.map(e,0);return i.keys(this.props.modes)},getDetails:function(){return this.state.details},getImageUrl:function(e,t){t||(t={});var n;switch(e.type){case"video":case"audio":case"website":n=e.poster_url;break;default:n=e.url}if(n){var s=[],o=e.clip;if(t.hasOwnProperty("clip")&&(o=t.clip),o){var a=i.map([o.left,o.top,o.width,o.height],Math.round);s.push("cr"+a.join("-"))}var c=r(t.width),l=r(t.height);1!==this.state.devicePixelRatio&&(c=Math.round(c*this.state.devicePixelRatio),l=Math.round(l*this.state.devicePixelRatio)),c&&l?s.push("re"+c+"-"+l):!c&&l?s.push("h"+l):!l&&c&&s.push("w"+c),void 0!==t.quality&&s.push("q"+t.quality);var u="";return s.length>0&&(u="/"+s.join("+"),"png"!==e.format&&"gif"!==e.format||(u+=".png")),""+this.props.serverAddress+n+u}},getImageFile:function(e){switch(e.type){case"video":case"audio":case"website":return e.poster_file;default:return e.file}},getVideoUrl:function(e,t){var n=""+this.props.serverAddress+e.url;if(t&&t.version){var r=e.versions[t.version];n+="."+t.version+"."+r.format}return n},getAudioUrl:function(e,t){return this.getVideoUrl(e,t)},getUrl:function(e,t){switch(e.type){case"image":return this.getImageUrl(e,t);case"video":return this.getVideoUrl(e,t);case"website":return e.url;case"audio":return this.getAudioUrl(e,t)}},selectMode:function(){var e=document.body.parentNode.offsetWidth,t="";for(var n in this.props.modes){e>=this.props.modes[n]&&(t=n)}return t},change:function(e){var t=this;return i.isEqual(this.state.details,e)?Promise.resolve(!0):(this.setState({details:e},function(){t.triggerChangeEvent()}),Promise.resolve(!0))},componentWillMount:function(){window.addEventListener("resize",this.handleWindowResize)},render:function(){return null},componentDidMount:function(){this.change(c)},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var r=this.props.database.use({schema:"local",by:this});r.start().then(function(){return r.findOne({table:"settings",key:"theme"})}).then(function(e){e&&e.theme&&n.change(e.theme)})}},componentWillUnmount:function(){window.removeEventListener("resize",this.handleWindowResize)},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},handleWindowResize:function(e){var t=this,n={},r=this.selectMode();this.state.mode!==r&&(n.mode=r),this.state.devicePixelRatio!==window.devicePixelRatio&&(n.devicePixelRatio=window.devicePixelRatio),i.isEmpty(n)||this.setState(n,function(){t.triggerChangeEvent()})}});var c={}},function(e,t,n){"use strict";var r=n(3),i=n(9),s=n(0),o=s.PropTypes,a=n(16),c=n(55),l=(n(150),n(81)),u=n(6),p=n(7);e.exports=s.createClass({displayName:"PayloadManager",propTypes:{database:o.instanceOf(u),route:o.instanceOf(p),onChange:o.func},getInitialState:function(){return{payloads:[]}},queue:function(e,t){var n=this,s=this.getAction(t);if(!s)return i.resolve(null);var o=this.props.route.parameters.address,c={};return this.createTask(e,s,c).then(function(i){var s=r.pick(t,"file","poster_file","stream","external_url","external_poster_url","url"),c=r.assign({payload_id:i.id,action:i.action,token:i.token,start:a(),transferred:0,total:0,backendProgress:0,address:o,schema:e,promise:null},s),l=r.concat(n.state.payloads,c);return n.setState({payloads:l},function(){n.triggerChangeEvent()}),c.payload_id})},getAction:function(e){switch(e.type){case"image":if(!e.url){if(e.file instanceof Blob)return"image-upload";if(e.external_url)return"image-copy"}break;case"audio":if(!e.url){if(e.stream)return"audio-upload-transcode";if(e.file instanceof Blob)return"audio-upload-transcode";if(e.external_url)return"audio-copy-transcode"}break;case"video":if(!e.url){if(e.stream)return"video-upload-transcode";if(e.file instanceof Blob)return"video-upload-transcode";if(e.external_url)return"video-copy-transcode"}break;case"website":if(!e.poster_url&&e.url)return"website-poster-generate"}},createTask:function(e,t,n){var r=this.props.database.use({schema:e,by:this});return r.start().then(function(e){var i={action:t,options:n,user_id:e};return r.saveOne({table:"task"},i)})},find:function(e,t){if(!this.props.route)return null;var n=this.props.route.parameters.address;return r.find(this.state.payloads,function(i){if(i.address===n&&i.schema===e)return r.some(t,function(e,t){return i[t]===e})})},send:function(e,t){var n=this,r=this.find(e,{payload_id:t});if(r&&!r.promise){var i={responseType:"json"};if(!r.stream&&r.file){var s=r.file;i.onUploadProgress=function(e){var r=e.total?Math.round(s.size*(e.loaded/e.total)):0;n.updatePayloadStatus(t,{transferred:r,total:s.size})}}var o=this.createFormData(r).then(function(e){var t=n.getUrl(r);return c.fetch("POST",t,e,i)});r.promise=o}},createFormData:function(e){var t={};return e.stream?t.stream=this.stream(e.stream):e.file?t.file=e.file:e.external_url&&(t.external_url=e.external_url),e.poster_file?t.poster_file=e.poster_file:e.external_poster_url&&(t.external_poster_url=e.external_poster_url),e.url&&(t.url=e.url),i.props(t).then(function(e){return r.transform(e,function(e,t,n){e.append(n,t)},new FormData)})},getUrl:function(e){var t=e.schema,n=e.address,r=e.payload_id;switch(e.action){case"image-upload":case"image-copy":n+="/media/images/upload/"+t+"/"+r;break;case"video-copy-transcode":case"video-upload-transcode":n+="/media/videos/upload/"+t+"/"+r;break;case"audio-copy-transcode":case"audio-upload-transcode":n+="/media/audios/upload/"+t+"/"+r;break;case"website-poster-generate":n+="/media/html/screenshot/"+t+"/"+r;break;default:return}return n+="?token="+e.token},stream:function(e){var t=this,n=this.props.route.parameters;return e.id?i.resolve(e.id):new i(function(s,o){var a=0,u=!1,p=0;l.do(function(){return e.pull().then(function(i){var o=n.address+"/media/stream";e.id&&(o+="/"+e.id);var a=new FormData;i?a.append("file",i):u=!0;var l={responseType:"json"};return i&&(l.onUploadProgress=function(n){var s=r.find(t.state.payloads,{stream:e});if(s){var o=n.total?Math.round(i.size*(n.loaded/n.total)):0;t.updatePayloadStatus(s.id,{transferred:p+o,total:e.size})}}),c.fetch("POST",o,a,l).then(function(t){e.id||(e.id=t.id,s(e.id)),i&&(e.finalize(i),p+=i.size)})}).catch(function(t){if(++a<1)return i.delay(5e3);throw e.id||o(t),t})}),l.while(function(){return!u}),l.end().catch(function(t){e.abandon(t)})})},updatePayloadStatus:function(e,t){var n=this,i=r.slice(this.state.payloads),s=r.findIndex(i,{payload_id:e});-1!==s&&(i[s]=r.assign({},i[s],t),this.setState({payloads:i},function(){n.triggerChangeEvent()}))},updateProgress:function(){var e=this,t=this.props.database.use({by:this}),n=r.filter(this.state.payloads,function(e){if(e.address===t.context.address&&100!==e.backendProgress)return!0}),s=r.groupBy(n,"schema"),o=r.keys(s),a=!1;return i.each(o,function(e){var i=s[e],o=r.map(i,"payload_id"),c={id:o};return t.find({table:"task",schema:e,criteria:c}).then(function(e){n=r.map(n,function(t){if(r.includes(i,t)){var n=r.find(e,{id:t.payload_id});if(n&&n.completion!==t.backendProgress){var s=r.clone(t);return s.backendProgress=n.completion,a=!0,s}}return t})})}).then(function(){if(a)return e.setState({payloads:n},function(){e.triggerChangeEvent()}),null})},getUploadProgress:function(){var e=0,t=0;return r.each(this.state.payloads,function(n){var r=n.transferred,i=n.total;0===i&&(n.file?i=n.file.size:n.stream&&(i=n.stream.size)),r<i&&(e++,t+=Math.max(0,i-r))}),e>0?{files:e,bytes:t}:null},render:function(){return null},componentDidUpdate:function(e){!e.database&&this.props.database&&this.triggerChangeEvent(),e.database!==this.props.database&&this.updateProgress()},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})}})},function(e,t,n){"use strict";var r=n(3),i=n(9),s=n(0),o=s.PropTypes,a=n(81),c=n(55);e.exports=s.createClass({displayName:"PushNotifier",propTypes:{serverAddress:o.string,relayAddress:o.string,initialReconnectionDelay:o.number,maximumReconnectionDelay:o.number,onConnect:o.func,onDisconnect:o.func,onNotify:o.func,onAlertClick:o.func},statics:{isAvailable:function(){return!0}},getDefaultProps:function(){return{initialReconnectionDelay:500,maximumReconnectionDelay:3e4}},getInitialState:function(){return{pushNetwork:"fcm",registrationId:"test-id:0000000000000",deviceDetails:{test:1},info:null}},componentDidUpdate:function(e,t){e.serverAddress===this.props.serverAddress&&e.relayAddress===this.props.relayAddress&&t.registrationId===this.state.registrationId||this.props.relayAddress&&this.state.registrationId&&this.register(this.props.relayAddress,this.props.serverAddress,this.state.registrationId)},register:function(e,t,n){var s=this,o=this.registrationAttempt;if(o&&o.relayAddress===e&&o.serverAddress===t&&o.registrationId===n)return o.promise;o=this.registrationAttempt={relayAddress:e,serverAddress:t,registrationId:n},this.setState({info:null,registered:!1});var l=!1,u=this.props.initialReconnectionDelay,p=this.props.maximumReconnectionDelay;return a.do(function(){var a=r.trimEnd(e,"/")+"/register",d={network:s.state.pushNetwork,registration_id:n,details:s.state.deviceDetails,address:t},h={responseType:"json",contentType:"json"};return c.fetch("POST",a,d,h).then(function(e){return o===s.registrationAttempt&&(s.registrationAttempt=null,s.setState({info:r.omit(e,"token"),registered:!0}),s.triggerConnectEvent(e.token)),l=!0,null}).catch(function(t){return u*=2,u>p&&(u=p),console.log("Connection attempt in "+u+"ms: "+e),i.delay(u,null)})}),a.while(function(){return o===s.registrationAttempt&&!l}),a.return(function(){return s.registrationAttempt=null,l}),o.promise=a.end(),o.promise},triggerNotifyEvent:function(e,t){this.props.onNotify&&this.props.onNotify({type:"notify",target:this,address:e,changes:t})},triggerConnectEvent:function(e,t){this.props.onConnect&&this.props.onConnect({type:"connect",target:this,address:e,token:t})},triggerDisconnectEvent:function(){this.props.onDisconnect&&this.props.onDisconnect({type:"disconnect",target:this,address:address})},triggerAlertClickEvent:function(e,t){this.props.onAlertClick&&this.props.onAlertClick({type:"alertclick",target:this,address:e,alert:t})},render:function(){return null}})},function(e,t,n){"use strict";function r(e){return i(e).then(function(e){return new Uint8Array(e)})}function i(e){return new o(function(t,n){var r=new FileReader;r.onload=function(e){t(r.result)},r.onerror=function(e){n(new Error("Unable to load blob"))},r.readAsArrayBuffer(e)})}function s(e){return new o(function(t,n){var r=new FileReader;r.onload=function(e){t(r.result)},r.onerror=function(e){n(new Error("Unable to load blob"))},r.readAsText(e)})}var o=n(9);t.loadUint8Array=r,t.loadArrayBuffer=i,t.loadText=s},function(e,t,n){"use strict";function r(e){var t={},n=i.split(e,/[\r\n]+/);return i.each(n,function(e){var n=/^(\w+)\s*=\s*(.*)/.exec(e);if(n){var r=i.lowerCase(n[1]),s=i.trim(n[2]);t[r]=s}}),console.log(t),t.url?t:null}var i=n(3);t.parse=r},function(e,t,n){"use strict";function r(e){switch(void 0===e?"undefined":i(e)){case"number":return 0;case"string":return s.repeat("x",e.length);case"boolean":return!1;case"object":return e instanceof Array?s.map(e,r):s.mapValues(e,r)}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(3),o={};s.mixin({decouple:function(e,t,n){"string"==typeof t?t=s.split(t,"."):t instanceof Array||(t=[t]),n||(n=o);var r=s.clone(e);r instanceof Object||(r={});for(var i=r,a=e,c=0;c<t.length;c++){var l=t[c],u=a?a[l]:void 0,p=s.clone(u);c===t.length-1?p instanceof n.constructor||(p=n):p instanceof Object||(p={}),i[l]=p,i=p,a=u}return r},decoupleSet:function(e,t,n){if("string"==typeof t?t=s.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var r=s.slice(t,0,-1),i=s.decouple(e,r,{});return s.set(i,t,n),i},decoupleUnset:function(e,t){if("string"==typeof t?t=s.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var n=s.slice(t,0,-1),r=s.decouple(e,n,{});return s.unset(r,t),r},decouplePush:function(e,t){for(var n=s.decouple(e,t,[]),r=s.get(n,t),i=arguments.length,o=Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return Array.prototype.push.apply(r,o),n},shallowDiff:function(e,t){return s.pickBy(e,function(e,n){return t[n]!==e})},obscure:function(e,t){var n=s.cloneDeep(e);return s.each(t,function(e){var t=s.get(n,e);s.set(n,e,r(t))}),n},strictParseInt:function(e){var t=s.parseInt(e);if(t.toString()!==e)throw new Error("Not an integer: "+e);return t}})},function(e,t,n){"use strict";var r=n(3),i=n(0),s=i.PropTypes,o=(n(27),n(294)),a=n(30);n(579),e.exports=i.createClass({displayName:"Chartist",propTypes:{type:s.oneOf(["line","bar","pie"]).isRequired,data:s.object.isRequired,className:s.string,options:s.object,responsiveOptions:s.array,style:s.object,onDraw:s.func},getInitialState:function(){return this.components=a({container:HTMLDivElement}),{}},componentWillReceiveProps:function(e){this.props.onDraw!==e.onDraw&&(this.chartist?this.chartist.off(this.props.onDraw):this.chartist.on(e.onDraw))},render:function(){var e=["ct-chart"];this.props.className&&e.push(this.props.className);var t={ref:this.components.setters.container,className:e.join(" "),style:this.props.style};return i.createElement("div",t)},componentDidUpdate:function(e,t){e.type!==this.props.type?(this.destroyChart(),this.createChart()):e.data===this.props.data&&e.options===this.props.options&&e.responsiveOptions===this.props.responsiveOptions||this.updateChart()},componentDidMount:function(){this.createChart()},createChart:function(){var e=o[r.upperFirst(this.props.type)],t=this.components.container;this.chartist=new e(t,this.props.data,this.props.options,this.props.responsiveOptions),this.props.onDraw&&this.chartist.on("draw",this.props.onDraw)},updateChart:function(){this.chartist.update(this.props.data,this.props.options,this.props.responsiveOptions)},destroyChart:function(){this.chartist&&this.chartist.detach();var e=this.components.container;if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}}),e.exports.Interpolation=o.Interpolation,e.exports.Svg=o.Svg},function(e,t,n){"use strict";function r(e){var t=e.offsetHeight,n=e.getElementsByClassName("collapsible-container");return _.each(n,function(e){if(t-=e.offsetHeight,parseInt(e.style.height)>0){var n=e.children[0];t+=n.offsetHeight}}),t}var i=n(0),s=(i.PropTypes,n(30));n(657),e.exports=i.createClass({displayName:"CollapsibleContainer",propTypes:{open:i.PropTypes.bool},getInitialState:function(){return this.components=s({container:HTMLDivElement,contents:HTMLDivElement}),{contentHeight:void 0,collapsing:!1,expanding:!1}},componentWillReceiveProps:function(e){this.props.open!==e.open&&(e.open?this.setState({collapsing:!1,expanding:!0}):this.setState({collapsing:!0,expanding:!1}))},render:function(){var e=this.components.setters,t={};this.props.open?t.height=this.state.contentHeight:t.height=0;var n="collapsible-container";return this.state.expanding?n+=" expanding":this.state.collapsing&&(n+=" collapsing"),i.createElement("div",{ref:e.container,className:n,style:t},i.createElement("div",{ref:e.contents,className:"collapsible-contents"},this.props.children))},componentDidMount:function(){this.props.open&&this.componentDidUpdate()},componentDidUpdate:function(e,t){var n=r(this.components.contents);this.state.contentHeight!==n&&this.setState({contentHeight:n})}})},function(e,t,n){"use strict";function r(e){if(e<1024)return e+"B";var t=e/1024;if(t<1024)return i.round(t)+"KB";var n=t/1024;if(n<1024)return i.round(n,1)+"MB";var r=n/1024;return i.round(r,2)+"GB"}var i=n(3),s=n(0),o=s.PropTypes,a=n(4),c=n(18);n(659),e.exports=s.createClass({displayName:"UploadProgress",propTypes:{payloads:o.instanceOf(c).isRequired,locale:o.instanceOf(a).isRequired},render:function(){var e=this.props.locale.translate,t=this.props.payloads.uploading;if(!t)return null;var n=r(t.bytes),i=t.files;return s.createElement("div",{className:"upload-progress"},e("upload-progress-uploading-$count-files-$size-remaining",i,n))}})},,,function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"* {\n  box-sizing: border-box;\n  font-family: sans-serif; }\n  *:focus {\n    outline-color: #fca326; }\n\nbody {\n  overflow: hidden; }\n\n.application {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  height: 100%;\n  width: 100%; }\n\n.page-view-port {\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: auto;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  position: relative;\n  background-color: #4d3936; }\n  .page-view-port .scroll-box {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    overflow-y: auto;\n    overflow-x: hidden;\n    z-index: 0;\n    display: flex;\n    flex-direction: column;\n    align-items: center; }\n    .page-view-port .scroll-box::-webkit-scrollbar-track {\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: transparent; }\n    .page-view-port .scroll-box::-webkit-scrollbar {\n      width: 14px;\n      background-color: transparent; }\n    .page-view-port .scroll-box::-webkit-scrollbar-thumb {\n      border-radius: 2px;\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: rgba(0, 0, 0, 0.2); }\n  .page-view-port .contents {\n    width: 100%;\n    max-width: 125em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".app-component-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  width: 80%;\n  max-width: 40em;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #999999;\n  margin: auto;\n  padding: 0.5em 0.5em 0.5em 0.5em; }\n  .app-component-dialog-box .contents {\n    flex-grow: 1;\n    flex-shrink: 1;\n    overflow: auto;\n    padding: 0.5em 0.5em 0.25em 0.5em;\n    margin-bottom: 0.25em; }\n    .app-component-dialog-box .contents .picture {\n      float: left;\n      margin-right: 1em;\n      margin-bottom: 0.5em; }\n      .app-component-dialog-box .contents .picture .icon {\n        display: inline-block;\n        color: #000000;\n        background-color: #fca326;\n        height: 8em;\n        width: 8em;\n        padding-top: 2em;\n        text-align: center; }\n        .app-component-dialog-box .contents .picture .icon .fa {\n          font-size: 4em; }\n      .app-component-dialog-box .contents .picture IMG {\n        width: auto;\n        height: 8em; }\n    .app-component-dialog-box .contents .text H1:first-child,\n    .app-component-dialog-box .contents .text H2:first-child,\n    .app-component-dialog-box .contents .text H3:first-child,\n    .app-component-dialog-box .contents .text H4:first-child,\n    .app-component-dialog-box .contents .text H5:first-child,\n    .app-component-dialog-box .contents .text H6:first-child,\n    .app-component-dialog-box .contents .text P:first-child {\n      margin-top: 0.1em; }\n    .app-component-dialog-box .contents::-webkit-scrollbar-track {\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: transparent; }\n    .app-component-dialog-box .contents::-webkit-scrollbar {\n      width: 10px;\n      background-color: transparent; }\n    .app-component-dialog-box .contents::-webkit-scrollbar-thumb {\n      border-radius: 2px;\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: rgba(0, 0, 0, 0.1); }\n  .app-component-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".confirmation-dialog-box {\n  display: flex;\n  flex-direction: column;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .confirmation-dialog-box .message {\n    font-size: 1.5em;\n    font-weight: bold;\n    padding: 0.5em 0.5em 0.3em 0.5em; }\n  .confirmation-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,'.media-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .media-dialog-box .container {\n    flex: 1 1 auto;\n    display: flex;\n    overflow: hidden;\n    padding-bottom: 0.2em;\n    align-items: center;\n    justify-content: center; }\n    .media-dialog-box .container IMG {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n    .media-dialog-box .container VIDEO {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n  .media-dialog-box .controls {\n    display: block;\n    flex: 1 0 auto;\n    padding: 0.4em 0 0.2em 0;\n    border-top: 1px solid #666666; }\n    .media-dialog-box .controls .links {\n      float: left; }\n    .media-dialog-box .controls .buttons {\n      float: right; }\n    .media-dialog-box .controls:after {\n      content: "";\n      display: table;\n      clear: both; }\n  .media-dialog-box .thumbnail {\n    float: left;\n    margin-right: 0.2em;\n    width: 2em;\n    cursor: pointer;\n    border: 2px solid #333333; }\n    .media-dialog-box .thumbnail:hover, .media-dialog-box .thumbnail.selected {\n      border: 2px solid #e24329; }\n    .media-dialog-box .thumbnail IMG {\n      display: block;\n      width: 100%; }\n',""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".mobile-setup-dialog-box {\n  display: flex;\n  flex-direction: column;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .mobile-setup-dialog-box .contents {\n    padding-bottom: 0.5em; }\n    .mobile-setup-dialog-box .contents .qr-code {\n      float: left;\n      width: 198px;\n      height: 198px; }\n    .mobile-setup-dialog-box .contents .info {\n      overflow: hidden;\n      padding: 0.5em 0.25em 0.25em 0.5em;\n      font-size: 3em; }\n  .mobile-setup-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    border-top: 1px solid #666666;\n    text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".project-description-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 40em;\n  width: 80%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .project-description-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n  .project-description-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n  .project-description-dialog-box .title {\n    font-size: 1.4em;\n    font-weight: bold;\n    margin-bottom: 0.3em; }\n  .project-description-dialog-box .description {\n    margin-top: 0.5em;\n    margin-bottom: 0.5em;\n    white-space: pre-line; }\n    .project-description-dialog-box .description img {\n      float: right;\n      width: 10em;\n      margin-left: 0.5em;\n      margin-bottom: 0.3em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".project-management-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 100%;\n  min-width: 20em;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .project-management-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto;\n    font-size: 1.4em;\n    padding: 0.25em 0.25em 0.25em 0.25em; }\n  .project-management-dialog-box .option-button.selected, .project-management-dialog-box .option-button:hover {\n    color: #ee3333; }\n  .project-management-dialog-box .option-button.disabled {\n    color: #eeeeee;\n    opacity: 0.1; }\n  .project-management-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".telephone-number-dialog-box {\n  display: flex;\n  flex-direction: column;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .telephone-number-dialog-box .contents {\n    padding-bottom: 0.5em; }\n    .telephone-number-dialog-box .contents .qr-code {\n      float: left;\n      width: 198px;\n      height: 198px; }\n    .telephone-number-dialog-box .contents .number {\n      overflow: hidden;\n      padding: 0.5em 0.25em 0.25em 0.5em;\n      font-size: 3em; }\n  .telephone-number-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    border-top: 1px solid #666666;\n    text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".user-selection-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .user-selection-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n  .user-selection-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".audio-editor {\n  position: relative;\n  width: 100%;\n  padding-top: 50%;\n  padding-bottom: 50%; }\n  .audio-editor .graphic {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center; }\n    .audio-editor .graphic .icon {\n      font-size: 8em; }\n    .audio-editor .graphic .duration {\n      font-size: 2em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,'.comment-editor {\n  display: flex;\n  flex-direction: row;\n  padding: 0.1em 0.1em 0.1em 0.1em; }\n  .comment-editor .profile-image-column {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .comment-editor .profile-image-column .profile-image {\n      margin: 0 0.4em 0 0.2em; }\n  .comment-editor .editor-column {\n    flex-grow: 1;\n    flex-shrink: 1; }\n    .comment-editor .editor-column .media {\n      max-width: 300px;\n      padding: 0em 1em 0.25em 1em; }\n    .comment-editor .editor-column .controls .buttons {\n      display: block; }\n      .comment-editor .editor-column .controls .buttons .media-buttons {\n        padding-top: 0.30em;\n        float: left; }\n      .comment-editor .editor-column .controls .buttons .action-buttons {\n        float: right; }\n      .comment-editor .editor-column .controls .buttons:after {\n        content: "";\n        display: table;\n        clear: both; }\n',""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".image-editor {\n  position: relative;\n  width: 100%;\n  padding-top: 50%;\n  padding-bottom: 50%; }\n  .image-editor .image-cropper, .image-editor .preview, .image-editor .placeholder {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%; }\n  .image-editor .preview {\n    cursor: wait;\n    filter: saturate(0%); }\n  .image-editor .placeholder {\n    display: flex;\n    bottom: 0;\n    align-items: center;\n    justify-content: center; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".media-editor {\n  display: flex;\n  position: relative;\n  vertical-align: top;\n  max-width: 600px; }\n  .media-editor.inactive {\n    max-width: none; }\n  .media-editor .navigation {\n    position: absolute;\n    width: 100%;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.75);\n    opacity: 1;\n    transition: opacity .5s; }\n    .media-editor .navigation .left {\n      float: left; }\n    .media-editor .navigation .right {\n      float: right; }\n    .media-editor .navigation.hidden {\n      opacity: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.editor-options .body {\n  margin-left: 0.3em; }\n\n.story-section.editor-options .supplemental {\n  margin-top: 0.5em;\n  padding-top: 0.4em;\n  border-top: 1px dotted #404040; }\n\n.editor-options.in-menu .main {\n  max-width: 20em; }\n\n.editor-options.in-menu .supplemental {\n  max-width: 20em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.media-preview {\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n  .story-section.media-preview .header {\n    flex-grow: 0;\n    flex-shrink: 1; }\n  .story-section.media-preview .body {\n    flex-grow: 1;\n    flex-shrink: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    position: relative; }\n    .story-section.media-preview .body .drop-zone {\n      position: relative;\n      width: 100%;\n      flex: 1 1 auto;\n      text-align: center; }\n      .story-section.media-preview .body .drop-zone .media-editor.inactive {\n        position: absolute;\n        left: 0;\n        top: 0;\n        right: 0;\n        bottom: 0; }\n        .story-section.media-preview .body .drop-zone .media-editor.inactive .placeholder {\n          position: absolute;\n          left: 1em;\n          top: 1em;\n          right: 1em;\n          bottom: 1em;\n          border: 2px dashed rgba(127, 127, 127, 0.15); }\n          .story-section.media-preview .body .drop-zone .media-editor.inactive .placeholder .message {\n            position: absolute;\n            left: 0;\n            top: 0;\n            right: 0;\n            bottom: 0;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            color: #666666;\n            margin: auto;\n            user-select: none;\n            cursor: default;\n            opacity: 0;\n            animation: fadeInAndOut 30s normal forwards; }\n\n@keyframes fadeInAndOut {\n  0% {\n    opacity: 0; }\n  15% {\n    opacity: 1; }\n  30% {\n    opacity: 0; }\n  100% {\n    opacity: 0; } }\n\n.columns-1 .story-section.media-preview .body {\n  padding: 0; }\n  .columns-1 .story-section.media-preview .body .placeholder {\n    display: none; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.text-editor .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.story-section.text-editor .header .name {\n  color: #eeeeee; }\n\n.story-section.text-editor .subheader .button {\n  font-size: 0.9em;\n  color: #666666;\n  cursor: pointer; }\n  .story-section.text-editor .subheader .button .label {\n    margin-left: 0.2em; }\n  .story-section.text-editor .subheader .button:hover {\n    color: #eeeeee; }\n\n.story-section.text-editor .body .autosize-text-area {\n  margin-left: calc(0.3em - 1px);\n  margin-right: calc(0.3em - 1px); }\n  .story-section.text-editor .body .autosize-text-area TEXTAREA {\n    font-size: 1em;\n    min-height: 5em;\n    max-height: 50vh;\n    background-color: #eeeeee;\n    border: 1px inset #666666; }\n\n.story-section.text-editor .footer {\n  text-align: right; }\n\n.columns-1 .story-section.text-editor .body .autosize-text-area TEXTAREA {\n  min-height: 1.2em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".image-editor .video-duration {\n  position: absolute;\n  top: 0.5em;\n  right: 0.5em;\n  opacity: 0.5;\n  pointer-events: none;\n  color: #ffffff; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".comment-list .scrollable {\n  display: flex;\n  flex-direction: column-reverse;\n  padding-right: 0.25em;\n  max-height: 12em; }\n\n.comment-list .comment-view, .comment-list .comment-editor {\n  flex-grow: 0;\n  flex-shrink: 0; }\n\n.story-view.columns-2 .column-2, .story-view.columns-3 .column-2 {\n  position: relative; }\n\n.story-view.columns-2 .story-section.comments, .story-view.columns-3 .story-section.comments {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column; }\n  .story-view.columns-2 .story-section.comments .header, .story-view.columns-3 .story-section.comments .header {\n    flex-grow: 0;\n    flex-shrink: 0; }\n  .story-view.columns-2 .story-section.comments .body, .story-view.columns-3 .story-section.comments .body {\n    flex-grow: 1;\n    flex-shrink: 1;\n    display: flex;\n    flex-direction: column; }\n    .story-view.columns-2 .story-section.comments .body .comment-list, .story-view.columns-3 .story-section.comments .body .comment-list {\n      flex-grow: 1;\n      flex-shrink: 1;\n      width: 100%;\n      display: flex;\n      flex-direction: column; }\n      .story-view.columns-2 .story-section.comments .body .comment-list .scrollable, .story-view.columns-3 .story-section.comments .body .comment-list .scrollable {\n        flex-grow: 0;\n        flex-shrink: 1;\n        max-height: none; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".notification-list {\n  padding-top: 0.5em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".user-selection-list {\n  min-width: 14em;\n  padding-bottom: 0.1em; }\n  .user-selection-list .user {\n    position: relative;\n    cursor: pointer;\n    padding: 0.2em 0.2em 0.2em 0.2em;\n    filter: grayscale(50%); }\n    .user-selection-list .user .name {\n      margin-left: 0.2em;\n      margin-right: 2em;\n      vertical-align: middle; }\n    .user-selection-list .user .fa {\n      position: absolute;\n      right: 0.3em;\n      top: 0;\n      bottom: 0;\n      margin: auto;\n      height: 1em;\n      font-size: 1.2em;\n      color: #e24329;\n      opacity: 0;\n      transition: opacity 0.5s;\n      vertical-align: middle; }\n    .user-selection-list .user:hover {\n      color: #cccccc;\n      filter: none; }\n    .user-selection-list .user.selected {\n      background-color: #211a1a;\n      color: #eeeeee;\n      filter: none; }\n      .user-selection-list .user.selected .fa {\n        opacity: 1; }\n    .user-selection-list .user.disabled {\n      cursor: default; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".error-page {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 20vh;\n  color: #ffffff; }\n  .error-page .text {\n    max-width: 25em;\n    line-height: 135%;\n    margin-left: 1em;\n    margin-right: 1em; }\n    .error-page .text h1 {\n      text-align: center; }\n  .error-page .graphic {\n    margin-left: 3em;\n    margin-right: 1em; }\n    .error-page .graphic svg {\n      width: 100%;\n      max-width: 20em; }\n      .error-page .graphic svg polygon {\n        fill: #ffffff; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-page .panels {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  margin: auto;\n  padding: 1em 1em 1em 1em;\n  column-fill: balance;\n  column-width: 25em;\n  column-gap: 1em;\n  max-width: 110em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.language .option-button {\n  margin-top: 0.35em;\n  margin-bottom: 0.35em; }\n  .settings-section.language .option-button SELECT {\n    color: #666666;\n    background-color: #4d3936;\n    border: 0;\n    padding: 2px;\n    margin-left: 0.5em;\n    margin-top: -3px;\n    margin-bottom: -3px; }\n    .settings-section.language .option-button SELECT:hover, .settings-section.language .option-button SELECT:focus {\n      color: #eeeeee;\n      background-color: #806666; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.mobile-alert .option-button {\n  margin: 0.35em 0 0.35em 0.125em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.notification .option-button {\n  margin: 0.35em 0 0.35em 0.125em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.project .body {\n  padding-left: 0.5em; }\n\n.settings-section.project .project-option-button {\n  display: table;\n  width: 100%;\n  color: #666666;\n  margin-top: 0.35em;\n  margin-bottom: 0.35em;\n  cursor: pointer; }\n  .settings-section.project .project-option-button.selected, .settings-section.project .project-option-button:hover {\n    color: #eeeeee; }\n  .settings-section.project .project-option-button.selected {\n    cursor: default; }\n  .settings-section.project .project-option-button .icon {\n    display: table-cell;\n    width: 1em;\n    padding-right: 0.25em;\n    font-size: 1.4em; }\n  .settings-section.project .project-option-button .text {\n    display: table-cell; }\n    .settings-section.project .project-option-button .text .name {\n      font-size: 1.4em; }\n    .settings-section.project .project-option-button .text .supplemental {\n      margin-top: 0.5em;\n      margin-bottom: 0.15em; }\n      .settings-section.project .project-option-button .text .supplemental .item {\n        margin-bottom: 0.35em; }\n        .settings-section.project .project-option-button .text .supplemental .item .button {\n          color: #999999;\n          cursor: pointer; }\n          .settings-section.project .project-option-button .text .supplemental .item .button:hover {\n            color: #eeeeee; }\n          .settings-section.project .project-option-button .text .supplemental .item .button .fa {\n            margin-right: 0.15em; }\n          .settings-section.project .project-option-button .text .supplemental .item .button .label {\n            font-size: 0.9em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.user-image .no-image {\n  position: relative;\n  background-color: #999999;\n  width: 100%;\n  padding-top: 50%;\n  padding-bottom: 50%; }\n  .settings-section.user-image .no-image svg {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    height: 80%;\n    margin: auto; }\n\n.settings-section.user-image .buttons {\n  overflow: hidden;\n  padding-bottom: 0.15em; }\n  .settings-section.user-image .buttons .left {\n    float: left; }\n    .settings-section.user-image .buttons .left .push-button {\n      margin-left: 0; }\n  .settings-section.user-image .buttons .right {\n    float: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.user-info .gender-selector {\n  margin-bottom: 0.35em; }\n  .settings-section.user-info .gender-selector LABEL {\n    display: block;\n    font-size: 0.9em; }\n  .settings-section.user-info .gender-selector SELECT {\n    width: 100%;\n    overflow-y: auto;\n    margin-top: 3px;\n    font-size: 1em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section.web-alert .option-button {\n  margin: 0.35em 0 0.35em 0.125em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".app-component {\n  display: flex;\n  flex-direction: row;\n  border: 1px solid #211a1a;\n  margin-top: 0.3em;\n  margin-right: 0.1em;\n  background-color: #cccccc;\n  cursor: pointer; }\n  .app-component:first-child {\n    margin-top: 0; }\n  .app-component .picture {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .app-component .picture .icon {\n      display: inline-block;\n      color: #000000;\n      background-color: #fca326;\n      height: 4em;\n      width: 4em;\n      padding-top: 1em;\n      text-align: center; }\n      .app-component .picture .icon .fa {\n        font-size: 2em; }\n    .app-component .picture IMG {\n      display: block;\n      width: auto;\n      height: 4em; }\n  .app-component .text {\n    flex-grow: 1;\n    flex-shrink: 1;\n    color: #333333;\n    font-size: 1em;\n    margin: 0.25em 0.25em 0 0.40em;\n    overflow: hidden;\n    height: calc(3em + 9px); }\n    .app-component .text .text-contents {\n      width: calc(100% - 1em);\n      position: relative;\n      display: block;\n      max-height: 4em; }\n      .app-component .text .text-contents .ellipsis {\n        position: absolute;\n        right: -1em;\n        top: calc(6em + 6px - 100%);\n        text-align: left; }\n      .app-component .text .text-contents H1, .app-component .text .text-contents H2, .app-component .text .text-contents H3, .app-component .text .text-contents H4, .app-component .text .text-contents H5 {\n        font-size: 1em;\n        margin-top: 0;\n        margin-bottom: 0.2em; }\n      .app-component .text .text-contents P {\n        margin-top: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".bookmark-view {\n  border: 2px solid #111;\n  background-color: #111;\n  margin: 1em 1em 1em 1em; }\n  .bookmark-view .title {\n    color: #eeeeee; }\n    .bookmark-view .title .name {\n      display: inline-block;\n      padding: 0.2em 0.1em 0.4em 0.4em;\n      font-size: 0.9em; }\n    .bookmark-view .title .close-btn {\n      display: inline-block;\n      float: right;\n      padding: 0.2em 0.3em 0.2em 0.3em;\n      cursor: pointer; }\n  .bookmark-view .contents {\n    clear: both; }\n    .bookmark-view .contents .story-view {\n      margin: 0;\n      border: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".comment-view-options .button {\n  color: #666666;\n  padding-left: 0.5em;\n  padding-right: 0.25em;\n  opacity: 0.2; }\n  .comment-view-options .button.active {\n    opacity: 1; }\n    .comment-view-options .button.active:hover {\n      color: #eeeeee; }\n\n.comment-view-options .container {\n  right: 0.5em;\n  top: 1.25em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".comment-view {\n  display: flex;\n  flex-direction: row;\n  padding: 0.1em 0.1em 0.1em 0.1em;\n  margin-right: -0.5em; }\n  .comment-view .profile-image-column {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .comment-view .profile-image-column .profile-image {\n      margin: 0 0.4em 0 0.2em; }\n  .comment-view .contents-column {\n    flex-grow: 1;\n    flex-shrink: 1; }\n    .comment-view .contents-column .text {\n      padding: 0.25em 0.25em 0.25em 0; }\n      .comment-view .contents-column .text .comment.markdown IMG, .comment-view .contents-column .text .comment.markdown CANVAS {\n        height: 1.5em;\n        vertical-align: middle;\n        cursor: pointer; }\n      .comment-view .contents-column .text .note:link, .comment-view .contents-column .text .note:visited, .comment-view .contents-column .text .issue-assignment:link, .comment-view .contents-column .text .issue-assignment:visited {\n        color: #cccccc;\n        text-decoration: none;\n        cursor: pointer; }\n      .comment-view .contents-column .text .note:hover, .comment-view .contents-column .text .issue-assignment:hover {\n        color: #ffffff; }\n      .comment-view .contents-column .text .in-progress {\n        color: #666666; }\n    .comment-view .contents-column .comment-view-options {\n      float: right; }\n    .comment-view .contents-column .time {\n      display: block;\n      float: right;\n      color: #666666;\n      font-size: 0.9em;\n      margin-bottom: 0.5em;\n      margin-left: 0.5em; }\n    .comment-view .contents-column .media {\n      padding: 0.5em 1em 1em 1em;\n      max-width: 300px; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".media-view {\n  position: relative; }\n  .media-view IMG, .media-view CANVAS {\n    display: block;\n    width: 100%;\n    height: auto; }\n  .media-view .image, .media-view .video, .media-view .audio, .media-view .website {\n    cursor: pointer; }\n  .media-view .overlay {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    z-index: 0; }\n    .media-view .overlay .icon {\n      font-size: 10em; }\n    .media-view .overlay .duration {\n      font-size: 2em; }\n    .media-view .overlay.hidden {\n      opacity: 0; }\n      .media-view .overlay.hidden:hover {\n        opacity: 0.5; }\n  .media-view .website A {\n    display: block; }\n    .media-view .website A:link, .media-view .website A:visited {\n      color: #000000; }\n  .media-view .audio {\n    padding-top: 50%;\n    padding-bottom: 50%;\n    background-color: #111111; }\n  .media-view .navigation {\n    position: absolute;\n    width: 100%;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5); }\n    .media-view .navigation .left {\n      float: left; }\n    .media-view .navigation .right {\n      float: right; }\n  .media-view audio {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,'.notification-view {\n  display: block;\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  margin: 0.5em 1em 0.5em 1em;\n  padding: 0.4em 0.4em 0.3em 0.4em;\n  color: #666666;\n  cursor: pointer; }\n  .notification-view .event {\n    float: left; }\n    .notification-view .event .profile-image {\n      margin: 0 0.4em 0 0; }\n    .notification-view .event .text {\n      vertical-align: middle; }\n  .notification-view .date {\n    float: right;\n    margin: 0.1em 0 0 2em;\n    color: #666666; }\n    .notification-view .date .time {\n      vertical-align: middle; }\n    .notification-view .date .fa {\n      margin-left: 0.4em; }\n  .notification-view.unread {\n    color: #eeeeee; }\n    .notification-view.unread .date {\n      color: #eeeeee; }\n  .notification-view:after {\n    content: "";\n    display: table;\n    clear: both; }\n\n.notification-view.columns-1 {\n  margin: 0.5em 0.5em 0.5em 0.5em; }\n',""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.comments .header .show-btn {\n  float: right; }\n\n.story-section.comments .body {\n  padding: 0.2em 0.2em 0.2em 0.2em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.contents .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.story-section.contents .header .name {\n  color: #eeeeee; }\n\n.story-section.contents .subheader .time, .story-section.contents .subheader .status {\n  color: #666666;\n  font-size: 0.9em; }\n\n.story-section.contents .subheader .time.today {\n  color: #aaaaaa; }\n\n.story-section.contents .subheader .time.yesterday {\n  color: #999999; }\n\n.story-section.contents .subheader .graphic {\n  float: right; }\n  .story-section.contents .subheader .graphic svg {\n    fill: #211a1a;\n    margin-top: 0.2em;\n    height: 3em; }\n\n.story-section.contents .body .text {\n  padding-left: 0.3em; }\n  .story-section.contents .body .text A:link, .story-section.contents .body .text A:visited {\n    text-decoration: none;\n    color: #cccccc; }\n  .story-section.contents .body .text A:hover {\n    color: #ffffff; }\n  .story-section.contents .body .text .status-opened, .story-section.contents .body .text .status-reopened {\n    color: #99ff66; }\n  .story-section.contents .body .text .status-closed {\n    color: #ff3333; }\n  .story-section.contents .body .text .tag {\n    font-size: 0.9em;\n    color: #ffffff;\n    background-color: #444444;\n    padding: 0.2em 0.4em 0.2em 0.4em;\n    border-radius: 0.25em; }\n  .story-section.contents .body .text.plain-text {\n    white-space: pre-wrap; }\n    .story-section.contents .body .text.plain-text .list-item.vote-count {\n      width: 100%; }\n  .story-section.contents .body .text.markdown IMG, .story-section.contents .body .text.markdown CANVAS {\n    vertical-align: top;\n    height: 1.5em;\n    cursor: pointer; }\n  .story-section.contents .body .text.survey .list-item, .story-section.contents .body .text.survey .vote-count, .story-section.contents .body .text.task-list .list-item, .story-section.contents .body .text.task-list .vote-count {\n    margin-bottom: 0.2em; }\n    .story-section.contents .body .text.survey .list-item H1, .story-section.contents .body .text.survey .list-item H2, .story-section.contents .body .text.survey .list-item H3, .story-section.contents .body .text.survey .list-item H4, .story-section.contents .body .text.survey .list-item H5, .story-section.contents .body .text.survey .list-item H6, .story-section.contents .body .text.survey .vote-count H1, .story-section.contents .body .text.survey .vote-count H2, .story-section.contents .body .text.survey .vote-count H3, .story-section.contents .body .text.survey .vote-count H4, .story-section.contents .body .text.survey .vote-count H5, .story-section.contents .body .text.survey .vote-count H6, .story-section.contents .body .text.task-list .list-item H1, .story-section.contents .body .text.task-list .list-item H2, .story-section.contents .body .text.task-list .list-item H3, .story-section.contents .body .text.task-list .list-item H4, .story-section.contents .body .text.task-list .list-item H5, .story-section.contents .body .text.task-list .list-item H6, .story-section.contents .body .text.task-list .vote-count H1, .story-section.contents .body .text.task-list .vote-count H2, .story-section.contents .body .text.task-list .vote-count H3, .story-section.contents .body .text.task-list .vote-count H4, .story-section.contents .body .text.task-list .vote-count H5, .story-section.contents .body .text.task-list .vote-count H6 {\n      display: inline-block;\n      margin-top: 0;\n      margin-bottom: 0; }\n    .story-section.contents .body .text.survey .list-item:last-child, .story-section.contents .body .text.survey .vote-count:last-child, .story-section.contents .body .text.task-list .list-item:last-child, .story-section.contents .body .text.task-list .vote-count:last-child {\n      margin-bottom: 0; }\n  .story-section.contents .body .text.survey .vote-count .label {\n    display: block;\n    margin-bottom: 0.1em; }\n  .story-section.contents .body .text.survey .vote-count .bar {\n    display: block;\n    position: relative;\n    border: 1px solid #aaaaaa;\n    font-size: 0.8em;\n    height: 1.5em;\n    margin-bottom: 0.4em; }\n    .story-section.contents .body .text.survey .vote-count .bar .percent {\n      position: absolute;\n      display: block;\n      left: 0.2em;\n      top: 0.1em;\n      color: #333333; }\n    .story-section.contents .body .text.survey .vote-count .bar .count {\n      position: absolute;\n      display: block;\n      right: 0.2em;\n      top: 0.1em;\n      color: #cccccc; }\n    .story-section.contents .body .text.survey .vote-count .bar .filled {\n      display: block;\n      position: absolute;\n      left: 0;\n      top: 0;\n      bottom: 0; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-0 {\n        background-color: #d70206; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-1 {\n        background-color: #f05b4f; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-2 {\n        background-color: #f4c63d; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-3 {\n        background-color: #d17905; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-4 {\n        background-color: #59922b; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-5 {\n        background-color: #f05b4f; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-6 {\n        background-color: #dda458; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-7 {\n        background-color: #eacf7d; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-8 {\n        background-color: #b2c326; }\n      .story-section.contents .body .text.survey .vote-count .bar .filled.color-9 {\n        background-color: #6188e2; }\n  .story-section.contents .body .text.milestone .start-date {\n    color: #99ff66; }\n  .story-section.contents .body .text.milestone .due-date {\n    color: #ff3333; }\n  .story-section.contents .body .text.push .files, .story-section.contents .body .text.push .lines {\n    display: inline-block;\n    list-style-type: none;\n    vertical-align: top;\n    margin: 0;\n    padding: 0; }\n    .story-section.contents .body .text.push .files .added, .story-section.contents .body .text.push .lines .added {\n      color: #99ee66; }\n    .story-section.contents .body .text.push .files .deleted, .story-section.contents .body .text.push .lines .deleted {\n      color: #ee3333; }\n    .story-section.contents .body .text.push .files .modified, .story-section.contents .body .text.push .lines .modified {\n      color: #66aaff; }\n    .story-section.contents .body .text.push .files .renamed, .story-section.contents .body .text.push .lines .renamed {\n      color: #eeee66; }\n  .story-section.contents .body .text.push .files {\n    margin-right: 2em; }\n\n.story-section.contents .body .impact .message {\n  padding-left: 0.3em; }\n\n.story-section.contents .body .impact .scrollable {\n  margin: -0.3em 0.2em 0.3em 0.3em;\n  max-height: 15em; }\n\n.story-section.contents .footer .buttons {\n  text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section.view-options .body {\n  margin-left: 0.3em; }\n\n.view-options.in-menu .main {\n  width: 15em; }\n\n.view-options.in-menu .supplemental {\n  width: 15em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-view {\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  margin: 1em 1em 1em 1em; }\n\n.story-view.columns-1 {\n  margin: 0.8em 0.5em 0.8em 0.5em; }\n\n.story-view.columns-2 {\n  display: flex;\n  flex-direction: row; }\n  .story-view.columns-2 .column-1 {\n    flex: 1; }\n  .story-view.columns-2 .column-2 {\n    flex: 1; }\n\n.story-view.columns-3 {\n  display: flex;\n  flex-direction: row; }\n  .story-view.columns-3 .column-1 {\n    flex: 5; }\n  .story-view.columns-3 .column-2 {\n    flex: 5; }\n  .story-view.columns-3 .column-3 {\n    flex: 5; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".ct-chart {\n  height: 12.8em; }\n  .ct-chart .ct-label {\n    color: #999999; }\n  .ct-chart .ct-grids line {\n    stroke: #444444; }\n\n.user-section.statistics .legend {\n  text-align: right;\n  font-size: 0.8em; }\n  .user-section.statistics .legend .item {\n    display: inline-block;\n    white-space: nowrap;\n    margin-left: 0.6em; }\n    .user-section.statistics .legend .item .ct-chart-bar {\n      width: 0.8em;\n      height: 0.8em;\n      vertical-align: middle;\n      margin-right: 0.3em; }\n    .user-section.statistics .legend .item .label {\n      vertical-align: middle; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".user-section.summary .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.user-section.summary .header .roles {\n  color: #eeeeee; }\n\n.user-section.summary .subheader .name {\n  font-size: 1.5em;\n  margin-top: 0.4em;\n  margin-bottom: 0.2em;\n  color: #eeeeee; }\n\n.user-section.summary .subheader .tag {\n  margin-top: 0.2em;\n  margin-bottom: 0.4em;\n  color: #666666;\n  display: inline-block; }\n\n.user-section.summary .body {\n  clear: both; }\n  .user-section.summary .body .activity {\n    margin-bottom: 0.15em; }\n    .user-section.summary .body .activity .time {\n      float: right;\n      color: #666666;\n      font-size: 0.9em; }\n\n.user-section.summary .footer {\n  padding-top: 0.6em;\n  text-align: right; }\n\n.user-section.summary A {\n  color: #999999;\n  cursor: pointer; }\n  .user-section.summary A:link, .user-section.summary A:visited {\n    color: #999999;\n    text-decoration: none; }\n  .user-section.summary A:hover {\n    color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".view-options.in-menu .main {\n  max-width: 20em; }\n\n.view-options.in-menu .supplemental {\n  max-width: 20em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".bottom-navigation {\n  flex-grow: 0;\n  flex-shrink: 0;\n  flex-basis: auto;\n  display: flex;\n  align-items: flex-start;\n  transition: height 0.7s;\n  z-index: 2; }\n  .bottom-navigation .container {\n    display: flex;\n    flex-direction: row;\n    background-color: #262626;\n    border-top: 1px solid #323232;\n    padding-left: 4px;\n    padding-right: 4px;\n    width: 100%; }\n  .bottom-navigation .button {\n    display: block;\n    flex: 1 1 auto;\n    text-align: center;\n    padding: 6px 6px 6px 6px;\n    cursor: pointer;\n    color: #888888; }\n    .bottom-navigation .button:link, .bottom-navigation .button:visited {\n      color: #888888;\n      text-decoration: none; }\n    .bottom-navigation .button:hover, .bottom-navigation .button:hover .label {\n      color: #eeeeee; }\n    .bottom-navigation .button.active, .bottom-navigation .button.active .label {\n      color: #ffffff; }\n    .bottom-navigation .button .fa {\n      font-size: 1.4em; }\n    .bottom-navigation .button .label {\n      font-size: 0.8em;\n      vertical-align: 0.2em;\n      color: #666666; }\n    .bottom-navigation .button .badge {\n      position: relative; }\n      .bottom-navigation .button .badge .number {\n        position: absolute;\n        color: #111111;\n        background-color: #fca326;\n        font-size: 0.6em;\n        border-radius: 2em;\n        padding: 0.10em 0.5em 0.2em 0.5em;\n        left: 0.25em;\n        top: -0.5em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".calendar-bar {\n  padding: 4px 4px 4px 4px;\n  overflow-x: auto;\n  white-space: nowrap;\n  display: flex;\n  width: 100%;\n  flex-direction: row-reverse; }\n  .calendar-bar .calendar {\n    flex-grow: 0;\n    flex-shrink: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".calendar {\n  display: inline-block;\n  border-collapse: collapse;\n  border-spacing: 0;\n  direction: ltr;\n  margin-left: 0.2em;\n  margin-right: 0.2em; }\n  .calendar .title TH {\n    font-size: 0.8em;\n    font-weight: bold;\n    color: #999999;\n    border: 1px solid #444444;\n    padding: 0.25em 0.1em 0.2em 0.1em; }\n  .calendar .headings TH {\n    font-size: 0.6em;\n    font-weight: normal;\n    color: #999999;\n    border: 1px solid #444444;\n    padding: 0.2em 0 0.2em 0; }\n  .calendar .headings TH.weekend {\n    background-color: #333333; }\n  .calendar .dates TD {\n    width: 1.6em;\n    height: 1.4em;\n    font-size: 0.8em;\n    color: #666666;\n    text-align: center;\n    border: 1px solid #444444;\n    cursor: default; }\n    .calendar .dates TD A:link, .calendar .dates TD A:visited {\n      text-decoration: none;\n      color: #cccccc; }\n  .calendar .dates TD.weekend {\n    background-color: #333333; }\n  .calendar .dates TD.today {\n    color: #ffffff;\n    background-color: #000000; }\n    .calendar .dates TD.today A:link, .calendar .dates TD.today A:visited {\n      color: #ffffff; }\n  .calendar .dates TD.selected {\n    color: #000000;\n    background-color: #eeeeee; }\n    .calendar .dates TD.selected A:link, .calendar .dates TD.selected A:visited {\n      color: #000000; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".corner-pop-up {\n  float: right; }\n  .corner-pop-up .button {\n    color: #eeeeee; }\n    .corner-pop-up .button:hover {\n      color: #666666; }\n  .corner-pop-up .container {\n    right: 0.3em;\n    top: 1.5em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".drop-zone {\n  position: relative; }\n  .drop-zone .overlay {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    border: 3px solid #fca326; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".duration-indiactor .icon {\n  color: #eeeeee; }\n  .duration-indiactor .icon.blinking {\n    color: #cc2222;\n    opacity: 1;\n    animation: blinking 0.5s linear infinite; }\n\n@keyframes blinking {\n  50% {\n    opacity: 0; } }\n\n.duration-indiactor .duration {\n  margin-left: 0.5em;\n  color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,'.header-button {\n  display: inline-block;\n  color: #666666;\n  margin-right: 0.5em;\n  cursor: pointer; }\n  .header-button:hover {\n    color: #eeeeee; }\n  .header-button.disabled {\n    cursor: default; }\n    .header-button.disabled:hover {\n      color: #666666; }\n  .header-button.highlighted {\n    color: #e24329; }\n  .header-button .label {\n    font-size: 0.9em;\n    margin-left: 0.3em; }\n  .header-button INPUT[type="file"] {\n    position: absolute;\n    z-index: -50000;\n    width: 1px;\n    height: 1px;\n    top: -1000px; }\n',""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".media-button {\n  display: inline-block;\n  color: #666666;\n  padding: 0.45em 0.1em 0.3em 0.5em;\n  margin-left: 0.2em;\n  margin-right: 0.1em;\n  cursor: pointer; }\n  .media-button:hover {\n    color: #eeeeee; }\n  .media-button.disabled {\n    cursor: default; }\n    .media-button.disabled:hover {\n      color: #666666; }\n  .media-button .label {\n    font-size: 0.9em;\n    margin-left: 0.3em; }\n\n.media-direction {\n  padding: 0.2em 0.3em 0.1em 0.3em; }\n  .media-direction .backward-button, .media-direction .forward-button {\n    display: inline-block;\n    font-size: 1.2em;\n    color: #666666;\n    padding: 0.1em 0.5em 0.1em 0.5em;\n    cursor: pointer;\n    vertical-align: middle; }\n  .media-direction .position {\n    display: inline-block;\n    font-size: 0.9em;\n    vertical-align: middle; }\n  .media-direction:hover .backward-button, .media-direction:hover .forward-button {\n    color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".multiple-user-names {\n  position: relative; }\n  .multiple-user-names .label {\n    cursor: pointer; }\n  .multiple-user-names .popup-container {\n    position: absolute;\n    left: 0.5em;\n    top: 1.5em;\n    width: 100vw;\n    z-index: 500; }\n    .multiple-user-names .popup-container .popup {\n      display: inline-block;\n      border: 1px solid black;\n      padding: 0.3em 0.3em 0.1em 0.3em;\n      background-color: #fff;\n      box-shadow: 2px 2px 2px 0px rgba(0, 0, 0, 0.5); }\n      .multiple-user-names .popup-container .popup .user {\n        margin-bottom: 0.2em; }\n        .multiple-user-names .popup-container .popup .user .name {\n          color: #333;\n          margin-left: 0.2em;\n          vertical-align: middle; }\n        .multiple-user-names .popup-container .popup .user .profile-image {\n          float: none;\n          margin: 0; }\n      .multiple-user-names .popup-container .popup .more {\n        color: #bbb;\n        font-size: 0.8em;\n        text-align: right;\n        border-top: 1px solid #eee; }\n\n.multiple-user-names-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .multiple-user-names-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n    .multiple-user-names-dialog-box .scrollable .list {\n      min-width: 14em;\n      padding-bottom: 0.1em; }\n      .multiple-user-names-dialog-box .scrollable .list .user {\n        margin-bottom: 0.2em; }\n        .multiple-user-names-dialog-box .scrollable .list .user .profile-image {\n          float: none;\n          margin: 0; }\n        .multiple-user-names-dialog-box .scrollable .list .user .name {\n          margin-left: 0.2em;\n          vertical-align: middle; }\n  .multiple-user-names-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".new-items-alert {\n  position: absolute;\n  transition: opacity 0.5s;\n  opacity: 1;\n  right: 3em;\n  top: 2em;\n  padding: 0.75em 0.75em 0.75em 0.75em;\n  color: #111111;\n  background-color: #fca326;\n  cursor: pointer; }\n  .new-items-alert.hide {\n    opacity: 0; }\n  .new-items-alert .fa {\n    margin-right: 0.5em; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".option-button {\n  display: table;\n  width: 100%;\n  color: #666666;\n  margin-bottom: 0.35em;\n  cursor: pointer; }\n  .option-button:link, .option-button:visited {\n    text-decoration: none; }\n  .option-button .fa {\n    display: table-cell;\n    width: 1em;\n    padding-right: 0.25em; }\n  .option-button.selected, .option-button:hover {\n    color: #eeeeee; }\n  .option-button.disabled {\n    color: #666666;\n    opacity: 0.25;\n    cursor: default; }\n  .option-button .label {\n    display: table-cell; }\n\n.in-menu .option-button.selected, .in-menu .option-button:hover {\n  color: #000000; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".pop-up-menu {\n  position: relative; }\n  .pop-up-menu .button.active {\n    cursor: pointer; }\n  .pop-up-menu .container {\n    position: absolute;\n    width: 50vw;\n    right: 0;\n    top: 1em;\n    z-index: 1000;\n    text-align: right; }\n    .pop-up-menu .container .menu {\n      display: inline-block;\n      border: 1px solid black;\n      padding: 0.5em 0.5em 0.5em 0.5em;\n      background-color: #eeeeee;\n      box-shadow: 3px 3px 3px 0px rgba(0, 0, 0, 0.75);\n      text-align: left; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".profile-image {\n  vertical-align: middle; }\n  .profile-image.small {\n    width: 1.5em;\n    height: 1.5em; }\n  .profile-image.medium {\n    width: 3em;\n    height: 3em; }\n  .profile-image.large {\n    width: 6em;\n    height: 6em; }\n\nsvg.profile-image {\n  background-color: #999999; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,'.push-button {\n  min-width: 5em;\n  margin-left: 0.4em;\n  margin-bottom: 0.1em;\n  padding: 0.4em 1em 0.4em 1em;\n  color: #666666;\n  font-size: 0.9em;\n  background-color: #4d3936;\n  border: 2px solid #4d3936; }\n  .push-button:not(:disabled).emphasized, .push-button:not(:disabled):hover, .push-button:not(:disabled):active {\n    color: #eeeeee;\n    background-color: #806666;\n    border: 2px solid #806666; }\n  .push-button:not(:disabled):active {\n    border: 2px inset #333333; }\n  .push-button INPUT[type="file"] {\n    position: absolute;\n    z-index: -50000;\n    width: 1px;\n    height: 1px;\n    top: -1000px; }\n',""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".role-filter-bar {\n  padding: 4px 4px 4px 4px;\n  overflow-x: auto;\n  white-space: nowrap; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".role-filter-button {\n  display: inline-block;\n  margin-right: 0.5em;\n  vertical-align: top;\n  cursor: pointer; }\n  .role-filter-button .contents {\n    position: relative;\n    border: 1px solid #444444;\n    margin: 1px;\n    overflow: hidden; }\n    .role-filter-button .contents .row {\n      width: 12em;\n      height: 3em; }\n      .role-filter-button .contents .row .profile-image {\n        display: inline-block; }\n    .role-filter-button .contents .band {\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      left: 0;\n      right: 0;\n      top: 3em;\n      background-color: #1a1a1a;\n      color: #eeeeee;\n      padding: 0.25em 0.25em 0.25em 0.25em;\n      min-height: 3em; }\n      .role-filter-button .contents .band .title {\n        width: 100%;\n        text-align: center;\n        line-height: 1.25em; }\n        .role-filter-button .contents .band .title .user-count {\n          float: right;\n          line-height: 0.5em;\n          padding-top: 0.2em; }\n          .role-filter-button .contents .band .title .user-count .number {\n            font-size: 0.6em;\n            vertical-align: -2px;\n            margin-left: 2px; }\n  .role-filter-button.selected .contents {\n    border: 2px solid #eeeeee;\n    margin: 0; }\n  .role-filter-button.selected .band {\n    background-color: #eeeeee;\n    color: #000000; }\n  .role-filter-button.no-roles {\n    cursor: default; }\n    .role-filter-button.no-roles .message {\n      color: #444444;\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: center;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".scrollable {\n  overflow-y: auto;\n  overflow-x: hidden; }\n  .scrollable::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: transparent; }\n  .scrollable::-webkit-scrollbar {\n    width: 10px;\n    background-color: transparent; }\n  .scrollable::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: rgba(0, 0, 0, 0.1); }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".search-bar {\n  padding: 4px 9px 8px 4px;\n  text-align: right; }\n  .search-bar label {\n    color: #999999;\n    margin-right: 0.35em; }\n  .search-bar input {\n    font-size: 1em;\n    min-width: 20em;\n    max-width: 40em;\n    width: 28%;\n    color: #eeeeee;\n    background-color: #333333;\n    border: 1px inset #444444;\n    padding: 4px 3px 3px 3px; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".settings-section {\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  width: 100%;\n  max-width: 25em;\n  break-inside: avoid-column;\n  margin-bottom: 1em; }\n  .settings-section .header {\n    font-size: 1.2em;\n    color: #eeeeee;\n    background-color: #211a1a;\n    padding: 0.5em 0.5em 0.4em 0.5em; }\n    .settings-section .header .fa {\n      margin-right: 0.2em; }\n  .settings-section .body {\n    color: #cccccc;\n    padding: 0.35em 0.35em 0.35em 0.35em;\n    clear: both; }\n  .settings-section .footer {\n    padding: 0.15em 0.35em 0.25em 0.35em;\n    text-align: right;\n    clear: both; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".story-section {\n  margin: 0 0 0 0; }\n  .story-section .header {\n    background-color: #211a1a;\n    padding: 0.5em 0.5em 0.4em 0.5em; }\n  .story-section .subheader {\n    padding: 0.25em 0.5em 0.1em 0.5em; }\n  .story-section .body {\n    color: #cccccc;\n    padding: 0.2em 0.2em 0.2em 0.2em;\n    clear: left; }\n  .story-section .footer {\n    padding: 0.0em 0.5em 0.4em 0.5em;\n    clear: both; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".text-field {\n  margin-top: 0.35em;\n  margin-bottom: 0.35em; }\n  .text-field label {\n    display: block;\n    font-size: 0.9em; }\n  .text-field input[type=text],\n  .text-field input[type=password],\n  .text-field input[type=email],\n  .text-field textarea {\n    display: block;\n    width: 100%;\n    margin-top: 3px;\n    font-size: 1em; }\n  .text-field textarea {\n    resize: none; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".top-navigation {\n  flex-grow: 0;\n  flex-shrink: 0;\n  flex-basis: auto;\n  display: flex;\n  align-items: flex-end;\n  transition: height 0.7s;\n  z-index: 2; }\n  .top-navigation .container {\n    background-color: #262626;\n    border-bottom: 1px solid #171717;\n    padding-left: 4px;\n    padding-right: 4px;\n    width: 100%; }\n    .top-navigation .container .collapsible-container {\n      clear: both; }\n  .top-navigation .button {\n    font-size: 1.4em;\n    width: 1.8em;\n    text-align: center;\n    padding: 6px 6px 6px 6px;\n    cursor: pointer;\n    color: #888888; }\n    .top-navigation .button:hover {\n      color: #cccccc; }\n    .top-navigation .button.active {\n      color: #eeeeee; }\n    .top-navigation .button.disabled {\n      color: #333333;\n      cursor: not-allowed; }\n    .top-navigation .button.calendar-btn, .top-navigation .button.filter-btn {\n      float: left; }\n    .top-navigation .button.search-btn {\n      float: right; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".user-section .header {\n  background-color: #211a1a;\n  padding: 0.5em 0.5em 0.4em 0.5em; }\n\n.user-section .subheader {\n  padding: 0.25em 0.5em 0.1em 0.5em; }\n\n.user-section .body {\n  color: #cccccc;\n  padding: 0.2em 0.2em 0.2em 0.2em;\n  clear: body; }\n\n.user-section .footer {\n  padding: 0.0em 0.5em 0.4em 0.5em;\n  clear: both; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".image-cropper {\n  overflow: hidden; }\n  .image-cropper CANVAS {\n    width: 100%;\n    display: block; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".autosize-text-area {\n  position: relative; }\n  .autosize-text-area TEXTAREA {\n    width: 100%;\n    resize: vertical; }\n  .autosize-text-area .shadow {\n    position: absolute;\n    top: 0;\n    left: 0;\n    min-height: 1em !important;\n    max-height: 1em !important;\n    visibility: hidden; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".collapsible-container {\n  transition: height .25s;\n  overflow: hidden; }\n  .collapsible-container .collapsible-contents {\n    overflow: hidden; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".overlay {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  z-index: 5000; }\n  .overlay .background {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: #000;\n    transition: opacity 0.5s; }\n  .overlay .foreground {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 90%;\n    transition: opacity 0.25s, top 0.25s; }\n  .overlay.show .background {\n    opacity: 0.75; }\n  .overlay.show .foreground {\n    opacity: 1; }\n  .overlay.hide .background {\n    opacity: 0; }\n  .overlay.hide .foreground {\n    top: -30px;\n    opacity: 0; }\n",""])},function(e,t,n){t=e.exports=n(1)(void 0),t.push([e.i,".upload-progress {\n  position: fixed;\n  right: 1em;\n  bottom: 3em;\n  font-size: 1.2em;\n  font-weight: bold;\n  color: #eeeeee;\n  background-color: #aa0000;\n  padding: 0.5em 0.5em 0.5em 0.5em; }\n",""])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"ee141d1b002541c24fa79391f52200db.png"},function(e,t,n){e.exports=n.p+"716d5f1dc6c95c82cfac16c394db733b.png"},function(e,t,n){e.exports=n.p+"72bb4a181bab6923b6bc3421016cb573.png"},function(e,t,n){e.exports=n.p+"7fbc441dc116c285bf2bb3be1d2f3616.png"},function(e,t,n){e.exports=n.p+"6abad3de23e8db566c4cafd3a8ee7f24.png"},function(e,t,n){e.exports=n.p+"11164feb11ebf5b10f4fb8a015d166e9.png"},function(e,t,n){e.exports=n.p+"1d631316668fba6a8f6c7d4f4411587f.png"},function(e,t,n){e.exports=n.p+"6939925abcb6fcfbcc49465dee1032c5.png"},function(e,t,n){e.exports=n.p+"4ae70e06469cf691b724146e8c0728b3.png"},function(e,t,n){e.exports=n.p+"1f68ea20b77e7d8717c22708ea6968c1.png"},function(e,t,n){e.exports=n.p+"563cc3494172864075b55660bdffc75a.png"},function(e,t,n){e.exports=n.p+"ce7a0e79e69f7f86d3a0c9a310372aa4.png"},function(e,t,n){e.exports=n.p+"ee78976e8358ad86d606d2de1e220931.png"},function(e,t,n){e.exports=n.p+"72bb4a181bab6923b6bc3421016cb573.png"},function(e,t,n){e.exports=n.p+"7af9ee3a80ed151b77494dea1e8b9a89.png"},function(e,t,n){e.exports=n.p+"dbe43e1b6a21cb4ee792d70b7d813114.png"},function(e,t,n){e.exports=n.p+"e72f85d8622d3ab0c93af4e0dc3b3ae3.png"},function(e,t,n){e.exports=n.p+"4ae70e06469cf691b724146e8c0728b3.png"},function(e,t,n){e.exports=n.p+"be613ad3c1fb13a04edca971d584e375.png"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(296);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(297);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(298);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(299);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(300);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(301);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(302);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(303);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(304);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(305);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(306);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(307);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(308);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(309);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(310);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(311);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(312);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(313);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(314);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(315);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(316);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(317);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(318);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(319);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(320);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(321);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(322);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(324);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(325);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(326);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(327);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(328);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(329);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(330);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(331);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(332);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(333);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(334);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(335);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(336);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(337);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(338);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(339);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(340);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(341);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(342);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(343);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(344);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(345);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(346);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(347);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(348);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(349);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(350);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(351);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(352);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(353);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(354);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(355);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(356);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(357);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(358);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(359);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(360);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(361);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(362);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(363);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(364);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(365);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(366);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(367);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(368);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(369);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(370);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(371);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(372);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(373);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(374);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(375);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(376);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(2)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){function r(e){return i.createElement("svg",e,[i.createElement("polygon",{points:"280,653 373,679 255,840",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:0}),i.createElement("polygon",{points:"102,634 298,439 373,430 297,540 447,585 387,674 281,646 285,575",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:1}),i.createElement("polygon",{points:"312,528 386,425 431,428",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:2}),i.createElement("polygon",{points:"332,520 485,397 513,414 496,435",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:3}),i.createElement("polygon",{points:"316,534 492,443 467,467 521,509 515,543 565,587 560,592 498,549",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:4}),i.createElement("polygon",{points:"318,542 496,557 555,595 548,605",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:5}),i.createElement("polygon",{points:"550,611 574,592 599,618",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:6}),i.createElement("polygon",{points:"476,466 543,399 521,500",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:7}),i.createElement("polygon",{points:"525,524 555,392 600,427",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:8}),i.createElement("polygon",{points:"522,542 605,435 597,604",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:9}),i.createElement("polygon",{points:"613,444 743,521 685,543 775,833 554,617 605,625",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:10}),i.createElement("polygon",{points:"565,318 620,318 655,457 613,434",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:11}),i.createElement("polygon",{points:"629,310 695,204 751,184 733,267 740,508 661,462",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:12}),i.createElement("polygon",{points:"757,183 869,81 776,196",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:13}),i.createElement("polygon",{points:"743,273 755,194 848,270 853,338",fill:"black",stroke:"black",strokeLinejoin:"round",strokeWidth:"3",key:14})])}var i=n(0);r.displayName="Unicorn",r.defaultProps={version:"1.1",viewBox:"0 0 1000 1000"},e.exports=r,r.default=r}],[245]);