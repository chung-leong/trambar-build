webpackJsonp(["page-settings"],{"../../common/node_modules/relaks-media-capture/index.js":function(e,t,n){function a(e){h.call(this),this.options={},this.status=void 0,this.duration=void 0,this.volume=void 0,this.liveVideo=void 0,this.liveAudio=void 0,this.capturedVideo=void 0,this.capturedAudio=void 0,this.capturedImage=void 0,this.lastError=null,this.devices=[],this.chosenDeviceID=void 0,this.stream=void 0,this.audioProcessor=void 0,this.audioContext=void 0,this.audioSource=void 0,this.mediaRecorder=null,this.mediaRecorderStartTime=null,this.mediaRecorderDuration=0,this.mediaRecorderInterval=0,this.mediaRecorderBlobs=[],this.orientationChanged=!1,this.videoDimensions=null,this.handleDeviceChange=this.handleDeviceChange.bind(this),this.handleStreamEnd=this.handleStreamEnd.bind(this),this.handleAudioProcess=this.handleAudioProcess.bind(this),this.handleMediaRecorderData=this.handleMediaRecorderData.bind(this),this.handleMediaRecorderStart=this.handleMediaRecorderStart.bind(this),this.handleMediaRecorderStop=this.handleMediaRecorderStop.bind(this),this.handleMediaRecorderPause=this.handleMediaRecorderPause.bind(this),this.handleMediaRecorderResume=this.handleMediaRecorderResume.bind(this),this.handleMediaRecorderInterval=this.handleMediaRecorderInterval.bind(this),this.handleOrientationChange=this.handleOrientationChange.bind(this),this.handleResize=this.handleResize.bind(this);for(var t in v)e&&void 0!==e[t]?this.options[t]=e[t]:this.options[t]=v[t]}function r(e){try{return navigator.mediaDevices.getUserMedia(e)}catch(e){return Promise.reject(e)}}function o(e){return new Promise(function(t,n){var a=document.createElement("VIDEO");a.srcObject=e,a.muted=!0,a.onloadedmetadata=a.onloadeddata=a.oncanplay=function(e){if(t){var n;if("VIDEO"===a.tagName){var r=a.videoWidth,o=a.videoHeight;r&&o&&(n={width:r,height:o})}else n={};n&&(t(n),t=null,a.pause(),a.srcObject=null)}},a.onerror=function(e){var t=new p("Unable to obtain metadata");n(t),a.pause()},a.play()})}function s(e){return new Promise(function(t,n){var a=document.createElement("VIDEO");a.srcObject=e,a.muted=!0,a.oncanplay=function(e){if(t){var n=a.videoWidth,r=a.videoHeight,o=document.createElement("CANVAS");o.width=n,o.height=r;o.getContext("2d").drawImage(a,0,0,n,r),t(o),t=null,a.pause(),a.srcObject=null}},a.onerror=function(e){var t=new p("Unable to capture image");n(t),a.pause(),a.srcObject=null},a.play()})}function i(e){for(var t=e.getTracks(),n=0;n<t.length;n++)t[n].stop()}function l(e){var t;return e.video?t="videoinput":e.audio&&(t="audioinput"),u(t).then(function(n){for(var a=0,o=0;o<n.length;o++)n[o].label||a++;return a>0&&a===n.length?r(e).then(function(e){return i(e),u(t)}):n}).then(function(e){return e.map(function(e){return{id:e.deviceId,label:e.label}})})}function u(e){var t=navigator.mediaDevices;return t&&t.enumerateDevices?t.enumerateDevices().then(function(t){return t.filter(function(t){return t.kind===e})}).catch(function(e){return[]}):Promise.resolve([])}function d(e,t){if(t){for(var n=0;n<e.length;n++){var a=e[n];if(a.id===t)return a}for(var r=t.toLowerCase(),n=0;n<e.length;n++){var a=e[n],o=a.label;if(o&&-1!==o.toLowerCase().indexOf(r))return a}}return e[0]}function c(e,t,n){return new Promise(function(a,r){if("function"==typeof e.toBlob)e.toBlob(a,t,90);else try{var o=e.toDataURL(t,n),s=new XMLHttpRequest;s.responseType="blob",s.onload=function(e){s.status>=400?r(new p("Error parsing data URL")):a(s.response)},s.onerror=function(){r(new p("Unable to load image"))},s.open("GET",o,!0),s.send()}catch(e){r(e)}})}function m(e,t,n){f.call(this,e,t,n)}function p(e){this.message=e}var h=n("../../common/node_modules/relaks-event-emitter/index.js"),f=h.GenericEvent,v={video:!0,audio:!0,preferredDevice:"front",chooseNewDevice:!0,captureImageOnly:!1,watchVolume:!1,segmentDuration:void 0,videoMIMEType:"video/webm",audioMIMEType:"audio/webm",imageMIMEType:"image/jpeg",audioBitsPerSecond:128e3,videoBitsPerSecond:25e5},g=a.prototype=Object.create(h.prototype);g.activate=function(){if(!this.active){if(this.capturedVideo||this.capturedAudio||this.capturedImage)return;this.acquire(),this.active=!0,this.notifyChange(),this.watchDevices()}},g.deactivate=function(){this.active&&(this.mediaRecorder&&(clearInterval(this.mediaRecorderInterval),this.mediaRecorder.removeEventListener("dataavailable",this.handleMediaRecorderData),this.mediaRecorder.removeEventListener("start",this.handleMediaRecorderStart),this.mediaRecorder.removeEventListener("stop",this.handleMediaRecorderStop),this.mediaRecorder.removeEventListener("pause",this.handleMediaRecorderPause),this.mediaRecorder.removeEventListener("resume",this.handleMediaRecorderResume),this.mediaRecorder.stop(),this.mediaRecorder=null,this.mediaRecorderStartTime=null,this.mediaRecorderDuration=0,this.mediaRecorderInterval=0,this.mediaRecorderBlobs=[]),this.releaseInput(),this.revokeBlobURLs(),this.unwatchDevices(),this.active=!1,this.notifyChange())},g.acquire=function(){var e=this;this.status||(this.status="acquiring");var t={video:this.options.video,audio:this.options.audio};return l(t).then(function(n){var a=e.chosenDeviceID||e.options.preferredDevice,s=d(n,a);if(s){var i={deviceId:s.id};t.video?t.video=i:t.audio&&(t.audio=i)}return r(t).then(function(a){if(e.status="initiating",e.devices=n,e.chosenDeviceID=s?s.id:void 0,e.notifyChange(),t.video)return o(a).then(function(n){e.stream=a,e.liveVideo={stream:a,height:n.height,width:n.width},e.options.watchVolume&&t.audio&&e.watchAudioVolume(),e.watchStreamStatus(),e.status="previewing",e.notifyChange()});t.audio&&(e.stream=a,e.liveAudio={stream:a},e.options.watchVolume&&e.watchAudioVolume(),e.watchStreamStatus(),e.status="previewing",e.notifyChange())})}).catch(function(t){return e.lastError=t,e.status="denied",e.notifyChange(),console.error(t),null})},g.start=function(){try{if(this.mediaRecorder)return;var e=this.options.segmentDuration,t={};this.options.audio&&(t.audioBitsPerSecond=this.options.audioBitsPerSecond,t.mimeType=this.options.audioMIMEType),this.options.video&&(t.videoBitsPerSecond=this.options.videoBitsPerSecond,t.mimeType=this.options.videoMIMEType),this.liveVideo&&(this.videoDimensions={width:this.liveVideo.width,height:this.liveVideo.height}),this.mediaRecorder=new MediaRecorder(this.stream,t),this.mediaRecorder.addEventListener("dataavailable",this.handleMediaRecorderData),this.mediaRecorder.addEventListener("start",this.handleMediaRecorderStart),this.mediaRecorder.addEventListener("stop",this.handleMediaRecorderStop),this.mediaRecorder.addEventListener("pause",this.handleMediaRecorderPause),this.mediaRecorder.addEventListener("resume",this.handleMediaRecorderResume),this.mediaRecorder.start(e)}catch(e){this.lastError=e,console.error(e)}},g.stop=function(){try{this.mediaRecorder.stop()}catch(e){this.lastError=e,console.error(e)}},g.pause=function(){try{this.mediaRecorder.pause()}catch(e){this.lastError=e,console.error(e)}},g.resume=function(){try{this.mediaRecorder.resume()}catch(e){this.lastError=e,console.error(e)}},g.snap=function(){try{var e=this,t=this.options.imageMIMEType,n=this.options.imageQuality||90,a=this.options.captureImageOnly;if(!this.liveVideo)throw new p("No video stream");s(this.stream).then(function(r){c(r,t,n).then(function(t){var n=URL.createObjectURL(t);e.capturedImage={url:n,blob:t,width:r.width,height:r.height},a&&(e.status="captured"),e.notifyChange()}).catch(function(e){console.error(e)})})}catch(e){this.lastError=e,console.error(e)}},g.watchDevices=function(){var e=navigator.mediaDevices;e&&e.addEventListener&&e.addEventListener("devicechange",this.handleDeviceChange),window.addEventListener("orientationchange",this.handleOrientationChange),window.addEventListener("resize",this.handleResize)},g.unwatchDevices=function(){var e=navigator.mediaDevices;e&&e.removeEventListener&&e.removeEventListener("devicechange",this.handleDeviceChange),window.removeEventListener("orientationchange",this.handleOrientationChange),window.removeEventListener("resize",this.handleResize)},g.watchStreamStatus=function(){for(var e=this.stream.getTracks(),t=0;t<e.length;t++)e[t].onended=this.handleStreamEnd},g.unwatchStreamStatus=function(){for(var e=this.stream.getTracks(),t=0;t<e.length;t++)e[t].onended=null},g.watchAudioVolume=function(){"function"==typeof AudioContext&&(this.audioContext=new AudioContext,this.audioProcessor=this.audioContext.createScriptProcessor(4096,1,1),this.audioSource=this.audioContext.createMediaStreamSource(this.stream),this.audioProcessor.addEventListener("audioprocess",this.handleAudioProcess),this.audioSource.connect(this.audioProcessor),this.audioProcessor.connect(this.audioContext.destination))},g.unwatchAudioVolume=function(){this.audioContext&&(this.audioProcessor.disconnect(this.audioContext.destination),this.audioSource.disconnect(this.audioProcessor),this.audioProcessor.removeEventListener("audioprocess",this.handleAudioProcess),this.audioContext=void 0,this.audioSource=void 0,this.audioProcessor=void 0),this.volume=void 0},g.releaseInput=function(){this.stream&&(this.unwatchAudioVolume(),this.unwatchStreamStatus(),i(this.stream),this.stream=void 0,this.liveVideo=void 0,this.liveAudio=void 0)},g.revokeBlobURLs=function(){this.capturedVideo&&(URL.revokeObjectURL(this.capturedVideo.url),this.capturedVideo=void 0),this.capturedAudio&&(URL.revokeObjectURL(this.capturedAudio.url),this.capturedAudio=void 0),this.capturedImage&&(URL.revokeObjectURL(this.capturedImage.url),this.capturedImage=void 0)},g.reacquire=function(){return this.status="initiating",this.releaseInput(),this.notifyChange(),this.acquire()},g.choose=function(e){try{return this.chosenDeviceID===e&&this.stream?Promise.resolve():(this.chosenDeviceID=e,this.reacquire())}catch(e){return this.lastError=e,console.error(e),Promise.reject(e)}},g.clear=function(){this.revokeBlobURLs(),this.liveVideo||this.liveAudio?this.status="previewing":(this.status=void 0,this.active&&this.acquire()),this.duration=void 0,this.notifyChange()},g.change=function(){return this.waitForEvent("change")},g.notifyChange=function(){this.triggerEvent(new m("change",this))},g.handleDeviceChange=function(e){if(!this.scanningDevices){this.scanningDevices=!0;var t=this,n=this.devices;l({video:this.options.video,audio:this.options.audio}).then(function(e){var a=null,r=!1;if("initiating"!==t.status&&"previewing"!==t.status&&"denied"!==t.status||(r=t.options.chooseNewDevice),r)for(var o=0;o<e.length;o++){for(var s=e[o],i=!0,l=0;l<n.length;l++){var u=n[l];if(s.id===u.id){i=!1;break}}if(i){a=e[o];break}}t.devices=e,t.scanningDevices=!1,a?t.choose(a.id):t.notifyChange()})}},g.handleStreamEnd=function(e){if(this.stream)for(var t=this.stream.getTracks(),n=0;n<t.length;n++)if(e.target===t[n]){"previewing"===this.status?this.reacquire():"capturing"!==this.status&&"paused"!==this.status||(this.releaseInput(),this.stop());break}},g.handleAudioProcess=function(e){for(var t=e.inputBuffer.getChannelData(0),n=0,a=t.length,r=0;r<a;r++){var o=t[r];o>n&&(n=o)}var s=Math.round(100*n);s!==this.volume&&(this.volume=s,this.notifyChange())},g.handleMediaRecorderData=function(e){if(this.mediaRecorderBlobs.push(e.data),this.options.segmentDuration){var e=new m("chunk",this,{blob:e.data});this.triggerEvent(e)}},g.handleMediaRecorderStart=function(e){this.mediaRecorderInterval=setInterval(this.handleMediaRecorderInterval,100),this.mediaRecorderStartTime=new Date,this.status="capturing",this.notifyChange()},g.handleMediaRecorderStop=function(e){clearInterval(this.mediaRecorderInterval);var t=this.mediaRecorderBlobs;if(t.length>0){var n;n=1===t.length?t[0]:new Blob(t,{type:t[0].type});var a=URL.createObjectURL(n);if(this.videoDimensions?this.capturedVideo={url:a,blob:n,blobs:t,duration:this.duration,width:this.videoDimensions.width,height:this.videoDimensions.height}:this.capturedAudio={url:a,blob:n,blobs:t,duration:this.duration},this.mediaRecorderStartTime){var r=new Date,o=r-this.mediaRecorderStartTime;this.duration=this.mediaRecorderDuration+o}this.status="captured"}else this.duration=void 0,this.status="previewing";if(this.mediaRecorder=null,this.mediaRecorderBlobs=[],this.mediaRecorderInterval=0,this.mediaRecorderStartTime=null,this.mediaRecorderDuration=0,this.notifyChange(),this.options.segmentDuration){var e=new m("end",this);this.triggerEvent(e)}},g.handleMediaRecorderPause=function(e){clearInterval(this.mediaRecorderInterval);var t=new Date,n=t-this.mediaRecorderStartTime;this.duration=this.mediaRecorderDuration+n,this.mediaRecorderDuration=this.duration,this.mediaRecorderStartTime=null,this.status="paused",this.notifyChange()},g.handleMediaRecorderResume=g.handleMediaRecorderStart,g.handleOrientationChange=function(e){this.orientationChanged=!0},g.handleResize=function(e){if(this.orientationChanged){this.orientationChanged=!1;var t=this,n=this.liveVideo;n&&o(this.stream).then(function(e){n.width===e.width&&n.height===e.height||(t.liveVideo={stream:n.stream,width:e.width,height:e.height},t.notifyChange())})}},g.handleMediaRecorderInterval=function(){var e=new Date,t=e-this.mediaRecorderStartTime;this.duration=this.mediaRecorderDuration+t,this.notifyChange()},p.prototype=Object.create(Error.prototype),e.exports=a},"../../common/src/media/media-tag-reader.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.extractAlbumArt=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/core-js/promise.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),u=a(l),d=function(){var e=(0,u.default)(o.default.mark(function e(t){var a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("jsmediatags").then(n.bind(null,"../node_modules/jsmediatags/dist/jsmediatags.js"));case 2:return a=e.sent,e.abrupt("return",new i.default(function(e,n){var r=new a.Reader(t);r.setTagsToRead(["picture"]),r.read({onSuccess:function(t){var n=m.default.get(t,"tags.picture");if(n&&n.data){var a=n.data,r=new Uint8Array(a),o=new Blob([r],{type:n.format});e(o)}else e(null)},onError:function(t){e(null)}})}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=n("../../common/node_modules/lodash/lodash.js"),m=a(c);t.extractAlbumArt=d},"../../common/src/media/quick-start.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,l,u){for(;t<n;){var d=o(e,t),c=i(e,t+4);if(d<8)break;switch(c){case"stco":for(var m=0,p=o(e,t+12);m<p;m++){var h=t+16+4*m,f=o(e,h);a<=f&&f<=l&&(f+=u,e[h+0]=f>>24&255,e[h+1]=f>>16&255,e[h+2]=f>>8&255,e[h+3]=f>>0&255)}break;case"co64":for(var v=0,g=o(e,t+12);v<g;v++){var b=t+16+8*v,y=s(e,b);a<=y&&y<=l&&(y+=u,e[b+0]=y>>56&255,e[b+1]=y>>48&255,e[b+2]=y>>40&255,e[b+3]=y>>32&255,e[b+4]=y>>24&255,e[b+5]=y>>16&255,e[b+6]=y>>8&255,e[b+7]=y>>0&255)}break;case"trak":case"mdia":case"minf":case"stbl":r(e,t+8,t+d,a,l,u)}t+=d}}function o(e,t){return e[t+0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function s(e,t){return e[t+0]<<56|e[t+1]<<48|e[t+2]<<40|e[t+3]<<32|e[t+4]<<24|e[t+5]<<16|e[t+6]<<8|e[t+7]}function i(e,t){return String.fromCharCode(e[t+0])+String.fromCharCode(e[t+1])+String.fromCharCode(e[t+2])+String.fromCharCode(e[t+3])}Object.defineProperty(t,"__esModule",{value:!0}),t.process=void 0;var l=n("../../common/node_modules/babel-runtime/core-js/promise.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/regenerator/index.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=a(m),h=function(){var e=(0,p.default)(c.default.mark(function e(t){var n,a,o,s,i,l,u,d,m,p,h,v;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(t);case 3:if(n=e.sent,a=y.default.findIndex(n,{name:"ftyp"}),o=y.default.findIndex(n,{name:"moov"}),0===a&&o>1){e.next=8;break}return e.abrupt("return",null);case 8:return s=n[a],i=n[o],e.next=12,g(t,s);case 12:return l=e.sent,e.next=15,g(t,i);case 15:return u=e.sent,d=new Uint8Array(u),r(d,8,d.length,s.offset+s.size,i.offset,i.size),m=t.slice(s.offset+s.size,i.offset),p=t.slice(i.offset+i.size),h=[l,u,m,p],v=new Blob(h,{type:t.type}),e.abrupt("return",v);case 25:return e.prev=25,e.t0=e.catch(0),e.abrupt("return",null);case 28:case"end":return e.stop()}},e,this,[[0,25]])}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,p.default)(c.default.mark(function e(t){var n,a,r,o,s,i,l;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0,r=t.size,o=!1,s=!1;case 5:if(o&&s){e.next=18;break}return e.next=8,v(t,a);case 8:if(i=e.sent,l=!1,o?"moov"===i.name&&(s=!0):"ftyp"===i.name?o=!0:l=!0,a+=i.size,a>r&&(l=!0),!l){e.next=15;break}throw new Error("File does not appear to a QuickTime container");case 15:n.push(i),e.next=5;break;case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,p.default)(c.default.mark(function e(t,n){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new u.default(function(e,a){var r=t.slice(n,n+16),l=new FileReader;l.readAsArrayBuffer(r),l.onload=function(t){var r=new Uint8Array(t.target.result),l=o(r,0),u=8;1===l&&(l=s(r,8),u=16),l>=u||a(new Error("Invalid atom size"));var d=i(r,4);e({offset:n,size:l,name:d})},l.onerror=function(e){a(new Error("Unable to load data"))}}));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,p.default)(c.default.mark(function e(t,n){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new u.default(function(e,a){var r=t.slice(n.offset,n.offset+n.size),o=new FileReader;o.readAsArrayBuffer(r),o.onload=function(t){e(t.target.result)},o.onerror=function(e){a(new Error("Unable to load data"))}}));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),b=n("../../common/node_modules/lodash/lodash.js"),y=a(b);t.process=h},"../../common/src/objects/finders/device-finder.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.findUserDevices=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=function(){var e=(0,i.default)(o.default.mark(function e(t,n,a){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return",d);case 2:return e.abrupt("return",t.find({schema:"global",table:"device",criteria:{user_id:n.id},prefetch:!0,minimum:a}));case 3:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}(),u=n("../../common/node_modules/lodash/lodash.js"),d=(a(u),[]);t.findUserDevices=l},"../../common/src/objects/finders/repo-finder.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.findProjectRepos=t.findExistingRepos=t.findAllRepos=t.findRepo=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=function(){var e=(0,i.default)(o.default.mark(function e(t,n){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.findOne({schema:"global",table:"repo",criteria:{id:n},required:!0}));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=(0,i.default)(o.default.mark(function e(t,n){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.find({schema:"global",table:"repo",criteria:{},minimum:n}));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=(0,i.default)(o.default.mark(function e(t,n){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.find({schema:"global",table:"repo",criteria:{deleted:!1},minimum:n}));case 1:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.default)(o.default.mark(function e(t,n){var a,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n instanceof Array)){e.next=8;break}if(a=p.default.flatten(p.default.map(n,"repo_ids")),!p.default.isEmpty(a)){e.next=4;break}return e.abrupt("return",h);case 4:return a=p.default.sortBy(p.default.uniq(a)),e.abrupt("return",t.find({schema:"global",table:"repo",criteria:{id:a,deleted:!1}}));case 8:if(r=n){e.next=11;break}return e.abrupt("return",h);case 11:return e.abrupt("return",t.find({schema:"global",table:"repo",criteria:{id:r.repo_ids,deleted:!1},prefetch:!0}));case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),m=n("../../common/node_modules/lodash/lodash.js"),p=a(m),h=[];t.findRepo=l,t.findAllRepos=u,t.findExistingRepos=d,t.findProjectRepos=c},"../../common/src/objects/finders/system-finder.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.findSystem=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=function(){var e=(0,i.default)(o.default.mark(function e(t){var n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.findOne({schema:"global",table:"system",criteria:{},prefetch:!0});case 2:return n=e.sent,e.abrupt("return",n||{});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),u=n("../../common/node_modules/lodash/lodash.js");a(u);t.findSystem=l},"../../common/src/objects/types/resource-types.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=["image","video","audio","website"];t.default=a,t.ResourceTypes=a},"../../common/src/routing/universal-link.js":function(e,t,n){"use strict";function a(e,t,n){var a=e.replace("://","/");return o+"/"+a+"/?ac="+n+"&p="+t}function r(e){var t=new RegExp("^"+o+"/([^/]+)/([^/]+)/\\?ac=([^&]+)&p=([^&]+)"),n=t.exec(e);return n?{address:n[1]+"://"+n[2],schema:n[4],activationCode:n[3]}:null}Object.defineProperty(t,"__esModule",{value:!0});var o="https://trambar.io";t.createActivationURL=a,t.parseActivationURL=r},"../../common/src/utils/focus-manager.js":function(e,t,n){"use strict";function a(e,t){l.unshift({component:e,props:t}),u=i.default.filter(u,function(n){return!i.default.isMatch(t,n)||(e.focus(),!1)})}function r(e){l=i.default.filter(l,function(t){return t.component!==e})}function o(e){var t=i.default.find(l,{props:e});t?t.component.focus():u.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.focus=t.unregister=t.register=void 0;var s=n("../../common/node_modules/lodash/lodash.js"),i=function(e){return e&&e.__esModule?e:{default:e}}(s),l=[],u=[];t.register=a,t.unregister=r,t.focus=o},"../../common/src/utils/konami-code.js":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){c.push(e),1===c.length&&window.addEventListener("keydown",s)}function o(e){d.default.pull(c,e),0===c.length&&window.removeEventListener("keydown",s)}function s(e){if(p.push(e.keyCode),p.length>m.length&&p.splice(0,p.length-m.length),d.default.isEqual(p,m)){var n=!0,a=!1,r=void 0;try{for(var o,s=(0,l.default)(c);!(n=(o=s.next()).done);n=!0){(0,o.value)({type:"cheat",target:t})}}catch(e){a=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw r}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.removeListener=t.addListener=void 0;var i=n("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),l=a(i),u=n("../../common/node_modules/lodash/lodash.js"),d=a(u),c=[],m=[38,38,40,40,37,39,37,39,66,65],p=[];t.addListener=r,t.removeListener=o},"../../common/src/widgets/image-cropper.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){e.left<0?e.left=0:e.left+e.width>t&&(e.left=t-e.width),e.top<0?e.top=0:e.top+e.height>n&&(e.top=n-e.height)}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageCropper=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),s=a(o),i=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),l=a(i),u=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),d=a(u),c=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=a(c),p=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),h=a(p),f=n("../../common/node_modules/lodash/lodash.js"),v=a(f),g=n("../../common/node_modules/react/index.js"),b=a(g),y=n("../../common/node_modules/react-dom/index.js"),j=(a(y),n("../../common/node_modules/hammerjs/hammer.js")),C=a(j),_=n("../../common/src/utils/component-refs.js"),k=a(_),w=n("../../common/src/widgets/bitmap-view.jsx"),E=a(w),x=n("../../common/src/widgets/vector-view.jsx"),P=a(x);n("../../common/src/widgets/image-cropper.scss");var R=function(e){function t(e){(0,l.default)(this,t);var n=(e.clippingRect,(0,m.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e)));return D.call(n),n.components=(0,k.default)({container:HTMLElement,image:E.default}),n.state={uncommittedClippingRect:null,hasFocus:!1},n}return(0,h.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.url,n=e.disabled,a=e.vector,r=e.onLoad,o=(this.state.hasFocus,this.components.setters),s=this.getClippingRect(),i={ref:o.container,className:"image-cropper"};n||v.default.assign(i,{tabIndex:0,onMouseDown:this.handleMouseDown,onFocus:this.handleFocus,onBlur:this.handleBlur,onWheel:this.handleMouseWheel,onKeyDown:this.handleKeyDown});var l={ref:o.image,url:t,clippingRect:s,onLoad:r},u=E.default;return a&&(u=P.default),b.default.createElement("div",i,b.default.createElement(u,l))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.clippingRect,a=this.state,r=a.hasFocus,o=a.uncommittedClippingRect;!t.hasFocus&&r?this.activateTouchHandling():t.hasFocus&&!r&&this.deactivateTouchHandling(),e.clippingRect!==n&&o&&v.default.isEqual(o,n)&&this.setState({uncommittedClippingRect:null})}},{key:"componentWillUnmount",value:function(){this.dragStart&&this.handleMouseUp(),this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.handleZoomTimeout()),this.deactivateTouchHandling()}},{key:"focus",value:function(){this.components.container.focus()}},{key:"getClippingRect",value:function(){var e=this.props.clippingRect;return this.state.uncommittedClippingRect||e}},{key:"activateTouchHandling",value:function(){var e=this.components.container;if(e&&!this.hammer){this.hammer=new C.default(e);var t=this.hammer.get("pan").set({direction:C.default.DIRECTION_ALL,threshold:5});this.hammer.get("pinch").set({enable:!0}).recognizeWith(t),this.hammer.on("panstart",this.handlePanStart),this.hammer.on("panmove",this.handlePanMove),this.hammer.on("panend",this.handlePanEnd),this.hammer.on("pinchstart",this.handlePinchStart),this.hammer.on("pinchmove",this.handlePinchMove),this.hammer.on("pinchend",this.handlePinchEnd)}}},{key:"deactivateTouchHandling",value:function(){this.hammer&&(this.hammer.off("panstart",this.handlePanStart),this.hammer.off("panmove",this.handlePanMove),this.hammer.off("panend",this.handlePanEnd),this.hammer.off("pinchstart",this.handlePinchStart),this.hammer.off("pinchmove",this.handlePinchMove),this.hammer.off("pinchend",this.handlePinchEnd),this.hammer.stop(!0),this.hammer.element.style.touchAction="",this.hammer.destroy(),this.hammer=null)}},{key:"triggerChangeEvent",value:function(){var e=this.props.onChange,t=this.state.uncommittedClippingRect;t&&e&&e({type:"change",target:this,rect:t})}}]),t}(g.PureComponent);R.displayName="ImageCropper";var D=function(){var e=this;this.handleFocus=function(t){e.setState({hasFocus:!0})},this.handleBlur=function(t){e.setState({hasFocus:!1})},this.handleMouseDown=function(t){var n=e.components,a=n.image,r=n.container,o=e.getClippingRect();if(0===t.button&&a&&r&&o){var s=r.getBoundingClientRect();e.dragStart={clippingRect:o,boundingRect:s,pageX:t.pageX,pageY:t.pageY,naturalWidth:a.naturalWidth,naturalHeight:a.naturalHeight},document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.handleMouseUp)}},this.handleMouseMove=function(t){if(t.preventDefault(),e.dragStart){var n={x:e.dragStart.pageX-t.pageX,y:e.dragStart.pageY-t.pageY},a=e.dragStart.boundingRect,o=v.default.clone(e.dragStart.clippingRect),s=n.x*o.width/a.width,i=n.y*o.height/a.height;o.left+=Math.round(s),o.top+=Math.round(i),r(o,e.dragStart.naturalWidth,e.dragStart.naturalHeight),e.setState({uncommittedClippingRect:o})}},this.handleMouseUp=function(t){e.dragStart&&(document.removeEventListener("mousemove",e.handleMouseMove),document.removeEventListener("mouseup",e.handleMouseUp),e.triggerChangeEvent(),e.dragStart=null)},this.handleMouseWheel=function(t){var n=e.state.hasFocus,a=e.components,o=a.image,s=a.container,i=e.getClippingRect();if(t.preventDefault(),o&&s&&i){n||e.focus();var l=4;t.shiftKey&&(l=1);var u=s.getBoundingClientRect(),d=void 0;switch(t.deltaMode){case 0:d=t.deltaY;break;case 1:d=18*t.deltaY;break;case 2:d=480*t.deltaY}var c=Math.round(d*i.height/u.height/l),m=i.width+c;m>o.naturalWidth&&(m=o.naturalWidth,c=m-i.width);var p=i.height+c;p>o.naturalHeight&&(p=o.naturalHeight,c=p-i.height,m=i.width+c);var h={x:t.pageX-u.left,y:t.pageY-u.top},f=-h.x*c/u.width,g=-h.y*c/u.height;i=v.default.clone(i),i.left+=Math.round(f),i.top+=Math.round(g),i.width=m,i.height=p,r(i,o.naturalWidth,o.naturalHeight),e.setState({uncommittedClippingRect:i},function(){e.zoomChangeTimeout&&clearTimeout(e.zoomChangeTimeout),e.zoomChangeTimeout=setTimeout(e.handleZoomTimeout,1e3)}),e.dragStart&&(e.dragStart={clippingRect:i,boundingRect:u,pageX:t.pageX,pageY:t.pageY,naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight})}},this.handleZoomTimeout=function(){e.triggerChangeEvent(),e.zoomChangeTimeout=0},this.handlePanStart=function(t){var n=e.components,a=n.image,r=n.container,o=e.getClippingRect();if("mouse"!==t.pointerType&&a&&r&&o){var s=r.getBoundingClientRect();e.panStart={clippingRect:o,boundingRect:s,naturalWidth:a.naturalWidth,naturalHeight:a.naturalHeight},e.handlePanMove(t)}},this.handlePanMove=function(t){if(e.panStart){var n=e.panStart.boundingRect,a=v.default.clone(e.panStart.clippingRect),o=-t.deltaX*a.width/n.width,s=-t.deltaY*a.height/n.height;a.left+=Math.round(o),a.top+=Math.round(s),r(a,e.panStart.naturalWidth,e.panStart.naturalHeight),e.setState({uncommittedClippingRect:a})}},this.handlePanEnd=function(t){e.panStart&&(e.triggerChangeEvent(),e.panStart=null)},this.handlePinchStart=function(t){var n=e.components,a=n.image,r=n.container,o=e.getClippingRect();if("mouse"!==t.pointerType&&a&&r&&o){var s=r.getBoundingClientRect();e.pinchStart={clippingRect:o,boundingRect:s,pointers:v.default.map(t.pointers,function(e){return{pageX:e.pageX,pageY:e.pageY}})},e.handlePinchMove(t)}},this.handlePinchMove=function(t){var n=e.components.image;if(e.pinchStart){var a=v.default.clone(e.pinchStart.clippingRect),o=e.pinchStart.boundingRect,s=1/t.scale,i=Math.round(a.width*s);i>n.naturalWidth&&(i=n.naturalWidth,s=i/a.width);var l=Math.round(a.height*s);l>n.naturalHeight&&(l=n.naturalHeight,s=l/a.height,i=Math.round(a.width*s));var u={x:e.pinchStart.pointers[0].pageX-o.left,y:e.pinchStart.pointers[0].pageY-o.top},d={x:e.pinchStart.pointers[1].pageX-o.left,y:e.pinchStart.pointers[1].pageY-o.top},c={x:t.pointers[0].pageX-o.left,y:t.pointers[0].pageY-o.top},m={x:t.pointers[1].pageX-o.left,y:t.pointers[1].pageY-o.top},p=(u.x*a.width-c.x*i)/o.width,h=(d.x*a.width-m.x*i)/o.width,f=(u.y*a.height-c.y*l)/o.height,g=(d.y*a.height-m.y*l)/o.height;a.left+=Math.round((p+h)/2),a.top+=Math.round((f+g)/2),a.width=i,a.height=l,r(a,n.naturalWidth,n.naturalHeight),e.setState({uncommittedClippingRect:a})}},this.handlePinchEnd=function(t){e.pinchStart&&(e.triggerChangeEvent(),e.pinchStart=null)},this.handleKeyDown=function(t){var n=e.state.hasFocus,a=e.components.container;n&&27===t.keyCode&&a.blur()}};R.defaultProps={vector:!1},t.default=R,t.ImageCropper=R},"../../common/src/widgets/image-cropper.scss":function(e,t){},"../../common/src/widgets/live-video.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LiveVideo=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/helpers/extends.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/objectWithoutProperties.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),g=a(v),b=n("../../common/node_modules/react/index.js"),y=a(b),j=function(e){function t(){var e,n,a,r;(0,c.default)(this,t);for(var o=arguments.length,s=Array(o),i=0;i<o;i++)s[i]=arguments[i];return n=a=(0,f.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),a.setNode=function(e){a.node=e},r=n,(0,f.default)(a,r)}return(0,g.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){var e=this.props,t=e.srcObject,n=(0,i.default)(e,["srcObject"]);return t instanceof Blob&&(n.src=this.blobURL=URL.createObjectURL(t)),y.default.createElement("video",(0,o.default)({ref:this.setNode},n))}},{key:"setSrcObject",value:function(){var e=this.props.srcObject;e&&(e instanceof Blob||(this.node.srcObject=e),this.node.play())}},{key:"componentDidMount",value:function(){this.setSrcObject()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.srcObject;e.srcObject!==n&&this.setSrcObject()}},{key:"componentWillUnmount",value:function(){this.blobURL&&URL.revokeObjectURL(this.blobURL)}}]),t}(b.PureComponent);t.default=j,t.LiveVideo=j},"./dialogs/audio-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioCaptureDialogBoxBrowserSync=t.AudioCaptureDialogBoxBrowser=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),g=a(v),b=n("../../common/node_modules/lodash/lodash.js"),y=a(b),j=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),C=(a(j),n("../../common/node_modules/react/index.js")),_=a(C),k=n("../../common/node_modules/relaks/index.js"),w=n("../../common/node_modules/relaks-media-capture/index.js"),E=a(w),x=n("../../common/src/widgets/overlay.jsx"),P=a(x),R=n("./widgets/push-button.jsx"),D=a(R),S=n("./widgets/device-placeholder.jsx"),M=a(S),U=n("./widgets/duration-indicator.jsx"),N=a(U),I=n("./widgets/volume-indicator.jsx"),O=a(I);n("./dialogs/audio-capture-dialog-box-browser.scss");var L=n("../../common/src/transport/payloads.js"),A=(a(L),n("../../common/src/env/environment.js")),B=(a(A),function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));n.handleStart=function(e){var t=n.props.payloads;n.stream=t.stream(),n.stream.start(),n.capture.start()},n.handleStop=function(e){n.capture.stop()},n.handlePause=function(e){n.capture.pause()},n.handleResume=function(e){n.capture.resume()},n.handleClear=function(e){n.capture.clear(),n.stream&&(n.stream.cancel(),n.stream=null)},n.handleChoose=function(e){n.capture.choose(e.id)},n.handleCancel=function(e){var t=n.props.onClose;t&&t({type:"cancel",target:n})},n.handleAccept=function(e){var t=n.props,a=t.payloads,r=t.onCapture;if(r){var o=n.capture.capturedAudio,s=a.add("audio");s.attachStream(n.stream);var i={type:"audio",payload_token:s.id,duration:o.duration,format:y.default.last(y.default.split(n.capture.options.audioMIMEType,"/")),bitrates:{audio:n.capture.options.audioBitsPerSecond}};r({type:"capture",target:n,resource:i})}n.capture.deactivate(),n.handleCancel()},n.handleCaptureChunk=function(e){n.stream&&n.stream.push(e.blob)},n.handleCaptureEnd=function(e){n.stream&&n.stream.close()};var a={video:!1,audio:!0,watchVolume:!0,segmentDuration:5e3};return n.capture=new E.default(a),n.capture.addEventListener("chunk",n.handleCaptureChunk),n.capture.addEventListener("end",n.handleCaptureEnd),n.stream=null,n}return(0,g.default)(t,e),(0,p.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,i.default)(o.default.mark(function e(t){var n,a,r,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,a=n.env,r=n.show,t.delay(50,50),s={env:a,show:r,onStart:this.handleStart,onStop:this.handleStop,onPause:this.handlePause,onResume:this.handleResume,onClear:this.handleClear,onChoose:this.handleChoose,onAccept:this.handleAccept,onCancel:this.handleCancel},!r){e.next=16;break}this.capture.activate();case 5:return s.status=this.capture.status,s.devices=this.capture.devices,s.chosenDeviceID=this.capture.chosenDeviceID,s.duration=this.capture.duration,s.volume=this.capture.volume<5?0:this.capture.volume,s.capturedImage=this.capture.capturedImage,s.capturedAudio=this.capture.capturedAudio,t.show(_.default.createElement(T,s)),e.next=15,this.capture.change();case 15:if(this.capture.active){e.next=5;break}case 16:return e.abrupt("return",_.default.createElement(T,s));case 17:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentDidUpdate",value:function(e,t){var n=this;e.show&&setTimeout(function(){n.props.show||(n.capture.deactivate(),n.capture.clear())},500)}},{key:"componentWillUnmount",value:function(){this.capture.deactivate()}}]),t}(k.AsyncComponent)),T=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return _.default.createElement(P.default,t,_.default.createElement("div",{className:"audio-capture-dialog-box"},_.default.createElement("div",{className:"container"},this.renderView()),_.default.createElement("div",{className:"controls"},_.default.createElement("div",{className:"left"},this.renderDuration()),_.default.createElement("div",{className:"right"},this.renderButtons()))))}},{key:"renderView",value:function(){var e=this.props,t=e.status,n=e.capturedAudio;switch(t){case"acquiring":case"denied":var a={blocked:"denied"===t,icon:"microphone"};return _.default.createElement(M.default,a);case"initiating":case"previewing":case"capturing":case"paused":return this.renderVolume();case"captured":var r={className:"preview",src:n.url,controls:!0};return _.default.createElement("audio",r)}}},{key:"renderDeviceSelector",value:function(){var e=this.props,t=e.env,n=e.devices,a=e.chosenDeviceID,r=e.onChoose,o={type:"audio",chosenDeviceID:a,devices:n,env:t,onSelect:r};return _.default.createElement(DeviceSelector,o)}},{key:"renderDuration",value:function(){var e=this.props,t=e.status,n=e.duration;if("number"!=typeof n)return null;var a={duration:n,recording:"capturing"===t};return _.default.createElement(N.default,a)}},{key:"renderVolume",value:function(){var e=this.props,t=e.status,n=e.volume,a={type:"gauge",volume:n,recording:"capturing"===t};return _.default.createElement(O.default,a)}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.status,a=this.props,r=a.onCancel,o=a.onStart,s=a.onPause,i=a.onResume,l=a.onStop,u=a.onClear,d=a.onAccept,c=t.locale.t;switch(n){case"acquiring":case"denied":case"initiating":case"previewing":var m={label:c("audio-capture-cancel"),onClick:r},p={label:c("audio-capture-start"),onClick:o,disabled:"previewing"!==n,emphasized:"previewing"===n};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,m),_.default.createElement(D.default,p));case"capturing":var h={label:c("audio-capture-pause"),onClick:s},f={label:c("audio-capture-stop"),onClick:l,emphasized:!0};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,h),_.default.createElement(D.default,f));case"paused":var v={label:c("audio-capture-resume"),onClick:i,emphasized:!0},g={label:c("audio-capture-stop"),onClick:l};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,v),_.default.createElement(D.default,g));case"captured":var b={label:c("audio-capture-rerecord"),onClick:u},y={label:c("audio-capture-accept"),onClick:d,emphasized:!0};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,b),_.default.createElement(D.default,y))}}}]),t}(C.PureComponent);T.displayName="AudioCaptureDialogBoxBrowserSync",t.default=B,t.AudioCaptureDialogBoxBrowser=B,t.AudioCaptureDialogBoxBrowserSync=T},"./dialogs/audio-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/audio-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AudioCaptureDialogBoxCordova=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/slicedToArray.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),g=a(v),b=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),y=a(b),j=function(){var e=(0,u.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=cordova.plugins.permissions)&&"android"===cordova.platformId){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new w.default(function(e,n){var a=function(){e()},r=function(e){n(new Error("Unable to obtain permission"))};t.requestPermissions([t.RECORD_AUDIO,t.READ_EXTERNAL_STORAGE,t.WRITE_EXTERNAL_STORAGE],a,r)}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),C=n("../../common/node_modules/lodash/lodash.js"),_=a(C),k=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),w=a(k),E=n("../../common/node_modules/react/index.js"),x=(a(E),n("../../common/src/media/media-loader.js")),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(x),R=n("../../common/src/transport/cordova-file.js"),D=a(R),S=n("../../common/src/transport/payloads.js"),M=(a(S),n("../../common/src/env/environment.js")),U=(a(M),function(e){function t(){var e,n,a,r,s=this;(0,p.default)(this,t);for(var l=arguments.length,d=Array(l),m=0;m<l;m++)d[m]=arguments[m];return n=a=(0,g.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(d))),a.handleCaptureSuccess=function(){var e=(0,u.default)(o.default.mark(function e(t){var n,r,l,u,d,c,m,p,h,f;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.payloads,a.triggerCloseEvent(),!(r=t[0])){e.next=20;break}return e.prev=4,a.triggerCapturePendingEvent(),e.next=8,P.getFormatData(r);case 8:l=e.sent,u=new D.default(r.fullPath),d=_.default.split(r.type,"/"),c=(0,i.default)(d,2),m=c[0],p=c[1],h=n.add("audio"),h.attachFile(u),f={type:"audio",payload_token:h.id,format:p,width:l.width,height:l.height,filename:r.name,duration:1e3*l.duration},a.triggerCaptureEvent(f),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.triggerCaptureErrorEvent(e.t0);case 20:case"end":return e.stop()}},e,s,[[4,17]])}));return function(t){return e.apply(this,arguments)}}(),a.handleCaptureFailure=function(e){a.triggerCloseEvent(),a.triggerCaptureErrorEvent(e)},r=n,(0,g.default)(a,r)}return(0,y.default)(t,e),(0,f.default)(t,[{key:"componentWillReceiveProps",value:function(e){!this.props.show&&e.show&&this.startCapture()}},{key:"render",value:function(){return null}},{key:"startCapture",value:function(){function e(){return t.apply(this,arguments)}var t=(0,u.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=navigator.device.capture)){e.next=6;break}return e.next=4,j();case 4:n={duration:54e3,limit:1},t.captureAudio(this.handleCaptureSuccess,this.handleCaptureFailure,n);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"audio"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}}]),t}(E.PureComponent));U.displayName="AudioCaptureDialogBoxCordova",t.default=U,t.AudioCaptureDialogBoxCordova=U},"./dialogs/confirmation-dialog-box.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ConfirmationDialogBox=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),p=a(m),h=n("../../common/node_modules/react/index.js"),f=a(h),v=n("../../common/src/widgets/overlay.jsx"),g=a(v),b=n("./widgets/push-button.jsx"),y=a(b);n("./dialogs/confirmation-dialog-box.scss");var j=n("../../common/src/env/environment.js"),C=(a(j),function(e){function t(){return(0,i.default)(this,t),(0,c.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,p.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onClose,a={show:t,onBackgroundClick:n};return f.default.createElement(g.default,a,f.default.createElement("div",{className:"confirmation-dialog-box"},this.renderMessage(),this.renderButtons()))}},{key:"renderMessage",value:function(){var e=this.props.children;return f.default.createElement("div",{className:"message"},e)}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.onClose,a=e.onConfirm,r=t.locale.t,o={label:r("confirmation-cancel"),onClick:n,hidden:!n},s={label:r("confirmation-confirm"),onClick:a,hidden:!a,emphasized:!0};return f.default.createElement("div",{className:"buttons"},f.default.createElement(y.default,o),f.default.createElement(y.default,s))}}]),t}(h.PureComponent));C.displayName="ConfirmationDialogBox",t.default=C,t.ConfirmationDialogBox=C},"./dialogs/confirmation-dialog-box.scss":function(e,t){},"./dialogs/mobile-setup-dialog-box.jsx":function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!e)return e;var t=e.match(/.{1,4}/g);return _.toUpper(t.join(" "))}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileSetupDialogBox=t.default=void 0;var s=n("../../common/node_modules/babel-runtime/regenerator/index.js"),i=r(s),l=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),u=r(l),d=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=r(d),m=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=r(m),h=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),f=r(h),v=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),g=r(v),b=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),y=r(b),j=n("../../common/node_modules/react/index.js"),C=r(j),k=n("../../common/node_modules/relaks/index.js"),w=n("../../common/src/routing/universal-link.js"),E=a(w),x=n("../../common/src/objects/finders/device-finder.js"),P=a(x),R=n("../../common/src/objects/finders/user-finder.js"),D=a(R),S=n("../../common/src/widgets/overlay.jsx"),M=r(S),U=n("./widgets/push-button.jsx"),N=r(U),I=n("./widgets/qr-code.jsx"),O=r(I);n("./dialogs/mobile-setup-dialog-box.scss");var L=n("../../common/src/data/database.js"),A=(r(L),n("../../common/src/env/environment.js")),B=(r(A),function(e){function t(){return(0,p.default)(this,t),(0,g.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,f.default)(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onClose,a={show:t,onBackgroundClick:n},r=_.omit(this.props,"show");return C.default.createElement(M.default,a,C.default.createElement(T,r))}}]),t}(j.PureComponent));B.displayName="MobileSetupDialogBox";var T=function(e){function t(){return(0,p.default)(this,t),(0,g.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,f.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,u.default)(i.default.mark(function e(t){var n,a,r,o,s,l,u,d;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,a=n.database,r=n.env,o=n.system,s=n.onClose,l=a.use({by:this}),u={activationCode:void 0,currentUser:void 0,devices:void 0,system:o,database:a,env:r,onClose:s},t.show(C.default.createElement(F,u)),e.next=6,l.start();case 6:return d=e.sent,e.next=9,D.findUser(l,d);case 9:return u.currentUser=e.sent,e.next=12,l.beginMobileSession("client");case 12:return u.activationCode=e.sent,t.show(C.default.createElement(F,u)),e.next=16,P.findUserDevices(l,u.currentUser);case 16:return u.devices=e.sent,e.abrupt("return",C.default.createElement(F,u));case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentWillUnmount",value:function(){this.props.database.use({by:this}).releaseMobileSession()}}]),t}(k.AsyncComponent);T.displayName="MobileSetupForm";var F=function(e){function t(){return(0,p.default)(this,t),(0,g.default)(this,(t.__proto__||(0,c.default)(t)).apply(this,arguments))}return(0,y.default)(t,e),(0,f.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.devices,a=t.onClose;if(e.devices!==n){var r=e.activationCode;r&&_.some(e.devices,{session_handle:r})&&a&&a({type:"close",target:this})}}},{key:"render",value:function(){var e=this.props,t=e.database,n=e.env,a=e.system,r=e.activationCode,s=e.onClose,i=n.locale.t,l=t.context,u=l.address,d=l.schema,c=_.get(a,"settings.address");c||(u=c);var m=void 0;r&&(m=E.createActivationURL(u,d,r),console.log(m));var p={label:i("mobile-setup-close"),emphasized:!0,onClick:s};return C.default.createElement("div",{className:"mobile-setup-dialog-box"},C.default.createElement("div",{className:"contents"},C.default.createElement(O.default,{text:m,scale:6}),C.default.createElement("div",{className:"info"},C.default.createElement("div",{className:"label"},i("mobile-setup-address")),C.default.createElement("div",{className:"value"},u),C.default.createElement("div",{className:"label"},i("mobile-setup-code")),C.default.createElement("div",{className:"value"},o(r)),C.default.createElement("div",{className:"label"},i("mobile-setup-project")),C.default.createElement("div",{className:"value"},d))),C.default.createElement("div",{className:"buttons"},C.default.createElement(N.default,p)))}}]),t}(j.PureComponent);F.displayName="MobileSetupFormSyncSync",t.default=B,t.MobileSetupDialogBox=B},"./dialogs/mobile-setup-dialog-box.scss":function(e,t){},"./dialogs/photo-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoCaptureDialogBoxBrowserSync=t.PhotoCaptureDialogBoxBrowser=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),g=a(v),b=n("../../common/node_modules/lodash/lodash.js"),y=a(b),j=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),C=(a(j),n("../../common/node_modules/react/index.js")),_=a(C),k=n("../../common/node_modules/relaks/index.js"),w=n("../../common/node_modules/relaks-media-capture/index.js"),E=a(w),x=n("../../common/src/widgets/overlay.jsx"),P=a(x),R=n("./widgets/push-button.jsx"),D=a(R),S=n("../../common/src/widgets/live-video.jsx"),M=a(S),U=n("./widgets/device-selector.jsx"),N=a(U),I=n("./widgets/device-placeholder.jsx"),O=a(I);n("./dialogs/photo-capture-dialog-box-browser.scss");var L=n("../../common/src/transport/payloads.js"),A=(a(L),n("../../common/src/env/environment.js")),B=(a(A),function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));n.handleSnap=function(e){n.capture.snap()},n.handleClear=function(e){n.capture.clear()},n.handleChoose=function(e){n.capture.choose(e.id)},n.handleCancel=function(e){var t=n.props.onClose;t&&t({type:"cancel",target:n})},n.handleAccept=function(e){var t=n.props,a=t.payloads,r=t.onCapture;if(r){var o=n.capture.capturedImage,s=a.add("image");s.attachFile(o.blob);var i={type:"image",payload_token:s.id,width:o.width,height:o.height,format:y.default.last(y.default.split(n.capture.options.imageMIMEType,"/"))};r({type:"capture",target:n,resource:i})}n.capture.deactivate(),n.handleCancel()};var a={video:!0,audio:!1,preferredDevice:"front",watchVolume:!1,captureImageOnly:!0};return n.capture=new E.default(a),n}return(0,g.default)(t,e),(0,p.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,i.default)(o.default.mark(function e(t){var n,a,r,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,a=n.env,r=n.show,t.delay(50,50),s={env:a,show:r,onSnap:this.handleSnap,onClear:this.handleClear,onChoose:this.handleChoose,onAccept:this.handleAccept,onCancel:this.handleCancel},!r){e.next=14;break}this.capture.activate();case 5:return s.status=this.capture.status,s.devices=this.capture.devices,s.chosenDeviceID=this.capture.chosenDeviceID,s.liveVideo=this.capture.liveVideo,s.capturedImage=this.capture.capturedImage,t.show(_.default.createElement(T,s)),e.next=13,this.capture.change();case 13:if(this.capture.active){e.next=5;break}case 14:return e.abrupt("return",_.default.createElement(T,s));case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentDidUpdate",value:function(e,t){var n=this;e.show&&setTimeout(function(){n.props.show||(n.capture.deactivate(),n.capture.clear())},500)}},{key:"componentWillUnmount",value:function(){this.capture.deactivate()}}]),t}(k.AsyncComponent)),T=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onCancel,a={show:t,onBackgroundClick:n};return _.default.createElement(P.default,a,_.default.createElement("div",{className:"photo-capture-dialog-box"},_.default.createElement("div",{className:"container"},this.renderView()),_.default.createElement("div",{className:"controls"},_.default.createElement("div",{className:"left"},this.renderDeviceSelector()),_.default.createElement("div",{className:"right"},this.renderButtons()))))}},{key:"renderView",value:function(){var e=this.props,t=e.status,n=e.liveVideo,a=e.capturedImage;switch(t){case"acquiring":case"denied":var r={blocked:"denied"===t,icon:"camera"};return _.default.createElement(O.default,r);case"initiating":return _.default.createElement(M.default,{muted:!0});case"previewing":var o={srcObject:n.stream,width:n.width,height:n.height,muted:!0};return _.default.createElement(M.default,o);case"captured":var s={className:"preview",src:a.url,width:a.width,height:a.height};return _.default.createElement("img",s)}}},{key:"renderDeviceSelector",value:function(){var e=this.props,t=e.env,n=e.devices,a=e.chosenDeviceID,r=e.onChoose,o={type:"video",chosenDeviceID:a,devices:n,env:t,onSelect:r};return _.default.createElement(N.default,o)}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.status,a=this.props,r=a.onCancel,o=a.onSnap,s=a.onClear,i=a.onAccept,l=t.locale.t;switch(n){case"acquiring":case"denied":case"initiating":case"previewing":var u={label:l("photo-capture-cancel"),onClick:r},d={label:l("photo-capture-snap"),onClick:o,disabled:"previewing"!==n,emphasized:"previewing"===n};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,u),_.default.createElement(D.default,d));case"captured":var c={label:l("photo-capture-retake"),onClick:s},m={label:l("photo-capture-accept"),onClick:i,emphasized:!0};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,c),_.default.createElement(D.default,m))}}}]),t}(C.PureComponent);T.displayName="PhotoCaptureDialogBoxBrowserSync",t.default=B,t.PhotoCaptureDialogBoxBrowser=B,t.PhotoCaptureDialogBoxBrowserSync=T},"./dialogs/photo-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/photo-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoCaptureDialogBoxCordova=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),g=a(v),b=n("../../common/node_modules/lodash/lodash.js"),y=(a(b),n("../../common/node_modules/bluebird/js/browser/bluebird.js")),j=(a(y),n("../../common/node_modules/react/index.js")),C=(a(j),n("../../common/src/media/media-loader.js")),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(C),k=n("../../common/src/transport/cordova-file.js"),w=a(k),E=n("../../common/src/transport/payloads.js"),x=(a(E),n("../../common/src/env/environment.js")),P=(a(x),function(e){function t(){var e,n,a,r,s=this;(0,c.default)(this,t);for(var l=arguments.length,d=Array(l),m=0;m<l;m++)d[m]=arguments[m];return n=a=(0,f.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(d))),a.handleCaptureSuccess=function(){var e=(0,i.default)(o.default.mark(function e(t){var n,r,i,l,u;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.payloads,r=new w.default(t),a.triggerCloseEvent(),a.triggerCapturePendingEvent(),e.prev=4,e.next=7,r.obtainMetadata();case 7:return e.next=9,_.getImageMetadata(r);case 9:i=e.sent,l=n.add("image").attachFile(r),u={type:"image",payload_token:l.id,format:i.format,width:i.width,height:i.height},a.triggerCaptureEvent(u),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),a.triggerCaptureErrorEvent(e.t0);case 18:case"end":return e.stop()}},e,s,[[4,15]])}));return function(t){return e.apply(this,arguments)}}(),a.handleCaptureFailure=function(e){a.triggerCloseEvent()},r=n,(0,f.default)(a,r)}return(0,g.default)(t,e),(0,p.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.show;e.show&&!t&&this.startCapture(e)}},{key:"render",value:function(){return null}},{key:"startCapture",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,i.default)(o.default.mark(function e(t){var n,a,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=navigator.camera,n&&(a=void 0,"front"===t.cameraDirection?a=Camera.Direction.FRONT:"back"===t.cameraDirection&&(a=Camera.Direction.BACK),r={quality:50,destinationType:Camera.DestinationType.FILE_URI,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG,mediaType:Camera.MediaType.PICTURE,cameraDirection:a,allowEdit:!1},n.getPicture(this.handleCaptureSuccess,this.handleCaptureFailure,r));case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"image"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}}]),t}(j.PureComponent));P.displayName="PhotoCaptureDialogBoxCordova",t.default=P,t.PhotoCaptureDialogBoxCordova=P},"./dialogs/project-description-dialog-box.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectDescriptionDialogBox=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),p=a(m),h=n("../../common/node_modules/lodash/lodash.js"),f=a(h),v=n("../../common/node_modules/react/index.js"),g=a(v),b=n("../../common/src/widgets/overlay.jsx"),y=a(b),j=n("./widgets/push-button.jsx"),C=a(j),_=n("../../common/src/widgets/resource-view.jsx"),k=a(_),w=n("./widgets/scrollable.jsx"),E=a(w);n("./dialogs/project-description-dialog-box.scss");var x=n("../../common/src/env/environment.js"),P=(a(x),function(e){function t(){var e,n,a,r;(0,i.default)(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=(0,c.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(l))),a.handleCloseClick=function(e){var t=a.props.onClose;t&&t({type:"cancel",target:a})},r=n,(0,c.default)(a,r)}return(0,p.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCloseClick};return g.default.createElement(y.default,t,g.default.createElement("div",{className:"project-description-dialog-box"},this.renderText(),this.renderButtons()))}},{key:"renderText",value:function(){var e=this.props,t=e.env,n=e.project,a=n.name,r=n.details,o=r.resources,s=r.title,i=t.locale.p,l=f.default.find(o,{type:"image"});return g.default.createElement(E.default,null,g.default.createElement("div",{className:"title"},i(s)||a),g.default.createElement("div",{className:"description"},g.default.createElement("div",{className:"image"},g.default.createElement(k.default,{resource:l,width:160,env:t})),i(n.details.description)))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-description-close"),emphasized:!0,onClick:this.handleCloseClick};return g.default.createElement("div",{className:"buttons"},g.default.createElement(C.default,n))}}]),t}(v.PureComponent));P.displayName="ProjectDescriptionDialogBox",t.default=P,t.ProjectDescriptionDialogBox=P},"./dialogs/project-description-dialog-box.scss":function(e,t){},"./dialogs/project-management-dialog-box.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectManagementDialogBox=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/helpers/extends.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),f=a(h),v=n("../../common/node_modules/lodash/lodash.js"),g=a(v),b=n("../../common/node_modules/react/index.js"),y=a(b),j=n("../../common/src/widgets/overlay.jsx"),C=a(j),_=n("./widgets/push-button.jsx"),k=a(_),w=n("./widgets/scrollable.jsx"),E=a(w),x=n("./widgets/option-button.jsx"),P=a(x);n("./dialogs/project-management-dialog-box.scss");var R=n("../../common/src/routing/route.js"),D=(a(R),n("../../common/src/env/environment.js")),S=(a(D),function(e){function t(e){(0,u.default)(this,t);var n=(0,p.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleProjectClick=function(e){var t=n.state.selection,a=e.currentTarget.id;g.default.includes(t,a)?(t=g.default.without(t,a),g.default.pull(t,a)):t=g.default.concat(t,a),n.setState({selection:t})},n.handleRemoveClick=function(e){var t=n.props.onDelete,a=n.state.selection;t&&t({type:"delete",target:n,selection:a})},n.handleCancelClick=function(e){var t=n.props.onCancel;t&&t({type:"cancel",target:n})},n.state={selection:[]},n}return(0,f.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCancelClick};return y.default.createElement(C.default,t,y.default.createElement("div",{className:"project-management-dialog-box"},this.renderList(),this.renderButtons()))}},{key:"renderList",value:function(){var e=this,t=this.props.projectLinks;return y.default.createElement(E.default,null,g.default.map(t,function(t,n){return e.renderProjectButton(t,n)}))}},{key:"renderProjectButton",value:function(e,t){var n=this.props.env,a=this.state.selection,r=n.locale.p,s={id:e.key,label:r(e.name),iconOn:"times-circle",selected:g.default.includes(a,e.key),onClick:this.handleProjectClick};return y.default.createElement(P.default,(0,o.default)({key:t},s))}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state.selection,n=e.locale.t,a={label:n("project-management-cancel"),onClick:this.handleCancelClick},r={label:n("project-management-remove"),onClick:this.handleRemoveClick,emphasized:!0,disabled:g.default.isEmpty(t)};return y.default.createElement("div",{className:"buttons"},y.default.createElement(k.default,a),y.default.createElement(k.default,r))}}]),t}(b.PureComponent));S.displayName="ProjectManagementDialogBox",t.default=S,t.ProjectManagementDialogBox=S},"./dialogs/project-management-dialog-box.scss":function(e,t){},"./dialogs/system-description-dialog-box.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SystemDescriptionDialogBox=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),p=a(m),h=n("../../common/node_modules/lodash/lodash.js"),f=a(h),v=n("../../common/node_modules/react/index.js"),g=a(v),b=n("../../common/src/widgets/overlay.jsx"),y=a(b),j=n("./widgets/push-button.jsx"),C=a(j),_=n("./widgets/scrollable.jsx"),k=a(_);n("./dialogs/system-description-dialog-box.scss");var w=n("../../common/src/env/environment.js"),E=(a(w),function(e){function t(){var e,n,a,r;(0,i.default)(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=(0,c.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(l))),a.handleCloseClick=function(e){var t=a.props.onClose;t&&t({type:"cancel",target:a})},r=n,(0,c.default)(a,r)}return(0,p.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props.show,t={show:e,onBackgroundClick:this.handleCloseClick};return g.default.createElement(y.default,t,g.default.createElement("div",{className:"system-description-dialog-box"},this.renderText(),this.renderButtons()))}},{key:"renderText",value:function(){var e=this.props,t=e.env,n=e.system,a=t.locale.p,r=a(f.default.get(n,"details.title")),o=a(f.default.get(n,"details.description"));return g.default.createElement(k.default,null,g.default.createElement("div",{className:"title"},r),g.default.createElement("div",{className:"description"},o))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-description-close"),emphasized:!0,onClick:this.handleCloseClick};return g.default.createElement("div",{className:"buttons"},g.default.createElement(C.default,n))}}]),t}(v.PureComponent));E.displayName="SystemDescriptionDialogBox",t.default=E,t.SystemDescriptionDialogBox=E},"./dialogs/system-description-dialog-box.scss":function(e,t){},"./dialogs/video-capture-dialog-box-browser.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoCaptureDialogBoxBrowserSync=t.VideoCaptureDialogBoxBrowser=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),g=a(v),b=n("../../common/node_modules/lodash/lodash.js"),y=a(b),j=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),C=(a(j),n("../../common/node_modules/react/index.js")),_=a(C),k=n("../../common/node_modules/relaks/index.js"),w=n("../../common/node_modules/relaks-media-capture/index.js"),E=a(w),x=n("../../common/src/widgets/overlay.jsx"),P=a(x),R=n("./widgets/push-button.jsx"),D=a(R),S=n("../../common/src/widgets/live-video.jsx"),M=a(S),U=n("./widgets/device-selector.jsx"),N=a(U),I=n("./widgets/device-placeholder.jsx"),O=a(I),L=n("./widgets/duration-indicator.jsx"),A=a(L),B=n("./widgets/volume-indicator.jsx"),T=a(B);n("./dialogs/video-capture-dialog-box-browser.scss");var F=n("../../common/src/transport/payloads.js"),V=(a(F),n("../../common/src/env/environment.js")),W=(a(V),function(e){function t(e){(0,c.default)(this,t);var n=(0,f.default)(this,(t.__proto__||(0,u.default)(t)).call(this,e));n.handleStart=function(e){var t=n.props.payloads;n.stream=t.stream(),n.stream.start(),n.capture.start(),n.capture.snap()},n.handleStop=function(e){n.capture.stop()},n.handlePause=function(e){n.capture.pause()},n.handleResume=function(e){n.capture.resume()},n.handleClear=function(e){n.capture.clear(),n.stream&&(n.stream.cancel(),n.stream=null)},n.handleChoose=function(e){n.capture.choose(e.id)},n.handleCancel=function(e){var t=n.props.onClose;t&&t({type:"cancel",target:n})},n.handleAccept=function(e){var t=n.props,a=t.payloads,r=t.onCapture;if(r){var o=n.capture,s=o.capturedVideo,i=o.capturedImage,l=a.add("video");l.attachStream(n.stream),l.attachFile(i.blob,"poster");var u={type:"video",payload_token:l.id,width:s.width,height:s.height,duration:s.duration,format:y.default.last(y.default.split(n.capture.options.videoMIMEType,"/")),bitrates:{audio:n.capture.options.audioBitsPerSecond,video:n.capture.options.videoBitsPerSecond}};r({type:"capture",target:n,resource:u})}n.capture.deactivate(),n.handleCancel()},n.handleCaptureChunk=function(e){n.stream&&n.stream.push(e.blob)},n.handleCaptureEnd=function(e){n.stream&&n.stream.close()};var a={video:!0,audio:!0,preferredDevice:"front",watchVolume:!0,segmentDuration:2e3};return n.capture=new E.default(a),n.capture.addEventListener("chunk",n.handleCaptureChunk),n.capture.addEventListener("end",n.handleCaptureEnd),n.stream=null,n}return(0,g.default)(t,e),(0,p.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,i.default)(o.default.mark(function e(t){var n,a,r,s;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,a=n.env,r=n.show,t.delay(50,50),s={env:a,show:r,onStart:this.handleStart,onStop:this.handleStop,onPause:this.handlePause,onResume:this.handleResume,onClear:this.handleClear,onChoose:this.handleChoose,onAccept:this.handleAccept,onCancel:this.handleCancel},!r){e.next=17;break}this.capture.activate();case 5:return s.status=this.capture.status,s.devices=this.capture.devices,s.chosenDeviceID=this.capture.chosenDeviceID,s.liveVideo=this.capture.liveVideo,s.duration=this.capture.duration,s.volume=this.capture.volume<5?0:this.capture.volume,s.capturedImage=this.capture.capturedImage,s.capturedVideo=this.capture.capturedVideo,t.show(_.default.createElement(z,s)),e.next=16,this.capture.change();case 16:if(this.capture.active){e.next=5;break}case 17:return e.abrupt("return",_.default.createElement(z,s));case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentDidUpdate",value:function(e,t){var n=this;e.show&&setTimeout(function(){n.props.show||(n.capture.deactivate(),n.capture.clear())},500)}},{key:"componentWillUnmount",value:function(){this.capture.deactivate()}}]),t}(k.AsyncComponent)),z=function(e){function t(){return(0,c.default)(this,t),(0,f.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.onCancel,a={show:t,onBackgroundClick:n};return _.default.createElement(P.default,a,_.default.createElement("div",{className:"video-capture-dialog-box"},_.default.createElement("div",{className:"container"},this.renderView()),_.default.createElement("div",{className:"controls"},_.default.createElement("div",{className:"left"},this.renderDuration()||this.renderDeviceSelector()),_.default.createElement("div",{className:"center"},this.renderVolume()),_.default.createElement("div",{className:"right"},this.renderButtons()))))}},{key:"renderView",value:function(){var e=this.props,t=e.status,n=e.liveVideo,a=e.capturedVideo,r=e.capturedImage;switch(t){case"acquiring":case"denied":var o={blocked:"denied"===t,icon:"video-camera"};return _.default.createElement(O.default,o);case"initiating":return _.default.createElement(M.default,{muted:!0});case"previewing":case"capturing":case"paused":var s={srcObject:n.stream,width:n.width,height:n.height,muted:!0};return _.default.createElement(M.default,s);case"captured":var i={className:"preview",src:a.url,poster:r.url,width:a.width,height:a.height,controls:!0};return _.default.createElement("video",i)}}},{key:"renderDeviceSelector",value:function(){var e=this.props,t=e.env,n=e.devices,a=e.chosenDeviceID,r=e.onChoose,o={type:"video",chosenDeviceID:a,devices:n,env:t,onSelect:r};return _.default.createElement(N.default,o)}},{key:"renderDuration",value:function(){var e=this.props,t=e.status,n=e.duration;if("number"!=typeof n)return null;var a={duration:n,recording:"capturing"===t};return _.default.createElement(A.default,a)}},{key:"renderVolume",value:function(){var e=this.props,t=e.status,n=e.volume;if("number"!=typeof n||"captured"===t)return null;var a={volume:n,recording:"capturing"===t};return _.default.createElement(T.default,a)}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.status,a=this.props,r=a.onCancel,o=a.onStart,s=a.onPause,i=a.onResume,l=a.onStop,u=a.onClear,d=a.onAccept,c=t.locale.t;switch(n){case"acquiring":case"denied":case"initiating":case"previewing":var m={label:c("video-capture-cancel"),onClick:r},p={label:c("video-capture-start"),onClick:o,disabled:"previewing"!==n,emphasized:"previewing"===n};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,m),_.default.createElement(D.default,p));case"capturing":var h={label:c("video-capture-pause"),onClick:s},f={label:c("video-capture-stop"),onClick:l,emphasized:!0};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,h),_.default.createElement(D.default,f));case"paused":var v={label:c("video-capture-resume"),onClick:i,emphasized:!0},g={label:c("video-capture-stop"),onClick:l};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,v),_.default.createElement(D.default,g));case"captured":var b={label:c("video-capture-retake"),onClick:u},y={label:c("video-capture-accept"),onClick:d,emphasized:!0};return _.default.createElement("div",{className:"buttons"},_.default.createElement(D.default,b),_.default.createElement(D.default,y))}}}]),t}(C.PureComponent);z.displayName="VideoCaptureDialogBoxBrowserSync",t.default=W,t.VideoCaptureDialogBoxBrowser=W,t.VideoCaptureDialogBoxBrowserSync=z},"./dialogs/video-capture-dialog-box-browser.scss":function(e,t){},"./dialogs/video-capture-dialog-box-cordova.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return new k.default(function(t,n){var a=function(e){if("windows"===cordova.platformId){var n=C.default.lastIndexOf(e,"\\");if(-1!==n){var a=e.substr(n+1);e=cordova.file.dataDirectory+a}}t(e)},r=function(e){n(new Error(e))},o={fileUri:e.fullPath,outputFileName:e.name,quality:70};"windows"===cordova.platformId&&(o.outputFileName+=".jpg"),VideoEditor.createThumbnail(a,r,o)})}Object.defineProperty(t,"__esModule",{value:!0}),t.VideoCaptureDialogBoxCordova=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/regenerator/index.js"),s=a(o),i=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=a(i),u=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),d=a(u),c=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),m=a(c),p=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=a(p),f=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),v=a(f),g=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),b=a(g),y=function(){var e=(0,l.default)(s.default.mark(function e(){var t;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=cordova.plugins.permissions)&&"android"===cordova.platformId){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new k.default(function(e,n){var a=function(){e()},r=function(e){n(new Error("Unable to obtain permission"))};t.requestPermissions([t.RECORD_AUDIO,t.RECORD_VIDEO,t.READ_EXTERNAL_STORAGE,t.WRITE_EXTERNAL_STORAGE],a,r)}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),j=n("../../common/node_modules/lodash/lodash.js"),C=a(j),_=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),k=a(_),w=n("../../common/node_modules/react/index.js"),E=(a(w),n("../../common/src/media/media-loader.js")),x=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(E),P=n("../../common/src/transport/cordova-file.js"),R=a(P),D=n("../../common/src/transport/payloads.js"),S=(a(D),n("../../common/src/env/environment.js")),M=(a(S),function(e){function t(){var e,n,a,o,i=this;(0,m.default)(this,t);for(var u=arguments.length,c=Array(u),p=0;p<u;p++)c[p]=arguments[p];return n=a=(0,v.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(c))),a.handleCaptureSuccess=function(){var e=(0,l.default)(s.default.mark(function e(t){var n,o,l,u,d,c,m,p,h,f;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.payloads,a.triggerCloseEvent(),!(o=t[0])){e.next=37;break}return a.triggerCapturePendingEvent(),e.prev=5,e.next=8,x.getFormatData(o);case 8:return l=e.sent,u=void 0,u="windows"===cordova.platformId?o.localURL:o.fullPath,d=new R.default(u,o.type,o.size),c=n.add("video"),c.attachFile(d),m={type:"video",payload_token:c.id,format:x.extractFileFormat(o.type),filename:o.name,duration:1e3*l.duration},e.prev=15,e.next=18,r(d);case 18:return p=e.sent,h=new R.default(p),e.next=22,x.getImageMetadata(h);case 22:f=e.sent,c.attachFile(h,"poster"),m.width=f.width,m.height=f.height,e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),c.attachStep("main","poster");case 31:a.triggerCaptureEvent(m),e.next=37;break;case 34:e.prev=34,e.t1=e.catch(5),a.triggerCaptureErrorEvent(e.t1);case 37:case"end":return e.stop()}},e,i,[[5,34],[15,28]])}));return function(t){return e.apply(this,arguments)}}(),a.handleCaptureFailure=function(e){a.triggerCloseEvent(),a.triggerCaptureErrorEvent(e)},o=n,(0,v.default)(a,o)}return(0,b.default)(t,e),(0,h.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.show;e.show&&!t&&this.startCapture()}},{key:"render",value:function(){return null}},{key:"startCapture",value:function(){function e(){return t.apply(this,arguments)}var t=(0,l.default)(s.default.mark(function e(){var t,n;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=navigator.device.capture)){e.next=6;break}return e.next=4,y();case 4:n={duration:18e3,limit:1},t.captureVideo(this.handleCaptureSuccess,this.handleCaptureFailure,n);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"triggerCloseEvent",value:function(){var e=this.props.onClose;e&&e({type:"close",target:this})}},{key:"triggerCaptureEvent",value:function(e){var t=this.props.onCapture;t&&t({type:"capture",target:this,resource:e})}},{key:"triggerCapturePendingEvent",value:function(){var e=this.props.onCapturePending;e&&e({type:"capturepending",target:this,resourceType:"video"})}},{key:"triggerCaptureErrorEvent",value:function(e){var t=this.props.onCaptureError;t&&t({type:"capturefailure",target:this,error:e})}}]),t}(w.PureComponent));M.displayName="VideoCaptureDialogBoxCordova",t.default=M,t.VideoCaptureDialogBoxCordova=M},"./editors/image-editor.jsx":function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditor=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/regenerator/index.js"),s=r(o),i=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=r(i),u=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),d=r(u),c=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),m=r(c),p=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=r(p),f=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),v=r(f),g=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),b=r(g),y=n("../../common/node_modules/lodash/lodash.js"),j=r(y),C=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),_=(r(C),n("../../common/node_modules/react/index.js")),k=r(_),w=n("../../common/src/transport/blob-manager.js"),E=a(w),x=n("../../common/src/transport/payload.js"),P=(r(x),n("../../common/src/media/image-cropping.js")),R=(a(P),n("../../common/src/utils/focus-manager.js")),D=a(R),S=n("../../common/src/objects/utils/resource-utils.js"),M=a(S),U=n("../../common/src/utils/component-refs.js"),N=r(U),I=n("../../common/src/widgets/image-cropper.jsx"),O=r(I);n("./editors/image-editor.scss");var L=n("../../common/src/env/environment.js"),A=(r(L),function(e){function t(e){(0,m.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return n.handleClipRectChange=function(e){var t=n.props.resource;n.components.imageCropper;t=j.default.clone(t),t.clip=e.rect,n.triggerChangeEvent(t)},n.handleFullImageLoad=function(e){var t=(n.props.resource,n.components.imageCropper,e.target.props.url);n.setState({loadedImageURL:t})},n.components=(0,N.default)({imageCropper:O.default}),n.state={loadingFullImage:"",fullImageLoaded:""},n}return(0,b.default)(t,e),(0,h.default)(t,[{key:"render",value:function(){var e=this.props.children;return k.default.createElement("div",{className:"image-editor"},this.renderImage(),this.renderSpinner(),e)}},{key:"renderImage",value:function(){var e=this.getLocalImageURL(),t=this.getPreviewImageURL();return e?this.renderImageCropper():t?this.renderPreviewImage():this.renderPlaceholder()}},{key:"renderPreviewImage",value:function(){var e=this.props,t=e.previewWidth,n=e.previewHeight,a=e.disabled,r=this.getPreviewImageURL(),o="preview";a&&(o+=" disabled");var s={src:r,width:t,height:n};return k.default.createElement("div",{className:o},k.default.createElement("img",s))}},{key:"renderSpinner",value:function(){if(this.props.disabled)return null;var e=this.getLocalImageURL(),t=this.getPreviewImageURL();return e||!t?null:k.default.createElement("div",{className:"spinner"},k.default.createElement("i",{className:"fa fa-refresh fa-spin fa-fw"}))}},{key:"renderImageCropper",value:function(){var e=this.props,t=e.resource,n=e.disabled,a=this.components.setters,r=this.getLocalImageURL(),o=M.getClippingRect(t,{}),s={ref:a.imageCropper,url:r,clippingRect:o,vector:"svg"===t.format,disabled:n,onChange:this.handleClipRectChange,onLoad:this.handleFullImageLoad};return k.default.createElement(O.default,s)}},{key:"renderPlaceholder",value:function(){var e=this.props,t=e.env,n=e.resource,a=t.locale.t,r=void 0,o=void 0;return n.width&&n.height?(r=a("image-editor-upload-in-progress"),o="cloud-upload"):n.pending||("video"===n.type?(r=a("image-editor-poster-extraction-in-progress"),o="film"):"website"===n.type?(r=a("image-editor-page-rendering-in-progress"),o="file-image-o"):"image"===n.type&&(r=a("image-editor-image-transfer-in-progress"),o="file-image-o")),k.default.createElement("div",{className:"placeholder"},k.default.createElement("div",{className:"icon"},k.default.createElement("i",{className:"fa fa-"+o})),k.default.createElement("div",{className:"message"},r))}},{key:"componentDidMount",value:function(){D.register(this,{type:"ImageEditor"}),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,l.default)(s.default.mark(function e(t,n){var a,r,o;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.loadingFullImage,r=this.getLocalImageURL(),o=this.getRemoteImageURL(),r||!o){e.next=9;break}if(a===o){e.next=9;break}return this.setState({loadingFullImage:o}),e.next=8,E.fetch(o);case 8:this.setState({fullImageLoaded:o});case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentWillUnmount",value:function(){D.unregister(this)}},{key:"getRemoteImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,a={remote:!0,original:!0};return M.getImageURL(n,a,t)}},{key:"getLocalImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,a={local:!0,original:!0};return M.getImageURL(n,a,t)}},{key:"getPreviewImageURL",value:function(){var e=this.props,t=e.env,n=e.resource,a=e.previewWidth,r=e.previewHeight,o={remote:!0,width:a,height:r};return M.getImageURL(n,o,t)}},{key:"focus",value:function(){var e=this.components.imageCropper;e&&e.focus()}},{key:"triggerChangeEvent",value:function(e){var t=this.props.onChange;t&&t({type:"change",target:this,resource:e})}}]),t}(_.PureComponent));A.displayName="ImageEditor",A.defaultProps={previewWidth:512,previewHeight:512,disabled:!1},t.default=A,t.ImageEditor=A},"./editors/image-editor.scss":function(e,t){},"./editors/media-editor.scss":function(e,t){},"./editors/media-importer.jsx":function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return x.default.toUpper((0,S.default)().format("YYYY-MMM-DD-hhA"))+e}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaImporter=t.default=void 0;var s=n("../../common/node_modules/babel-runtime/regenerator/index.js"),i=r(s),l=n("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),u=r(l),d=n("../../common/node_modules/babel-runtime/helpers/slicedToArray.js"),c=r(d),m=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=r(m),h=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),f=r(h),v=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),g=r(v),b=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),y=r(b),j=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),C=r(j),_=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),k=r(_),w=function(){var e=(0,p.default)(i.default.mark(function e(t){var n,a;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=x.default.map(t,function(e){if("string"===e.kind&&/^text\/(html|uri-list)/.test(e.type))return new R.default(function(t,a){e.getAsString(function(a){n[e.type]=a,t()})})}),e.next=4,R.default.all(a);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),E=n("../../common/node_modules/lodash/lodash.js"),x=r(E),P=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),R=r(P),D=n("../../common/node_modules/moment/moment.js"),S=r(D),M=n("../../common/node_modules/react/index.js"),U=r(M),N=n("../../common/src/media/media-loader.js"),I=a(N),O=n("../../common/src/media/media-tag-reader.js"),L=a(O),A=n("../../common/src/media/quick-start.js"),B=a(A),T=n("../../common/src/transport/blob-reader.js"),F=(a(T),n("../../common/src/objects/types/resource-types.js")),V=r(F),W=n("./dialogs/photo-capture-dialog-box-browser.jsx"),z=r(W),G=n("./dialogs/photo-capture-dialog-box-cordova.jsx"),q=r(G),H=n("./dialogs/audio-capture-dialog-box-browser.jsx"),Y=r(H),X=n("./dialogs/audio-capture-dialog-box-cordova.jsx"),K=r(X),J=n("./dialogs/video-capture-dialog-box-browser.jsx"),Z=r(J),$=n("./dialogs/video-capture-dialog-box-cordova.jsx"),Q=r($);n("./editors/media-editor.scss");var ee=n("../../common/src/env/environment.js"),te=(r(ee),n("../../common/src/transport/payloads.js")),ne=(r(te),function(e){function t(e){(0,g.default)(this,t);var n=(0,C.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return n.handleClose=function(e){n.setState({capturing:null}),n.triggerCaptureEndEvent()},n.handleCapturePending=function(e){n.resourcePlaceholder={type:e.resourceType,pending:"capture-"+ ++re},n.addResources([n.resourcePlaceholder])},n.handleCaptureError=function(e){n.resourcePlaceholder&&n.removeResource(n.resourcePlaceholder)},n.handleCapture=function(e){var t=x.default.clone(e.resource),a="jpeg"===t.format?"jpg":t.format;t.filename=o("."+a),n.resourcePlaceholder?n.updateResource(n.resourcePlaceholder,t):n.addResources([t])},n.state={capturing:null},n}return(0,k.default)(t,e),(0,y.default)(t,[{key:"isAcceptable",value:function(e){var t=this.props.types;return x.default.includes(t,e)}},{key:"getResourceType",value:function(e){var t=I.extractFileCategory(e);if(this.isAcceptable(t))return t}},{key:"capture",value:function(e){this.setState({capturing:e}),this.triggerCaptureStartEvent()}},{key:"importFiles",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){var n,a,r,o,s,l,d,m,p,h,f,v,g=this;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=x.default.filter(t,function(e){return!!g.getResourceType(e.type)}),n=x.default.map(t,function(e){return g.getResourceType(e.type)}),a=this.addResourcePlaceholders(n),r=!0,o=!1,s=void 0,e.prev=6,l=(0,u.default)(t.entries());case 8:if(r=(d=l.next()).done){e.next=26;break}return m=d.value,p=(0,c.default)(m,2),h=p[0],f=p[1],e.prev=13,e.next=16,this.importFile(f);case 16:v=e.sent,this.updateResource(a[h],v),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),this.removeResource(a[h]);case 23:r=!0,e.next=8;break;case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(6),o=!0,s=e.t1;case 32:e.prev=32,e.prev=33,!r&&l.return&&l.return();case 35:if(e.prev=35,!o){e.next=38;break}throw s;case 38:return e.finish(35);case 39:return e.finish(32);case 40:case"end":return e.stop()}},e,this,[[6,28,32,40],[13,20],[33,,35,39]])}));return e}()},{key:"importFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.getResourceType(t.type),e.next="image"===e.t0?3:"video"===e.t0?4:"audio"===e.t0?5:6;break;case 3:return e.abrupt("return",this.importImageFile(t));case 4:return e.abrupt("return",this.importVideoFile(t));case 5:return e.abrupt("return",this.importAudioFile(t));case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"importImageFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){var n,a,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.payloads,a=n.add("image").attachFile(t),e.prev=2,e.next=5,I.getImageMetadata(t);case 5:return r=e.sent,e.abrupt("return",{type:"image",payload_token:a.id,width:r.width,height:r.height,format:r.format,filename:t.name,imported:!0});case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",{type:"image",payload_token:a.id,format:I.extractFileFormat(t.type),filename:t.name,imported:!0});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return e}()},{key:"importVideoFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){var n,a,r,o,s;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.payloads,e.next=3,B.process(t);case 3:return a=e.sent,a||(a=t),r=n.add("video"),o=n.stream().pipe(a),r.attachStream(o),e.prev=7,e.next=10,I.getVideoMetadata(a);case 10:return s=e.sent,r.attachFile(s.poster,"poster"),e.abrupt("return",{type:"video",payload_token:r.id,width:s.width,height:s.height,format:s.format,duration:s.duration,filename:t.name,imported:!0});case 15:return e.prev=15,e.t0=e.catch(7),r.attachStep("main","poster"),e.abrupt("return",{type:"video",payload_token:r.id,format:I.extractFileFormat(t.type),filename:t.name,imported:!0});case 19:case"end":return e.stop()}},e,this,[[7,15]])}));return e}()},{key:"importAudioFile",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){var n,a,r,o,s,l,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.payloads,a=n.add("audio"),r=n.stream().pipe(t),a.attachStream(r),e.prev=3,e.next=6,I.getAudioMetadata(t);case 6:return o=e.sent,s={type:"audio",payload_token:a.id,format:o.format,duration:o.duration,filename:t.name,imported:!0},e.next=10,L.extractAlbumArt(t);case 10:if(!(l=e.sent)){e.next=17;break}return e.next=14,I.getImageMetadata(l);case 14:u=e.sent,s.width=u.width,s.height=u.height;case 17:return a.attachFile(l,"poster"),e.abrupt("return",s);case 21:return e.prev=21,e.t0=e.catch(3),e.abrupt("return",{type:"audio",payload_token:a.id,format:I.extractFileFormat(t.type),filename:t.name,imported:!0});case 24:case"end":return e.stop()}},e,this,[[3,21]])}));return e}()},{key:"importDataItems",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,p.default)(i.default.mark(function e(t){var n,a,r,o,s,l,u,d;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.payloads,e.next=3,w(t);case 3:a=e.sent,r=a["text/html"],/<img\b/i.test(r)&&this.isAcceptable("image")&&(o=/<img\b.*?\bsrc="(.*?)"/.exec(r))&&(s=x.default.unescape(o[1]),l=s.replace(/.*\/([^\?#]*).*/,"$1")||void 0,u=n.add("image").attachURL(s),d={type:"image",payload_token:u.id,filename:l},this.addResources([d]));case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"render",value:function(){return U.default.createElement("div",null,this.renderPhotoDialog(),this.renderAudioDialog(),this.renderVideoDialog())}},{key:"renderPhotoDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,a=e.cameraDirection,r=this.state.capturing,o={show:"image"===r,cameraDirection:a,payloads:t,env:n,onLoadStart:this.handleLoadStart,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?U.default.createElement(z.default,o):"cordova"===n.platform?U.default.createElement(q.default,o):void 0}},{key:"renderVideoDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,a=e.cameraDirection,r=this.state.capturing,o={show:"video"===r,cameraDirection:a,payloads:t,env:n,onLoadStart:this.handleLoadStart,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?U.default.createElement(Z.default,o):"cordova"===n.platform?U.default.createElement(Q.default,o):void 0}},{key:"renderAudioDialog",value:function(){var e=this.props,t=e.payloads,n=e.env,a=(e.cameraDirection,this.state.capturing),r={show:"audio"===a,payloads:t,env:n,onClose:this.handleClose,onCapturePending:this.handleCapturePending,onCaptureError:this.handleCaptureError,onCapture:this.handleCapture};return"browser"===n.platform?U.default.createElement(Y.default,r):"cordova"===n.platform?U.default.createElement(K.default,r):void 0}},{key:"componentWillUnmount",value:function(){this.state.capturing&&this.triggerCaptureEndEvent()}},{key:"addResourcePlaceholders",value:function(e){var t=x.default.map(e,function(e){return{type:e,pending:"import-"+ ++ae,imported:!0}});return this.addResources(t),t}},{key:"addResources",value:function(e){var t=this.props,n=t.resources,a=t.limit;if(!x.default.isEmpty(e)){var r=n.length;if(1===a){var o=x.default.first(e),s=x.default.findIndex(n,{type:o.type});n=x.default.concat(n,o),-1!==s&&(n.splice(s,1),r--)}else n=x.default.concat(n,e);this.triggerChangeEvent(n,r)}}},{key:"updateResource",value:function(e,t){var n=this.props.resources,a=x.default.findIndex(n,e);return-1!==a&&(n=x.default.slice(n),n[a]=t,this.triggerChangeEvent(n)),null}},{key:"removeResource",value:function(e,t){var n=this.props.resources,a=x.default.findIndex(n,e);-1!==a&&(n=x.default.slice(n),n.splice(a,1),this.triggerChangeEvent(n))}},{key:"triggerChangeEvent",value:function(e,t){var n=this.props.onChange;n&&n({type:"change",target:this,resources:e,selection:t})}},{key:"triggerCaptureStartEvent",value:function(){var e=this.props.onCaptureStart,t=this.state.capturing;e&&e({type:"capturestart",target:this,mediaType:t})}},{key:"triggerCaptureEndEvent",value:function(e){var t=this.props.onCaptureEnd,n=this.state.capturing;t&&t({type:"captureend",target:this,mediaType:n,resource:e})}}]),t}(M.PureComponent));ne.displayName="MediaImporter";var ae=0,re=0;ne.defaultProps={types:V.default,limit:1/0},t.default=ne,t.MediaImporter=ne},"./pages/settings-page.jsx":function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SettingsPageSync=t.SettingsPage=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/regenerator/index.js"),s=r(o),i=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=r(i),u=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),d=r(u),c=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),m=r(c),p=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=r(p),f=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),v=r(f),g=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),b=r(g),y=n("../../common/node_modules/lodash/lodash.js"),j=r(y),C=n("../../common/node_modules/react/index.js"),_=r(C),k=n("../../common/node_modules/relaks/index.js"),w=n("../../common/src/utils/konami-code.js"),E=a(w),x=n("../../common/src/objects/finders/device-finder.js"),P=a(x),R=n("../../common/src/objects/finders/project-finder.js"),D=a(R),S=n("../../common/src/objects/finders/project-link-finder.js"),M=a(S),U=n("../../common/src/objects/finders/repo-finder.js"),N=a(U),I=n("../../common/src/objects/finders/system-finder.js"),O=a(I),L=n("../../common/src/objects/finders/user-finder.js"),A=a(L),B=n("../../common/src/objects/utils/user-utils.js"),T=a(B),F=n("./widgets/page-container.jsx"),V=r(F),W=n("./panels/development-panel.jsx"),z=r(W),G=n("./panels/project-panel.jsx"),q=r(G),H=n("./panels/device-panel.jsx"),Y=r(H),X=n("./panels/user-info-panel.jsx"),K=r(X),J=n("./panels/user-image-panel.jsx"),Z=r(J),$=n("./panels/notification-panel.jsx"),Q=r($),ee=n("./panels/web-alert-panel.jsx"),te=r(ee),ne=n("./panels/mobile-alert-panel.jsx"),ae=r(ne),re=n("./panels/social-network-panel.jsx"),oe=r(re),se=n("./panels/language-panel.jsx"),ie=r(se),le=n("../../common/src/widgets/error-boundary.jsx"),ue=r(le);n("./pages/settings-page.scss");var de=n("../../common/src/data/database.js"),ce=(r(de),n("../../common/src/transport/payloads.js")),me=(r(ce),n("../../common/src/routing/route.js")),pe=(r(me),n("../../common/src/env/environment.js")),he=(r(pe),function(e){function t(){return(0,m.default)(this,t),(0,v.default)(this,(t.__proto__||(0,d.default)(t)).apply(this,arguments))}return(0,b.default)(t,e),(0,h.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,l.default)(s.default.mark(function e(t){var n,a,r,o,i,l,u,d;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,a=n.database,r=n.route,o=n.payloads,i=n.env,l=a.use({by:this}),u={database:a,payloads:o,route:r,env:i},t.show(_.default.createElement(fe,u)),e.next=6,l.start();case 6:return d=e.sent,e.next=9,A.findUser(l,d);case 9:return u.currentUser=e.sent,e.next=12,M.findActiveLinks(l);case 12:return u.projectLinks=e.sent,e.next=15,D.findCurrentProject(l);case 15:return u.currentProject=e.sent,t.show(_.default.createElement(fe,u)),e.next=19,P.findUserDevices(l,u.currentUser,1);case 19:return u.devices=e.sent,t.show(_.default.createElement(fe,u)),e.next=23,N.findProjectRepos(l,u.currentProject);case 23:return u.repos=e.sent,t.show(_.default.createElement(fe,u)),e.next=27,O.findSystem(l);case 27:return u.system=e.sent,e.abrupt("return",_.default.createElement(fe,u));case 29:case"end":return e.stop()}},e,this)}));return e}()}]),t}(k.AsyncComponent));he.displayName="SettingsPage";var fe=function(e){function t(e){(0,m.default)(this,t);var n=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return n.handleChange=function(e){n.saveUser(e.user,e.immediate||!1)},n.handleKonamiCode=function(e){var t=n.props.currentUser,a=j.default.decoupleSet(t,"settings.development.show_panel",!0);n.saveUser(a,!0)},n.state={original:null,draft:null},n}return(0,b.default)(t,e),(0,h.default)(t,[{key:"render",value:function(){var e=this.props,t=e.env;return e.currentUser?_.default.createElement(V.default,{className:"settings-page"},_.default.createElement("div",{className:"panels"},_.default.createElement(ue.default,{env:t},this.renderDevelopmentPanel(),this.renderProjectPanel(),this.renderDevicePanel(),this.renderNotificationPanel(),this.renderWebAlertPanel(),this.renderMobileAlertPanel(),this.renderUserInfoPanel(),this.renderUserImagePanel(),this.renderSocialNetworkPanel(),this.renderLanguagePanel()))):null}},{key:"renderDevelopmentPanel",value:function(){var e=this.props,t=e.route,n=e.env,a=e.currentUser;if(!j.default.get(a,"settings.development.show_panel"))return null;var r={currentUser:a,route:t,env:n,onChange:this.handleChange};return _.default.createElement(z.default,r)}},{key:"renderProjectPanel",value:function(){var e=this.props,t=e.system,n=e.currentProject,a=e.projectLinks,r=e.database,o=e.route,s=e.env,i=e.currentUser,l={system:t,currentUser:i,currentProject:n,projectLinks:a,database:r,route:o,env:s,onChange:this.handleChange};return _.default.createElement(q.default,l)}},{key:"renderDevicePanel",value:function(){var e=this.props,t=e.database,n=e.route,a=e.env,r=e.devices;if("cordova"===a.platform)return null;if(j.default.isEmpty(r))return null;var o={devices:r,database:t,route:n,env:a};return _.default.createElement(Y.default,o)}},{key:"renderUserInfoPanel",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=this.state.draft,r={currentUser:a||n,env:t,onChange:this.handleChange};return _.default.createElement(K.default,r)}},{key:"renderUserImagePanel",value:function(){var e=this.props,t=e.env,n=e.payloads,a=e.currentUser,r=this.state.draft,o={currentUser:r||a,payloads:n,env:t,onChange:this.handleChange};return _.default.createElement(Z.default,o)}},{key:"renderSocialNetworkPanel",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=this.state.draft,r={currentUser:a||n,env:t,onChange:this.handleChange};return _.default.createElement(oe.default,r)}},{key:"renderNotificationPanel",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=e.repos,r=this.state.draft,o={currentUser:r||n,repos:a,env:t,onChange:this.handleChange};return _.default.createElement(Q.default,o)}},{key:"renderWebAlertPanel",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=e.repos,r=this.state.draft;if("cordova"===t.platform)return null;var o={currentUser:r||n,repos:a,env:t,onChange:this.handleChange};return _.default.createElement(te.default,o)}},{key:"renderMobileAlertPanel",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=e.devices,r=e.repos,o=this.state.draft;if(j.default.isEmpty(a))return null;var s={currentUser:o||n,repos:r,env:t,onChange:this.handleChange};return _.default.createElement(ae.default,s)}},{key:"renderLanguagePanel",value:function(){var e=this.props.env,t={env:e};return _.default.createElement(ie.default,t)}},{key:"componentDidMount",value:function(){E.addListener(this.handleKonamiCode)}},{key:"componentWillUnmount",value:function(){E.removeListener(this.handleKonamiCode)}},{key:"saveUser",value:function(){function e(e,n){return t.apply(this,arguments)}var t=(0,l.default)(s.default.mark(function e(t,n){var a,r,o,i,l,u,d;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props,r=a.database,o=a.payloads,i=this.state.original,l={delay:n?void 0:2e3,onConflict:function(e){T.mergeRemoteChanges(e.local,e.remote,i)&&e.preventDefault()}},this.setState({draft:t}),u=r.use({schema:"global",by:this}),e.next=7,u.saveOne({table:"user"},t,l);case 7:return d=e.sent,o.dispatch(d),e.abrupt("return",d);case 10:case"end":return e.stop()}},e,this)}));return e}()}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.currentUser,a=t.original,r=t.draft;return n&&(n.uncommitted||(a=n),r&&r.gn!==n.gn&&(r=null)),{original:a,draft:r}}}]),t}(C.PureComponent);fe.displayName="SettingsPageSync",t.default=he,t.SettingsPage=he,t.SettingsPageSync=fe},"./pages/settings-page.scss":function(e,t){},"./panels/development-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DevelopmentPanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/regenerator/index.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/extends.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),g=a(v),b=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),y=a(b),j=n("../../common/node_modules/lodash/lodash.js"),C=a(j),_=n("../../common/node_modules/react/index.js"),k=a(_),w=n("../../common/src/transport/code-push.js"),E=(a(w),n("./widgets/settings-panel.jsx")),x=a(E),P=n("./widgets/push-button.jsx"),R=a(P),D=n("./widgets/option-button.jsx"),S=a(D);n("./panels/development-panel.scss");var M=n("../../common/src/routing/route.js"),U=(a(M),n("../../common/src/env/environment.js")),N=(a(U),function(e){function t(e){(0,p.default)(this,t);var n=(0,g.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));I.call(n);var a=e.env,r=void 0;return a.codePush&&(r=a.codePush.getDeploymentNames()),n.state={deploymentName:C.default.first(r)},n}return(0,y.default)(t,e),(0,f.default)(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=C.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return k.default.createElement(x.default,{className:"diagnostics"},k.default.createElement("header",null,k.default.createElement("div",{className:"icon"},k.default.createElement("i",{className:"fa fa-bug"}),k.default.createElement("i",{className:"fa fa-search icon-overlay"}))," ",t("settings-development")),k.default.createElement("body",null,this.renderDevelopmentOptions(),this.renderDeploymentOptions()),k.default.createElement("footer",null,this.renderButtons()))}},{key:"renderDeploymentOptions",value:function(){var e=this.props.env;if(!e.codePush)return null;var t=e.codePush.getDeploymentNames();return C.default.map(t,this.renderDeploymentOption.bind(this))}},{key:"renderDevelopmentOptions",value:function(){var e=["show-panel"];return C.default.map(e,this.renderDevelopmentOption.bind(this))}},{key:"renderDevelopmentOption",value:function(e,t){var n=this.props,a=n.env,r=n.currentUser,o=a.locale.t,s=C.default.snakeCase(e),i=C.default.get(r,"settings",{}),l=!!C.default.get(i,"development."+s),d={label:o("development-"+e),selected:l,onClick:this.handleDevelopmentOptionClick,id:s};return k.default.createElement(S.default,(0,u.default)({key:t},d))}},{key:"renderDeploymentOption",value:function(e,t){var n=this.props.env,a=this.state.deploymentName,r=n.locale.t,o={label:r("development-code-push-$deployment",e),selected:e===a,onClick:this.handleDeploymentOptionClick,id:e};return k.default.createElement(S.default,(0,u.default)({key:t},o))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("development-show-diagnostics"),onClick:this.handleShowClick};return k.default.createElement("div",{className:"buttons"},k.default.createElement(R.default,n))}},{key:"componentDidMount",value:function(){function e(){return t.apply(this,arguments)}var t=(0,i.default)(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.env,!t.codePush){e.next=6;break}return e.next=4,t.codePush.loadDeploymentName();case 4:n=e.sent,this.setState({deploymentName:n});case 6:case"end":return e.stop()}},e,this)}));return e}()}]),t}(_.PureComponent));N.displayName="DevelopmentPanel";var I=function(){var e=this;this.handleDevelopmentOptionClick=function(t){var n=e.props.currentUser,a=t.currentTarget.id,r="development."+a,o=C.default.clone(C.default.get(n,"settings",{}));!C.default.get(o,r)?C.default.set(o,r,!0):C.default.unset(o,r),e.setUserProperty("settings",o)},this.handleDeploymentOptionClick=function(t){var n=e.props.env;if(!n.codePush)return null;var a=t.currentTarget.id;n.codePush.saveDeploymentName(a),e.setState({deploymentName:a})},this.handleShowClick=function(t){e.props.route.push("diagnostics-page")}};t.default=N,t.DevelopmentPanel=N},"./panels/development-panel.scss":function(e,t){},"./panels/device-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.type,n=void 0;switch(t){case"ios":case"osx":n="apple";break;default:n=t}return k.default.createElement("div",{className:"device-icon"},k.default.createElement("i",{className:"fa fa-tablet background"}),k.default.createElement("i",{className:"fa fa-"+n+" icon-overlay"}))}function o(e){var t=e.details.manufacturer,n=e.details.display_name||e.details.name;return C.default.includes(C.default.toLower(n),C.default.toLower(t))||(n=t+" "+n),n}Object.defineProperty(t,"__esModule",{value:!0}),t.DevicePanel=t.default=void 0;var s=n("../../common/node_modules/babel-runtime/regenerator/index.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),f=a(h),v=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),g=a(v),b=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),y=a(b),j=n("../../common/node_modules/lodash/lodash.js"),C=a(j),_=n("../../common/node_modules/react/index.js"),k=a(_),w=n("./widgets/settings-panel.jsx"),E=a(w),x=n("./widgets/push-button.jsx"),P=(a(x),n("./dialogs/confirmation-dialog-box.jsx")),R=a(P);n("./panels/device-panel.scss");var D=n("../../common/src/data/database.js"),S=(a(D),n("../../common/src/routing/route.js")),M=(a(S),n("../../common/src/env/environment.js")),U=(a(M),function(e){function t(e){var n=this;(0,p.default)(this,t);var a=(0,g.default)(this,(t.__proto__||(0,c.default)(t)).call(this,e));return a.handleRevokeClick=function(e){var t=parseInt(e.currentTarget.getAttribute("data-device-id"));a.setState({confirmingRevocation:!0,selectedDeviceID:t})},a.handleRevokeConfirm=function(){var e=(0,u.default)(i.default.mark(function e(t){var r,o,s,l,u,d;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,o=r.database,s=r.devices,l=a.state.selectedDeviceID,u=C.default.find(s,{id:l}),d=o.use({schema:"global",by:a}),e.prev=4,e.next=7,d.removeOne({table:"device"},u);case 7:return e.next=9,d.endMobileSession(u.session_handle);case 9:return e.prev=9,a.handleDialogClose(),e.finish(9);case 12:case"end":return e.stop()}},e,n,[[4,,9,12]])}));return function(t){return e.apply(this,arguments)}}(),a.handleDialogClose=function(e){a.setState({confirmingRevocation:!1})},a.state={confirmingRevocation:!1,selectedDeviceID:null},a}return(0,y.default)(t,e),(0,f.default)(t,[{key:"render",value:function(){var e=this.props,t=e.env,n=e.devices,a=t.locale.t,r=void 0;return r=a(1===C.default.size(n)?"settings-device":"settings-devices"),k.default.createElement(E.default,{className:"device"},k.default.createElement("header",null,k.default.createElement("i",{className:"fa fa-tablet"})," ",r),k.default.createElement("body",null,this.renderDevices(),this.renderDialogBox()))}},{key:"renderDevices",value:function(){var e=this,t=this.props.devices;return C.default.map(t,function(t){return e.renderDevice(t)})}},{key:"renderDevice",value:function(e){var t=this.props.env,n=t.locale.t,a=o(e);return k.default.createElement("div",{key:e.id,className:"device-option-button selected"},k.default.createElement("div",{className:"icon"},k.default.createElement(r,{type:e.type})),k.default.createElement("div",{className:"text"},k.default.createElement("span",{className:"name"},a),k.default.createElement("div",{"data-device-id":e.id,className:"revoke",onClick:this.handleRevokeClick},k.default.createElement("i",{className:"fa fa-ban"})," ",k.default.createElement("span",null,n("mobile-device-revoke")))))}},{key:"renderDialogBox",value:function(){var e=this.props.env,t=this.state.confirmingRevocation,n=e.locale.t,a={show:t,env:e,onClose:this.handleDialogClose,onConfirm:this.handleRevokeConfirm};return k.default.createElement(R.default,a,n("mobile-device-revoke-are-you-sure"))}}]),t}(_.PureComponent));U.displayName="DevicePanel",t.default=U,t.DevicePanel=U},"./panels/device-panel.scss":function(e,t){},"./panels/language-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LanguagePanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/helpers/extends.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),f=a(h),v=n("../../common/node_modules/lodash/lodash.js"),g=a(v),b=n("../../common/node_modules/react/index.js"),y=a(b),j=n("./widgets/settings-panel.jsx"),C=a(j),_=n("./widgets/option-button.jsx"),k=a(_);n("./panels/language-panel.scss");var w=n("../../common/src/env/environment.js"),E=(a(w),function(e){function t(){var e,n,a,r;(0,u.default)(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=a=(0,p.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s))),a.handleLanguageClick=function(e){var t=a.props.env,n=t.locale,r=n.languageCode,o=n.directory,s=e.currentTarget.id;if(s!==r){var i=g.default.find(o,{code:s}),l=i.code+"-"+i.defaultCountry;t.locale.change(l)}},a.handleCountryChange=function(e){var t=a.props.env,n=t.locale,r=n.languageCode,o=n.countryCode,s=e.currentTarget.value;if(s!==o){var i=r+"-"+s;t.locale.change(i)}},r=n,(0,p.default)(a,r)}return(0,f.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return y.default.createElement(C.default,{className:"language"},y.default.createElement("header",null,y.default.createElement("i",{className:"fa fa-language"})," ",t("settings-language")),y.default.createElement("body",null,this.renderList()))}},{key:"renderList",value:function(){var e=this,t=this.props.env,n=t.locale.directory,a=g.default.filter(n,function(e){return!!e.module});return g.default.map(a,function(t){return e.renderButton(t)})}},{key:"renderButton",value:function(e){var t=this.props.env,n=t.locale.languageCode,a=this.renderCountrySelect(e),r={label:y.default.createElement("span",null,e.name,a),selected:e.code===n,onClick:this.handleLanguageClick,id:e.code};return y.default.createElement(k.default,(0,o.default)({key:e.code},r))}},{key:"renderCountrySelect",value:function(e){var t=this.props.env,n=t.locale,a=n.languageCode,r=n.countryCode;r||(r=e.defaultCountry);var s=g.default.map(e.countries,function(e,t){return y.default.createElement("option",{key:t,value:t},e)}),i={value:r,onChange:this.handleCountryChange};return(e.code!==a||g.default.size(e.countries)<=1)&&(i.className="sole"),y.default.createElement("select",(0,o.default)({key:1},i),s)}}]),t}(b.PureComponent));E.displayName="LanguagePanel",t.default=E,t.LanguagePanel=E},"./panels/language-panel.scss":function(e,t){},"./panels/mobile-alert-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MobileAlertPanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/helpers/extends.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),f=a(h),v=n("../../common/node_modules/lodash/lodash.js"),g=a(v),b=n("../../common/node_modules/react/index.js"),y=a(b),j=n("../../common/src/objects/types/notification-types.js"),C=a(j),_=n("../../common/src/objects/utils/user-utils.js"),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(_),w=n("./widgets/settings-panel.jsx"),E=a(w),x=n("./widgets/option-button.jsx"),P=a(x);n("./panels/mobile-alert-panel.scss");var R=n("../../common/src/env/environment.js"),D=(a(R),function(e){function t(){var e,n,a,r;(0,u.default)(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=a=(0,p.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s))),a.handleOptionClick=function(e){var t=a.props.currentUser,n=e.currentTarget.id,r="mobile_alert."+n,o=g.default.clone(g.default.get(t,"settings",{}));!g.default.get(o,r)?g.default.set(o,r,!0):g.default.unset(o,r),a.setUserProperty("settings",o)},r=n,(0,p.default)(a,r)}return(0,f.default)(t,e),(0,c.default)(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=g.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return y.default.createElement(E.default,{className:"mobile-alert"},y.default.createElement("header",null,y.default.createElement("div",{className:"icon"},y.default.createElement("i",{className:"fa fa-tablet"}),y.default.createElement("i",{className:"fa fa-exclamation-circle icon-overlay"}))," ",t("settings-mobile-alert")),y.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=C.default;return"admin"!==g.default.get(t,"type")&&(n=g.default.without(n,j.AdminNotificationTypes)),n=g.default.concat(n,"web-session"),g.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,a=n.env,r=n.currentUser,s=n.repos,i=a.locale.t,l=g.default.snakeCase(e),u=g.default.get(r,"settings",{}),d=!!g.default.get(u,"notification."+l),c=!!g.default.get(u,"mobile_alert."+l),m=k.canReceiveNotification(r,s,e),p={label:i("notification-option-"+e),selected:c&&(d||"web-session"===e),hidden:!m,disabled:!(d||"web-session"===e),onClick:this.handleOptionClick,id:l};return y.default.createElement(P.default,(0,o.default)({key:t},p))}}]),t}(b.PureComponent));D.displayName="MobileAlertPanel",t.default=D,t.MobileAlertPanel=D},"./panels/mobile-alert-panel.scss":function(e,t){},"./panels/notification-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationPanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/helpers/extends.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=a(m),h=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),f=a(h),v=n("../../common/node_modules/lodash/lodash.js"),g=a(v),b=n("../../common/node_modules/react/index.js"),y=a(b),j=n("../../common/src/objects/types/notification-types.js"),C=a(j),_=n("../../common/src/objects/utils/user-utils.js"),k=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(_),w=n("./widgets/settings-panel.jsx"),E=a(w),x=n("./widgets/option-button.jsx"),P=a(x);n("./panels/notification-panel.scss");var R=n("../../common/src/env/environment.js"),D=(a(R),function(e){function t(){var e,n,a,r;(0,u.default)(this,t);for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=a=(0,p.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(s))),a.handleOptionClick=function(e){var t=a.props.currentUser,n=e.currentTarget.id,r=["notification."+n,"web_alert."+n,"mobile_alert."+n],o=g.default.clone(g.default.get(t,"settings",{})),s=!!g.default.get(o,r[0]);g.default.each(r,function(e,t){s?g.default.unset(o,e):0===t&&"merge"===n?g.default.set(o,e,"master"):g.default.set(o,e,!0)}),a.setUserProperty("settings",o)},r=n,(0,p.default)(a,r)}return(0,f.default)(t,e),(0,c.default)(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=g.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return y.default.createElement(E.default,{className:"notification"},y.default.createElement("header",null,y.default.createElement("i",{className:"fa fa-exclamation-circle"})," ",t("settings-notification")),y.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=C.default;return"admin"!==g.default.get(t,"type")&&(n=g.default.without(n,j.AdminNotificationTypes)),g.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,a=n.env,r=n.currentUser,s=n.repos,i=a.locale.t,l=g.default.snakeCase(e),u=g.default.get(r,"settings",{}),d=!!g.default.get(u,"notification."+l),c=k.canReceiveNotification(r,s,e),m={label:i("notification-option-"+e),selected:d,hidden:!c,onClick:this.handleOptionClick,id:l};return y.default.createElement(P.default,(0,o.default)({key:t},m))}}]),t}(b.PureComponent));D.displayName="NotificationPanel",t.default=D,t.NotificationPanel=D},"./panels/notification-panel.scss":function(e,t){},"./panels/project-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.hidden?null:_.default.createElement("div",{className:"item"},_.default.createElement("span",{className:"button",onClick:e.onClick},_.default.createElement("i",{className:"fa fa-fw fa-"+e.icon}),_.default.createElement("span",{className:"label"},e.label)))}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectPanel=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/regenerator/index.js"),s=a(o),i=n("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),l=a(i),u=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),d=a(u),c=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),m=a(c),p=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=a(p),f=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),v=a(f),g=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),b=a(g),y=n("../../common/node_modules/lodash/lodash.js"),j=a(y),C=n("../../common/node_modules/react/index.js"),_=a(C),k=n("../../common/src/objects/utils/user-utils.js"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(k),E=n("./widgets/settings-panel.jsx"),x=a(E),P=n("./widgets/push-button.jsx"),R=a(P),D=n("./dialogs/system-description-dialog-box.jsx"),S=a(D),M=n("./dialogs/project-description-dialog-box.jsx"),U=a(M),N=n("./dialogs/mobile-setup-dialog-box.jsx"),I=a(N),O=n("./dialogs/confirmation-dialog-box.jsx"),L=a(O),A=n("./dialogs/project-management-dialog-box.jsx"),B=a(A);n("./panels/project-panel.scss");var T=n("../../common/src/data/database.js"),F=(a(T),n("../../common/src/routing/route.js")),V=(a(F),n("../../common/src/env/environment.js")),W=(a(V),function(e){function t(e){var n=this;(0,m.default)(this,t);var a=(0,v.default)(this,(t.__proto__||(0,d.default)(t)).call(this,e));return a.handleProjectClick=function(e){var t=a.props,n=t.route,r=t.projectLinks,o=e.currentTarget.getAttribute("data-key"),s=j.default.find(r,{key:o});if(s){var i=window.location.origin,l={address:s.address,schema:s.schema,cors:i!==s.address};n.replace("settings-page",{},l)}},a.handleAddClick=function(e){a.props.route.push("start-page",{},{schema:null})},a.handleManageClick=function(e){a.setState({managingProjects:!0})},a.handleSystemDescriptionClick=function(e){a.setState({showingSystemDescription:!0})},a.handleProjectDescriptionClick=function(e){a.setState({showingProjectDescription:!0})},a.handleMobileSetupClick=function(e){a.setState({activatingMobileDevice:!0})},a.handleJoinClick=function(e){var t=a.props,n=t.currentUser,r=t.currentProject,o=t.onChange,s=j.default.cloneDeep(n);s.requested_project_ids=j.default.union(s.requested_project_ids,[r.id]),o&&o({type:"change",target:a,user:s})},a.handleCancelJoinClick=function(e){var t=a.props,n=t.currentUser,r=t.currentProject,o=t.onChange,s=j.default.cloneDeep(n);j.default.pull(s.requested_project_ids,r.id),o&&o({type:"change",target:a,user:s})},a.handleSignOutClick=function(e){a.setState({confirmingSignOut:!0})},a.handleSystemDescriptionDialogClose=function(e){a.setState({showingSystemDescription:!1})},a.handleProjectDescriptionDialogClose=function(e){a.setState({showingProjectDescription:!1})},a.handleMobileSetupDialogClose=function(e){a.setState({activatingMobileDevice:!1})},a.handleMembershipDialogClose=function(e){a.setState({notifyingNewMembership:!1})},a.handleConfirmationDialogClose=function(e){a.setState({confirmingSignOut:!1})},a.handleProjectManagementDialogClose=function(e){a.setState({managingProjects:!1})},a.handleProjectDelete=function(){var e=(0,l.default)(s.default.mark(function e(t){var r,o,i,l,u,d,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.handleProjectManagementDialogClose(),r=a.props,o=r.database,i=r.route,l=i.context,u=j.default.includes(t.selection,l.address+"/"+l.schema),d=j.default.map(t.selection,function(e){return{key:e}}),c=o.use({by:a}),e.next=8,c.remove({schema:"local",table:"project_link"},d);case 8:if(!u){e.next=10;break}return e.abrupt("return",i.replace("start-page",{},{schema:null}));case 10:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}(),a.handleSignOutConfirm=function(){var e=(0,l.default)(s.default.mark(function e(t){var r,o,i,l,u,d,c;return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,o=r.database,i=r.route,l=r.projectLinks,u=i.context,d=o.use({by:a}),e.next=5,d.endSession();case 5:return c=j.default.filter(l,{address:u.address}),e.next=8,d.remove({schema:"local",table:"project_link"},c);case 8:case"end":return e.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}(),a.state={showingSystemDescription:!1,showingProjectDescription:!1,activatingMobileDevice:!1,notifyingNewMembership:!1,confirmingSignOut:!1,managingProjects:!1},a}return(0,b.default)(t,e),(0,h.default)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.currentProject,a=t.currentUser,r=this.state.notifyingNewMembership;if(e.currentProject!==n&&n&&e.currentProject&&e.currentProject.id===n.id){var o=w.isMember(a,n),s=w.isMember(a,e.currentProject);!o&&s&&(r||this.setState({notifyingNewMembership:!0}))}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return _.default.createElement(x.default,{className:"project"},_.default.createElement("header",null,_.default.createElement("i",{className:"fa fa-database"})," ",t("settings-projects")),_.default.createElement("body",null,this.renderProjects(),this.renderDialogBox()),_.default.createElement("footer",null,this.renderButtons()))}},{key:"renderProjects",value:function(){var e=this,t=this.props.projectLinks;return j.default.map(t,function(t,n){return e.renderProject(t,n)})}},{key:"renderProject",value:function(e,t){var n=this.props,a=n.route,o=n.env,s=n.currentProject,i=n.currentUser,l=o.locale,u=l.t,d=l.p,c=a.context;if(e.schema===c.schema&&e.address==c.address){var m=!0,p=!1;s&&i&&(j.default.includes(s.user_ids,i.id)||(m=!1,j.default.includes(i.requested_project_ids,s.id)&&(p=!0)));var h={icon:"home",label:e.address,onClick:this.handleSystemDescriptionClick},f={icon:"info-circle",label:u("project-management-description"),onClick:this.handleProjectDescriptionClick},v={icon:"qrcode",label:u("project-management-mobile-set-up"),hidden:"cordova"===o.platform,onClick:this.handleMobileSetupClick},g={icon:p?"clock-o":"user-circle-o",label:u("project-management-"+(p?"withdraw-request":"join-project")),hidden:m,onClick:p?this.handleCancelJoinClick:this.handleJoinClick},b={icon:"sign-out",label:u("project-management-sign-out"),onClick:this.handleSignOutClick};return _.default.createElement("div",{key:t,className:"project-option-button selected"},_.default.createElement("i",{className:"icon fa fa-check-circle"}),_.default.createElement("div",{className:"text"},_.default.createElement("span",{className:"name"},d(e.name)),_.default.createElement("div",{className:"supplemental"},_.default.createElement(r,h),_.default.createElement(r,f),_.default.createElement(r,v),_.default.createElement(r,g),_.default.createElement(r,b))))}return _.default.createElement("div",{key:t,"data-key":e.key,className:"project-option-button",onClick:this.handleProjectClick},_.default.createElement("i",{className:"icon fa fa-circle-o"}),_.default.createElement("div",{className:"text"},_.default.createElement("span",{className:"name"},d(e.name))))}},{key:"renderButtons",value:function(){var e=this.props.env,t=e.locale.t,n={label:t("project-management-add"),onClick:this.handleAddClick},a={label:t("project-management-manage"),onClick:this.handleManageClick};return _.default.createElement("div",{className:"buttons"},_.default.createElement(R.default,a),_.default.createElement(R.default,n))}},{key:"renderDialogBox",value:function(){return this.props.currentProject?_.default.createElement("div",null,this.renderSystemDescriptionDialogBox(),this.renderProjectDescriptionDialogBox(),this.renderMobileSetupDialogBox(),this.renderSignOutDialogBox(),this.renderProjectManagementDialogBox(),this.renderMembershipDialogBox()):null}},{key:"renderSystemDescriptionDialogBox",value:function(){var e=this.props,t=e.env,n=e.system,a=this.state.showingSystemDescription,r={show:a,system:n,env:t,onClose:this.handleSystemDescriptionDialogClose};return _.default.createElement(S.default,r)}},{key:"renderProjectDescriptionDialogBox",value:function(){var e=this.props,t=e.env,n=e.currentProject,a=this.state.showingProjectDescription,r={show:a,project:n,env:t,onClose:this.handleProjectDescriptionDialogClose};return _.default.createElement(U.default,r)}},{key:"renderMobileSetupDialogBox",value:function(){var e=this.props,t=e.database,n=e.env,a=e.system,r=this.state.activatingMobileDevice,o={show:r,system:a,database:t,env:n,onClose:this.handleMobileSetupDialogClose};return _.default.createElement(I.default,o)}},{key:"renderSignOutDialogBox",value:function(){var e=this.props.env,t=this.state.confirmingSignOut,n=e.locale.t,a={show:t,env:e,onClose:this.handleConfirmationDialogClose,onConfirm:this.handleSignOutConfirm};return _.default.createElement(L.default,a,n("project-management-sign-out-are-you-sure"))}},{key:"renderMembershipDialogBox",value:function(){var e=this.props,t=e.env,n=e.currentUser,a=this.state.notifyingNewMembership,r=t.locale,o=r.t,s=r.g,i=w.getDisplayName(n,t);s(i,w.getGender(n));var l={show:a,env:t,onConfirm:this.handleMembershipDialogClose};return _.default.createElement(L.default,l,o("membership-request-$you-are-now-member",i))}},{key:"renderProjectManagementDialogBox",value:function(){var e=this.props,t=e.route,n=e.env,a=e.projectLinks,r=this.state.managingProjects,o={show:r,projectLinks:a,route:t,env:n,onDelete:this.handleProjectDelete,onCancel:this.handleProjectManagementDialogClose};return _.default.createElement(B.default,o)}}]),t}(C.PureComponent));W.displayName="ProjectPanel",t.default=W,t.ProjectPanel=W},"./panels/project-panel.scss":function(e,t){},"./panels/social-network-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(/https?:/.test(e)){e=v.default.trim(e.replace(/\?.*/,""));var n=v.default.filter(e.split("/"));return n[n.length-1]}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.SocialNetworkPanel=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),s=a(o),i=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),l=a(i),u=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),d=a(u),c=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=a(c),p=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),h=a(p),f=n("../../common/node_modules/lodash/lodash.js"),v=a(f),g=n("../../common/node_modules/react/index.js"),b=a(g),y=n("./widgets/settings-panel.jsx"),j=a(y),C=n("./widgets/push-button.jsx"),_=(a(C),n("./widgets/text-field.jsx")),k=a(_);n("./panels/social-network-panel.scss");var w=n("../../common/src/env/environment.js"),E=(a(w),function(e){function t(){var e,n,a,o;(0,l.default)(this,t);for(var i=arguments.length,u=Array(i),d=0;d<i;d++)u[d]=arguments[d];return n=a=(0,m.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(u))),a.handleSkypeUsernameChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.skype_username",t)},a.handleIchatUsernameChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.ichat_username",t)},a.handleTwitterUsernameChange=function(e){var t=r(e.target.value);a.setUserProperty("details.twitter_username",t)},a.handleLinkedinURLChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.linkedin_url",t)},a.handleGitHubURLChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.github_url",t)},a.handleGitlabURLChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.gitlab_url",t)},a.handleStackoverflowURLChange=function(e){var t=v.default.trim(e.target.value);a.setUserProperty("details.stackoverflow_url",t)},o=n,(0,m.default)(a,o)}return(0,h.default)(t,e),(0,d.default)(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return v.default.get(t,e)}},{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=v.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return b.default.createElement(j.default,{className:"user"},b.default.createElement("header",null,b.default.createElement("i",{className:"fa fa-handshake-o"})," ",t("settings-social-networks")),b.default.createElement("body",null,this.renderSkypeNameInput(),this.renderIChatInput(),this.renderTwitterInput(),this.renderGithubURLInput(),this.renderGitlabURLInput(),this.renderLinkedInURLInput(),this.renderStackoverflowURLInput()))}},{key:"renderSkypeNameInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"skype",value:this.getUserProperty("details.skype_username"),env:e,onChange:this.handleSkypeUsernameChange};return b.default.createElement(k.default,n,t("social-network-skype"))}},{key:"renderIChatInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"ichat",value:this.getUserProperty("details.ichat_username"),env:e,onChange:this.handleIchatUsernameChange};return b.default.createElement(k.default,n,t("social-network-ichat"))}},{key:"renderTwitterInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"twitter",value:this.getUserProperty("details.twitter_username"),env:e,onChange:this.handleTwitterUsernameChange};return b.default.createElement(k.default,n,t("social-network-twitter"))}},{key:"renderGithubURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"github",value:this.getUserProperty("details.github_url"),env:e,onChange:this.handleGitHubURLChange};return b.default.createElement(k.default,n,t("social-network-github"))}},{key:"renderGitlabURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"github",value:this.getUserProperty("details.gitlab_url"),env:e,onChange:this.handleGitlabURLChange};return b.default.createElement(k.default,n,t("social-network-gitlab"))}},{key:"renderLinkedInURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"linkedin",value:this.getUserProperty("details.linkedin_url"),env:e,onChange:this.handleLinkedinURLChange};return b.default.createElement(k.default,n,t("social-network-linkedin"))}},{key:"renderStackoverflowURLInput",value:function(){var e=this.props.env,t=e.locale.t,n={id:"stackoverflow",value:this.getUserProperty("details.stackoverflow_url"),env:e,onChange:this.handleStackoverflowURLChange};return b.default.createElement(k.default,n,t("social-network-stackoverflow"))}}]),t}(g.PureComponent));E.displayName="SocialNetworkPanel",t.default=E,t.SocialNetworkPanel=E},"./panels/social-network-panel.scss":function(e,t){},"./panels/user-image-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserImagePanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),p=a(m),h=n("../../common/node_modules/lodash/lodash.js"),f=a(h),v=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),g=(a(v),n("../../common/node_modules/moment/moment.js")),b=(a(g),n("../../common/node_modules/react/index.js")),y=a(b),j=n("../../common/src/utils/component-refs.js"),C=a(j),_=n("../../common/src/utils/focus-manager.js"),k=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(_),n("./widgets/settings-panel.jsx")),w=a(k),E=n("./widgets/push-button.jsx"),x=a(E),P=n("./editors/image-editor.jsx"),R=a(P),D=n("./editors/media-importer.jsx"),S=a(D),M=n("../node_modules/octicons/build/svg/person.svg"),U=a(M);n("./panels/user-image-panel.scss");var N=n("../../common/src/transport/payloads.js"),I=(a(N),n("../../common/src/env/environment.js")),O=(a(I),function(e){function t(e){(0,i.default)(this,t);var n=(0,c.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.handleCancelClick=function(e){n.setState({action:null,image:null})},n.handleAdjustClick=function(e){n.setState({action:"adjust"})},n.handleReplaceClick=function(e){n.setState({action:"replace"})},n.handleTakeClick=function(e){n.components.importer.capture("image")},n.handleFileChange=function(e){var t=n.components.importer,a=e.target.files;t.importFiles(a)},n.handleSaveClick=function(e){var t=n.state.image;t&&(n.setUserProperty("details.resources",[t]),n.setState({action:null,image:null}))},n.handleImageChange=function(e){n.setState({image:e.resource})},n.handleChange=function(e){n.setState({image:e.resources[0],action:"adjust"})},n.handleCaptureEnd=function(e){},n.components=(0,C.default)({importer:S.default}),n.state={action:null,image:null},n}return(0,p.default)(t,e),(0,u.default)(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return f.default.get(t,e)}},{key:"getImage",value:function(){var e=this.state.image;if(e)return e;var t=this.getUserProperty("details.resources");return f.default.find(t,{type:"image"})}},{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=f.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o,immediate:!0})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return y.default.createElement(w.default,{className:"user-image"},y.default.createElement("header",null,y.default.createElement("i",{className:"fa fa-image"})," ",t("settings-profile-image")),y.default.createElement("body",null,this.renderProfilePicture(),this.renderMediaImporter()),y.default.createElement("footer",null,this.renderButtons()))}},{key:"renderProfilePicture",value:function(){var e=this.props.env,t=this.state.action,n=void 0,a=this.getImage();if(a){var r={resource:a,previewWidth:256,previewHeight:256,disabled:"adjust"!==t,env:e,onChange:this.handleImageChange};n=y.default.createElement(R.default,r)}else n=y.default.createElement("div",{className:"no-image"},y.default.createElement(U.default,{className:""}));return y.default.createElement("div",{className:"image-container"},n)}},{key:"renderMediaImporter",value:function(){var e=this.props,t=e.env,n=e.payloads,a=e.currentUser,r=this.state.image,o=this.components.setters,s=void 0;s=r?[r]:f.default.get(a,"details.resources",[]);var i={ref:o.importer,types:["image"],limit:1,schema:"global",resources:s,env:t,payloads:n.override({schema:"global"}),cameraDirection:"front",onChange:this.handleChange,onCaptureEnd:this.handleCaptureEnd};return y.default.createElement(S.default,i)}},{key:"renderButtons",value:function(){var e=this.props.env,t=this.state,n=t.action,a=t.image,r=e.locale.t,o=!!this.getImage();if("adjust"===n&&o){var s={label:r("user-image-cancel"),onClick:this.handleCancelClick},i={label:r("user-image-save"),emphasized:!0,disabled:!a,onClick:this.handleSaveClick};return y.default.createElement("div",{key:"adjust",className:"buttons"},y.default.createElement(x.default,s),y.default.createElement(x.default,i))}if("replace"===n&&o){var l={label:r("user-image-cancel"),onClick:this.handleCancelClick},u={label:r("user-image-snap"),hidden:!f.default.includes(e.recorders,"image"),onClick:this.handleTakeClick},d={label:r("user-image-select"),accept:"image/*",onChange:this.handleFileChange};return y.default.createElement("div",{key:"replace",className:"buttons"},y.default.createElement(x.default,l),y.default.createElement(x.default,u),y.default.createElement(x.default.File,d))}if(o){var c={label:r("user-image-adjust"),onClick:this.handleAdjustClick},m={label:r("user-image-replace"),onClick:this.handleReplaceClick};return y.default.createElement("div",{key:"action",className:"buttons"},y.default.createElement(x.default,c),y.default.createElement(x.default,m))}var p={label:r("user-image-snap"),hidden:!f.default.includes(e.recorders,"image"),onClick:this.handleTakeClick},h={label:r("user-image-select"),accept:"image/*",onChange:this.handleFileChange};return y.default.createElement("div",{key:"add",className:"buttons"},y.default.createElement(x.default,p),y.default.createElement(x.default.File,h))}}]),t}(b.PureComponent));O.displayName="UserImagePanel",t.default=O,t.UserImagePanel=O},"./panels/user-image-panel.scss":function(e,t){},"./panels/user-info-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoPanel=t.default=void 0;var r=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=a(r),s=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),i=a(s),l=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=a(l),d=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=a(d),m=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),p=a(m),h=n("../../common/node_modules/lodash/lodash.js"),f=a(h),v=n("../../common/node_modules/react/index.js"),g=a(v),b=n("./widgets/settings-panel.jsx"),y=a(b),j=n("./widgets/push-button.jsx"),C=(a(j),n("./widgets/text-field.jsx")),_=a(C);n("./panels/user-info-panel.scss");var k=n("../../common/src/env/environment.js"),w=(a(k),function(e){function t(){var e,n,a,r;(0,i.default)(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=(0,c.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(l))),a.handleNameChange=function(e){var t=e.target.value;a.setUserProperty("details.name",t)},a.handleEmailChange=function(e){var t=e.target.value;a.setUserProperty("details.email",t)},a.handlePhoneChange=function(e){var t=e.target.value;a.setUserProperty("details.phone",t)},a.handleGenderChange=function(e){var t=e.target.value;a.setUserProperty("details.gender",t||void 0)},r=n,(0,c.default)(a,r)}return(0,p.default)(t,e),(0,u.default)(t,[{key:"getUserProperty",value:function(e){var t=this.props.currentUser;return f.default.get(t,e)}},{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=f.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t;return g.default.createElement(y.default,{className:"user-info"},g.default.createElement("header",null,g.default.createElement("i",{className:"fa fa-user-circle"})," ",t("settings-user-information")),g.default.createElement("body",null,this.renderNameInput(),this.renderEmailInput(),this.renderPhoneInput(),this.renderGenderSelector()))}},{key:"renderNameInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,a=t.p,r=this.getUserProperty("details.name"),o={id:"name",value:a(r),env:e,onChange:this.handleNameChange};return g.default.createElement(_.default,o,n("user-info-name"))}},{key:"renderEmailInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,a=(t.p,{id:"email",value:this.getUserProperty("details.email"),env:e,onChange:this.handleEmailChange});return g.default.createElement(_.default,a,n("user-info-email"))}},{key:"renderPhoneInput",value:function(){var e=this.props.env,t=e.locale,n=t.t,a=(t.p,{id:"email",value:this.getUserProperty("details.phone"),env:e,onChange:this.handlePhoneChange});return g.default.createElement(_.default,a,n("user-info-phone"))}},{key:"renderGenderSelector",value:function(){var e=this.props.env,t=e.locale,n=t.t,a=(t.p,{id:"gender",value:this.getUserProperty("details.gender")||"",size:3,onChange:this.handleGenderChange});return g.default.createElement("div",{className:"gender-selector"},g.default.createElement("label",{htmlFor:"gender"},n("user-info-gender")),g.default.createElement("select",a,g.default.createElement("option",{value:"male"},n("user-info-gender-male")),g.default.createElement("option",{value:"female"},n("user-info-gender-female")),g.default.createElement("option",{value:""},n("user-info-gender-unspecified"))))}}]),t}(v.PureComponent));w.displayName="UserInfoPanel",t.default=w,t.UserInfoPanel=w},"./panels/user-info-panel.scss":function(e,t){},"./panels/web-alert-panel.jsx":function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){var e=navigator.userAgent;for(var t in M){if(M[t].test(e))return t}return"globe"}Object.defineProperty(t,"__esModule",{value:!0}),t.WebAlertPanel=t.default=void 0;var o=n("../../common/node_modules/babel-runtime/helpers/extends.js"),s=a(o),i=n("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=a(i),u=n("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),d=a(u),c=n("../../common/node_modules/babel-runtime/helpers/createClass.js"),m=a(c),p=n("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),h=a(p),f=n("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=a(f),g=n("../../common/node_modules/lodash/lodash.js"),b=a(g),y=n("../../common/node_modules/react/index.js"),j=a(y),C=n("../../common/src/objects/types/notification-types.js"),_=a(C),k=n("../../common/src/objects/utils/user-utils.js"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(k),E=n("./widgets/settings-panel.jsx"),x=a(E),P=n("./widgets/option-button.jsx"),R=a(P);n("./panels/web-alert-panel.scss");var D=n("../../common/src/env/environment.js"),S=(a(D),function(e){function t(){var e,n,a,r;(0,d.default)(this,t);for(var o=arguments.length,s=Array(o),i=0;i<o;i++)s[i]=arguments[i];return n=a=(0,h.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(s))),a.handleOptionClick=function(e){var t=a.props.currentUser,n=e.currentTarget.id,r="web_alert."+n,o=b.default.clone(b.default.get(t,"settings",{}));!b.default.get(o,r)?b.default.set(o,r,!0):b.default.unset(o,r),a.setUserProperty("settings",o)},r=n,(0,h.default)(a,r)}return(0,v.default)(t,e),(0,m.default)(t,[{key:"setUserProperty",value:function(e,t){var n=this.props,a=n.currentUser,r=n.onChange;if(a){var o=b.default.decoupleSet(a,e,t);r&&r({type:"change",target:this,user:o})}}},{key:"render",value:function(){var e=this.props.env,t=e.locale.t,n=r();return j.default.createElement(x.default,{className:"web-alert"},j.default.createElement("header",null,j.default.createElement("div",{className:"icon"},j.default.createElement("i",{className:"fa fa-"+n}),j.default.createElement("i",{className:"fa fa-exclamation-circle icon-overlay"}))," ",t("settings-web-alert")),j.default.createElement("body",null,this.renderOptions()))}},{key:"renderOptions",value:function(){var e=this,t=this.props.currentUser,n=_.default;return"admin"!==b.default.get(t,"type")&&(n=b.default.without(n,C.AdminNotificationTypes)),b.default.map(n,function(t,n){return e.renderOption(t,n)})}},{key:"renderOption",value:function(e,t){var n=this.props,a=n.env,r=n.currentUser,o=n.repos,i=a.locale.t,l=b.default.snakeCase(e),u=b.default.get(r,"settings",{}),d=!!b.default.get(u,"notification."+l),c=!!b.default.get(u,"web_alert."+l),m=w.canReceiveNotification(r,o,e),p={label:i("notification-option-"+e),selected:c&&d,hidden:!m,disabled:!d,onClick:this.handleOptionClick,id:l};return j.default.createElement(R.default,(0,s.default)({key:t},p))}}]),t}(y.PureComponent));S.displayName="WebAlertPanel";var M={edge:/(Edge|Internet Explorer)/,chrome:/Chrome/,safari:/Safari/,firefox:/Firefox/};t.default=S,t.WebAlertPanel=S},"./panels/web-alert-panel.scss":function(e,t){}});