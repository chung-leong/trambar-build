webpackJsonp(["page-project-summary"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var r=void 0,n=void 0,a=void 0,s=!1;if(t&&(r=t.type,t.user_id&&(n={id:t.user_id}),e.context.schema&&(a={name:e.context.schema}),s=t.public),"daily-activities"===r){if(n&&a)return o(e,a,n,s);if(a)return i(e,a,n,s)}else if("daily-notifications"===r&&n&&a)return u(e,a,n);return _.default.resolve(null)}function i(e,t,r){if(!t||t.deleted)return _.default.resolve(null);var n={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:r||void 0}},prefetch:!0};return e.findOne(n).then(function(n){if(m(n)){var a=w.getMonthRanges(n.details.start_time,n.details.end_time),i=w.getTimeZoneOffset(),s=g.default.map(a,function(e){return{time_range:e,tz_offset:i,public:r||void 0}}),o={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:s},prefetch:!0};return e.find(o).then(function(e){return k(e,n)})}})}function s(e,t){return _.default.mapSeries(t,function(t){return i(e,t)}).then(function(e){var r=g.default.map(t,"id");return g.default.zipObject(r,e)})}function o(e,t,r,n){return!r||r.deleted?_.default.resolve(null):l(e,t,[r],n).then(function(e){return g.default.get(e,r.id,null)})}function l(e,t,r,n){if(!t||t.deleted)return _.default.resolve(null);var a=(t.name,g.default.filter(r,function(e){return!e.deleted})),i=g.default.map(a,function(e){return{user_ids:[e.id],public:n||void 0}}),s={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:i},prefetch:!0};return e.find(s).then(function(r){r=g.default.filter(r,m);var a=g.default.map(r,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),r=w.getTimeZoneOffset();return g.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:r,public:n||void 0}})}),i=g.default.flatten(a);if(g.default.isEmpty(i))return{};var s={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:i},prefetch:!0};return e.find(s).then(function(e){return g.default.transform(r,function(t,r){var n=r.filters.user_ids[0],a=g.default.filter(e,function(e){return e.filters.user_ids[0]===n});t[n]=k(a,r)},{})})})}function u(e,t,r){return!r||r.deleted?_.default.resolve(null):c(e,t,[r]).then(function(e){return g.default.get(e,r.id,null)})}function c(e,t,r){if(!t||t.deleted)return _.default.resolve(null);var n=t.name,a=g.default.filter(r,function(e){return!e.deleted}),i={type:"notification-date-range",filters:g.default.map(a,function(e){return{target_user_id:e.id}})};return e.find({schema:n,table:"statistics",criteria:i}).then(function(t){t=g.default.filter(t,m);var r=g.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),r=w.getTimeZoneOffset();return g.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:r}})}),a=g.default.flatten(r);if(g.default.isEmpty(a))return{};var i={type:"daily-notifications",filters:a};return e.find({schema:n,table:"statistics",criteria:i}).then(function(e){return g.default.transform(t,function(t,r){var n=r.filters.target_user_id,a=g.default.filter(e,function(e){return e.filters.target_user_id===n});t[n]=k(a,r)},{})})})}function d(e,t,r){return!t||t.deleted||!r||r.deleted?_.default.resolve(null):f(e,t,[r]).then(function(e){return g.default.get(e,r.id,null)})}function f(e,t,r){if(!t||t.deleted)return _.default.resolve(null);var n=t.name,a=g.default.filter(r,function(e){return!e.deleted}),i={type:"story-date-range",filters:g.default.map(a,function(e){return{external_object:g.default.find(e.external,{type:e.type})}})};return e.find({schema:n,table:"statistics",criteria:i}).then(function(t){t=g.default.filter(t,m);var a=g.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),r=w.getTimeZoneOffset();return g.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:r}})}),i=g.default.flatten(a);if(g.default.isEmpty(i))return{};var s={type:"daily-activities",filters:i};return e.find({schema:n,table:"statistics",criteria:s}).then(function(e){return g.default.transform(t,function(t,n){var a=n.filters.external_object,i=g.default.filter(e,function(e){return g.default.isEqual(e.filters.external_object,a)});t[g.default.find(r,function(e){return g.default.some(e.external,a)}).id]=k(i,n)},{})})})}function m(e){return e&&!!e.details.start_time&&!!e.details.end_time}function p(e,t){var r={total:0};return g.default.each(e,function(e){g.default.each(e.details,function(e,n){t&&n.substr(0,7)!==t||g.default.each(e,function(e,t){"#"!==t.charAt(0)&&(r.total+=e),r[t]?r[t]+=e:r[t]=e})})}),r}function h(e){var t={};return g.default.each(e,function(e){g.default.assign(t,e.details)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var v=r("../../common/node_modules/lodash/lodash.js"),g=n(v),y=r("../../common/node_modules/bluebird/js/browser/bluebird.js"),_=n(y),j=r("../../common/node_modules/moment/moment.js"),b=n(j),P=r("../../common/src/utils/memoize.js"),O=r("../../common/src/utils/date-utils.js"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(O),k=(0,P.memoizeWeak)(null,function(e,t,r){var n=(0,b.default)().subtract(1,"month").format("YYYY-MM"),a=(0,b.default)().format("YYYY-MM"),i=h(e),s=p(e,n),o=p(e,a),l=p(e),u=t.details.start_time,c=t.details.end_time;if(0===s.total){u.substr(0,7)<=n||(s.total=void 0)}return{range:{start:u,end:c},last_month:s,this_month:o,to_date:l,daily:i}});t.find=a,t.findDailyActivitiesOfProject=i,t.findDailyActivitiesOfProjects=s,t.findDailyActivitiesOfUser=o,t.findDailyActivitiesOfUsers=l,t.findDailyNotificationsOfUser=u,t.findDailyNotificationsOfUsers=c,t.findDailyActivitiesOfRepo=d,t.findDailyActivitiesOfRepos=f},"../../common/src/objects/finders/system-finder.js":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return e.findOne({schema:"global",table:"system",criteria:{},prefetch:!0}).then(function(e){return e||{}})}Object.defineProperty(t,"__esModule",{value:!0}),t.findSystem=void 0;var i=r("../../common/node_modules/lodash/lodash.js"),s=(n(i),r("../../common/node_modules/bluebird/js/browser/bluebird.js"));n(s);t.findSystem=a},"../../common/src/objects/settings/project-settings.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectSettingsTypedef=void 0;var n=r("../../common/node_modules/lodash/lodash.js"),a=(function(e){e&&e.__esModule}(n),void 0);t.ProjectSettingsTypedef=a},"../../common/src/utils/date-utils.js":function(e,t,r){"use strict";function n(e){var t=e instanceof l.default?e:(0,l.default)(e),r=t.clone().endOf("day");return"["+t.toISOString()+","+r.toISOString()+"]"}function a(e,t){for(var r=e instanceof l.default?e:(0,l.default)(e),n=t instanceof l.default?t:(0,l.default)(t),a=r.startOf("month"),i=n.endOf("month"),s=[],o=a.clone();o<=i;o.add(1,"month")){var u=o.toISOString(),c=o.clone().endOf("month").toISOString(),d="["+u+","+c+"]";s.push(d)}return s}function i(e,t){for(var r=startTime instanceof l.default?startTime:(0,l.default)(startTime),n=t instanceof l.default?t:(0,l.default)(t),a=r.startOf("day"),i=n.endOf("day"),s=[],o=a.clone();o<=i;o.add(1,"day")){var u=o.format("YYYY-MM-DD");s.push(u)}return s}function s(){return(0,l.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var o=r("../../common/node_modules/moment/moment.js"),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.getDayRange=n,t.getMonthRanges=a,t.getTimeZoneOffset=s,t.getDates=i},"../../common/src/utils/slug-generator.js":function(e,t,r){"use strict";function n(e){"string"==typeof e&&(e={en:e});var t="";for(var r in e)if(t=String(e[r]),t=i(t).toLowerCase(),t=t.replace(/\s+/g,"-"),t=t.replace(/[^0-9a-z\-]/g,""),/^\-+$/.test(t)&&(t=""),t)break;return t.length>32&&(t=t.substr(0,32)),t}function a(e){"string"==typeof e&&(e={en:e});var t="";for(var r in e){var n=String(e[r]).split(/\s+/).map(function(e){return i(e).toLowerCase().replace(/[^a-z]/g,"")}).filter(Boolean);if(n.length>0){for(var a=n[n.length-1],s="",o=0;o<n.length-1;o++)s+=n[o].charAt(0);if(t=s+a)break}}return t}function i(e){return String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.fromTitle=n,t.fromPersonalName=a},"./pages/project-summary-page.jsx":function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectSummaryPageSync=t.ProjectSummaryPage=t.default=void 0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=r("../../common/node_modules/lodash/lodash.js"),d=a(c),f=r("../../common/node_modules/react/index.js"),m=a(f),p=r("../../common/node_modules/relaks/index.js"),h=r("../../common/src/utils/component-refs.js"),v=a(h),g=r("../../common/src/objects/finders/project-finder.js"),y=n(g),_=r("../../common/src/objects/settings/project-settings.js"),j=n(_),b=r("../../common/src/objects/finders/statistics-finder.js"),P=n(b),O=r("../../common/src/objects/finders/system-finder.js"),w=n(O),k=r("../../common/src/utils/slug-generator.js"),C=n(k),E=r("./widgets/push-button.jsx"),S=a(E),q=r("./widgets/combo-button.jsx"),x=a(q),D=r("./widgets/instruction-block.jsx"),M=a(D),A=r("./widgets/text-field.jsx"),T=a(A),N=r("./widgets/multilingual-text-field.jsx"),I=a(N),R=r("./widgets/option-list.jsx"),L=a(R),Y=r("./widgets/image-selector.jsx"),z=a(Y),U=r("./widgets/activity-chart.jsx"),F=a(U),Z=r("./widgets/input-error.jsx"),W=a(Z),B=r("./widgets/action-confirmation.jsx"),$=a(B),H=r("./widgets/data-loss-warning.jsx"),J=a(H),G=r("./widgets/unexpected-error.jsx"),K=a(G),Q=r("../../common/src/widgets/error-boundary.jsx"),V=a(Q);r("./pages/project-summary-page.scss");var X=r("../../common/src/data/database.js"),ee=(a(X),r("../../common/src/routing/route.js")),te=(a(ee),r("../../common/src/env/environment.js")),re=(a(te),r("../../common/src/transport/payloads.js")),ne=(a(re),function(e){function t(){return i(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"renderAsync",value:function(e){var t=this.props,r=t.database,n=t.route,a=t.env,i=t.payloads,s=t.projectID,o=t.editing,l=r.use({schema:"global",by:this}),u="new"===s,c={system:void 0,project:void 0,statistics:void 0,database:r,route:n,env:a,payloads:i,editing:o||u,creating:u};return e.show(m.default.createElement(ae,c)),l.start().then(function(e){return w.findSystem(l).then(function(e){c.system=e})}).then(function(){if(!u)return y.findProject(l,s).then(function(e){c.project=e})}).then(function(){if(!u)return e.show(m.default.createElement(ae,c)),P.findDailyActivitiesOfProject(l,c.project).then(function(e){c.statistics=e})}).then(function(){return m.default.createElement(ae,c)})}}]),t}(p.AsyncComponent));ne.displayName="ProjectSummaryPage";var ae=function(e){function t(e){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleArchiveClick=function(e){var t=r.props.env,n=r.components.confirmation,a=t.locale.t,i=a("project-summary-confirm-archive");return n.ask(i).then(function(e){if(e)return r.changeFlags({archived:!0}).then(function(e){if(e)return r.returnToList()})})},r.handleDeleteClick=function(e){var t=r.props.env,n=r.components.confirmation,a=t.locale.t,i=a("project-summary-confirm-delete");return n.ask(i).then(function(e){if(e)return r.changeFlags({deleted:!0}).then(function(e){if(e)return r.returnToList()})})},r.handleRestoreClick=function(e){var t=r.props.env,n=r.components.confirmation,a=t.locale.t,i=a("project-summary-confirm-restore");return n.ask(i).then(function(e){if(e)return r.changeFlags({archived:!1,deleted:!1})})},r.handleReturnClick=function(e){return r.returnToList()},r.handleAddClick=function(e){return r.startNew()},r.handleEditClick=function(e){return r.setEditability(!0)},r.handleCancelClick=function(e){return r.setEditability(!1)},r.handleSaveClick=function(e){var t=r.props,n=t.database,a=t.payloads;if(!r.state.saving){var i=r.findProblems();if(d.default.some(i))return void r.setState({problems:i});var s=d.default.omit(r.getProject(),"user_ids","repo_ids");r.setState({saving:!0,adding:!s.id,problems:{}},function(){var e=n.use({schema:"global",by:r});return e.start().then(function(t){return e.saveOne({table:"project"},s).then(function(e){return a.dispatch(e),r.setState({hasChanges:!1,saving:!1},function(){r.setEditability(!1,e)}),null})}).catch(function(e){var t={};t=409===e.statusCode?{name:"validation-duplicate-project-name"}:{unexpected:e.message},r.setState({problems:t,saving:!1})})})}},r.handleTitleChange=function(e){r.setProjectProperty("details.title",e.target.value)},r.handleNameChange=function(e){var t=d.default.toLower(e.target.value).replace(/\W+/g,"");r.setProjectProperty("name",t)},r.handleDescriptionChange=function(e){r.setProjectProperty("details.description",e.target.value)},r.handleEmblemChange=function(e){r.setProjectProperty("details.resources",e.target.value)},r.handleMembershipOptionClick=function(e){var t=d.default.clone(r.getProjectProperty("settings.membership"))||{};switch(e.name){case"manual":t={};break;case"allow_user_request":t.allow_user_request?(delete t.allow_user_request,delete t.approve_user_request):t.allow_user_request=!0;break;case"approve_user_request":t.approve_user_request?delete t.approve_user_request:t.approve_user_request=!0;break;case"allow_guest_request":t.allow_guest_request?(delete t.allow_guest_request,delete t.approve_guest_request):t.allow_guest_request=!0;break;case"approve_guest_request":t.approve_guest_request?delete t.approve_guest_request:t.approve_guest_request=!0}r.setProjectProperty("settings.membership",t)},r.handleAccessControlOptionClick=function(e){var t=d.default.clone(r.getProjectProperty("settings.access_control"))||{};switch(e.name){case"members_only":t={};break;case"grant_view_access":t.grant_view_access?delete t.grant_view_access:t.grant_view_access=!0;break;case"grant_comment_access":t.grant_comment_access?delete t.grant_comment_access:t.grant_comment_access=!0}r.setProjectProperty("settings.access_control",t)},r.components=(0,v.default)({confirmation:$.default}),r.state={newProject:null,saving:!1,adding:!1,problems:{}},r}return o(t,e),u(t,[{key:"getProject",value:function(e){var t=this.props,r=t.project,n=t.editing,a=this.state.newProject;return!n||e&&"current"!==e?r||ie:a||r||ie}},{key:"getProjectProperty",value:function(e,t){var r=this.getProject(t);return d.default.get(r,e)}},{key:"setProjectProperty",value:function(e,t){var r=this.props.project,n=this.getProject("current"),a=d.default.decoupleSet(n,e,t);if("details.title"===e&&!n.id){var i=C.fromTitle(n.details.title),s=C.fromTitle(a.details.title);n.name&&n.name!==i||(a.name=s)}d.default.size(a.name)>128&&(a.name=a.name.substr(0,128));var o=!0;d.default.isEqual(a,r)&&(a=null,o=!1),this.setState({newProject:a,hasChanges:o})}},{key:"findProblems",value:function(){var e={},t=this.getProject(),r=d.default.toLower(d.default.trim(t.name)),n=["global","admin","public","srv"];return r?d.default.includes(n,r)&&(e.name="validation-illegal-project-name"):e.name="validation-required",e}},{key:"setEditability",value:function(e,t){var r=this,n=this.props,a=n.route;if(!n.creating||e||t){var i=d.default.clone(a.params);return i.editing=e||void 0,t&&(i.projectID=t.id),a.replace(a.name,i).then(function(e){e&&r.setState({problems:{}})})}this.returnToList()}},{key:"returnToList",value:function(){return this.props.route.push("project-list-page")}},{key:"startNew",value:function(){var e=this.props.route,t=d.default.clone(e.params);return t.projectID="new",e.replace(e.name,t)}},{key:"getInputLanguages",value:function(){var e=this.props.system;return d.default.get(e,"settings.input_languages",[])}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.editing;e.editing!==t&&(e.editing?this.setState({newProject:null,hasChanges:!1}):this.setState({problems:{}}))}},{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=this.state,a=n.hasChanges,i=n.problems,s=this.components.setters,o=r.locale,l=o.t,u=o.p,c=this.getProject(),d=u(c.details.title)||c.name;return m.default.createElement("div",{className:"project-summary-page"},this.renderButtons(),m.default.createElement("h2",null,l("project-summary-$title",d)),m.default.createElement(K.default,null,i.unexpected),this.renderForm(),this.renderInstructions(),this.renderChart(),m.default.createElement($.default,{ref:s.confirmation,env:r}),m.default.createElement(J.default,{changes:a,route:t,env:r}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,r=e.project,n=e.editing,a=this.state,i=a.hasChanges,s=a.adding,o=t.locale,l=o.t;o.p;if(n)return m.default.createElement("div",{key:"edit",className:"buttons"},m.default.createElement(S.default,{onClick:this.handleCancelClick},l("project-summary-cancel"))," ",m.default.createElement(S.default,{className:"emphasis",disabled:!i,onClick:this.handleSaveClick},l("project-summary-save")));var u=!r||!r.deleted&&!r.archived,c=void 0;return c=u?s?"add":"return":"restore",m.default.createElement("div",{key:"view",className:"buttons"},m.default.createElement(x.default,{preselected:c},m.default.createElement("option",{name:"return",onClick:this.handleReturnClick},l("project-summary-return")),m.default.createElement("option",{name:"add",onClick:this.handleAddClick},l("project-summary-add")),m.default.createElement("option",{name:"archive",disabled:!u,separator:!0,onClick:this.handleArchiveClick},l("project-summary-archive")),m.default.createElement("option",{name:"delete",disabled:!u,onClick:this.handleDeleteClick},l("project-summary-delete")),m.default.createElement("option",{name:"restore",hidden:u,onClick:this.handleRestoreClick},l("project-summary-restore")))," ",m.default.createElement(S.default,{className:"emphasis",onClick:this.handleEditClick},l("project-summary-edit")))}},{key:"renderForm",value:function(){return m.default.createElement("div",{className:"form"},this.renderTitleInput(),this.renderNameInput(),this.renderDescriptionInput(),this.renderEmblemSelector(),this.renderMembershipOptions(),this.renderAccessControlOptions())}},{key:"renderTitleInput",value:function(){var e=this.props,t=e.env,r=e.editing,n=t.locale.t,a={id:"title",value:this.getProjectProperty("details.title"),availableLanguageCodes:this.getInputLanguages(),readOnly:!r,env:t,onChange:this.handleTitleChange};return m.default.createElement(I.default,a,n("project-summary-title"))}},{key:"renderNameInput",value:function(){var e=this.props,t=e.env,r=e.editing,n=this.state.problems,a=t.locale.t,i={id:"name",value:this.getProjectProperty("name"),readOnly:!r,spellCheck:!1,env:t,onChange:this.handleNameChange};return m.default.createElement(T.default,i,a("project-summary-name"),m.default.createElement(W.default,null,a(n.name)))}},{key:"renderDescriptionInput",value:function(){var e=this.props,t=e.env,r=e.editing,n=t.locale.t,a={id:"description",value:this.getProjectProperty("details.description"),availableLanguageCodes:this.getInputLanguages(),type:"textarea",readOnly:!r,env:t,onChange:this.handleDescriptionChange};return m.default.createElement(I.default,a,n("project-summary-description"))}},{key:"renderEmblemSelector",value:function(){var e=this.props,t=e.database,r=e.env,n=e.payloads,a=e.editing,i=r.locale.t,s={purpose:"project-emblem",desiredWidth:500,desiredHeight:500,resources:this.getProjectProperty("details.resources"),readOnly:!a,database:t,env:r,payloads:n,onChange:this.handleEmblemChange};return m.default.createElement(z.default,s,i("project-summary-emblem"))}},{key:"renderMembershipOptions",value:function(){var e=this.props,t=e.env,r=e.editing,n=t.locale.t,a=this.getProjectProperty("settings.membership","current")||{},i=this.getProjectProperty("settings.membership","original")||{},s=!!this.getProjectProperty("id"),o=[{name:"manual",selected:!d.default.some(a),previous:s?!d.default.some(i):void 0,children:n("project-summary-new-members-manual")},{name:"allow_user_request",selected:a.allow_user_request,previous:i.allow_user_request,children:n("project-summary-new-members-join-user")},{name:"approve_user_request",selected:a.approve_user_request,previous:i.approve_user_request,hidden:!a.allow_user_request,children:n("project-summary-new-members-auto-accept-user")},{name:"allow_guest_request",selected:a.allow_guest_request,previous:i.allow_guest_request,children:n("project-summary-new-members-join-guest")},{name:"approve_guest_request",selected:a.approve_guest_request,previous:i.approve_guest_request,hidden:!a.allow_guest_request,children:n("project-summary-new-members-auto-accept-guest")}],u={readOnly:!r,onOptionClick:this.handleMembershipOptionClick};return m.default.createElement(L.default,u,m.default.createElement("label",null,n("project-summary-new-members")),d.default.map(o,function(e,t){return m.default.createElement("option",l({key:t},e))}))}},{key:"renderAccessControlOptions",value:function(){var e=this.props,t=e.env,r=e.editing,n=t.locale.t,a=this.getProjectProperty("settings.access_control","current")||{},i=this.getProjectProperty("settings.access_control","original")||{},s=!!this.getProjectProperty("id"),o=[{name:"members_only",selected:!d.default.some(a),previous:s?!d.default.some(i):void 0,children:n("project-summary-access-control-member-only")},{name:"grant_view_access",selected:a.grant_view_access,previous:i.grant_view_access,children:n("project-summary-access-control-non-member-view")},{name:"grant_comment_access",selected:a.grant_comment_access,previous:i.grant_comment_access,hidden:!a.grant_view_access,children:n("project-summary-access-control-non-member-comment")}],u={readOnly:!r,onOptionClick:this.handleAccessControlOptionClick};return m.default.createElement(L.default,u,m.default.createElement("label",null,n("project-summary-access-control")),d.default.map(o,function(e,t){return m.default.createElement("option",l({key:t},e))}))}},{key:"renderInstructions",value:function(){var e=this.props,t=e.env,r=e.editing,n=(t.locale.t,{folder:"project",topic:"project-summary",hidden:!r,env:t});return m.default.createElement("div",{className:"instructions"},m.default.createElement(M.default,n))}},{key:"renderChart",value:function(){var e=this.props,t=e.env,r=e.statistics,n=e.creating,a=t.locale.t;if(n)return null;var i={statistics:r,env:t};return m.default.createElement("div",{className:"statistics"},m.default.createElement(V.default,{env:t},m.default.createElement(F.default,i,a("project-summary-statistics"))))}},{key:"changeFlags",value:function(e){var t=this,r=this.props,n=r.database,a=r.project,i=n.use({schema:"global",by:this}),s=d.default.assign({},a,e);return i.saveOne({table:"project"},s).catch(function(e){var r={unexpected:e.message};t.setState({problems:r})})}}]),t}(f.PureComponent);ae.displayName="ProjectSummaryPageSync";var ie={details:{},settings:j.default};t.default=ne,t.ProjectSummaryPage=ne,t.ProjectSummaryPageSync=ae},"./pages/project-summary-page.scss":function(e,t){}});