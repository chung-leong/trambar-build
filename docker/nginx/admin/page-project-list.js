webpackJsonp(["page-project-list"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=void 0,r=void 0,i=void 0,a=!1;if(t&&(n=t.type,t.user_id&&(r={id:t.user_id}),e.context.schema&&(i={name:e.context.schema}),a=t.public),"daily-activities"===n){if(r&&i)return l(e,i,r,a);if(i)return o(e,i,r,a)}else if("daily-notifications"===n&&r&&i)return u(e,i,r);return b.default.resolve(null)}function o(e,t,n){if(!t||t.deleted)return b.default.resolve(null);var r={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:n||void 0}},prefetch:!0};return e.findOne(r).then(function(r){if(m(r)){var i=w.getMonthRanges(r.details.start_time,r.details.end_time),o=w.getTimeZoneOffset(),a=y.default.map(i,function(e){return{time_range:e,tz_offset:o,public:n||void 0}}),l={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:a},prefetch:!0};return e.find(l).then(function(e){return P(e,r)})}})}function a(e,t){return b.default.mapSeries(t,function(t){return o(e,t)}).then(function(e){var n=y.default.map(t,"id");return y.default.zipObject(n,e)})}function l(e,t,n,r){return!n||n.deleted?b.default.resolve(null):s(e,t,[n],r).then(function(e){return y.default.get(e,n.id,null)})}function s(e,t,n,r){if(!t||t.deleted)return b.default.resolve(null);var i=(t.name,y.default.filter(n,function(e){return!e.deleted})),o=y.default.map(i,function(e){return{user_ids:[e.id],public:r||void 0}}),a={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:o},prefetch:!0};return e.find(a).then(function(n){n=y.default.filter(n,m);var i=y.default.map(n,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:n,public:r||void 0}})}),o=y.default.flatten(i);if(y.default.isEmpty(o))return{};var a={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:o},prefetch:!0};return e.find(a).then(function(e){return y.default.transform(n,function(t,n){var r=n.filters.user_ids[0],i=y.default.filter(e,function(e){return e.filters.user_ids[0]===r});t[r]=P(i,n)},{})})})}function u(e,t,n){return!n||n.deleted?b.default.resolve(null):d(e,t,[n]).then(function(e){return y.default.get(e,n.id,null)})}function d(e,t,n){if(!t||t.deleted)return b.default.resolve(null);var r=t.name,i=y.default.filter(n,function(e){return!e.deleted}),o={type:"notification-date-range",filters:y.default.map(i,function(e){return{target_user_id:e.id}})};return e.find({schema:r,table:"statistics",criteria:o}).then(function(t){t=y.default.filter(t,m);var n=y.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:n}})}),i=y.default.flatten(n);if(y.default.isEmpty(i))return{};var o={type:"daily-notifications",filters:i};return e.find({schema:r,table:"statistics",criteria:o}).then(function(e){return y.default.transform(t,function(t,n){var r=n.filters.target_user_id,i=y.default.filter(e,function(e){return e.filters.target_user_id===r});t[r]=P(i,n)},{})})})}function c(e,t,n){return!t||t.deleted||!n||n.deleted?b.default.resolve(null):f(e,t,[n]).then(function(e){return y.default.get(e,n.id,null)})}function f(e,t,n){if(!t||t.deleted)return b.default.resolve(null);var r=t.name,i=y.default.filter(n,function(e){return!e.deleted}),o={type:"story-date-range",filters:y.default.map(i,function(e){return{external_object:y.default.find(e.external,{type:e.type})}})};return e.find({schema:r,table:"statistics",criteria:o}).then(function(t){t=y.default.filter(t,m);var i=y.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:n}})}),o=y.default.flatten(i);if(y.default.isEmpty(o))return{};var a={type:"daily-activities",filters:o};return e.find({schema:r,table:"statistics",criteria:a}).then(function(e){return y.default.transform(t,function(t,r){var i=r.filters.external_object,o=y.default.filter(e,function(e){return y.default.isEqual(e.filters.external_object,i)});t[y.default.find(n,function(e){return y.default.some(e.external,i)}).id]=P(o,r)},{})})})}function m(e){return e&&!!e.details.start_time&&!!e.details.end_time}function p(e,t){var n={total:0};return y.default.each(e,function(e){var r=e.filters.time_range,i=y.default.split(r.slice(1,-1),","),o=(0,_.default)(i[0]).format("YYYY-MM"),a=(0,_.default)(i[1]).format("YYYY-MM");(!t||o<=t&&t<=a)&&(y.default.each(e.details,function(e,t){y.default.each(e,function(e,t){"#"!==t.charAt(0)&&(n.total+=e),n[t]?n[t]+=e:n[t]=e})}),e.dirty&&(n.dirty=!0))}),n}function v(e){var t={};return y.default.each(e,function(e){y.default.assign(t,e.details)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var h=n("../../common/node_modules/lodash/lodash.js"),y=r(h),g=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),b=r(g),j=n("../../common/node_modules/moment/moment.js"),_=r(j),E=n("../../common/src/utils/memoize.js"),O=n("../../common/src/utils/date-utils.js"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(O),P=(0,E.memoizeWeak)(null,function(e,t,n){var r=(0,_.default)().subtract(1,"month").format("YYYY-MM"),i=(0,_.default)().format("YYYY-MM"),o=v(e),a=p(e,r),l=p(e,i),s=p(e),u=t.details.start_time,d=t.details.end_time;if(0===a.total){u.substr(0,7)<=r||(a.total=void 0)}return{range:{start:u,end:d},last_month:a,this_month:l,to_date:s,daily:o}});t.find=i,t.findDailyActivitiesOfProject=o,t.findDailyActivitiesOfProjects=a,t.findDailyActivitiesOfUser=l,t.findDailyActivitiesOfUsers=s,t.findDailyNotificationsOfUser=u,t.findDailyNotificationsOfUsers=d,t.findDailyActivitiesOfRepo=c,t.findDailyActivitiesOfRepos=f},"../../common/src/objects/utils/repo-utils.js":function(e,t,n){"use strict";function r(e,t){var n=t.locale.p,r=void 0;return e&&e.details&&(r=n(e.details.title)||e.name),r||""}function i(e){var t=void 0;return e&&e.details&&(t=e.details.web_url),t}function o(e){var t=void 0,n=i(e);return n&&(n=b.default.trimEnd(n," /"),t=n+"/settings/members"),t}function a(e,t){var n=_.findLinkByRelations(t,"issue");return b.default.get(n,"issue.number")||""}function l(e,t){var n=void 0,r=i(e),o=a(e,t);return r&&o&&(n=r+"/issues/"+o),n}function s(e,t){var n=void 0,r=i(e),o=_.findLinkByRelations(t,"milestone"),a=b.default.get(o,"milestone.id");return r&&a&&(n=e.details.web_url+"/milestones/"+a),n}function u(e,t){var n=void 0,r=i(e),o=_.findLinkByRelations(t,"merge_request"),a=b.default.get(o,"merge_request.number");return r&&a&&(n=e.details.web_url+"/merge_requests/"+a),n}function d(e,t){var n=void 0,r=b.default.get(t,"details.commit_before"),o=b.default.get(t,"details.commit_after"),a=i(e);return a&&(r?n=a+"/compare/"+r+"..."+o:o&&(n=a+"/commit/"+o)),n}function c(e,t){var n=void 0,r=b.default.get(t,"details.branch"),o=i(e);return o&&("branch"===t.type?n=o+"/commits/"+r:"tag"===t.type&&(n=o+"/tags/"+r)),n}function f(e,t){var n=void 0;if(e){var r=(b.default.get(e,"details.labels"),b.default.get(e,"details.label_colors")),i=b.default.indexOf(e.details.labels,t),o=b.default.get(r,i);o&&(n={backgroundColor:o},y(o)&&(n.color="#000000"))}return n}function m(e){var t=b.default.get(e,"note.id");return t?"#note_"+t:""}function p(e,t){var n=void 0,r=i(e),o=_.findLinkByRelations(t,"note","commit");if(r&&o){n=r+"/commit/"+o.commit.id+m(o)}return n}function v(e,t){var n=void 0,r=i(e),o=_.findLinkByRelations(t,"note","issue"),a=b.default.get(o,"issue.number");if(r&&a){n=r+"/issues/"+a+m(o)}return n}function h(e,t){var n=void 0,r=i(e),o=_.findLinkByRelations(t,"note","merge_request"),a=b.default.get(o,"merge_request.number");if(r&&a){n=r+"/merge_requests/"+a+m(o)}return n}function y(e){var t,n,r;4===e.length?(t=parseInt(e.substr(1,1),16)*(1/15),n=parseInt(e.substr(2,1),16)*(1/15),r=parseInt(e.substr(3,1),16)*(1/15)):7===e.length&&(t=parseInt(e.substr(1,2),16)*(1/255),n=parseInt(e.substr(3,2),16)*(1/255),r=parseInt(e.substr(5,2),16)*(1/255));var r=Math.sqrt(.299*t*t+.587*n*n+.114*r*r);return r>.8}Object.defineProperty(t,"__esModule",{value:!0}),t.getMergeRequestNoteURL=t.getIssueNoteURL=t.getCommitNoteURL=t.getLabelStyle=t.getBranchURL=t.getPushURL=t.getMergeRequestURL=t.getMilestoneURL=t.getIssueURL=t.getIssueNumber=t.getMembershipPageURL=t.getURL=t.getDisplayName=void 0;var g=n("../../common/node_modules/lodash/lodash.js"),b=function(e){return e&&e.__esModule?e:{default:e}}(g),j=n("../../common/src/objects/utils/external-data-utils.js"),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(j);t.getDisplayName=r,t.getURL=i,t.getMembershipPageURL=o,t.getIssueNumber=a,t.getIssueURL=l,t.getMilestoneURL=s,t.getMergeRequestURL=u,t.getPushURL=d,t.getBranchURL=c,t.getLabelStyle=f,t.getCommitNoteURL=p,t.getIssueNoteURL=v,t.getMergeRequestNoteURL=h},"../../common/src/utils/date-utils.js":function(e,t,n){"use strict";function r(e){var t=e instanceof s.default?e:(0,s.default)(e),n=t.clone().endOf("day");return"["+t.toISOString()+","+n.toISOString()+"]"}function i(e,t){for(var n=e instanceof s.default?e:(0,s.default)(e),r=t instanceof s.default?t:(0,s.default)(t),i=n.startOf("month"),o=r.endOf("month"),a=[],l=i.clone();l<=o;l.add(1,"month")){var u=l.toISOString(),d=l.clone().endOf("month").toISOString(),c="["+u+","+d+"]";a.push(c)}return a}function o(e,t){for(var n=startTime instanceof s.default?startTime:(0,s.default)(startTime),r=t instanceof s.default?t:(0,s.default)(t),i=n.startOf("day"),o=r.endOf("day"),a=[],l=i.clone();l<=o;l.add(1,"day")){var u=l.format("YYYY-MM-DD");a.push(u)}return a}function a(){return(0,s.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var l=n("../../common/node_modules/moment/moment.js"),s=function(e){return e&&e.__esModule?e:{default:e}}(l);t.getDayRange=r,t.getMonthRanges=i,t.getTimeZoneOffset=a,t.getDates=o},"./pages/project-list-page.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectListPageSync=t.ProjectListPage=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n("../../common/node_modules/lodash/lodash.js"),c=i(d),f=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),m=(i(f),n("../../common/node_modules/moment/moment.js")),p=i(m),v=n("../../common/node_modules/react/index.js"),h=i(v),y=n("../../common/node_modules/relaks/index.js"),g=n("../../common/src/utils/memoize.js"),b=n("../../common/src/utils/component-refs.js"),j=i(b),_=n("../../common/src/objects/finders/project-finder.js"),E=r(_),O=n("../../common/src/objects/finders/repo-finder.js"),w=r(O),P=n("../../common/src/objects/finders/user-finder.js"),C=r(P),T=n("../../common/src/objects/finders/statistics-finder.js"),k=r(T),R=n("./widgets/push-button.jsx"),D=i(R),M=n("./widgets/combo-button.jsx"),x=i(M),L=n("./widgets/sortable-table.jsx"),I=i(L),N=n("./tooltips/user-tooltip.jsx"),S=i(N),U=n("./tooltips/repository-tooltip.jsx"),A=i(U),Y=n("./tooltips/activity-tooltip.jsx"),W=i(Y),z=n("./tooltips/modified-time-tooltip.jsx"),q=i(z),B=n("./widgets/action-badge.jsx"),H=i(B),F=n("./widgets/action-confirmation.jsx"),$=i(F),Z=n("./widgets/data-loss-warning.jsx"),J=i(Z),G=n("./widgets/unexpected-error.jsx"),K=i(G);n("./pages/project-list-page.scss");var Q=n("../../common/src/data/database.js"),V=(i(Q),n("../../common/src/routing/route.js")),X=(i(V),n("../../common/src/env/environment.js")),ee=(i(X),function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),u(t,[{key:"renderAsync",value:function(e){var t=this.props,n=t.database,r=t.route,i=t.env,o=t.editing,a=n.use({schema:"global",by:this}),l={projects:void 0,repos:void 0,users:void 0,statistics:void 0,database:n,route:r,env:i,editing:o};return e.show(h.default.createElement(te,l)),a.start().then(function(e){return E.findAllProjects(a).then(function(e){l.projects=e})}).then(function(t){return e.show(h.default.createElement(te,l)),w.findProjectRepos(a,l.projects).then(function(e){l.repos=e})}).then(function(){return C.findProjectMembers(a,l.projects).then(function(e){l.users=e})}).then(function(){return k.findDailyActivitiesOfProjects(a,l.projects).then(function(e){l.statistics=e})}).then(function(){return h.default.createElement(te,l)})}}]),t}(y.AsyncComponent));ee.displayName="ProjectListPage";var te=function(e){function t(e){o(this,t);var n=e.editing,r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleSort=function(e){r.setState({sortColumns:e.columns,sortDirections:e.directions})},r.handleAddClick=function(e){return r.props.route.push("project-summary-page",{projectID:"new"})},r.handleEditClick=function(e){r.setEditability(!0)},r.handleCancelClick=function(e){r.setEditability(!1)},r.handleSaveClick=function(e){var t=r.props,n=t.database,i=t.env,o=t.projects,a=r.state,l=a.archivingProjectIDs,s=a.restoringProjectIDs,u=r.components.confirmation,d=i.locale.t,f=[d("project-list-confirm-archive-$count",l.length),d("project-list-confirm-restore-$count",s.length)],m=[!!c.default.isEmpty(l)||void 0,!!c.default.isEmpty(s)||void 0];return u.askSeries(f,m).then(function(e){if(e){r.setState({problems:{}});var t=n.use({schema:"global",by:r});return t.start().then(function(e){var n=[];return c.default.each(o,function(e){var t={};if(c.default.includes(l,e.id))t.archived=!0;else{if(!c.default.includes(s,e.id))return;t.archived=t.deleted=!1}var r=c.default.assign({},e,t);n.push(r)}),t.save({table:"project"},n).then(function(e){return r.setState({hasChanges:!1},function(){r.setEditability(!1)}),null}).catch(function(e){var t={unexpected:e.message};r.setState({problems:t})})})}})},r.handleRowClick=function(e){var t=r.props.projects,n=r.state,i=n.restoringProjectIDs,o=n.archivingProjectIDs,a=parseInt(e.currentTarget.getAttribute("data-project-id")),l=c.default.find(t,{id:a});l.deleted||l.archived?i=c.default.includes(i,l.id)?c.default.without(i,l.id):c.default.concat(i,l.id):o=c.default.includes(o,l.id)?c.default.without(o,l.id):c.default.concat(o,l.id);var s=!c.default.isEmpty(i)||!c.default.isEmpty(o);r.setState({restoringProjectIDs:i,archivingProjectIDs:o,hasChanges:s})},r.components=(0,j.default)({confirmation:$.default}),r.state={sortColumns:["name"],sortDirections:["asc"],restoringProjectIDs:[],archivingProjectIDs:[],hasChanges:!1,renderingFullList:n,problems:{}},r}return l(t,e),u(t,[{key:"setEditability",value:function(e){var t=this.props.route,n=c.default.clone(t.params);return n.editing=e||void 0,t.replace(t.name,n)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.editing;e.editing!==n&&(e.editing?this.setState({renderingFullList:!0,restoringProjectIDs:[],archivingProjectIDs:[],hasChanges:!1}):setTimeout(function(){t.props.editing||t.setState({renderingFullList:!1,problems:{}})},500))}},{key:"render",value:function(){var e=this.props,t=e.route,n=e.env,r=this.state,i=r.hasChanges,o=r.problems,a=this.components.setters,l=n.locale.t;return h.default.createElement("div",{className:"project-list-page"},this.renderButtons(),h.default.createElement("h2",null,l("project-list-title")),h.default.createElement(K.default,null,o.unexpected),this.renderTable(),h.default.createElement($.default,{ref:a.confirmation,env:n}),h.default.createElement(J.default,{changes:i,env:n,route:t}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.projects,r=e.editing,i=this.state.hasChanges,o=t.locale.t;if(r)return h.default.createElement("div",{className:"buttons"},h.default.createElement(D.default,{onClick:this.handleCancelClick},o("project-list-cancel"))," ",h.default.createElement(D.default,{className:"emphasis",disabled:!i,onClick:this.handleSaveClick},o("project-list-save")));var a=c.default.isEmpty(n);return h.default.createElement("div",{className:"buttons"},h.default.createElement(x.default,{preselected:void 0},h.default.createElement("option",{name:"add",className:"separated",onClick:this.handleAddClick},o("project-list-add")))," ",h.default.createElement(D.default,{className:"emphasis",disabled:a,onClick:this.handleEditClick},o("project-list-edit")))}},{key:"renderTable",value:function(){var e=this.props.editing,t=this.state,n=t.renderingFullList,r=t.sortColumns,i=t.sortDirections,o={sortColumns:r,sortDirections:i,onSort:this.handleSort};return n&&(o.expandable=!0,o.selectable=!0,o.expanded=e,o.onClick=this.handleRowClick),h.default.createElement(I.default,o,h.default.createElement("thead",null,this.renderHeadings()),h.default.createElement("tbody",null,this.renderRows()))}},{key:"renderHeadings",value:function(){return h.default.createElement("tr",null,this.renderTitleColumn(),this.renderUsersColumn(),this.renderRepositoriesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())}},{key:"renderRows",value:function(){var e=this,t=this.props,n=t.env,r=t.projects,i=t.users,o=t.repos,a=t.statistics,l=this.state,s=l.renderingFullList,u=l.sortColumns,d=l.sortDirections;return s||(r=re(r)),r=ne(r,i,o,a,n,u,d),c.default.map(r,function(t){return e.renderRow(t)})}},{key:"renderRow",value:function(e){var t=this.props.env,n=this.state,r=n.renderingFullList,i=n.restoringProjectIDs,o=n.archivingProjectIDs,a=t.locale.t,l=[],u=void 0,d=void 0;e.deleted?(l.push("deleted"),d=a("project-list-status-deleted")):e.archived&&(l.push("disabled"),d=a("project-list-status-archived")),r&&(e.deleted||e.archived?c.default.includes(i,e.id)&&l.push("selected"):(l.push("fixed"),c.default.includes(o,e.id)||l.push("selected")),u=this.handleRowClick);var f={className:l.join(" "),"data-project-id":e.id,title:d,onClick:u};return h.default.createElement("tr",s({key:e.id},f),this.renderTitleColumn(e),this.renderUsersColumn(e),this.renderRepositoriesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))}},{key:"renderTitleColumn",value:function(e){var t=this.props,n=t.env,r=t.route,i=this.state,o=i.renderingFullList,a=i.restoringProjectIDs,l=i.archivingProjectIDs,s=n.locale,u=s.t,d=s.p;if(e){var f=d(e.details.title)||e.name,m=void 0,p=void 0;if(o){var v=void 0,y=void 0;e.deleted||e.archived?(v=!1,y=c.default.includes(a,e.id)):(v=!0,y=!c.default.includes(l,e.id)),v!==y&&(p=y?h.default.createElement(H.default,{type:"restore",env:n}):h.default.createElement(H.default,{type:"archive",env:n}))}else m=r.find("project-summary-page",{projectID:e.id});return h.default.createElement("td",null,h.default.createElement("a",{href:m},f),p)}return h.default.createElement(L.TH,{id:"title"},u("table-heading-name"))}},{key:"renderUsersColumn",value:function(e){var t=this.props,n=t.route,r=t.env,i=t.users,o=r.locale.t;if(!r.isWiderThan("narrow"))return null;if(e){var a={users:oe(i,e),project:e,route:n,env:r};return h.default.createElement("td",null,h.default.createElement(S.default,a))}return h.default.createElement(L.TH,{id:"users"},o("table-heading-users"))}},{key:"renderRepositoriesColumn",value:function(e){var t=this.props,n=t.route,r=t.env,i=t.repos,o=r.locale.t;if(!r.isWiderThan("narrow"))return null;if(e){var a={repos:ie(i,e),project:e,route:n,env:r};return h.default.createElement("td",null,h.default.createElement(A.default,a))}return h.default.createElement(L.TH,{id:"repos"},o("table-heading-repositories"))}},{key:"renderDateRangeColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=n.locale,o=i.t,a=i.localeCode;if(!n.isWiderThan("ultra-wide"))return null;if(e){if(e.deleted)return h.default.createElement("td",null,o("project-list-status-deleted"));var l=void 0,s=void 0,u=c.default.get(r,[e.id,"range"]);return u&&(l=(0,p.default)(u.start).locale(a).format("ll"),s=(0,p.default)(u.end).locale(a).format("ll")),h.default.createElement("td",null,o("date-range-$start-$end",l,s))}return h.default.createElement(L.TH,{id:"range"},o("table-heading-date-range"))}},{key:"renderLastMonthColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=(this.state.renderingFullList,n.locale.t);if(!n.isWiderThan("super-wide"))return null;if(e){var o={statistics:c.default.get(r,[e.id,"last_month"]),env:n};return h.default.createElement("td",null,h.default.createElement(W.default,o))}return h.default.createElement(L.TH,{id:"last_month"},i("table-heading-last-month"))}},{key:"renderThisMonthColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=n.locale.t;if(!n.isWiderThan("super-wide"))return null;if(e){var o={statistics:c.default.get(r,[e.id,"this_month"]),env:n};return h.default.createElement("td",null,h.default.createElement(W.default,o))}return h.default.createElement(L.TH,{id:"this_month"},i("table-heading-this-month"))}},{key:"renderToDateColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=n.locale.t;if(!n.isWiderThan("super-wide"))return null;if(e){var o={statistics:c.default.get(r,[e.id,"to_date"]),env:n};return h.default.createElement("td",null,h.default.createElement(W.default,o))}return h.default.createElement(L.TH,{id:"to_date"},i("table-heading-to-date"))}},{key:"renderModifiedTimeColumn",value:function(e){var t=this.props.env,n=t.locale.t;if(!t.isWiderThan("standard"))return null;if(e){var r={time:e.mtime,env:t};return h.default.createElement("td",null,h.default.createElement(q.default,r))}return h.default.createElement(L.TH,{id:"mtime"},n("table-heading-last-modified"))}}]),t}(v.PureComponent);te.displayName="ProjectListPageSync";var ne=(0,g.memoizeWeak)(null,function(e,t,n,r,i,o,a){var l=i.locale.p;return o=c.default.map(o,function(e){switch(e){case"title":return function(e){return l(e.details.title)};case"users":return function(e){return c.default.size(oe(t,e))};case"repos":return function(e){return c.default.size(ie(n,e))};case"range":return function(e){return c.default.get(r,[e.id,"range","start"],"")};case"last_month":return function(e){return c.default.get(r,[e.id,"last_month","total"],0)};case"this_month":return function(e){return c.default.get(r,[e.id,"this_month","total"],0)};case"to_date":return function(e){return c.default.get(r,[e.id,"to_date","total"],0)};default:return e}}),c.default.orderBy(e,o,a)}),re=(0,g.memoizeWeak)(null,function(e){return c.default.filter(e,function(e){return!e.deleted&&!e.archived})}),ie=(0,g.memoizeWeak)(null,function(e,t){var n=c.default.keyBy(e,"id");return c.default.filter(c.default.map(t.repo_ids,function(e){return n[e]}))}),oe=(0,g.memoizeWeak)(null,function(e,t){var n=c.default.keyBy(e,"id");return c.default.filter(c.default.map(t.user_ids,function(e){return n[e]}))});t.default=ee,t.ProjectListPage=ee,t.ProjectListPageSync=te},"./pages/project-list-page.scss":function(e,t){},"./tooltips/activity-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTooltip=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),c=r(d),f=n("../../common/src/env/environment.js"),m=(r(f),n("../../common/src/objects/types/story-types.js")),p=n("./widgets/tooltip.jsx"),v=r(p);n("./tooltips/activity-tooltip.scss");var h=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.env,n=e.statistics,r=e.disabled,i=t.locale.t;if(!n)return null;if(0===n.total&&n.dirty)return null;var o=i("activity-tooltip-$count",n.total);void 0===n.total&&(o="-");var a=[];return u.default.each(m.StoryTypes,function(e,t){var r=n[e];if(r){var o=m.StoryIcons[e];a.push(c.default.createElement("div",{className:"item",key:t},c.default.createElement(o,{className:"icon"})," ",i("activity-tooltip-$count-"+e,r)))}}),c.default.createElement(v.default,{className:"activity",disabled:r},c.default.createElement("inline",null,o),c.default.createElement("window",null,a))}}]),t}(d.PureComponent);h.displayName="ActivityTooltip",t.default=h,t.ActivityTooltip=h},"./tooltips/activity-tooltip.scss":function(e,t){},"./tooltips/modified-time-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedTimeTooltip=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),c=r(d),f=n("../../common/node_modules/moment/moment.js"),m=r(f),p=n("../../common/src/env/environment.js"),v=(r(p),n("./widgets/tooltip.jsx")),h=r(v),y=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"componentWillMount",value:function(){this.updateLabels()}},{key:"componentWillReceiveProps",value:function(e){this.updateLabels(e)}},{key:"updateLabels",value:function(e){var t=e||this.props,n=t.env,r=t.time,i=n.locale.localeCode,o=void 0;r&&(o=(0,m.default)(r),o.locale(i));var a={relativeTime:o?o.fromNow():null,absoluteTime:o?o.format("lll"):null};u.default.isEqual(a,this.state)||this.setState(a)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state,n=t.relativeTime,r=t.absoluteTime;return c.default.createElement(h.default,{disabled:e},c.default.createElement("inline",null,n),c.default.createElement("window",null,r))}},{key:"componentDidMount",value:function(){g.push(this)}},{key:"componentWillUnmount",value:function(){u.default.pull(g,this)}}]),t}(d.PureComponent);y.displayName="ModifiedTimeTooltip";var g=[];setInterval(function(){u.default.each(g,function(e){e.updateLabels()})},3e4),t.default=y,t.ModifiedTimeTooltip=y},"./tooltips/repository-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RepositoryTooltip=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),c=r(d),f=n("../../common/src/objects/utils/repo-utils.js"),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f),p=n("./widgets/tooltip.jsx"),v=r(p);n("./tooltips/repository-tooltip.scss");var h=n("../../common/src/routing/route.js"),y=(r(h),n("../../common/src/env/environment.js")),g=(r(y),function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.route,n=e.env,r=e.repos,i=e.project,o=e.disabled,a=n.locale.t;if(!r)return null;var l=a("repository-tooltip-$count",r.length),s=u.default.map(r,function(e,r){var o=t.find("repo-summary-page",{projectID:i.id,repoID:e.id}),a=e.type,l=m.getDisplayName(e,n);return c.default.createElement("div",{className:"item",key:r},c.default.createElement("a",{href:o},c.default.createElement("i",{className:"fa fa-"+a})," ",l))}),d=t.find("repo-list-page",{projectID:i.id});return c.default.createElement(v.default,{className:"repository",disabled:o||0===s.length},c.default.createElement("inline",null,l),c.default.createElement("window",null,s,c.default.createElement("div",{className:"bottom"},c.default.createElement("a",{href:d},a("tooltip-more")))))}}]),t}(d.PureComponent));g.displayName="RepositoryTooltip",t.default=g,t.RepositoryTooltip=g},"./tooltips/repository-tooltip.scss":function(e,t){},"./tooltips/user-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserTooltip=t.default=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),c=r(d),f=n("./widgets/tooltip.jsx"),m=r(f),p=n("./widgets/profile-image.jsx"),v=r(p);n("./tooltips/user-tooltip.scss");var h=n("../../common/src/routing/route.js"),y=(r(h),n("../../common/src/env/environment.js")),g=(r(y),function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.route,n=e.env,r=e.users,i=e.project,o=e.disabled,a=n.locale.t;if(!r)return null;var l=a("user-tooltip-$count",r.length),s=void 0;r.length>10&&(r=u.default.slice(r,0,10),s=c.default.createElement("div",{className:"ellipsis"},c.default.createElement("i",{className:"fa fa-ellipsis-v"})));var d=u.default.map(r,function(e,r){var o=void 0;return o=i?t.find("member-summary-page",{projectID:i.id,userID:e.id}):t.find("user-summary-page",{userID:e.id}),c.default.createElement("div",{className:"item",key:r},c.default.createElement("a",{href:o},c.default.createElement(v.default,{user:e,env:n})," ",e.details.name))}),f=void 0;return f=i?t.find("member-list-page",{projectID:i.id}):t.find("user-list-page"),c.default.createElement(m.default,{className:"user",disabled:o||0===d.length},c.default.createElement("inline",null,l),c.default.createElement("window",null,d,s,c.default.createElement("div",{className:"bottom"},c.default.createElement("a",{href:f},a("tooltip-more")))))}}]),t}(d.PureComponent));g.displayName="UserTooltip",t.default=g,t.UserTooltip=g},"./tooltips/user-tooltip.scss":function(e,t){}});