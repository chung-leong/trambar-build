webpackJsonp(["page-project-list"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return e&&!!e.details.start_time&&!!e.details.end_time}function i(e,t){var r={total:0},n=!0,a=!1,i=void 0;try{for(var s,o=(0,d.default)(e);!(n=(s=o.next()).done);n=!0){var u=s.value,c=u.filters.time_range,f=C.default.split(c.slice(1,-1),","),m=(0,R.default)(f[0]).format("YYYY-MM"),p=(0,R.default)(f[1]).format("YYYY-MM");if(!t||m<=t&&t<=p){var v=!0,h=!1,b=void 0;try{for(var g,y=(0,d.default)(C.default.entries(u.details));!(v=(g=y.next()).done);v=!0){var j=g.value,_=(0,l.default)(j,2),x=(_[0],_[1]),k=!0,E=!1,w=void 0;try{for(var T,D=(0,d.default)(C.default.entries(x));!(k=(T=D.next()).done);k=!0){var M=T.value,P=(0,l.default)(M,2),O=P[0],L=P[1];"#"!==O.charAt(0)&&(r.total+=L),r[O]?r[O]+=L:r[O]=L}}catch(e){E=!0,w=e}finally{try{!k&&D.return&&D.return()}finally{if(E)throw w}}}}catch(e){h=!0,b=e}finally{try{!v&&y.return&&y.return()}finally{if(h)throw b}}u.dirty&&(r.dirty=!0)}}}catch(e){a=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw i}}return r}function s(e){var t={},r=!0,n=!1,a=void 0;try{for(var i,s=(0,d.default)(e);!(r=(i=s.next()).done);r=!0){var o=i.value;C.default.assign(t,o.details)}}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var o=r("../../common/node_modules/babel-runtime/helpers/slicedToArray.js"),l=n(o),u=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),d=n(u),c=r("../../common/node_modules/babel-runtime/regenerator/index.js"),f=n(c),m=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=n(m),v=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,a=void 0,i=void 0,s=!1,r&&(n=r.type,r.user_id&&(a={id:r.user_id}),t.context.schema&&(i={name:t.context.schema}),s=r.public),"daily-activities"!==n){e.next=11;break}if(!a||!i){e.next=7;break}return e.abrupt("return",g(t,i,a,s));case 7:if(!i){e.next=9;break}return e.abrupt("return",h(t,i,a,s));case 9:e.next=14;break;case 11:if("daily-notifications"!==n){e.next=14;break}if(!a||!i){e.next=14;break}return e.abrupt("return",j(t,i,a));case 14:return e.abrupt("return",null);case 16:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,o,l,u,d,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:n||void 0}},prefetch:!0},e.next=5,t.findOne(i);case 5:if(s=e.sent,a(s)){e.next=8;break}return e.abrupt("return",null);case 8:return o=M.getMonthRanges(s.details.start_time,s.details.end_time),l=M.getTimeZoneOffset(),u=C.default.map(o,function(e){return{time_range:e,tz_offset:l,public:n||void 0}}),d={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:u},prefetch:!0},e.next=14,t.find(d);case 14:return c=e.sent,e.abrupt("return",P(c,s));case 16:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s,o,l,u;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=!0,i=!1,s=void 0,e.prev=4,o=(0,d.default)(r);case 6:if(a=(l=o.next()).done){e.next=14;break}return u=l.value,e.next=10,h(t,u);case 10:n[u.id]=e.sent;case 11:a=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,s=e.t0;case 20:e.prev=20,e.prev=21,!a&&o.return&&o.return();case 23:if(e.prev=23,!i){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])}));return function(t,r){return e.apply(this,arguments)}}(),g=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,a){var i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,y(t,r,[n],a);case 4:return i=e.sent,e.abrupt("return",C.default.get(i,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}(),y=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,i){var s,o,l,u,c,m,p,v,h,b,g,y,j,_,x,k,E;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return s=r.name,o=C.default.filter(n,function(e){return!e.deleted}),l=C.default.map(o,function(e){return{user_ids:[e.id],public:i||void 0}}),u={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:l},prefetch:!0},e.next=8,t.find(u);case 8:if(c=e.sent,c=C.default.filter(c,a),m=C.default.map(c,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return C.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:r,public:i||void 0}})}),p=C.default.flatten(m),!C.default.isEmpty(p)){e.next=14;break}return e.abrupt("return",{});case 14:return v={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:p},prefetch:!0},e.next=17,t.find(v);case 17:for(h=e.sent,b={},g=function(e){var t=e.filters.user_ids[0],r=C.default.filter(h,function(e){return e.filters.user_ids[0]===t});b[t]=P(r,e)},y=!0,j=!1,_=void 0,e.prev=23,x=(0,d.default)(c);!(y=(k=x.next()).done);y=!0)E=k.value,g(E);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),j=!0,_=e.t0;case 31:e.prev=31,e.prev=32,!y&&x.return&&x.return();case 34:if(e.prev=34,!j){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",b);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n,a){return e.apply(this,arguments)}}(),j=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,_(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",C.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),_=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,o,l,u,c,m,p,v,h,b,g,y,j,_,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=C.default.filter(n,function(e){return!e.deleted}),o=C.default.map(s,function(e){return{target_user_id:e.id}}),l={schema:i,table:"statistics",criteria:{type:"notification-date-range",filters:o}},e.next=8,t.find(l);case 8:if(u=e.sent,u=C.default.filter(u,a),c=C.default.map(u,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return C.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:r}})}),m=C.default.flatten(c),!C.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-notifications",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.target_user_id,r=C.default.filter(v,function(e){return e.filters.target_user_id===t});h[t]=P(r,e)},g=!0,y=!1,j=void 0,e.prev=23,_=(0,d.default)(u);!(g=(x=_.next()).done);g=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),y=!0,j=e.t0;case 31:e.prev=31,e.prev=32,!g&&_.return&&_.return();case 34:if(e.prev=34,!y){e.next=37;break}throw j;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted&&n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,k(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",C.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),k=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,o,l,u,c,m,p,v,h,b,g,y,j,_,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=C.default.filter(n,function(e){return!e.deleted}),o=C.default.map(s,function(e){return{external_object:C.default.find(e.external,{type:e.type})}}),l={schema:i,table:"statistics",criteria:{type:"story-date-range",filters:o}},e.next=8,t.find(l);case 8:if(u=e.sent,u=C.default.filter(u,a),c=C.default.map(u,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return C.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:r}})}),m=C.default.flatten(c),!C.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-activities",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.external_object,r=C.default.filter(v,function(e){return C.default.isEqual(e.filters.external_object,t)}),a=C.default.find(n,function(e){return C.default.some(e.external,t)});h[a.id]=P(r,e)},g=!0,y=!1,j=void 0,e.prev=23,_=(0,d.default)(u);!(g=(x=_.next()).done);g=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),y=!0,j=e.t0;case 31:e.prev=31,e.prev=32,!g&&_.return&&_.return();case 34:if(e.prev=34,!y){e.next=37;break}throw j;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),E=r("../../common/node_modules/lodash/lodash.js"),C=n(E),w=r("../../common/node_modules/moment/moment.js"),R=n(w),T=r("../../common/src/utils/memoize.js"),D=r("../../common/src/utils/date-utils.js"),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(D),P=(0,T.memoizeWeak)(null,function(e,t,r){var n=(0,R.default)().subtract(1,"month").format("YYYY-MM"),a=(0,R.default)().format("YYYY-MM"),o=s(e),l=i(e,n),u=i(e,a),d=i(e),c=t.details.start_time,f=t.details.end_time;if(0===l.total){c.substr(0,7)<=n||(l.total=void 0)}return{range:{start:c,end:f},last_month:l,this_month:u,to_date:d,daily:o}});t.find=v,t.findDailyActivitiesOfProject=h,t.findDailyActivitiesOfProjects=b,t.findDailyActivitiesOfUser=g,t.findDailyActivitiesOfUsers=y,t.findDailyNotificationsOfUser=j,t.findDailyNotificationsOfUsers=_,t.findDailyActivitiesOfRepo=x,t.findDailyActivitiesOfRepos=k},"../../common/src/objects/utils/repo-utils.js":function(e,t,r){"use strict";function n(e,t){var r=t.locale.p,n=void 0;return e&&e.details&&(n=r(e.details.title)||e.name),n||""}function a(e){var t=void 0;return e&&e.details&&(t=e.details.web_url),t}function i(e){var t=void 0,r=a(e);return r&&(r=y.default.trimEnd(r," /"),t=r+"/settings/members"),t}function s(e,t){var r=_.findLinkByRelations(t,"issue");return y.default.get(r,"issue.number")||""}function o(e,t){var r=void 0,n=a(e),i=s(e,t);return n&&i&&(r=n+"/issues/"+i),r}function l(e,t){var r=void 0,n=a(e),i=_.findLinkByRelations(t,"milestone"),s=y.default.get(i,"milestone.id");return n&&s&&(r=e.details.web_url+"/milestones/"+s),r}function u(e,t){var r=void 0,n=a(e),i=_.findLinkByRelations(t,"merge_request"),s=y.default.get(i,"merge_request.number");return n&&s&&(r=e.details.web_url+"/merge_requests/"+s),r}function d(e,t){var r=void 0,n=y.default.get(t,"details.commit_before"),i=y.default.get(t,"details.commit_after"),s=a(e);return s&&(n?r=s+"/compare/"+n+"..."+i:i&&(r=s+"/commit/"+i)),r}function c(e,t){var r=void 0,n=y.default.get(t,"details.branch"),i=a(e);return i&&("branch"===t.type?r=i+"/commits/"+n:"tag"===t.type&&(r=i+"/tags/"+n)),r}function f(e,t){var r=void 0;if(e){var n=(y.default.get(e,"details.labels"),y.default.get(e,"details.label_colors")),a=y.default.indexOf(e.details.labels,t),i=y.default.get(n,a);i&&(r={backgroundColor:i},b(i)&&(r.color="#000000"))}return r}function m(e){var t=y.default.get(e,"note.id");return t?"#note_"+t:""}function p(e,t){var r=void 0,n=a(e),i=_.findLinkByRelations(t,"note","commit");if(n&&i){r=n+"/commit/"+i.commit.id+m(i)}return r}function v(e,t){var r=void 0,n=a(e),i=_.findLinkByRelations(t,"note","issue"),s=y.default.get(i,"issue.number");if(n&&s){r=n+"/issues/"+s+m(i)}return r}function h(e,t){var r=void 0,n=a(e),i=_.findLinkByRelations(t,"note","merge_request"),s=y.default.get(i,"merge_request.number");if(n&&s){r=n+"/merge_requests/"+s+m(i)}return r}function b(e){var t=void 0,r=void 0,n=void 0;return 4===e.length?(t=parseInt(e.substr(1,1),16)*(1/15),r=parseInt(e.substr(2,1),16)*(1/15),n=parseInt(e.substr(3,1),16)*(1/15)):7===e.length&&(t=parseInt(e.substr(1,2),16)*(1/255),r=parseInt(e.substr(3,2),16)*(1/255),n=parseInt(e.substr(5,2),16)*(1/255)),Math.sqrt(.299*t*t+.587*r*r+.114*n*n)>.8}Object.defineProperty(t,"__esModule",{value:!0}),t.getMergeRequestNoteURL=t.getIssueNoteURL=t.getCommitNoteURL=t.getLabelStyle=t.getBranchURL=t.getPushURL=t.getMergeRequestURL=t.getMilestoneURL=t.getIssueURL=t.getIssueNumber=t.getMembershipPageURL=t.getURL=t.getDisplayName=void 0;var g=r("../../common/node_modules/lodash/lodash.js"),y=function(e){return e&&e.__esModule?e:{default:e}}(g),j=r("../../common/src/objects/utils/external-data-utils.js"),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(j);t.getDisplayName=n,t.getURL=a,t.getMembershipPageURL=i,t.getIssueNumber=s,t.getIssueURL=o,t.getMilestoneURL=l,t.getMergeRequestURL=u,t.getPushURL=d,t.getBranchURL=c,t.getLabelStyle=f,t.getCommitNoteURL=p,t.getIssueNoteURL=v,t.getMergeRequestNoteURL=h},"../../common/src/utils/date-utils.js":function(e,t,r){"use strict";function n(e){var t=e instanceof l.default?e:(0,l.default)(e),r=t.clone().endOf("day");return"["+t.toISOString()+","+r.toISOString()+"]"}function a(e,t){for(var r=e instanceof l.default?e:(0,l.default)(e),n=t instanceof l.default?t:(0,l.default)(t),a=r.startOf("month"),i=n.endOf("month"),s=[],o=a.clone();o<=i;o.add(1,"month")){var u=o.toISOString(),d=o.clone().endOf("month").toISOString(),c="["+u+","+d+"]";s.push(c)}return s}function i(e,t){for(var r=startTime instanceof l.default?startTime:(0,l.default)(startTime),n=t instanceof l.default?t:(0,l.default)(t),a=r.startOf("day"),i=n.endOf("day"),s=[],o=a.clone();o<=i;o.add(1,"day")){var u=o.format("YYYY-MM-DD");s.push(u)}return s}function s(){return(0,l.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var o=r("../../common/node_modules/moment/moment.js"),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.getDayRange=n,t.getMonthRanges=a,t.getTimeZoneOffset=s,t.getDates=i},"./pages/project-list-page.jsx":function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectListPageSync=t.ProjectListPage=t.default=void 0;var i=r("../../common/node_modules/babel-runtime/helpers/extends.js"),s=a(i),o=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),l=a(o),u=r("../../common/node_modules/babel-runtime/regenerator/index.js"),d=a(u),c=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),f=a(c),m=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),p=a(m),v=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),h=a(v),b=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),g=a(b),y=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),j=a(y),_=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),x=a(_),k=r("../../common/node_modules/lodash/lodash.js"),E=a(k),C=r("../../common/node_modules/moment/moment.js"),w=a(C),R=r("../../common/node_modules/react/index.js"),T=a(R),D=r("../../common/node_modules/relaks/index.js"),M=r("../../common/src/utils/memoize.js"),P=r("../../common/src/utils/component-refs.js"),O=a(P),L=r("../../common/src/objects/finders/project-finder.js"),I=n(L),N=r("../../common/src/objects/finders/repo-finder.js"),U=n(N),S=r("../../common/src/objects/finders/user-finder.js"),A=n(S),Y=r("../../common/src/objects/finders/statistics-finder.js"),z=n(Y),B=r("./widgets/push-button.jsx"),W=a(B),q=r("./widgets/combo-button.jsx"),F=a(q),H=r("./widgets/sortable-table.jsx"),$=a(H),Z=r("./tooltips/user-tooltip.jsx"),G=a(Z),J=r("./tooltips/repository-tooltip.jsx"),K=a(J),Q=r("./tooltips/activity-tooltip.jsx"),V=a(Q),X=r("./tooltips/modified-time-tooltip.jsx"),ee=a(X),te=r("./widgets/action-badge.jsx"),re=a(te),ne=r("./widgets/action-confirmation.jsx"),ae=a(ne),ie=r("./widgets/data-loss-warning.jsx"),se=a(ie),oe=r("./widgets/unexpected-error.jsx"),le=a(oe);r("./pages/project-list-page.scss");var ue=r("../../common/src/data/database.js"),de=(a(ue),r("../../common/src/routing/route.js")),ce=(a(de),r("../../common/src/env/environment.js")),fe=(a(ce),function(e){function t(){return(0,h.default)(this,t),(0,j.default)(this,(t.__proto__||(0,p.default)(t)).apply(this,arguments))}return(0,x.default)(t,e),(0,g.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,f.default)(d.default.mark(function e(t){var r,n,a,i,s,o,l,u;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props,n=r.database,a=r.route,i=r.env,s=r.editing,o=n.use({schema:"global",by:this}),l={database:n,route:a,env:i,editing:s},t.show(T.default.createElement(me,l)),e.next=6,o.start();case 6:return u=e.sent,e.next=9,I.findAllProjects(o);case 9:return l.projects=e.sent,t.show(T.default.createElement(me,l)),e.next=13,U.findProjectRepos(o,l.projects);case 13:return l.repos=e.sent,e.next=16,A.findProjectMembers(o,l.projects);case 16:return l.users=e.sent,e.next=19,z.findDailyActivitiesOfProjects(o,l.projects);case 19:return l.statistics=e.sent,e.abrupt("return",T.default.createElement(me,l));case 21:case"end":return e.stop()}},e,this)}));return e}()}]),t}(D.AsyncComponent));fe.displayName="ProjectListPage";var me=function(e){function t(e){var r=this;(0,h.default)(this,t);var n=e.editing,a=(0,j.default)(this,(t.__proto__||(0,p.default)(t)).call(this,e));return a.handleSort=function(e){a.setState({sortColumns:e.columns,sortDirections:e.directions})},a.handleAddClick=function(e){return a.props.route.push("project-summary-page",{projectID:"new"})},a.handleEditClick=function(e){a.setEditability(!0)},a.handleCancelClick=function(e){a.setEditability(!1)},a.handleSaveClick=function(){var e=(0,f.default)(d.default.mark(function e(t){var n,i,s,o,u,c,f,m,p,v,h,b,g,y,j,_,x,k,C,w,R,T,D,M;return d.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,i=n.database,s=n.env,o=n.projects,u=a.state,c=u.archivingProjectIDs,f=u.restoringProjectIDs,m=a.components.confirmation,p=s.locale.t,v=[p("project-list-confirm-archive-$count",c.length),p("project-list-confirm-restore-$count",f.length)],h=[!!E.default.isEmpty(c)||void 0,!!E.default.isEmpty(f)||void 0],e.next=8,m.askSeries(v,h);case 8:if(b=e.sent){e.next=11;break}return e.abrupt("return");case 11:return a.setState({problems:{}}),g=i.use({schema:"global",by:a}),e.next=15,g.start();case 15:y=e.sent,j=[],_=!0,x=!1,k=void 0,e.prev=20,C=(0,l.default)(o);case 22:if(_=(w=C.next()).done){e.next=39;break}if(R=w.value,T={},!E.default.includes(c,R.id)){e.next=29;break}T.archived=!0,e.next=34;break;case 29:if(!E.default.includes(f,R.id)){e.next=33;break}T.archived=T.deleted=!1,e.next=34;break;case 33:return e.abrupt("continue",36);case 34:D=E.default.assign({},R,T),j.push(D);case 36:_=!0,e.next=22;break;case 39:e.next=45;break;case 41:e.prev=41,e.t0=e.catch(20),x=!0,k=e.t0;case 45:e.prev=45,e.prev=46,!_&&C.return&&C.return();case 48:if(e.prev=48,!x){e.next=51;break}throw k;case 51:return e.finish(48);case 52:return e.finish(45);case 53:return e.prev=53,e.next=56,g.save({table:"project"},j);case 56:a.setState({hasChanges:!1},function(){a.setEditability(!1)}),e.next=63;break;case 59:e.prev=59,e.t1=e.catch(53),M={unexpected:e.t1.message},a.setState({problems:M});case 63:case"end":return e.stop()}},e,r,[[20,41,45,53],[46,,48,52],[53,59]])}));return function(t){return e.apply(this,arguments)}}(),a.handleRowClick=function(e){var t=a.props.projects,r=a.state,n=r.restoringProjectIDs,i=r.archivingProjectIDs,s=parseInt(e.currentTarget.getAttribute("data-project-id")),o=E.default.find(t,{id:s});o.deleted||o.archived?n=E.default.includes(n,o.id)?E.default.without(n,o.id):E.default.concat(n,o.id):i=E.default.includes(i,o.id)?E.default.without(i,o.id):E.default.concat(i,o.id);var l=!E.default.isEmpty(n)||!E.default.isEmpty(i);a.setState({restoringProjectIDs:n,archivingProjectIDs:i,hasChanges:l})},a.components=(0,O.default)({confirmation:ae.default}),a.state={sortColumns:["name"],sortDirections:["asc"],restoringProjectIDs:[],archivingProjectIDs:[],hasChanges:!1,renderingFullList:n,problems:{}},a}return(0,x.default)(t,e),(0,g.default)(t,[{key:"setEditability",value:function(e){var t=this.props.route,r=E.default.clone(t.params);return r.editing=e||void 0,t.replace(t.name,r)}},{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=this.state,a=n.hasChanges,i=n.problems,s=this.components.setters,o=r.locale.t;return T.default.createElement("div",{className:"project-list-page"},this.renderButtons(),T.default.createElement("h2",null,o("project-list-title")),T.default.createElement(le.default,null,i.unexpected),this.renderTable(),T.default.createElement(ae.default,{ref:s.confirmation,env:r}),T.default.createElement(se.default,{changes:a,env:r,route:t}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,r=e.projects,n=e.editing,a=this.state.hasChanges,i=t.locale.t;if(n)return T.default.createElement("div",{className:"buttons"},T.default.createElement(W.default,{onClick:this.handleCancelClick},i("project-list-cancel"))," ",T.default.createElement(W.default,{className:"emphasis",disabled:!a,onClick:this.handleSaveClick},i("project-list-save")));var s=E.default.isEmpty(r);return T.default.createElement("div",{className:"buttons"},T.default.createElement(F.default,{preselected:void 0},T.default.createElement("option",{name:"add",className:"separated",onClick:this.handleAddClick},i("project-list-add")))," ",T.default.createElement(W.default,{className:"emphasis",disabled:s,onClick:this.handleEditClick},i("project-list-edit")))}},{key:"renderTable",value:function(){var e=this.props.editing,t=this.state,r=t.renderingFullList,n=t.sortColumns,a=t.sortDirections,i={sortColumns:n,sortDirections:a,onSort:this.handleSort};return r&&(i.expandable=!0,i.selectable=!0,i.expanded=e,i.onClick=this.handleRowClick),T.default.createElement($.default,i,T.default.createElement("thead",null,this.renderHeadings()),T.default.createElement("tbody",null,this.renderRows()))}},{key:"renderHeadings",value:function(){return T.default.createElement("tr",null,this.renderTitleColumn(),this.renderUsersColumn(),this.renderRepositoriesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())}},{key:"renderRows",value:function(){var e=this,t=this.props,r=t.env,n=t.projects,a=t.users,i=t.repos,s=t.statistics,o=this.state,l=o.renderingFullList,u=o.sortColumns,d=o.sortDirections;return l||(n=ve(n)),n=pe(n,a,i,s,r,u,d),E.default.map(n,function(t){return e.renderRow(t)})}},{key:"renderRow",value:function(e){var t=this.props.env,r=this.state,n=r.renderingFullList,a=r.restoringProjectIDs,i=r.archivingProjectIDs,o=t.locale.t,l=[],u=void 0,d=void 0;e.deleted?(l.push("deleted"),d=o("project-list-status-deleted")):e.archived&&(l.push("disabled"),d=o("project-list-status-archived")),n&&(e.deleted||e.archived?E.default.includes(a,e.id)&&l.push("selected"):(l.push("fixed"),E.default.includes(i,e.id)||l.push("selected")),u=this.handleRowClick);var c={className:l.join(" "),"data-project-id":e.id,title:d,onClick:u};return T.default.createElement("tr",(0,s.default)({key:e.id},c),this.renderTitleColumn(e),this.renderUsersColumn(e),this.renderRepositoriesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))}},{key:"renderTitleColumn",value:function(e){var t=this.props,r=t.env,n=t.route,a=this.state,i=a.renderingFullList,s=a.restoringProjectIDs,o=a.archivingProjectIDs,l=r.locale,u=l.t,d=l.p;if(e){var c=d(e.details.title)||e.name,f=void 0,m=void 0;if(i){var p=void 0,v=void 0;e.deleted||e.archived?(p=!1,v=E.default.includes(s,e.id)):(p=!0,v=!E.default.includes(o,e.id)),p!==v&&(m=v?T.default.createElement(re.default,{type:"restore",env:r}):T.default.createElement(re.default,{type:"archive",env:r}))}else f=n.find("project-summary-page",{projectID:e.id});return T.default.createElement("td",null,T.default.createElement("a",{href:f},c),m)}return T.default.createElement(H.TH,{id:"title"},u("table-heading-name"))}},{key:"renderUsersColumn",value:function(e){var t=this.props,r=t.route,n=t.env,a=t.users,i=n.locale.t;if(!n.isWiderThan("narrow"))return null;if(e){var s={users:be(a,e),project:e,route:r,env:n};return T.default.createElement("td",null,T.default.createElement(G.default,s))}return T.default.createElement(H.TH,{id:"users"},i("table-heading-users"))}},{key:"renderRepositoriesColumn",value:function(e){var t=this.props,r=t.route,n=t.env,a=t.repos,i=n.locale.t;if(!n.isWiderThan("narrow"))return null;if(e){var s={repos:he(a,e),project:e,route:r,env:n};return T.default.createElement("td",null,T.default.createElement(K.default,s))}return T.default.createElement(H.TH,{id:"repos"},i("table-heading-repositories"))}},{key:"renderDateRangeColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale,i=a.t,s=a.localeCode;if(!r.isWiderThan("ultra-wide"))return null;if(e){if(e.deleted)return T.default.createElement("td",null,i("project-list-status-deleted"));var o=void 0,l=void 0,u=E.default.get(n,[e.id,"range"]);return u&&(o=(0,w.default)(u.start).locale(s).format("ll"),l=(0,w.default)(u.end).locale(s).format("ll")),T.default.createElement("td",null,i("date-range-$start-$end",o,l))}return T.default.createElement(H.TH,{id:"range"},i("table-heading-date-range"))}},{key:"renderLastMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=(this.state.renderingFullList,r.locale.t);if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:E.default.get(n,[e.id,"last_month"]),env:r};return T.default.createElement("td",null,T.default.createElement(V.default,i))}return T.default.createElement(H.TH,{id:"last_month"},a("table-heading-last-month"))}},{key:"renderThisMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:E.default.get(n,[e.id,"this_month"]),env:r};return T.default.createElement("td",null,T.default.createElement(V.default,i))}return T.default.createElement(H.TH,{id:"this_month"},a("table-heading-this-month"))}},{key:"renderToDateColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:E.default.get(n,[e.id,"to_date"]),env:r};return T.default.createElement("td",null,T.default.createElement(V.default,i))}return T.default.createElement(H.TH,{id:"to_date"},a("table-heading-to-date"))}},{key:"renderModifiedTimeColumn",value:function(e){var t=this.props.env,r=t.locale.t;if(!t.isWiderThan("standard"))return null;if(e){var n={time:e.mtime,env:t};return T.default.createElement("td",null,T.default.createElement(ee.default,n))}return T.default.createElement(H.TH,{id:"mtime"},r("table-heading-last-modified"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.editing,n=t.renderingFullList;return r&&!n?{renderingFullList:!0}:!r&&n?{renderingFullList:!1,restoringProjectIDs:[],archivingProjectIDs:[],hasChanges:!1,problems:{}}:null}}]),t}(R.PureComponent);me.displayName="ProjectListPageSync";var pe=(0,M.memoizeWeak)(null,function(e,t,r,n,a,i,s){var o=a.locale.p;return i=E.default.map(i,function(e){switch(e){case"title":return function(e){return o(e.details.title)};case"users":return function(e){return E.default.size(be(t,e))};case"repos":return function(e){return E.default.size(he(r,e))};case"range":return function(e){return E.default.get(n,[e.id,"range","start"],"")};case"last_month":return function(e){return E.default.get(n,[e.id,"last_month","total"],0)};case"this_month":return function(e){return E.default.get(n,[e.id,"this_month","total"],0)};case"to_date":return function(e){return E.default.get(n,[e.id,"to_date","total"],0)};default:return e}}),E.default.orderBy(e,i,s)}),ve=(0,M.memoizeWeak)(null,function(e){return E.default.filter(e,function(e){return!e.deleted&&!e.archived})}),he=(0,M.memoizeWeak)(null,function(e,t){var r=E.default.keyBy(e,"id");return E.default.filter(E.default.map(t.repo_ids,function(e){return r[e]}))}),be=(0,M.memoizeWeak)(null,function(e,t){var r=E.default.keyBy(e,"id");return E.default.filter(E.default.map(t.user_ids,function(e){return r[e]}))});t.default=fe,t.ProjectListPage=fe,t.ProjectListPageSync=me},"./pages/project-list-page.scss":function(e,t){},"./tooltips/activity-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=n(s),l=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=n(l),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=(n(h),r("../../common/node_modules/react/index.js")),g=n(b),y=r("../../common/src/env/environment.js"),j=(n(y),r("../../common/src/objects/types/story-types.js")),_=r("./widgets/tooltip.jsx"),x=n(_);r("./tooltips/activity-tooltip.scss");var k=function(e){function t(){return(0,u.default)(this,t),(0,m.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.env,r=e.statistics,n=e.disabled,a=t.locale.t;if(!r)return null;if(0===r.total&&r.dirty)return null;var s=a("activity-tooltip-$count",r.total);void 0===r.total&&(s="-");var o=[],l=!0,u=!1,d=void 0;try{for(var c,f=(0,i.default)(j.StoryTypes);!(l=(c=f.next()).done);l=!0){var m=c.value,p=r[m];if(p){var v=j.StoryIcons[m];o.push(g.default.createElement("div",{className:"item",key:m},g.default.createElement(v,{className:"icon"})," ",a("activity-tooltip-$count-"+m,p)))}}}catch(e){u=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw d}}return g.default.createElement(x.default,{className:"activity",disabled:n},g.default.createElement("inline",null,s),g.default.createElement("window",null,o))}}]),t}(b.PureComponent);k.displayName="ActivityTooltip",t.default=k,t.ActivityTooltip=k},"./tooltips/activity-tooltip.scss":function(e,t){},"./tooltips/modified-time-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedTimeTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=n(s),l=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),u=n(l),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=n(h),g=r("../../common/node_modules/react/index.js"),y=n(g),j=r("../../common/node_modules/moment/moment.js"),_=n(j),x=r("../../common/src/env/environment.js"),k=(n(x),r("./widgets/tooltip.jsx")),E=n(k),C=function(e){function t(e){(0,u.default)(this,t);var r=(0,m.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return r.state={relativeTime:null,absoluteTime:null},r}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props.disabled,t=this.state,r=t.relativeTime,n=t.absoluteTime;return y.default.createElement(E.default,{disabled:e},y.default.createElement("inline",null,r),y.default.createElement("window",null,n))}},{key:"componentDidMount",value:function(){w.push(this)}},{key:"componentWillUnmount",value:function(){b.default.pull(w,this)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.env,r=e.time,n=t.locale.localeCode,a=void 0;return r&&(a=(0,_.default)(r),a.locale(n)),{relativeTime:a?a.fromNow():null,absoluteTime:a?a.format("lll"):null}}}]),t}(g.PureComponent);C.displayName="ModifiedTimeTooltip";var w=[];setInterval(function(){var e=!0,t=!1,r=void 0;try{for(var n,a=(0,i.default)(w);!(e=(n=a.next()).done);e=!0){n.value.forceUpdate()}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}},3e4),t.default=C,t.ModifiedTimeTooltip=C},"./tooltips/repository-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RepositoryTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(s),l=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=n(l),d=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),m=n(f),p=r("../../common/node_modules/lodash/lodash.js"),v=n(p),h=r("../../common/node_modules/react/index.js"),b=n(h),g=r("../../common/src/objects/utils/repo-utils.js"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(g),j=r("./widgets/tooltip.jsx"),_=n(j);r("./tooltips/repository-tooltip.scss");var x=r("../../common/src/routing/route.js"),k=(n(x),r("../../common/src/env/environment.js")),E=(n(k),function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=e.repos,a=e.project,i=e.disabled,s=r.locale.t;if(!n)return null;var o=s("repository-tooltip-$count",n.length),l=v.default.map(n,function(e,n){var i=t.find("repo-summary-page",{projectID:a.id,repoID:e.id}),s=e.type,o=y.getDisplayName(e,r);return b.default.createElement("div",{className:"item",key:n},b.default.createElement("a",{href:i},b.default.createElement("i",{className:"fa fa-"+s})," ",o))}),u=t.find("repo-list-page",{projectID:a.id});return b.default.createElement(_.default,{className:"repository",disabled:i||0===l.length},b.default.createElement("inline",null,o),b.default.createElement("window",null,l,b.default.createElement("div",{className:"bottom"},b.default.createElement("a",{href:u},s("tooltip-more")))))}}]),t}(h.PureComponent));E.displayName="RepositoryTooltip",t.default=E,t.RepositoryTooltip=E},"./tooltips/repository-tooltip.scss":function(e,t){},"./tooltips/user-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UserTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(s),l=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),u=n(l),d=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),m=n(f),p=r("../../common/node_modules/lodash/lodash.js"),v=n(p),h=r("../../common/node_modules/react/index.js"),b=n(h),g=r("./widgets/tooltip.jsx"),y=n(g),j=r("./widgets/profile-image.jsx"),_=n(j);r("./tooltips/user-tooltip.scss");var x=r("../../common/src/routing/route.js"),k=(n(x),r("../../common/src/env/environment.js")),E=(n(k),function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=e.users,a=e.project,i=e.disabled,s=r.locale.t;if(!n)return null;var o=s("user-tooltip-$count",n.length),l=void 0;n.length>10&&(n=v.default.slice(n,0,10),l=b.default.createElement("div",{className:"ellipsis"},b.default.createElement("i",{className:"fa fa-ellipsis-v"})));var u=v.default.map(n,function(e,n){var i=void 0;return i=a?t.find("member-summary-page",{projectID:a.id,userID:e.id}):t.find("user-summary-page",{userID:e.id}),b.default.createElement("div",{className:"item",key:n},b.default.createElement("a",{href:i},b.default.createElement(_.default,{user:e,env:r})," ",e.details.name))}),d=void 0;return d=a?t.find("member-list-page",{projectID:a.id}):t.find("user-list-page"),b.default.createElement(y.default,{className:"user",disabled:i||0===u.length},b.default.createElement("inline",null,o),b.default.createElement("window",null,u,l,b.default.createElement("div",{className:"bottom"},b.default.createElement("a",{href:d},s("tooltip-more")))))}}]),t}(h.PureComponent));E.displayName="UserTooltip",t.default=E,t.UserTooltip=E},"./tooltips/user-tooltip.scss":function(e,t){}});