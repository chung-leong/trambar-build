webpackJsonp(["page-repo-list"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return e&&!!e.details.start_time&&!!e.details.end_time}function i(e,t){var r={total:0},n=!0,a=!1,i=void 0;try{for(var s,l=(0,d.default)(e);!(n=(s=l.next()).done);n=!0){var o=s.value,c=o.filters.time_range,f=w.default.split(c.slice(1,-1),","),m=(0,T.default)(f[0]).format("YYYY-MM"),p=(0,T.default)(f[1]).format("YYYY-MM");if(!t||m<=t&&t<=p){var v=!0,h=!1,b=void 0;try{for(var y,g=(0,d.default)(w.default.entries(o.details));!(v=(y=g.next()).done);v=!0){var _=y.value,j=(0,u.default)(_,2),x=(j[0],j[1]),k=!0,C=!1,E=void 0;try{for(var D,O=(0,d.default)(w.default.entries(x));!(k=(D=O.next()).done);k=!0){var M=D.value,R=(0,u.default)(M,2),S=R[0],P=R[1];"#"!==S.charAt(0)&&(r.total+=P),r[S]?r[S]+=P:r[S]=P}}catch(e){C=!0,E=e}finally{try{!k&&O.return&&O.return()}finally{if(C)throw E}}}}catch(e){h=!0,b=e}finally{try{!v&&g.return&&g.return()}finally{if(h)throw b}}o.dirty&&(r.dirty=!0)}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return r}function s(e){var t={},r=!0,n=!1,a=void 0;try{for(var i,s=(0,d.default)(e);!(r=(i=s.next()).done);r=!0){var l=i.value;w.default.assign(t,l.details)}}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var l=r("../../common/node_modules/babel-runtime/helpers/slicedToArray.js"),u=n(l),o=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),d=n(o),c=r("../../common/node_modules/babel-runtime/regenerator/index.js"),f=n(c),m=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=n(m),v=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,a=void 0,i=void 0,s=!1,r&&(n=r.type,r.user_id&&(a={id:r.user_id}),t.context.schema&&(i={name:t.context.schema}),s=r.public),"daily-activities"!==n){e.next=11;break}if(!a||!i){e.next=7;break}return e.abrupt("return",y(t,i,a,s));case 7:if(!i){e.next=9;break}return e.abrupt("return",h(t,i,a,s));case 9:e.next=14;break;case 11:if("daily-notifications"!==n){e.next=14;break}if(!a||!i){e.next=14;break}return e.abrupt("return",_(t,i,a));case 14:return e.abrupt("return",null);case 16:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,d,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:n||void 0}},prefetch:!0},e.next=5,t.findOne(i);case 5:if(s=e.sent,a(s)){e.next=8;break}return e.abrupt("return",null);case 8:return l=M.getMonthRanges(s.details.start_time,s.details.end_time),u=M.getTimeZoneOffset(),o=w.default.map(l,function(e){return{time_range:e,tz_offset:u,public:n||void 0}}),d={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:o},prefetch:!0},e.next=14,t.find(d);case 14:return c=e.sent,e.abrupt("return",R(c,s));case 16:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s,l,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=!0,i=!1,s=void 0,e.prev=4,l=(0,d.default)(r);case 6:if(a=(u=l.next()).done){e.next=14;break}return o=u.value,e.next=10,h(t,o);case 10:n[o.id]=e.sent;case 11:a=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,s=e.t0;case 20:e.prev=20,e.prev=21,!a&&l.return&&l.return();case 23:if(e.prev=23,!i){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,a){var i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,g(t,r,[n],a);case 4:return i=e.sent,e.abrupt("return",w.default.get(i,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}(),g=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,i){var s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k,C;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return s=r.name,l=w.default.filter(n,function(e){return!e.deleted}),u=w.default.map(l,function(e){return{user_ids:[e.id],public:i||void 0}}),o={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:u},prefetch:!0},e.next=8,t.find(o);case 8:if(c=e.sent,c=w.default.filter(c,a),m=w.default.map(c,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return w.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:r,public:i||void 0}})}),p=w.default.flatten(m),!w.default.isEmpty(p)){e.next=14;break}return e.abrupt("return",{});case 14:return v={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:p},prefetch:!0},e.next=17,t.find(v);case 17:for(h=e.sent,b={},y=function(e){var t=e.filters.user_ids[0],r=w.default.filter(h,function(e){return e.filters.user_ids[0]===t});b[t]=R(r,e)},g=!0,_=!1,j=void 0,e.prev=23,x=(0,d.default)(c);!(g=(k=x.next()).done);g=!0)C=k.value,y(C);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),_=!0,j=e.t0;case 31:e.prev=31,e.prev=32,!g&&x.return&&x.return();case 34:if(e.prev=34,!_){e.next=37;break}throw j;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",b);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n,a){return e.apply(this,arguments)}}(),_=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,j(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",w.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),j=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=w.default.filter(n,function(e){return!e.deleted}),l=w.default.map(s,function(e){return{target_user_id:e.id}}),u={schema:i,table:"statistics",criteria:{type:"notification-date-range",filters:l}},e.next=8,t.find(u);case 8:if(o=e.sent,o=w.default.filter(o,a),c=w.default.map(o,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return w.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:r}})}),m=w.default.flatten(c),!w.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-notifications",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.target_user_id,r=w.default.filter(v,function(e){return e.filters.target_user_id===t});h[t]=R(r,e)},y=!0,g=!1,_=void 0,e.prev=23,j=(0,d.default)(o);!(y=(x=j.next()).done);y=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),g=!0,_=e.t0;case 31:e.prev=31,e.prev=32,!y&&j.return&&j.return();case 34:if(e.prev=34,!g){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted&&n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,k(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",w.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),k=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=w.default.filter(n,function(e){return!e.deleted}),l=w.default.map(s,function(e){return{external_object:w.default.find(e.external,{type:e.type})}}),u={schema:i,table:"statistics",criteria:{type:"story-date-range",filters:l}},e.next=8,t.find(u);case 8:if(o=e.sent,o=w.default.filter(o,a),c=w.default.map(o,function(e){var t=M.getMonthRanges(e.details.start_time,e.details.end_time),r=M.getTimeZoneOffset();return w.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:r}})}),m=w.default.flatten(c),!w.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-activities",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.external_object,r=w.default.filter(v,function(e){return w.default.isEqual(e.filters.external_object,t)}),a=w.default.find(n,function(e){return w.default.some(e.external,t)});h[a.id]=R(r,e)},y=!0,g=!1,_=void 0,e.prev=23,j=(0,d.default)(o);!(y=(x=j.next()).done);y=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),g=!0,_=e.t0;case 31:e.prev=31,e.prev=32,!y&&j.return&&j.return();case 34:if(e.prev=34,!g){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),C=r("../../common/node_modules/lodash/lodash.js"),w=n(C),E=r("../../common/node_modules/moment/moment.js"),T=n(E),D=r("../../common/src/utils/memoize.js"),O=r("../../common/src/utils/date-utils.js"),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(O),R=(0,D.memoizeWeak)(null,function(e,t,r){var n=(0,T.default)().subtract(1,"month").format("YYYY-MM"),a=(0,T.default)().format("YYYY-MM"),l=s(e),u=i(e,n),o=i(e,a),d=i(e),c=t.details.start_time,f=t.details.end_time;if(0===u.total){c.substr(0,7)<=n||(u.total=void 0)}return{range:{start:c,end:f},last_month:u,this_month:o,to_date:d,daily:l}});t.find=v,t.findDailyActivitiesOfProject=h,t.findDailyActivitiesOfProjects=b,t.findDailyActivitiesOfUser=y,t.findDailyActivitiesOfUsers=g,t.findDailyNotificationsOfUser=_,t.findDailyNotificationsOfUsers=j,t.findDailyActivitiesOfRepo=x,t.findDailyActivitiesOfRepos=k},"../../common/src/utils/date-utils.js":function(e,t,r){"use strict";function n(e){var t=e instanceof u.default?e:(0,u.default)(e),r=t.clone().endOf("day");return"["+t.toISOString()+","+r.toISOString()+"]"}function a(e,t){for(var r=e instanceof u.default?e:(0,u.default)(e),n=t instanceof u.default?t:(0,u.default)(t),a=r.startOf("month"),i=n.endOf("month"),s=[],l=a.clone();l<=i;l.add(1,"month")){var o=l.toISOString(),d=l.clone().endOf("month").toISOString(),c="["+o+","+d+"]";s.push(c)}return s}function i(e,t){for(var r=startTime instanceof u.default?startTime:(0,u.default)(startTime),n=t instanceof u.default?t:(0,u.default)(t),a=r.startOf("day"),i=n.endOf("day"),s=[],l=a.clone();l<=i;l.add(1,"day")){var o=l.format("YYYY-MM-DD");s.push(o)}return s}function s(){return(0,u.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var l=r("../../common/node_modules/moment/moment.js"),u=function(e){return e&&e.__esModule?e:{default:e}}(l);t.getDayRange=n,t.getMonthRanges=a,t.getTimeZoneOffset=s,t.getDates=i},"./pages/repo-list-page.jsx":function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RepoListPageSync=t.RepoListPage=t.default=void 0;var i=r("../../common/node_modules/babel-runtime/helpers/extends.js"),s=a(i),l=r("../../common/node_modules/babel-runtime/regenerator/index.js"),u=a(l),o=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),d=a(o),c=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),f=a(c),m=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=a(m),v=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=a(v),b=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),y=a(b),g=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),_=a(g),j=r("../../common/node_modules/lodash/lodash.js"),x=a(j),k=r("../../common/node_modules/moment/moment.js"),C=a(k),w=r("../../common/node_modules/react/index.js"),E=a(w),T=r("../../common/node_modules/relaks/index.js"),D=r("../../common/src/utils/memoize.js"),O=r("../../common/src/utils/component-refs.js"),M=a(O),R=r("../../common/src/objects/utils/external-data-utils.js"),S=n(R),P=r("../../common/src/objects/finders/project-finder.js"),A=n(P),I=r("../../common/src/objects/finders/repo-finder.js"),N=n(I),Y=r("../../common/src/objects/finders/server-finder.js"),L=n(Y),W=r("../../common/src/objects/finders/statistics-finder.js"),z=n(W),F=r("./widgets/push-button.jsx"),H=a(F),U=r("./widgets/sortable-table.jsx"),Z=a(U),$=r("./tooltips/activity-tooltip.jsx"),B=a($),G=r("./tooltips/modified-time-tooltip.jsx"),q=a(G),J=r("./widgets/action-badge.jsx"),K=a(J),Q=r("./widgets/action-confirmation.jsx"),V=a(Q),X=r("./widgets/data-loss-warning.jsx"),ee=a(X),te=r("./widgets/unexpected-error.jsx"),re=a(te);r("./pages/repo-list-page.scss");var ne=r("../../common/src/data/database.js"),ae=(a(ne),r("../../common/src/routing/route.js")),ie=(a(ae),r("../../common/src/env/environment.js")),se=(a(ie),function(e){function t(){return(0,p.default)(this,t),(0,y.default)(this,(t.__proto__||(0,f.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,h.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,d.default)(u.default.mark(function e(t){var r,n,a,i,s,l,o,d,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props,n=r.database,a=r.route,i=r.env,s=r.projectID,l=r.editing,o=n.use({schema:"global",by:this}),d={database:n,route:a,env:i,editing:l},t.show(E.default.createElement(le,d)),e.next=6,o.start();case 6:return c=e.sent,e.next=9,A.findProject(o,s);case 9:return d.project=e.sent,e.next=12,N.findExistingRepos(o);case 12:return d.repos=e.sent,t.show(E.default.createElement(le,d)),e.next=16,L.findServersOfRepos(o,d.repos);case 16:return d.servers=e.sent,t.show(E.default.createElement(le,d)),f=de(d.repos,d.project),e.next=21,z.findDailyActivitiesOfRepos(o,d.project,f);case 21:return d.statistics=e.sent,e.abrupt("return",E.default.createElement(le,d));case 23:case"end":return e.stop()}},e,this)}));return e}()}]),t}(T.AsyncComponent));se.displayName="RepoListPage";var le=function(e){function t(e){var r=this;(0,p.default)(this,t);var n=e.editing,a=(0,y.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.handleSort=function(e){a.setState({sortColumns:e.columns,sortDirections:e.directions})},a.handleEditClick=function(e){a.setEditability(!0)},a.handleCancelClick=function(e){a.setEditability(!1)},a.handleSaveClick=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,i,s,l,o,d,c,f,m,p,v,h,b,y,g,_,j,k;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,i=n.database,s=n.env,l=n.project,o=n.repos,d=a.state.selectedRepoIDs,c=a.components.confirmation,f=s.locale.t,m=x.default.get(l,"repo_ids",[]),p=x.default.difference(m,d),v=f("repo-list-confirm-remove-$count",p.length),h=!!x.default.isEmpty(p)||void 0,e.next=10,c.ask(v,h);case 10:if(!(b=e.sent)){e.next=29;break}return a.setState({problems:{}}),y=x.default.map(o,"id"),g={id:l.id,repo_ids:x.default.intersection(d,y)},e.prev=15,_=i.use({schema:"global",by:a}),e.next=19,_.start();case 19:return j=e.sent,e.next=22,_.saveOne({table:"project"},g);case 22:a.setState({hasChanges:!1},function(){a.setEditability(!1)}),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(15),k={unexpected:e.t0.message},a.setState({problems:k});case 29:case"end":return e.stop()}},e,r,[[15,25]])}));return function(t){return e.apply(this,arguments)}}(),a.handleRowClick=function(e){var t=a.props.project,r=a.state.selectedRepoIDs,n=parseInt(e.currentTarget.getAttribute("data-repo-id")),i=!0;r=x.default.includes(r,n)?x.default.without(r,n):x.default.concat(r,n),r.length===t.repo_ids.length&&0===x.default.difference(r,t.repo_ids).length&&(r=t.repo_ids,i=!1),a.setState({selectedRepoIDs:r,hasChanges:i})},a.components=(0,M.default)({confirmation:V.default}),a.state={sortColumns:["name"],sortDirections:["asc"],selectedRepoIDs:[],hasChanges:!1,renderingFullList:n,problems:{}},a}return(0,_.default)(t,e),(0,h.default)(t,[{key:"setEditability",value:function(e){var t=this.props.route,r=x.default.clone(t.params);return r.editing=e||void 0,t.replace(t.name,r)}},{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=this.state,a=n.hasChanges,i=n.problems,s=this.components.setters,l=r.locale.t;return E.default.createElement("div",{className:"repo-list-page"},this.renderButtons(),E.default.createElement("h2",null,l("repo-list-title")),E.default.createElement(re.default,null,i.unexpected),this.renderTable(),E.default.createElement(V.default,{ref:s.confirmation,env:r}),E.default.createElement(ee.default,{changes:a,env:r,route:t}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,r=e.repos,n=e.editing,a=this.state.hasChanges,i=t.locale.t;if(n)return E.default.createElement("div",{className:"buttons"},E.default.createElement(H.default,{onClick:this.handleCancelClick},i("repo-list-cancel"))," ",E.default.createElement(H.default,{className:"emphasis",disabled:!a,onClick:this.handleSaveClick},i("repo-list-save")));var s=x.default.isEmpty(r);return E.default.createElement("div",{className:"buttons"},E.default.createElement(H.default,{className:"emphasis",disabled:s,onClick:this.handleEditClick},i("repo-list-edit")))}},{key:"renderTable",value:function(){var e=this.props.editing,t=this.state,r=t.renderingFullList,n=t.sortColumns,a=t.sortDirections,i={sortColumns:n,sortDirections:a,onSort:this.handleSort};return r&&(i.expandable=!0,i.selectable=!0,i.expanded=e),E.default.createElement(Z.default,i,E.default.createElement("thead",null,this.renderHeadings()),E.default.createElement("tbody",null,this.renderRows()))}},{key:"renderHeadings",value:function(){return E.default.createElement("tr",null,this.renderTitleColumn(),this.renderServerColumn(),this.renderIssueTrackerColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())}},{key:"renderRows",value:function(){var e=this,t=this.props,r=t.env,n=t.project,a=t.repos,i=t.servers,s=t.statistics,l=this.state,u=l.renderingFullList,o=l.sortColumns,d=l.sortDirections;return u||(a=de(a,n)),a=ue(a,i,s,r,o,d),x.default.map(a,function(t){return e.renderRow(t)})}},{key:"renderRow",value:function(e){var t=this.props.project,r=this.state,n=r.renderingFullList,a=r.selectedRepoIDs,i={};if(n){var l=x.default.get(t,"repo_ids",[]);x.default.includes(l,e.id)&&(i.className="fixed"),x.default.includes(a,e.id)&&(i.className+=" selected"),i.onClick=this.handleRowClick,i["data-repo-id"]=e.id}return E.default.createElement("tr",(0,s.default)({key:e.id},i),this.renderTitleColumn(e),this.renderServerColumn(e),this.renderIssueTrackerColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))}},{key:"renderTitleColumn",value:function(e){var t=this.props,r=t.route,n=t.env,a=t.project,i=this.state,s=i.renderingFullList,l=i.selectedRepoIDs,u=n.locale,o=u.t,d=u.p;if(e){var c=d(e.details.title)||e.name,f=void 0,m=void 0;if(s){var p=x.default.get(a,"repo_ids",[]),v=x.default.includes(p,e.id),h=x.default.includes(l,e.id);v!==h&&(m=h?E.default.createElement(K.default,{type:"add",env:n}):E.default.createElement(K.default,{type:"remove",env:n}))}else{var b=x.default.clone(r.params);b.repoID=e.id,f=r.find("repo-summary-page",b)}return E.default.createElement("td",null,E.default.createElement("a",{href:f},c),m)}return E.default.createElement(U.TH,{id:"title"},o("table-heading-title"))}},{key:"renderServerColumn",value:function(e){var t=this.props,r=t.route,n=t.env,a=t.servers,i=n.locale,s=i.t,l=i.p;if(e){var u=oe(a,e),o=void 0;if(u){var d=l(u.details.title)||s("server-type-"+u.type),c={serverID:u.id},f=r.find("server-summary-page",c);o=E.default.createElement("a",{href:f},E.default.createElement("i",{className:"fa fa-"+u.type+" fa-fw"})," ",d)}return E.default.createElement("td",null,o)}return E.default.createElement(U.TH,{id:"server"},s("table-heading-server"))}},{key:"renderIssueTrackerColumn",value:function(e){var t=this.props.env,r=t.locale,n=r.t;r.p;if(!t.isWiderThan("ultra-wide"))return null;if(e){var a=!!e.details.issues_enabled;return E.default.createElement("td",null,n("repo-list-issue-tracker-enabled-"+a))}return E.default.createElement(U.TH,{id:"issue_tracker"},n("table-heading-issue-tracker"))}},{key:"renderDateRangeColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale,i=a.t,s=a.localeCode;if(!r.isWiderThan("wide"))return null;if(e){var l=void 0,u=void 0,o=x.default.get(n,[e.id,"range"]);return o&&(l=(0,C.default)(o.start).locale(s).format("ll"),u=(0,C.default)(o.end).locale(s).format("ll")),E.default.createElement("td",null,i("date-range-$start-$end",l,u))}return E.default.createElement(U.TH,{id:"range"},i("table-heading-date-range"))}},{key:"renderLastMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:x.default.get(n,[e.id,"last_month"]),env:r};return E.default.createElement("td",null,E.default.createElement(B.default,i))}return E.default.createElement(U.TH,{id:"last_month"},a("table-heading-last-month"))}},{key:"renderThisMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:x.default.get(n,[e.id,"this_month"]),env:r};return E.default.createElement("td",null,E.default.createElement(B.default,i))}return E.default.createElement(U.TH,{id:"this_month"},a("table-heading-this-month"))}},{key:"renderToDateColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var i={statistics:x.default.get(n,[e.id,"to_date"]),env:r};return E.default.createElement("td",null,E.default.createElement(B.default,i))}return E.default.createElement(U.TH,{id:"to_date"},a("table-heading-to-date"))}},{key:"renderModifiedTimeColumn",value:function(e){var t=this.props.env,r=t.locale.t;if(!t.isWiderThan("standard"))return null;if(e){var n={time:e.mtime,env:t};return E.default.createElement("td",null,E.default.createElement(q.default,n))}return E.default.createElement(U.TH,{id:"mtime"},r("table-heading-last-modified"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.editing,n=e.project,a=t.renderingFullList;return r&&!a?{renderingFullList:!0,selectedRepoIDs:x.default.get(n,"repo_ids",[])}:!r&&a?{renderingFullList:!1,hasChanges:!1,problems:{}}:null}}]),t}(w.PureComponent);le.displayName="RepoListPageSync";var ue=(0,D.memoizeWeak)(null,function(e,t,r,n,a,i){var s=n.locale,l=s.t,u=s.p;return a=x.default.map(a,function(e){switch(e){case"title":return function(e){return u(e.details.title)||e.name};case"server":return function(e){var r=oe(t,e);return r?u(r.details.title)||l("server-type-"+r.type):""};case"issue_tracker":return"details.issues_enabled";case"range":return function(e){return x.default.get(r,[e.id,"range","start"],"")};case"last_month":return function(e){return x.default.get(r,[e.id,"last_month","total"],0)};case"this_month":return function(e){return x.default.get(r,[e.id,"this_month","total"],0)};case"to_date":return function(e){return x.default.get(r,[e.id,"to_date","total"],0)};default:return e}}),x.default.orderBy(e,a,i)}),oe=(0,D.memoizeWeak)(null,function(e,t){return x.default.find(e,function(e){return!!S.findLink(t,e)})}),de=(0,D.memoizeWeak)(null,function(e,t){if(t){var r=x.default.keyBy(e,"id");return x.default.filter(x.default.map(t.repo_ids,function(e){return r[e]}))}});t.default=se,t.RepoListPage=se,t.RepoListPageSync=le},"./pages/repo-list-page.scss":function(e,t){},"./tooltips/activity-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=n(s),u=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(u),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=(n(h),r("../../common/node_modules/react/index.js")),y=n(b),g=r("../../common/src/env/environment.js"),_=(n(g),r("../../common/src/objects/types/story-types.js")),j=r("./widgets/tooltip.jsx"),x=n(j);r("./tooltips/activity-tooltip.scss");var k=function(e){function t(){return(0,o.default)(this,t),(0,m.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.env,r=e.statistics,n=e.disabled,a=t.locale.t;if(!r)return null;if(0===r.total&&r.dirty)return null;var s=a("activity-tooltip-$count",r.total);void 0===r.total&&(s="-");var l=[],u=!0,o=!1,d=void 0;try{for(var c,f=(0,i.default)(_.StoryTypes);!(u=(c=f.next()).done);u=!0){var m=c.value,p=r[m];if(p){var v=_.StoryIcons[m];l.push(y.default.createElement("div",{className:"item",key:m},y.default.createElement(v,{className:"icon"})," ",a("activity-tooltip-$count-"+m,p)))}}}catch(e){o=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(o)throw d}}return y.default.createElement(x.default,{className:"activity",disabled:n},y.default.createElement("inline",null,s),y.default.createElement("window",null,l))}}]),t}(b.PureComponent);k.displayName="ActivityTooltip",t.default=k,t.ActivityTooltip=k},"./tooltips/activity-tooltip.scss":function(e,t){},"./tooltips/modified-time-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedTimeTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=n(s),u=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(u),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=n(h),y=r("../../common/node_modules/react/index.js"),g=n(y),_=r("../../common/node_modules/moment/moment.js"),j=n(_),x=r("../../common/src/env/environment.js"),k=(n(x),r("./widgets/tooltip.jsx")),C=n(k),w=function(e){function t(e){(0,o.default)(this,t);var r=(0,m.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return r.state={relativeTime:null,absoluteTime:null},r}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props.disabled,t=this.state,r=t.relativeTime,n=t.absoluteTime;return g.default.createElement(C.default,{disabled:e},g.default.createElement("inline",null,r),g.default.createElement("window",null,n))}},{key:"componentDidMount",value:function(){E.push(this)}},{key:"componentWillUnmount",value:function(){b.default.pull(E,this)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.env,r=e.time,n=t.locale.localeCode,a=void 0;return r&&(a=(0,j.default)(r),a.locale(n)),{relativeTime:a?a.fromNow():null,absoluteTime:a?a.format("lll"):null}}}]),t}(y.PureComponent);w.displayName="ModifiedTimeTooltip";var E=[];setInterval(function(){var e=!0,t=!1,r=void 0;try{for(var n,a=(0,i.default)(E);!(e=(n=a.next()).done);e=!0){n.value.forceUpdate()}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}},3e4),t.default=w,t.ModifiedTimeTooltip=w}});