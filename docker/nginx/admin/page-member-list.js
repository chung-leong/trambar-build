webpackJsonp(["page-member-list"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=void 0,r=void 0,i=void 0,l=!1;if(t&&(n=t.type,t.user_id&&(r={id:t.user_id}),e.context.schema&&(i={name:e.context.schema}),l=t.public),"daily-activities"===n){if(r&&i)return o(e,i,r,l);if(i)return a(e,i,r,l)}else if("daily-notifications"===n&&r&&i)return u(e,i,r);return g.default.resolve(null)}function a(e,t,n){if(!t||t.deleted)return null;var r={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:n||void 0}},prefetch:!0};return e.findOne(r).then(function(r){if(m(r)){var i=w.getMonthRanges(r.details.start_time,r.details.end_time),a=w.getTimeZoneOffset(),l=y.default.map(i,function(e){return{time_range:e,tz_offset:a,public:n||void 0}}),o={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:l},prefetch:!0};return e.find(o).then(function(e){return C(e,r)})}})}function l(e,t){return g.default.mapSeries(t,function(t){return a(e,t)}).then(function(e){var n=y.default.map(t,"id");return y.default.zipObject(n,e)})}function o(e,t,n,r){return n?s(e,t,[n],r).then(function(e){return y.default.get(e,n.id,null)}):null}function s(e,t,n,r){if(!t)return g.default.resolve(null);var i=(t.name,y.default.filter(n,function(e){return!e.deleted})),a=y.default.map(i,function(e){return{user_ids:[e.id],public:r||void 0}}),l={schema:t.name,table:"statistics",criteria:{type:"story-date-range",filters:a},prefetch:!0};return e.find(l).then(function(n){n=y.default.filter(n,m);var i=y.default.map(n,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:n,public:r||void 0}})}),a=y.default.flatten(i);if(y.default.isEmpty(a))return{};var l={schema:t.name,table:"statistics",criteria:{type:"daily-activities",filters:a},prefetch:!0};return e.find(l).then(function(e){return y.default.transform(n,function(t,n){var r=n.filters.user_ids[0],i=y.default.filter(e,function(e){return e.filters.user_ids[0]===r});t[r]=C(i,n)},{})})})}function u(e,t,n){return n?d(e,t,[n]).then(function(e){return y.default.get(e,n.id,null)}):null}function d(e,t,n){if(!t)return g.default.resolve(null);var r=t.name,i=y.default.filter(n,function(e){return!e.deleted}),a={type:"notification-date-range",filters:y.default.map(i,function(e){return{target_user_id:e.id}})};return e.find({schema:r,table:"statistics",criteria:a}).then(function(t){t=y.default.filter(t,m);var n=y.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:n}})}),i=y.default.flatten(n);if(y.default.isEmpty(i))return{};var a={type:"daily-notifications",filters:i};return e.find({schema:r,table:"statistics",criteria:a}).then(function(e){return y.default.transform(t,function(t,n){var r=n.filters.target_user_id,i=y.default.filter(e,function(e){return e.filters.target_user_id===r});t[r]=C(i,n)},{})})})}function f(e,t,n){return n?c(e,t,[n]).then(function(e){return y.default.get(e,n.id,null)}):null}function c(e,t,n){if(!t)return g.default.resolve(null);var r=t.name,i=y.default.filter(n,function(e){return!e.deleted}),a={type:"story-date-range",filters:y.default.map(i,function(e){return{external_object:y.default.find(e.external,{type:e.type})}})};return e.find({schema:r,table:"statistics",criteria:a}).then(function(t){t=y.default.filter(t,m);var i=y.default.map(t,function(e){var t=w.getMonthRanges(e.details.start_time,e.details.end_time),n=w.getTimeZoneOffset();return y.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:n}})}),a=y.default.flatten(i);if(y.default.isEmpty(a))return{};var l={type:"daily-activities",filters:a};return e.find({schema:r,table:"statistics",criteria:l}).then(function(e){return y.default.transform(t,function(t,r){var i=r.filters.external_object,a=y.default.filter(e,function(e){return y.default.isEqual(e.filters.external_object,i)});t[y.default.find(n,function(e){return y.default.some(e.external,i)}).id]=C(a,r)},{})})})}function m(e){return e&&!!e.details.start_time&&!!e.details.end_time}function p(e,t){var n={total:0};return y.default.each(e,function(e){y.default.each(e.details,function(e,r){t&&r.substr(0,7)!==t||y.default.each(e,function(e,t){"#"!==t.charAt(0)&&(n.total+=e),n[t]?n[t]+=e:n[t]=e})})}),n}function h(e){var t={};return y.default.each(e,function(e){y.default.assign(t,e.details)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var v=n("../../common/node_modules/lodash/lodash.js"),y=r(v),b=n("../../common/node_modules/bluebird/js/browser/bluebird.js"),g=r(b),_=n("../../common/node_modules/moment/moment.js"),j=r(_),E=n("../../common/src/utils/memoize.js"),O=n("../../common/src/utils/date-utils.js"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(O),C=(0,E.memoizeWeak)(null,function(e,t,n){var r=(0,j.default)().subtract(1,"month").format("YYYY-MM"),i=(0,j.default)().format("YYYY-MM"),a=h(e),l=p(e,r),o=p(e,i),s=p(e),u=t.details.start_time,d=t.details.end_time;if(0===l.total){u.substr(0,7)<=r||(l.total=void 0)}return{range:{start:u,end:d},last_month:l,this_month:o,to_date:s,daily:a}});t.find=i,t.findDailyActivitiesOfProject=a,t.findDailyActivitiesOfProjects=l,t.findDailyActivitiesOfUser=o,t.findDailyActivitiesOfUsers=s,t.findDailyNotificationsOfUser=u,t.findDailyNotificationsOfUsers=d,t.findDailyActivitiesOfRepo=f,t.findDailyActivitiesOfRepos=c},"../../common/src/utils/date-utils.js":function(e,t,n){"use strict";function r(e){var t=e instanceof s.default?e:(0,s.default)(e),n=t.clone().endOf("day");return"["+t.toISOString()+","+n.toISOString()+"]"}function i(e,t){for(var n=e instanceof s.default?e:(0,s.default)(e),r=t instanceof s.default?t:(0,s.default)(t),i=n.startOf("month"),a=r.endOf("month"),l=[],o=i.clone();o<=a;o.add(1,"month")){var u=o.toISOString(),d=o.clone().endOf("month").toISOString(),f="["+u+","+d+"]";l.push(f)}return l}function a(e,t){for(var n=startTime instanceof s.default?startTime:(0,s.default)(startTime),r=t instanceof s.default?t:(0,s.default)(t),i=n.startOf("day"),a=r.endOf("day"),l=[],o=i.clone();o<=a;o.add(1,"day")){var u=o.format("YYYY-MM-DD");l.push(u)}return l}function l(){return(0,s.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var o=n("../../common/node_modules/moment/moment.js"),s=function(e){return e&&e.__esModule?e:{default:e}}(o);t.getDayRange=r,t.getMonthRanges=i,t.getTimeZoneOffset=l,t.getDates=a},"./pages/member-list-page.jsx":function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MemberListPageSync=t.MemberListPage=t.default=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n("../../common/node_modules/lodash/lodash.js"),f=i(d),c=n("../../common/node_modules/moment/moment.js"),m=i(c),p=n("../../common/node_modules/react/index.js"),h=i(p),v=n("../../common/node_modules/relaks/index.js"),y=n("../../common/src/utils/memoize.js"),b=n("../../common/src/objects/finders/project-finder.js"),g=r(b),_=n("../../common/src/objects/finders/role-finder.js"),j=r(_),E=n("../../common/src/objects/finders/user-finder.js"),O=r(E),w=n("../../common/src/objects/finders/statistics-finder.js"),C=r(w),T=n("./widgets/push-button.jsx"),k=i(T),D=n("./widgets/combo-button.jsx"),M=i(D),P=n("./widgets/sortable-table.jsx"),x=i(P),R=n("./widgets/profile-image.jsx"),S=i(R),L=n("./tooltips/activity-tooltip.jsx"),N=i(L),I=n("./tooltips/role-tooltip.jsx"),U=i(I),A=n("./widgets/action-badge.jsx"),W=i(A),F=n("./tooltips/modified-time-tooltip.jsx"),Y=i(F),z=n("./widgets/data-loss-warning.jsx"),H=i(z),q=n("./widgets/unexpected-error.jsx"),$=i(q);n("./pages/member-list-page.scss");var Z=n("../../common/src/data/database.js"),B=(i(Z),n("../../common/src/routing/route.js")),J=(i(B),n("../../common/src/env/environment.js")),G=(i(J),function(e){function t(){return a(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"renderAsync",value:function(e){var t=this.props,n=t.database,r=t.route,i=t.env,a=t.projectID,l=t.editing,o=n.use({schema:"global",by:this}),s={project:void 0,users:void 0,roles:void 0,database:n,route:r,env:i,editing:l};return e.show(h.default.createElement(K,s)),o.start().then(function(e){return g.findProject(o,a).then(function(e){s.project=e})}).then(function(){return O.findExistingUsers(o).then(function(e){s.users=e})}).then(function(){return e.show(h.default.createElement(K,s)),j.findRolesOfUsers(o,s.users).then(function(e){s.roles=e})}).then(function(){e.show(h.default.createElement(K,s));var t=V(s.users,s.project);return C.findDailyActivitiesOfUsers(o,s.project,t).then(function(e){s.statistics=e})}).then(function(){return h.default.createElement(K,s)})}}]),t}(v.AsyncComponent));G.displayName="MemberListPage";var K=function(e){function t(e){a(this,t);var n=e.editing,r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleSort=function(e){r.setState({sortColumns:e.columns,sortDirections:e.directions})},r.handleEditClick=function(e){r.setEditability(!0)},r.handleAddClick=function(e){var t=r.props.route,n=f.default.clone(t.params);return n.userID="new",t.push("user-summary-page",n)},r.handleCancelClick=function(e){r.setEditability(!1)},r.handleSaveClick=function(e){var t=r.props,n=t.database,i=t.project,a=r.state,l=a.removingUserIDs,o=a.addingUserIDs,s=n.use({schema:"global",by:r});return s.start().then(function(e){var t=i.user_ids,n=f.default.union(f.default.difference(t,l),o),a={id:i.id,user_ids:n};return s.saveOne({table:"project"},a).then(function(e){return r.setState({hasChanges:!1},function(){return r.setEditability(!1)}),null}).catch(function(e){var t={unexpected:e.message};r.setState({problems:t})})})},r.handleApproveClick=function(e){var t=r.props,n=t.database,i=t.project,a=t.users,l=n.use({schema:"global",by:r});return l.start().then(function(e){var t=f.default.filter(a,function(e){if(f.default.includes(e.requested_project_ids,i.id))return!0}),n=f.default.map(t,"id"),r=i.user_ids,o=f.default.union(r,n),s={id:i.id,user_ids:o};return l.saveOne({table:"project"},s)})},r.handleRejectClick=function(e){var t=r.props,n=t.database,i=t.project,a=t.users,l=n.use({schema:"global",by:r});return l.start().then(function(e){var t=f.default.filter(a,function(e){if(f.default.includes(e.requested_project_ids,i.id))return!0}),n=f.default.map(t,function(e){return{id:e.id,requested_project_ids:f.default.without(e.requested_project_ids,i.id)}});return l.save({table:"user"},n)})},r.handleRowClick=function(e){var t=r.props.project,n=r.state,i=n.addingUserIDs,a=n.removingUserIDs,l=parseInt(e.currentTarget.getAttribute("data-user-id"));f.default.includes(t.user_ids,l)?a=f.default.includes(a,l)?f.default.without(a,l):f.default.concat(a,l):i=f.default.includes(i,l)?f.default.without(i,l):f.default.concat(i,l);var o=!f.default.isEmpty(i)||!f.default.isEmpty(a);r.setState({addingUserIDs:i,removingUserIDs:a,hasChanges:o})},r.state={sortColumns:["name"],sortDirections:["asc"],removingUserIDs:[],addingUserIDs:[],hasChanges:!1,renderingFullList:n,problems:{}},r}return o(t,e),u(t,[{key:"setEditability",value:function(e){var t=this.props.route,n=f.default.clone(t.params);return n.editing=e||void 0,t.replace(t.name,n)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.editing;e.editing!==n&&(e.editing?this.setState({renderingFullList:!0,removingUserIDs:[],addingUserIDs:[],changes:!1}):setTimeout(function(){t.props.editing||t.setState({renderingFullList:!1,problems:{}})},500))}},{key:"render",value:function(){var e=this.props,t=e.route,n=e.env,r=this.state,i=r.hasChanges,a=r.problems,l=n.locale.t;return h.default.createElement("div",{className:"member-list-page"},this.renderButtons(),h.default.createElement("h2",null,l("member-list-title")),h.default.createElement($.default,null,a.unexpected),this.renderTable(),h.default.createElement(H.default,{changes:i,env:n,route:t}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,n=e.project,r=e.users,i=e.editing,a=this.state,l=a.hasChanges,o=(a.problems,t.locale.t);if(i)return h.default.createElement("div",{key:"edit",className:"buttons"},h.default.createElement(k.default,{onClick:this.handleCancelClick},o("member-list-cancel"))," ",h.default.createElement(k.default,{className:"emphasis",disabled:!l,onClick:this.handleSaveClick},o("member-list-save")));var s=f.default.get(n,"user_ids"),u=f.default.some(r,function(e){return!f.default.includes(s,e.id)}),d=u?"approve":void 0;f.default.isEmpty(r);return h.default.createElement("div",{key:"view",className:"buttons"},h.default.createElement(M.default,{preselected:d},h.default.createElement("option",{name:"approve",disabled:!u,onClick:this.handleApproveClick},o("member-list-approve-all")),h.default.createElement("option",{name:"reject",disabled:!u,onClick:this.handleRejectClick},o("member-list-reject-all")),h.default.createElement("option",{name:"add",separator:!0,onClick:this.handleAddClick},o("member-list-add")))," ",h.default.createElement(k.default,{className:"emphasis",onClick:this.handleEditClick},o("member-list-edit")))}},{key:"renderTable",value:function(){var e=this.props,t=e.env,n=e.editing,r=this.state,i=r.renderingFullList,a=r.sortColumns,l=r.sortDirections,o=(t.locale.t,{sortColumns:a,sortDirections:l,onSort:this.handleSort});return i&&(o.expandable=!0,o.selectable=!0,o.expanded=n),h.default.createElement(x.default,o,h.default.createElement("thead",null,this.renderHeadings()),h.default.createElement("tbody",{ref:"tbody"},this.renderRows()))}},{key:"renderHeadings",value:function(){return h.default.createElement("tr",null,this.renderNameColumn(),this.renderTypeColumn(),this.renderRolesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())}},{key:"renderRows",value:function(){var e=this,t=this.props,n=t.env,r=t.project,i=t.users,a=t.roles,l=t.statistics,o=this.state,s=o.renderingFullList,u=o.sortColumns,d=o.sortDirections;return s||(i=V(i,r)),i=Q(i,a,l,n,u,d),f.default.map(i,function(t){return e.renderRow(t)})}},{key:"renderRow",value:function(e){var t=this.props,n=t.env,r=t.project,i=this.state,a=i.renderingFullList,l=i.removingUserIDs,o=i.addingUserIDs,u=n.locale.t,d=[],c=void 0,m=void 0,p=f.default.includes(r.user_ids,e.id),v=f.default.includes(e.requested_project_ids,r.id);p||(v?(d.push("pending"),c=u("member-list-status-pending")):(d.push("disabled"),c=u("member-list-status-non-member"))),a&&((p||v)&&d.push("fixed"),p?f.default.includes(l,e.id)||d.push("selected"):f.default.includes(o,e.id)&&d.push("selected"),m=this.handleRowClick);var y={className:d.join(" "),"data-user-id":e.id,onClick:m,title:c};return h.default.createElement("tr",s({key:e.id},y),this.renderNameColumn(e),this.renderTypeColumn(e),this.renderRolesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))}},{key:"renderNameColumn",value:function(e){var t=this.props,n=t.env,r=t.project,i=t.route,a=this.state,l=a.renderingFullList,o=a.removingUserIDs,s=a.addingUserIDs,u=n.locale,d=u.t,c=u.p;if(e){var m=c(e.details.name),p=void 0,v=void 0;if(l){var y=f.default.get(r,"user_ids",[]),b=f.default.includes(y,e.id),g=void 0;g=b?!f.default.includes(o,e.id):f.default.includes(s,e.id),b!==g&&(v=g?h.default.createElement(W.default,{type:"add",env:n}):h.default.createElement(W.default,{type:"remove",env:n}))}else{var _=f.default.clone(i.params);_.userID=e.id,p=i.find("member-summary-page",_)}var j=h.default.createElement(S.default,{user:e,env:n});return h.default.createElement("td",null,h.default.createElement("a",{href:p},j," ",m),v)}return h.default.createElement(P.TH,{id:"name"},d("table-heading-name"))}},{key:"renderTypeColumn",value:function(e){var t=this.props.env,n=t.locale.t;return t.isWiderThan("narrow")?e?h.default.createElement("td",null,n("user-list-type-"+e.type)):h.default.createElement(P.TH,{id:"type"},n("table-heading-type")):null}},{key:"renderRolesColumn",value:function(e){var t=this.props,n=t.env,r=t.route,i=t.roles,a=this.state.renderingFullList,l=n.locale.t;if(!n.isWiderThan("standard"))return null;if(e){var o={roles:X(i,e),disabled:a,route:r,env:n};return h.default.createElement("td",null,h.default.createElement(U.default,o))}return h.default.createElement(P.TH,{id:"roles"},l("table-heading-roles"))}},{key:"renderEmailColumn",value:function(e){var t=this.props.env,n=this.state.renderingFullList,r=t.locale.t;if(!t.isWiderThan("wide"))return null;if(e){var i=e.details.email,a=void 0;return!n&&i&&(a="mailto:"+i),h.default.createElement("td",null,h.default.createElement("a",{href:a},i))}return h.default.createElement(P.TH,{id:"email"},r("table-heading-email"))}},{key:"renderDateRangeColumn",value:function(e,t){var n=this.props,r=n.env,i=n.statistics,a=(this.state.renderingFullList,r.locale),l=a.t,o=a.localeCode;if(!r.isWiderThan("ultra-wide"))return null;if(e){var s=void 0,u=void 0,d=f.default.get(i,[e.id,"range"]);return d&&(s=(0,m.default)(d.start).locale(o).format("ll"),u=(0,m.default)(d.end).locale(o).format("ll")),h.default.createElement("td",null,l("date-range-$start-$end",s,u))}return h.default.createElement(P.TH,{id:"range"},l("table-heading-date-range"))}},{key:"renderLastMonthColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=this.state.renderingFullList,a=n.locale.t;if(!n.isWiderThan("super-wide"))return null;if(e){var l={statistics:f.default.get(r,[e.id,"last_month"]),disabled:i,env:n};return h.default.createElement("td",null,h.default.createElement(N.default,l))}return h.default.createElement(P.TH,{id:"last_month"},a("table-heading-last-month"))}},{key:"renderThisMonthColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=this.state.renderingFullList,a=n.locale.t;if(!n.isWiderThan("super-wide"))return null;if(e){var l={statistics:f.default.get(r,[e.id,"this_month"]),disabled:i,env:n};return h.default.createElement("td",null,h.default.createElement(N.default,l))}return h.default.createElement(P.TH,{id:"this_month"},a("table-heading-this-month"))}},{key:"renderToDateColumn",value:function(e){var t=this.props,n=t.env,r=t.statistics,i=this.state.renderingFullList,a=n.locale.t;if(!n.isWiderThan("super-wide"))return null;if(e){var l={statistics:f.default.get(r,[e.id,"to_date"]),disabled:i,env:n};return h.default.createElement("td",null,h.default.createElement(N.default,l))}return h.default.createElement(P.TH,{id:"to_date"},a("table-heading-to-date"))}},{key:"renderModifiedTimeColumn",value:function(e){var t=this.props,n=t.env,r=(t.statistics,this.state.renderingFullList),i=n.locale.t;if(!n.isWiderThan("standard"))return null;if(e){var a={time:e.mtime,disabled:r,env:n};return h.default.createElement("td",null,h.default.createElement(Y.default,a))}return h.default.createElement(P.TH,{id:"mtime"},i("table-heading-last-modified"))}}]),t}(p.PureComponent);K.displayName="MemberListPageSync";var Q=(0,y.memoizeWeak)(null,function(e,t,n,r,i,a){var l=r.locale.p;return i=f.default.map(i,function(e){switch(e){case"name":return function(e){return l(e.details.name)};case"range":return function(e){return f.default.get(n,[e.id,"range","start"],"")};case"last_month":return function(e){return f.default.get(n,[e.id,"last_month","total"],0)};case"this_month":return function(e){return f.default.get(n,[e.id,"this_month","total"],0)};case"to_date":return function(e){return f.default.get(n,[e.id,"to_date","total"],0)};default:return e}}),f.default.orderBy(e,i,a)}),V=(0,y.memoizeWeak)(null,function(e,t){if(t){var n=f.default.keyBy(e,"id"),r=f.default.filter(f.default.map(t.user_ids,function(e){return n[e]})),i=f.default.filter(e,function(e){return f.default.includes(e.requested_project_ids,t.id)});return f.default.union(r,i)}}),X=(0,y.memoizeWeak)(null,function(e,t){var n=f.default.keyBy(e,"id");return f.default.filter(f.default.map(t.role_ids,function(e){return n[e]}))});t.default=G,t.MemberListPage=G,t.MemberListPageSync=K},"./pages/member-list-page.scss":function(e,t){},"./tooltips/activity-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTooltip=t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),f=r(d),c=n("../../common/src/env/environment.js"),m=(r(c),n("../../common/src/objects/types/story-types.js")),p=n("./widgets/tooltip.jsx"),h=r(p);n("./tooltips/activity-tooltip.scss");var v=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.env,n=e.statistics,r=e.disabled,i=t.locale.t;if(!n)return null;var a=i("activity-tooltip-$count",n.total);void 0===n.total&&(a="-");var l=[];return u.default.each(m.StoryTypes,function(e,t){var r=n[e];if(r){var a=m.StoryIcons[e];l.push(f.default.createElement("div",{className:"item",key:t},f.default.createElement(a,{className:"icon"})," ",i("activity-tooltip-$count-"+e,r)))}}),f.default.createElement(h.default,{className:"activity",disabled:r},f.default.createElement("inline",null,a),f.default.createElement("window",null,l))}}]),t}(d.PureComponent);v.displayName="ActivityTooltip",t.default=v,t.ActivityTooltip=v},"./tooltips/activity-tooltip.scss":function(e,t){},"./tooltips/modified-time-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedTimeTooltip=t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),f=r(d),c=n("../../common/node_modules/moment/moment.js"),m=r(c),p=n("../../common/src/env/environment.js"),h=(r(p),n("./widgets/tooltip.jsx")),v=r(h),y=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),o(t,[{key:"componentWillMount",value:function(){this.updateLabels()}},{key:"componentWillReceiveProps",value:function(e){this.updateLabels(e)}},{key:"updateLabels",value:function(e){var t=e||this.props,n=t.env,r=t.time,i=n.locale.localeCode,a=void 0;r&&(a=(0,m.default)(r),a.locale(i));var l={relativeTime:a?a.fromNow():null,absoluteTime:a?a.format("lll"):null};u.default.isEqual(l,this.state)||this.setState(l)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state,n=t.relativeTime,r=t.absoluteTime;return f.default.createElement(v.default,{disabled:e},f.default.createElement("inline",null,n),f.default.createElement("window",null,r))}},{key:"componentDidMount",value:function(){b.push(this)}},{key:"componentWillUnmount",value:function(){u.default.pull(b,this)}}]),t}(d.PureComponent);y.displayName="ModifiedTimeTooltip";var b=[];setInterval(function(){u.default.each(b,function(e){e.updateLabels()})},3e4),t.default=y,t.ModifiedTimeTooltip=y},"./tooltips/role-tooltip.jsx":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.RoleTooltip=t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n("../../common/node_modules/lodash/lodash.js"),u=r(s),d=n("../../common/node_modules/react/index.js"),f=r(d),c=n("./widgets/tooltip.jsx"),m=r(c);n("./tooltips/role-tooltip.scss");var p=n("../../common/src/routing/route.js"),h=(r(p),n("../../common/src/env/environment.js")),v=(r(h),function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),o(t,[{key:"render",value:function(){var e=this.props,t=e.route,n=e.env,r=e.roles,i=e.disabled,a=n.locale,l=a.t,o=a.p;if(!r)return null;if(r.length>0){var s=r[0],d=void 0;i||(d=t.find("role-summary-page",{roleID:s.id}));var c=o(s.details.title)||s.name;f.default.createElement("a",{href:d,key:0},c);r=u.default.slice(r,1)}var p=void 0;if(r.length>0){var h=void 0,v=l("role-tooltip-$count-others",r.length);r.length>10&&(r=u.default.slice(r,0,10),h=f.default.createElement("div",{className:"ellipsis"},f.default.createElement("i",{className:"fa fa-ellipsis-v"})));var y=u.default.map(r,function(e,n){var r=t.find("role-summary-page",{roleID:e.id}),i=o(e.details.title)||e.name;return f.default.createElement("div",{className:"item",key:n},f.default.createElement("a",{href:r},i))}),b=t.find("role-list-page");p=l("tooltip-$first-and-$tooltip","-",f.default.createElement(m.default,{className:"role",disabled:i||0===y.length,key:1},f.default.createElement("inline",null,v),f.default.createElement("window",null,y,h,f.default.createElement("div",{className:"bottom"},f.default.createElement("a",{href:b},l("tooltip-more"))))))}else p="-";return f.default.createElement("span",null,p)}}]),t}(d.PureComponent));v.displayName="RoleTooltip",t.default=v,t.RoleTooltip=v},"./tooltips/role-tooltip.scss":function(e,t){}});