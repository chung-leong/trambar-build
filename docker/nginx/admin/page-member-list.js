webpackJsonp(["page-member-list"],{"../../common/src/objects/finders/statistics-finder.js":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){return e&&!!e.details.start_time&&!!e.details.end_time}function i(e,t){var r={total:0},n=!0,a=!1,i=void 0;try{for(var s,l=(0,d.default)(e);!(n=(s=l.next()).done);n=!0){var o=s.value,c=o.filters.time_range,f=C.default.split(c.slice(1,-1),","),m=(0,T.default)(f[0]).format("YYYY-MM"),p=(0,T.default)(f[1]).format("YYYY-MM");if(!t||m<=t&&t<=p){var v=!0,h=!1,b=void 0;try{for(var y,g=(0,d.default)(C.default.entries(o.details));!(v=(y=g.next()).done);v=!0){var _=y.value,j=(0,u.default)(_,2),x=(j[0],j[1]),k=!0,E=!1,w=void 0;try{for(var D,M=(0,d.default)(C.default.entries(x));!(k=(D=M.next()).done);k=!0){var O=D.value,R=(0,u.default)(O,2),N=R[0],U=R[1];"#"!==N.charAt(0)&&(r.total+=U),r[N]?r[N]+=U:r[N]=U}}catch(e){E=!0,w=e}finally{try{!k&&M.return&&M.return()}finally{if(E)throw w}}}}catch(e){h=!0,b=e}finally{try{!v&&g.return&&g.return()}finally{if(h)throw b}}o.dirty&&(r.dirty=!0)}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return r}function s(e){var t={},r=!0,n=!1,a=void 0;try{for(var i,s=(0,d.default)(e);!(r=(i=s.next()).done);r=!0){var l=i.value;C.default.assign(t,l.details)}}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.findDailyActivitiesOfRepos=t.findDailyActivitiesOfRepo=t.findDailyNotificationsOfUsers=t.findDailyNotificationsOfUser=t.findDailyActivitiesOfUsers=t.findDailyActivitiesOfUser=t.findDailyActivitiesOfProjects=t.findDailyActivitiesOfProject=t.find=void 0;var l=r("../../common/node_modules/babel-runtime/helpers/slicedToArray.js"),u=n(l),o=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),d=n(o),c=r("../../common/node_modules/babel-runtime/regenerator/index.js"),f=n(c),m=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),p=n(m),v=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=void 0,a=void 0,i=void 0,s=!1,r&&(n=r.type,r.user_id&&(a={id:r.user_id}),t.context.schema&&(i={name:t.context.schema}),s=r.public),"daily-activities"!==n){e.next=11;break}if(!a||!i){e.next=7;break}return e.abrupt("return",y(t,i,a,s));case 7:if(!i){e.next=9;break}return e.abrupt("return",h(t,i,a,s));case 9:e.next=14;break;case 11:if("daily-notifications"!==n){e.next=14;break}if(!a||!i){e.next=14;break}return e.abrupt("return",_(t,i,a));case 14:return e.abrupt("return",null);case 16:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,d,c;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:{public:n||void 0}},prefetch:!0},e.next=5,t.findOne(i);case 5:if(s=e.sent,a(s)){e.next=8;break}return e.abrupt("return",null);case 8:return l=O.getMonthRanges(s.details.start_time,s.details.end_time),u=O.getTimeZoneOffset(),o=C.default.map(l,function(e){return{time_range:e,tz_offset:u,public:n||void 0}}),d={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:o},prefetch:!0},e.next=14,t.find(d);case 14:return c=e.sent,e.abrupt("return",R(c,s));case 16:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),b=function(){var e=(0,p.default)(f.default.mark(function e(t,r){var n,a,i,s,l,u,o;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=!0,i=!1,s=void 0,e.prev=4,l=(0,d.default)(r);case 6:if(a=(u=l.next()).done){e.next=14;break}return o=u.value,e.next=10,h(t,o);case 10:n[o.id]=e.sent;case 11:a=!0,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,s=e.t0;case 20:e.prev=20,e.prev=21,!a&&l.return&&l.return();case 23:if(e.prev=23,!i){e.next=26;break}throw s;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}},e,this,[[4,16,20,28],[21,,23,27]])}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,a){var i;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,g(t,r,[n],a);case 4:return i=e.sent,e.abrupt("return",C.default.get(i,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n,a){return e.apply(this,arguments)}}(),g=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n,i){var s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k,E;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return s=r.name,l=C.default.filter(n,function(e){return!e.deleted}),u=C.default.map(l,function(e){return{user_ids:[e.id],public:i||void 0}}),o={schema:r.name,table:"statistics",criteria:{type:"story-date-range",filters:u},prefetch:!0},e.next=8,t.find(o);case 8:if(c=e.sent,c=C.default.filter(c,a),m=C.default.map(c,function(e){var t=O.getMonthRanges(e.details.start_time,e.details.end_time),r=O.getTimeZoneOffset();return C.default.map(t,function(t){return{user_ids:e.filters.user_ids,time_range:t,tz_offset:r,public:i||void 0}})}),p=C.default.flatten(m),!C.default.isEmpty(p)){e.next=14;break}return e.abrupt("return",{});case 14:return v={schema:r.name,table:"statistics",criteria:{type:"daily-activities",filters:p},prefetch:!0},e.next=17,t.find(v);case 17:for(h=e.sent,b={},y=function(e){var t=e.filters.user_ids[0],r=C.default.filter(h,function(e){return e.filters.user_ids[0]===t});b[t]=R(r,e)},g=!0,_=!1,j=void 0,e.prev=23,x=(0,d.default)(c);!(g=(k=x.next()).done);g=!0)E=k.value,y(E);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),_=!0,j=e.t0;case 31:e.prev=31,e.prev=32,!g&&x.return&&x.return();case 34:if(e.prev=34,!_){e.next=37;break}throw j;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",b);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n,a){return e.apply(this,arguments)}}(),_=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,j(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",C.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),j=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=C.default.filter(n,function(e){return!e.deleted}),l=C.default.map(s,function(e){return{target_user_id:e.id}}),u={schema:i,table:"statistics",criteria:{type:"notification-date-range",filters:l}},e.next=8,t.find(u);case 8:if(o=e.sent,o=C.default.filter(o,a),c=C.default.map(o,function(e){var t=O.getMonthRanges(e.details.start_time,e.details.end_time),r=O.getTimeZoneOffset();return C.default.map(t,function(t){return{target_user_id:e.filters.target_user_id,time_range:t,tz_offset:r}})}),m=C.default.flatten(c),!C.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-notifications",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.target_user_id,r=C.default.filter(v,function(e){return e.filters.target_user_id===t});h[t]=R(r,e)},y=!0,g=!1,_=void 0,e.prev=23,j=(0,d.default)(o);!(y=(x=j.next()).done);y=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),g=!0,_=e.t0;case 31:e.prev=31,e.prev=32,!y&&j.return&&j.return();case 34:if(e.prev=34,!g){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),x=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var a;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted&&n&&!n.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,k(t,r,[n]);case 4:return a=e.sent,e.abrupt("return",C.default.get(a,n.id,null));case 6:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}(),k=function(){var e=(0,p.default)(f.default.mark(function e(t,r,n){var i,s,l,u,o,c,m,p,v,h,b,y,g,_,j,x,k;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&!r.deleted){e.next=2;break}return e.abrupt("return",null);case 2:return i=r.name,s=C.default.filter(n,function(e){return!e.deleted}),l=C.default.map(s,function(e){return{external_object:C.default.find(e.external,{type:e.type})}}),u={schema:i,table:"statistics",criteria:{type:"story-date-range",filters:l}},e.next=8,t.find(u);case 8:if(o=e.sent,o=C.default.filter(o,a),c=C.default.map(o,function(e){var t=O.getMonthRanges(e.details.start_time,e.details.end_time),r=O.getTimeZoneOffset();return C.default.map(t,function(t){return{external_object:e.filters.external_object,time_range:t,tz_offset:r}})}),m=C.default.flatten(c),!C.default.isEmpty(m)){e.next=14;break}return e.abrupt("return",{});case 14:return p={schema:i,table:"statistics",criteria:{type:"daily-activities",filters:m}},e.next=17,t.find(p);case 17:for(v=e.sent,h={},b=function(e){var t=e.filters.external_object,r=C.default.filter(v,function(e){return C.default.isEqual(e.filters.external_object,t)}),a=C.default.find(n,function(e){return C.default.some(e.external,t)});h[a.id]=R(r,e)},y=!0,g=!1,_=void 0,e.prev=23,j=(0,d.default)(o);!(y=(x=j.next()).done);y=!0)k=x.value,b(k);e.next=31;break;case 27:e.prev=27,e.t0=e.catch(23),g=!0,_=e.t0;case 31:e.prev=31,e.prev=32,!y&&j.return&&j.return();case 34:if(e.prev=34,!g){e.next=37;break}throw _;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return e.abrupt("return",h);case 40:case"end":return e.stop()}},e,this,[[23,27,31,39],[32,,34,38]])}));return function(t,r,n){return e.apply(this,arguments)}}(),E=r("../../common/node_modules/lodash/lodash.js"),C=n(E),w=r("../../common/node_modules/moment/moment.js"),T=n(w),D=r("../../common/src/utils/memoize.js"),M=r("../../common/src/utils/date-utils.js"),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(M),R=(0,D.memoizeWeak)(null,function(e,t,r){var n=(0,T.default)().subtract(1,"month").format("YYYY-MM"),a=(0,T.default)().format("YYYY-MM"),l=s(e),u=i(e,n),o=i(e,a),d=i(e),c=t.details.start_time,f=t.details.end_time;if(0===u.total){c.substr(0,7)<=n||(u.total=void 0)}return{range:{start:c,end:f},last_month:u,this_month:o,to_date:d,daily:l}});t.find=v,t.findDailyActivitiesOfProject=h,t.findDailyActivitiesOfProjects=b,t.findDailyActivitiesOfUser=y,t.findDailyActivitiesOfUsers=g,t.findDailyNotificationsOfUser=_,t.findDailyNotificationsOfUsers=j,t.findDailyActivitiesOfRepo=x,t.findDailyActivitiesOfRepos=k},"../../common/src/utils/date-utils.js":function(e,t,r){"use strict";function n(e){var t=e instanceof u.default?e:(0,u.default)(e),r=t.clone().endOf("day");return"["+t.toISOString()+","+r.toISOString()+"]"}function a(e,t){for(var r=e instanceof u.default?e:(0,u.default)(e),n=t instanceof u.default?t:(0,u.default)(t),a=r.startOf("month"),i=n.endOf("month"),s=[],l=a.clone();l<=i;l.add(1,"month")){var o=l.toISOString(),d=l.clone().endOf("month").toISOString(),c="["+o+","+d+"]";s.push(c)}return s}function i(e,t){for(var r=startTime instanceof u.default?startTime:(0,u.default)(startTime),n=t instanceof u.default?t:(0,u.default)(t),a=r.startOf("day"),i=n.endOf("day"),s=[],l=a.clone();l<=i;l.add(1,"day")){var o=l.format("YYYY-MM-DD");s.push(o)}return s}function s(){return(0,u.default)().utcOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDates=t.getTimeZoneOffset=t.getMonthRanges=t.getDayRange=void 0;var l=r("../../common/node_modules/moment/moment.js"),u=function(e){return e&&e.__esModule?e:{default:e}}(l);t.getDayRange=n,t.getMonthRanges=a,t.getTimeZoneOffset=s,t.getDates=i},"./pages/member-list-page.jsx":function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MemberListPageSync=t.MemberListPage=t.default=void 0;var i=r("../../common/node_modules/babel-runtime/helpers/extends.js"),s=a(i),l=r("../../common/node_modules/babel-runtime/regenerator/index.js"),u=a(l),o=r("../../common/node_modules/babel-runtime/helpers/asyncToGenerator.js"),d=a(o),c=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),f=a(c),m=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),p=a(m),v=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),h=a(v),b=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),y=a(b),g=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),_=a(g),j=r("../../common/node_modules/lodash/lodash.js"),x=a(j),k=r("../../common/node_modules/moment/moment.js"),E=a(k),C=r("../../common/node_modules/react/index.js"),w=a(C),T=r("../../common/node_modules/relaks/index.js"),D=r("../../common/src/utils/memoize.js"),M=r("../../common/src/objects/finders/project-finder.js"),O=n(M),R=r("../../common/src/objects/finders/role-finder.js"),N=n(R),U=r("../../common/src/objects/finders/user-finder.js"),I=n(U),A=r("../../common/src/objects/finders/statistics-finder.js"),P=n(A),L=r("./widgets/push-button.jsx"),S=a(L),Y=r("./widgets/combo-button.jsx"),F=a(Y),W=r("./widgets/sortable-table.jsx"),H=a(W),z=r("./widgets/profile-image.jsx"),q=a(z),$=r("./tooltips/activity-tooltip.jsx"),Z=a($),B=r("./tooltips/role-tooltip.jsx"),G=a(B),J=r("./widgets/action-badge.jsx"),K=a(J),Q=r("./tooltips/modified-time-tooltip.jsx"),V=a(Q),X=r("./widgets/data-loss-warning.jsx"),ee=a(X),te=r("./widgets/unexpected-error.jsx"),re=a(te);r("./pages/member-list-page.scss");var ne=r("../../common/src/data/database.js"),ae=(a(ne),r("../../common/src/routing/route.js")),ie=(a(ae),r("../../common/src/env/environment.js")),se=(a(ie),function(e){function t(){return(0,p.default)(this,t),(0,y.default)(this,(t.__proto__||(0,f.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,h.default)(t,[{key:"renderAsync",value:function(){function e(e){return t.apply(this,arguments)}var t=(0,d.default)(u.default.mark(function e(t){var r,n,a,i,s,l,o,d,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.props,n=r.database,a=r.route,i=r.env,s=r.projectID,l=r.editing,o=n.use({schema:"global",by:this}),d={project:void 0,users:void 0,roles:void 0,database:n,route:a,env:i,editing:l},t.show(w.default.createElement(le,d)),e.next=6,o.start();case 6:return c=e.sent,e.next=9,O.findProject(o,s);case 9:return d.project=e.sent,e.next=12,I.findExistingUsers(o);case 12:return d.users=e.sent,t.show(w.default.createElement(le,d)),e.next=16,N.findRolesOfUsers(o,d.users);case 16:return d.roles=e.sent,t.show(w.default.createElement(le,d)),f=oe(d.users,d.project),e.next=21,P.findDailyActivitiesOfUsers(o,d.project,f);case 21:return d.statistics=e.sent,e.abrupt("return",w.default.createElement(le,d));case 23:case"end":return e.stop()}},e,this)}));return e}()}]),t}(T.AsyncComponent));se.displayName="MemberListPage";var le=function(e){function t(e){var r=this;(0,p.default)(this,t);var n=e.editing,a=(0,y.default)(this,(t.__proto__||(0,f.default)(t)).call(this,e));return a.handleSort=function(e){a.setState({sortColumns:e.columns,sortDirections:e.directions})},a.handleEditClick=function(e){a.setEditability(!0)},a.handleAddClick=function(e){var t=a.props.route,r=x.default.clone(t.params);return r.userID="new",t.push("member-summary-page",r)},a.handleCancelClick=function(e){a.setEditability(!1)},a.handleSaveClick=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,i,s,l,o,d,c,f,m,p,v,h,b;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,i=n.database,s=n.project,l=a.state,o=l.removingUserIDs,d=l.addingUserIDs,c=i.use({schema:"global",by:a}),e.next=5,c.start();case 5:return f=e.sent,m=s.user_ids,p=x.default.union(x.default.difference(m,o),d),v={id:s.id,user_ids:p},e.prev=9,e.next=12,c.saveOne({table:"project"},v);case 12:h=e.sent,a.setState({hasChanges:!1},function(){a.setEditability(!1)}),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(9),b={unexpected:e.t0.message},a.setState({problems:b});case 20:case"end":return e.stop()}},e,r,[[9,16]])}));return function(t){return e.apply(this,arguments)}}(),a.handleApproveClick=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,i,s,l,o,d,c,f,m,p,v;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,i=n.database,s=n.project,l=n.users,o=i.use({schema:"global",by:a}),e.next=4,o.start();case 4:return d=e.sent,c=x.default.filter(l,function(e){if(x.default.includes(e.requested_project_ids,s.id))return!0}),f=x.default.map(c,"id"),m=s.user_ids,p=x.default.union(m,f),v={id:s.id,user_ids:p},e.abrupt("return",o.saveOne({table:"project"},v));case 11:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),a.handleRejectClick=function(){var e=(0,d.default)(u.default.mark(function e(t){var n,i,s,l,o,d,c,f;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,i=n.database,s=n.project,l=n.users,o=i.use({schema:"global",by:a}),e.next=4,o.start();case 4:return d=e.sent,c=x.default.filter(l,function(e){if(x.default.includes(e.requested_project_ids,s.id))return!0}),f=x.default.map(c,function(e){return{id:e.id,requested_project_ids:x.default.without(e.requested_project_ids,s.id)}}),e.abrupt("return",o.save({table:"user"},f));case 8:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),a.handleRowClick=function(e){var t=a.props.project,r=a.state,n=r.addingUserIDs,i=r.removingUserIDs,s=parseInt(e.currentTarget.getAttribute("data-user-id"));x.default.includes(t.user_ids,s)?i=x.default.includes(i,s)?x.default.without(i,s):x.default.concat(i,s):n=x.default.includes(n,s)?x.default.without(n,s):x.default.concat(n,s);var l=!x.default.isEmpty(n)||!x.default.isEmpty(i);a.setState({addingUserIDs:n,removingUserIDs:i,hasChanges:l})},a.state={sortColumns:["name"],sortDirections:["asc"],removingUserIDs:[],addingUserIDs:[],hasChanges:!1,renderingFullList:n,problems:{}},a}return(0,_.default)(t,e),(0,h.default)(t,[{key:"setEditability",value:function(e){var t=this.props.route,r=x.default.clone(t.params);return r.editing=e||void 0,t.replace(t.name,r)}},{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=this.state,a=n.hasChanges,i=n.problems,s=r.locale.t;return w.default.createElement("div",{className:"member-list-page"},this.renderButtons(),w.default.createElement("h2",null,s("member-list-title")),w.default.createElement(re.default,null,i.unexpected),this.renderTable(),w.default.createElement(ee.default,{changes:a,env:r,route:t}))}},{key:"renderButtons",value:function(){var e=this.props,t=e.env,r=e.project,n=e.users,a=e.editing,i=this.state,s=i.hasChanges,l=(i.problems,t.locale.t);if(a)return w.default.createElement("div",{key:"edit",className:"buttons"},w.default.createElement(S.default,{onClick:this.handleCancelClick},l("member-list-cancel"))," ",w.default.createElement(S.default,{className:"emphasis",disabled:!s,onClick:this.handleSaveClick},l("member-list-save")));var u=x.default.get(r,"user_ids"),o=x.default.some(n,function(e){return!x.default.includes(u,e.id)}),d=o?"approve":void 0;x.default.isEmpty(n);return w.default.createElement("div",{key:"view",className:"buttons"},w.default.createElement(F.default,{preselected:d},w.default.createElement("option",{name:"approve",disabled:!o,onClick:this.handleApproveClick},l("member-list-approve-all")),w.default.createElement("option",{name:"reject",disabled:!o,onClick:this.handleRejectClick},l("member-list-reject-all")),w.default.createElement("option",{name:"add",separator:!0,onClick:this.handleAddClick},l("member-list-add")))," ",w.default.createElement(S.default,{className:"emphasis",onClick:this.handleEditClick},l("member-list-edit")))}},{key:"renderTable",value:function(){var e=this.props,t=e.env,r=e.editing,n=this.state,a=n.renderingFullList,i=n.sortColumns,s=n.sortDirections,l=(t.locale.t,{sortColumns:i,sortDirections:s,onSort:this.handleSort});return a&&(l.expandable=!0,l.selectable=!0,l.expanded=r),w.default.createElement(H.default,l,w.default.createElement("thead",null,this.renderHeadings()),w.default.createElement("tbody",{ref:"tbody"},this.renderRows()))}},{key:"renderHeadings",value:function(){return w.default.createElement("tr",null,this.renderNameColumn(),this.renderTypeColumn(),this.renderRolesColumn(),this.renderDateRangeColumn(),this.renderLastMonthColumn(),this.renderThisMonthColumn(),this.renderToDateColumn(),this.renderModifiedTimeColumn())}},{key:"renderRows",value:function(){var e=this,t=this.props,r=t.env,n=t.project,a=t.users,i=t.roles,s=t.statistics,l=this.state,u=l.renderingFullList,o=l.sortColumns,d=l.sortDirections;return u||(a=oe(a,n)),a=ue(a,i,s,r,o,d),x.default.map(a,function(t){return e.renderRow(t)})}},{key:"renderRow",value:function(e){var t=this.props,r=t.env,n=t.project,a=this.state,i=a.renderingFullList,l=a.removingUserIDs,u=a.addingUserIDs,o=r.locale.t,d=[],c=void 0,f=void 0,m=x.default.includes(n.user_ids,e.id),p=x.default.includes(e.requested_project_ids,n.id);m||(p?(d.push("pending"),c=o("member-list-status-pending")):(d.push("disabled"),c=o("member-list-status-non-member"))),i&&((m||p)&&d.push("fixed"),m?x.default.includes(l,e.id)||d.push("selected"):x.default.includes(u,e.id)&&d.push("selected"),f=this.handleRowClick);var v={className:d.join(" "),"data-user-id":e.id,onClick:f,title:c};return w.default.createElement("tr",(0,s.default)({key:e.id},v),this.renderNameColumn(e),this.renderTypeColumn(e),this.renderRolesColumn(e),this.renderDateRangeColumn(e),this.renderLastMonthColumn(e),this.renderThisMonthColumn(e),this.renderToDateColumn(e),this.renderModifiedTimeColumn(e))}},{key:"renderNameColumn",value:function(e){var t=this.props,r=t.env,n=t.project,a=t.route,i=this.state,s=i.renderingFullList,l=i.removingUserIDs,u=i.addingUserIDs,o=r.locale,d=o.t,c=o.p;if(e){var f=c(e.details.name),m=void 0,p=void 0;if(s){var v=x.default.get(n,"user_ids",[]),h=x.default.includes(v,e.id),b=void 0;b=h?!x.default.includes(l,e.id):x.default.includes(u,e.id),h!==b&&(p=b?w.default.createElement(K.default,{type:"add",env:r}):w.default.createElement(K.default,{type:"remove",env:r}))}else{var y=x.default.clone(a.params);y.userID=e.id,m=a.find("member-summary-page",y)}var g=w.default.createElement(q.default,{user:e,env:r});return w.default.createElement("td",null,w.default.createElement("a",{href:m},g," ",f),p)}return w.default.createElement(W.TH,{id:"name"},d("table-heading-name"))}},{key:"renderTypeColumn",value:function(e){var t=this.props.env,r=t.locale.t;return t.isWiderThan("narrow")?e?w.default.createElement("td",null,r("user-list-type-"+e.type)):w.default.createElement(W.TH,{id:"type"},r("table-heading-type")):null}},{key:"renderRolesColumn",value:function(e){var t=this.props,r=t.env,n=t.route,a=t.roles,i=this.state.renderingFullList,s=r.locale.t;if(!r.isWiderThan("standard"))return null;if(e){var l={roles:de(a,e),disabled:i,route:n,env:r};return w.default.createElement("td",null,w.default.createElement(G.default,l))}return w.default.createElement(W.TH,{id:"roles"},s("table-heading-roles"))}},{key:"renderEmailColumn",value:function(e){var t=this.props.env,r=this.state.renderingFullList,n=t.locale.t;if(!t.isWiderThan("wide"))return null;if(e){var a=e.details.email,i=void 0;return!r&&a&&(i="mailto:"+a),w.default.createElement("td",null,w.default.createElement("a",{href:i},a))}return w.default.createElement(W.TH,{id:"email"},n("table-heading-email"))}},{key:"renderDateRangeColumn",value:function(e,t){var r=this.props,n=r.env,a=r.statistics,i=(this.state.renderingFullList,n.locale),s=i.t,l=i.localeCode;if(!n.isWiderThan("ultra-wide"))return null;if(e){var u=void 0,o=void 0,d=x.default.get(a,[e.id,"range"]);return d&&(u=(0,E.default)(d.start).locale(l).format("ll"),o=(0,E.default)(d.end).locale(l).format("ll")),w.default.createElement("td",null,s("date-range-$start-$end",u,o))}return w.default.createElement(W.TH,{id:"range"},s("table-heading-date-range"))}},{key:"renderLastMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=this.state.renderingFullList,i=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var s={statistics:x.default.get(n,[e.id,"last_month"]),disabled:a,env:r};return w.default.createElement("td",null,w.default.createElement(Z.default,s))}return w.default.createElement(W.TH,{id:"last_month"},i("table-heading-last-month"))}},{key:"renderThisMonthColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=this.state.renderingFullList,i=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var s={statistics:x.default.get(n,[e.id,"this_month"]),disabled:a,env:r};return w.default.createElement("td",null,w.default.createElement(Z.default,s))}return w.default.createElement(W.TH,{id:"this_month"},i("table-heading-this-month"))}},{key:"renderToDateColumn",value:function(e){var t=this.props,r=t.env,n=t.statistics,a=this.state.renderingFullList,i=r.locale.t;if(!r.isWiderThan("super-wide"))return null;if(e){var s={statistics:x.default.get(n,[e.id,"to_date"]),disabled:a,env:r};return w.default.createElement("td",null,w.default.createElement(Z.default,s))}return w.default.createElement(W.TH,{id:"to_date"},i("table-heading-to-date"))}},{key:"renderModifiedTimeColumn",value:function(e){var t=this.props,r=t.env,n=(t.statistics,this.state.renderingFullList),a=r.locale.t;if(!r.isWiderThan("standard"))return null;if(e){var i={time:e.mtime,disabled:n,env:r};return w.default.createElement("td",null,w.default.createElement(V.default,i))}return w.default.createElement(W.TH,{id:"mtime"},a("table-heading-last-modified"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.editing,n=t.renderingFullList;return r&&!n?{renderingFullList:!0}:!r&&n?{renderingFullList:!1,removingUserIDs:[],addingUserIDs:[],changes:!1,problems:{}}:null}}]),t}(C.PureComponent);le.displayName="MemberListPageSync";var ue=(0,D.memoizeWeak)(null,function(e,t,r,n,a,i){var s=n.locale.p;return a=x.default.map(a,function(e){switch(e){case"name":return function(e){return s(e.details.name)};case"range":return function(e){return x.default.get(r,[e.id,"range","start"],"")};case"last_month":return function(e){return x.default.get(r,[e.id,"last_month","total"],0)};case"this_month":return function(e){return x.default.get(r,[e.id,"this_month","total"],0)};case"to_date":return function(e){return x.default.get(r,[e.id,"to_date","total"],0)};default:return e}}),x.default.orderBy(e,a,i)}),oe=(0,D.memoizeWeak)(null,function(e,t){if(t){var r=x.default.keyBy(e,"id"),n=x.default.filter(x.default.map(t.user_ids,function(e){return r[e]})),a=x.default.filter(e,function(e){return x.default.includes(e.requested_project_ids,t.id)});return x.default.union(n,a)}}),de=(0,D.memoizeWeak)(null,function(e,t){var r=x.default.keyBy(e,"id");return x.default.filter(x.default.map(t.role_ids,function(e){return r[e]}))});t.default=se,t.MemberListPage=se,t.MemberListPageSync=le},"./pages/member-list-page.scss":function(e,t){},"./tooltips/activity-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=n(s),u=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(u),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=(n(h),r("../../common/node_modules/react/index.js")),y=n(b),g=r("../../common/src/env/environment.js"),_=(n(g),r("../../common/src/objects/types/story-types.js")),j=r("./widgets/tooltip.jsx"),x=n(j);r("./tooltips/activity-tooltip.scss");var k=function(e){function t(){return(0,o.default)(this,t),(0,m.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.env,r=e.statistics,n=e.disabled,a=t.locale.t;if(!r)return null;if(0===r.total&&r.dirty)return null;var s=a("activity-tooltip-$count",r.total);void 0===r.total&&(s="-");var l=[],u=!0,o=!1,d=void 0;try{for(var c,f=(0,i.default)(_.StoryTypes);!(u=(c=f.next()).done);u=!0){var m=c.value,p=r[m];if(p){var v=_.StoryIcons[m];l.push(y.default.createElement("div",{className:"item",key:m},y.default.createElement(v,{className:"icon"})," ",a("activity-tooltip-$count-"+m,p)))}}}catch(e){o=!0,d=e}finally{try{!u&&f.return&&f.return()}finally{if(o)throw d}}return y.default.createElement(x.default,{className:"activity",disabled:n},y.default.createElement("inline",null,s),y.default.createElement("window",null,l))}}]),t}(b.PureComponent);k.displayName="ActivityTooltip",t.default=k,t.ActivityTooltip=k},"./tooltips/activity-tooltip.scss":function(e,t){},"./tooltips/modified-time-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ModifiedTimeTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/get-iterator.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=n(s),u=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),o=n(u),d=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=n(f),p=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),v=n(p),h=r("../../common/node_modules/lodash/lodash.js"),b=n(h),y=r("../../common/node_modules/react/index.js"),g=n(y),_=r("../../common/node_modules/moment/moment.js"),j=n(_),x=r("../../common/src/env/environment.js"),k=(n(x),r("./widgets/tooltip.jsx")),E=n(k),C=function(e){function t(e){(0,o.default)(this,t);var r=(0,m.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return r.state={relativeTime:null,absoluteTime:null},r}return(0,v.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props.disabled,t=this.state,r=t.relativeTime,n=t.absoluteTime;return g.default.createElement(E.default,{disabled:e},g.default.createElement("inline",null,r),g.default.createElement("window",null,n))}},{key:"componentDidMount",value:function(){w.push(this)}},{key:"componentWillUnmount",value:function(){b.default.pull(w,this)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.env,r=e.time,n=t.locale.localeCode,a=void 0;return r&&(a=(0,j.default)(r),a.locale(n)),{relativeTime:a?a.fromNow():null,absoluteTime:a?a.format("lll"):null}}}]),t}(y.PureComponent);C.displayName="ModifiedTimeTooltip";var w=[];setInterval(function(){var e=!0,t=!1,r=void 0;try{for(var n,a=(0,i.default)(w);!(e=(n=a.next()).done);e=!0){n.value.forceUpdate()}}catch(e){t=!0,r=e}finally{try{!e&&a.return&&a.return()}finally{if(t)throw r}}},3e4),t.default=C,t.ModifiedTimeTooltip=C},"./tooltips/role-tooltip.jsx":function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RoleTooltip=t.default=void 0;var a=r("../../common/node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=n(a),s=r("../../common/node_modules/babel-runtime/helpers/classCallCheck.js"),l=n(s),u=r("../../common/node_modules/babel-runtime/helpers/createClass.js"),o=n(u),d=r("../../common/node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),c=n(d),f=r("../../common/node_modules/babel-runtime/helpers/inherits.js"),m=n(f),p=r("../../common/node_modules/lodash/lodash.js"),v=n(p),h=r("../../common/node_modules/react/index.js"),b=n(h),y=r("./widgets/tooltip.jsx"),g=n(y);r("./tooltips/role-tooltip.scss");var _=r("../../common/src/routing/route.js"),j=(n(_),r("../../common/src/env/environment.js")),x=(n(j),function(e){function t(){return(0,l.default)(this,t),(0,c.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,m.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.route,r=e.env,n=e.roles,a=e.disabled,i=r.locale,s=i.t,l=i.p;if(!n)return null;var u="-";if(n.length>0){var o=n[0],d=void 0;a||(d=t.find("role-summary-page",{roleID:o.id}));var c=l(o.details.title)||o.name;u=b.default.createElement("a",{href:d,key:0},c),n=v.default.slice(n,1)}var f=void 0;if(n.length>0){var m=void 0,p=s("role-tooltip-$count-others",n.length);n.length>10&&(n=v.default.slice(n,0,10),m=b.default.createElement("div",{className:"ellipsis"},b.default.createElement("i",{className:"fa fa-ellipsis-v"})));var h=v.default.map(n,function(e,r){var n=t.find("role-summary-page",{roleID:e.id}),a=l(e.details.title)||e.name;return b.default.createElement("div",{className:"item",key:r},b.default.createElement("a",{href:n},a))}),y=t.find("role-list-page");f=s("tooltip-$first-and-$tooltip",u,b.default.createElement(g.default,{className:"role",disabled:a||0===h.length,key:1},b.default.createElement("inline",null,p),b.default.createElement("window",null,h,m,b.default.createElement("div",{className:"bottom"},b.default.createElement("a",{href:y},s("tooltip-more"))))))}else f=u;return b.default.createElement("span",null,f)}}]),t}(h.PureComponent));x.displayName="RoleTooltip",t.default=x,t.RoleTooltip=x},"./tooltips/role-tooltip.scss":function(e,t){}});