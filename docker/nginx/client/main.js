webpackJsonp([6],[,,,,,function(e,t,n){"use strict";function r(e){this.languageCode=e.getLanguageCode(),this.lang=this.languageCode.substr(0,2),this.directory=e.getDirectory(),this.translate=function(t){return t instanceof Object?e.pick(t):e.translate.apply(e,arguments)},this.pick=function(t,n){return e.pick(t,n)},this.name=function(t,n,r){var i=e.pick(t,r),s=new String(i||"");return s.gender=n,s},this.change=function(t){return e.change(t)}}e.exports=r},function(e,t,n){"use strict";function r(e){this.mode=e.getMode(),this.modes=e.getModes(),this.details=e.getDetails(),this.change=function(t){return e.change(t)},this.isAboveMode=function(e){var t=_.indexOf(this.modes,e);return _.indexOf(this.modes,this.mode)>=t},this.isBelowMode=function(e){return!this.isAboveMode(e)},this.getImageUrl=function(t,n){return e.getImageUrl(t,n)},this.getVideoUrl=function(t,n){return e.getVideoUrl(t)},this.getPosterUrl=function(t,n,r){return e.getPosterUrl(t,n,r)}}e.exports=r},function(e,t,n){"use strict";function r(e,t){this.context=t;var n=this;this.find=function(n){return n=i(t,n),e.find(n)},this.findOne=function(e){return n.find(e).then(function(e){return e.length>0?e[0]:null})},this.save=function(n,r){return n=i(t,n),e.save(n,r)},this.saveOne=function(e,t){return n.save(e,[t]).then(function(e){return e.length>0?e[0]:null})},this.remove=function(n,r){return n=i(t,n),e.remove(n,r)},this.removeOne=function(e,t){return n.remove(e,[t]).then(function(e){return e.length>0?e[0]:null})},this.use=function(){var n={};s.assign(n,t);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return s.each(o,function(e){s.assign(n,e)}),"local"!==n.schema&&(n.server?n.protocol="https:":(n.server=window.location.hostname,n.protocol=window.location.protocol)),new r(e,n)},this.start=function(n){return n=i(t,n),e.start(n)},this.beginAuthorization=function(n){return e.beginAuthorization(t,n)},this.checkAuthorizationStatus=function(){return e.checkAuthorizationStatus(t)},this.submitPassword=function(n,r){return e.submitPassword(t,n,r)},this.endAuthorization=function(){return e.endAuthorization(t)},this.getActivationUrl=function(n){return e.getActivationUrl(t,n)}}function i(e,t){return e?s.assign({},e,t):t}var s=n(4);n(10);e.exports=r},function(e,t,n){"use strict";function r(e){this.url=e.getUrl(),this.path=i.replace(this.url,/[?#].*/,""),this.component=e.getComponent(),this.parameters=e.getParameters(),this.query=e.getQuery(),this.hash=e.getHash();var t=[],n=this;this.change=function(t,r){if("string"!=typeof t)throw new Error("Invalid argument");return n.ask(t,!0).then(function(n){return!!n&&e.change(t,r)})},this.ask=function(e,n){return n?s.reduce(t,function(t,n){try{if(!t)return!1;var r=n(e,!0);return s.resolve(r)}catch(e){return console.error(e),!0}},!0).then(function(e){return e}):i.reduce(t,function(e,t){try{if(!e)return!1;var n=t(!1);if("boolean"!=typeof n)throw new Error("Callback passed to keep() should return a boolean when interactive (2nd argument) is true");return n}catch(e){return console.error(e),!0}},!0)},this.keep=function(e){t.push(e)},this.free=function(e){i.pull(t,e)}}var i=n(4),s=n(10);e.exports=r,r.match=function(e,t){var n=[],r=e.replace(/(:\w+)/g,function(e){return n.push(e),"([^\\/]+)"}),s=new RegExp("^"+r),o=s.exec(t);if(o){var a={};return i.each(n,function(e,t){a[e.substr(1)]=o[t+1]}),a.match=o[0],a}},r.prototype.toString=function(){return this.url}},,,,,,function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if(!e||!t)return!1;for(var n in t){var r=e[n];if(t[n]!==r)return!1}return!0}e.exports={shouldComponentUpdate:function(e,t){return!r(this.props,e)||!r(this.state,t)}}},,,,,function(e,t,n){"use strict";function r(e){this.get=function(t){return e.get(t)},this.queue=function(t){return e.queue(t)},this.find=function(t){return e.find(t)},this.send=function(t){return e.send(t)},this.abort=function(t){return e.abort(t)},this.stream=function(t){return e.stream(t)},this.reattach=function(e){var t=this,n=_.get(e,"details.resources",[]);_.each(n,function(e){var n=_.pick(e,"payload_id","url","poster_url"),r=t.find(n);r&&_.forIn(r,function(t,n){t instanceof Blob&&(e[n]=t)})})},this.prepare=function(e,t){var n=this,r=_.get(e,"details.resources",[]);return i.each(r,function(e){if(!e.payload_id){var r=_.get(t,e.type);return n.queue(e,r).then(function(t){t&&(e.payload_id=t)})}})},this.dispatch=function(e){var t=this,n=_.get(e,"details.resources",[]),r=_.filter(_.map(n,"payload_id"));return i.each(r,function(e){return t.send(e),null})}}var i=n(10);e.exports=r},,function(e,t,n){"use strict";function r(e){if(e.hidden)return null;var t=["push-button"];return e.emphasized&&t.push("emphasized"),i.createElement("button",{className:t.join(" "),disabled:e.disabled,onClick:e.onClick},e.label)}var i=n(1);i.PropTypes;n(743),e.exports=r},function(e,t,n){"use strict";function r(e,t){void 0===t&&(t=null);var n=i(e);return function(){return null!=arguments[0]?n.apply(null,arguments):t}}var i=n(562);e.exports=r},,,,,,,function(e,t,n){"use strict";function r(e){var t=["overlay",e.show?"show":"hide"];return e.className&&t.push(e.className),i.createElement("div",{className:t.join(" "),onClick:e.onClick},i.createElement("div",{className:"background"}),i.createElement("div",{className:"foreground"},e.children))}var i=n(1),s=i.PropTypes,o=n(72);n(756),e.exports=i.createClass({displayName:"exports",display:"OverlayProxy",propTypes:{className:s.string,show:s.bool,onBackgroundClick:s.func},getDefaultProps:function(){return{show:!1}},componentWillMount:function(){this.props.show&&this.show()},render:function(){return null},componentDidUpdate:function(e){e.show!==this.props.show?this.props.show?this.show():this.hide():e.children!==this.props.children&&this.props.show&&this.redraw()},componentWillUnmount:function(){this.hide()},show:function(){var e=this;this.containerNode?this.containerRemovalTimeout&&(clearTimeout(this.containerRemovalTimeout),this.containerRemovalTimeout=0):(this.containerNode=document.createElement("DIV"),document.body.appendChild(this.containerNode));var t={show:!1,onClick:this.handleClick,children:this.props.children};o.render(i.createElement(r,t),this.containerNode),setTimeout(function(){t.show=!0,o.render(i.createElement(r,t),e.containerNode)},10)},redraw:function(){var e={show:!0,onClick:this.handleClick,children:this.props.children};o.render(i.createElement(r,e),this.containerNode)},hide:function(){var e=this;if(this.containerNode){this.containerRemovalTimeout||(this.containerRemovalTimeout=setTimeout(function(){o.unmountComponentAtNode(e.containerNode),document.body.removeChild(e.containerNode),e.containerNode=null,e.containerRemovalTimeout=0},1e3));var t={show:!1,children:this.props.children};o.render(i.createElement(r,t),this.containerNode)}},handleClick:function(e){var t=e.target.className;"foreground"!==t&&"background"!==t||this.props.onBackgroundClick&&this.props.onBackgroundClick(e)}})},,function(e,t,n){"use strict";function r(e){var t,r=["profile-image",e.size];if(e.user){var s=_.get(e.user,"details.resources"),o=_.find(s,{type:"image"});if(o){var c=a[e.size];t=e.theme.getImageUrl(o,{width:c,height:c})}}if(t)return i.createElement("img",{className:r.join(" "),src:t});var l=n(330);return i.createElement(l,{className:r.join(" ")})}var i=n(1),s=i.PropTypes,o=n(6);e.exports=r,n(742),r.propTypes={user:s.object,size:s.oneOf(["small","medium","large"]),theme:s.instanceOf(o)},r.defaultProps={size:"small"};var a={small:24,medium:48,large:96}},function(e,t,n){"use strict";function r(e){if(!this)return new r(e);var t=this,n={};_.forIn(e,function(e,r){var i=function(e){if(!(arguments.length>0))return t[r];t[r]=e};n[r]=i}),this.setters=n,_.forIn(e,function(e,n){t[n]=null})}e.exports=r},,,,,function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(0),a=n(18),c=n(7),l=n(19),u=n(8),d=n(5),p=n(6),h=n(14),m=n(94);n(328),e.exports=a.createClass({displayName:"NewsPage",propTypes:{database:s.instanceOf(c).isRequired,payloads:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired},statics:{parseUrl:function(e){return u.match("//:server/:schema/news/:roles/:date/?",e)||u.match("//:server/:schema/news/:roles/?",e)||u.match("//:server/:schema/news/?",e)||u.match("/:schema/news/:roles/:date/?",e)||u.match("/:schema/news/:roles/?",e)||u.match("/:schema/news/?",e)},getUrl:function(e){var t=e.server,n=e.schema,i=e.roles,s=e.date,o=e.search,a=e.storyId,c="/"+n+"/news/";return t&&(c="//"+t+c),i instanceof Array&&(i=i.join("+")),i&&"all"!==i?c+=i+"/":s&&(c+="all/"),s&&(c+=s+"/"),o&&(o=r.replace(encodeURIComponent(o),/%20/g,"+"),c+="?search="+o),a&&(c+="#story-"+a),c},navigation:{top:{dateSelection:!0,roleSelection:!0,textSearch:!0},bottom:{section:"news"}}},renderAsync:function(e){var t=this,s=this.props.route,a=s.parameters.date,c=r.filter(r.map(r.split(s.parameters.roles,"+"),Number)),l=s.query.search,u=!(!a&&r.isEmpty(c)&&!l),d=s.parameters.server,p=s.parameters.schema,h=this.props.database.use({server:d,schema:p,by:this}),m={stories:null,draftStories:null,pendingStories:null,currentUser:null,showEditors:!u,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(f,m),250),h.start().then(function(e){var t={};return t.id=e,h.findOne({schema:"global",table:"user",criteria:t})}).then(function(t){m.currentUser=t,e.show(i.createElement(f,m))}).then(function(){if(u){var e={};if(a){var i=o(a),s=i.clone().endOf("day"),f=i.toISOString(),v=s.toISOString(),g="["+f+","+v+"]";e.time_range=g}return r.isEmpty(c)||(e.role_ids=c),l?(e.search={lang:t.props.locale.lang,text:l},e.limit=100):e.limit=500,h.find({table:"story",criteria:e})}var e={type:"news",target_user_id:m.currentUser.id,filters:{}};return r.isEmpty(c)||(e.filters.role_ids=c),h.findOne({table:"listing",criteria:e}).then(function(e){if(!e)return[];var t={};return t.id=e.story_ids,h.find({table:"story",criteria:t})}).then(function(e){var i=parseInt(r.replace(t.props.route.hash,/\D/g,""));if(i&&!r.find(e,{id:i})){var s={id:i};return h.findOne({table:"story",criteria:s}).then(function(r){if(r){var s=o(r.ptime).format("YYYY-MM-DD"),a=n(37).getUrl({server:d,schema:p,date:s,storyId:i});return t.props.route.change(a,!0).return([])}return e})}return e})}).then(function(t){m.stories=t,e.show(i.createElement(f,m))}).then(function(){if(!u){var e={published:!1,user_ids:[m.currentUser.id]};return h.find({table:"story",criteria:e})}}).then(function(t){t&&(r.each(t,function(e){m.payloads.reattach(e)}),m.draftStories=t,e.show(i.createElement(f,m)))}).then(function(){if(!u){var e=r.map(m.stories,"id"),t={published:!0,exclude_ids:e,user_ids:[m.currentUser.id]};return h.find({table:"story",criteria:t})}}).then(function(e){return e&&(r.each(e,function(e){m.payloads.reattach(e)}),m.pendingStories=e),i.createElement(f,m)})}});var f=e.exports.Sync=i.createClass({displayName:"NewsPage.Sync",mixins:[h],propTypes:{showEditors:s.bool,stories:s.arrayOf(s.object),draftStories:s.arrayOf(s.object),pendingStories:s.arrayOf(s.object),currentUser:s.object,database:s.instanceOf(c).isRequired,payloads:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired},render:function(){return i.createElement("div",{className:"news-page"},this.renderList())},renderList:function(){var e={showEditors:this.props.showEditors,stories:this.props.stories,draftStories:this.props.draftStories,pendingStories:this.props.pendingStories,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(m,e)}})},function(e,t,n){"use strict";function r(e){return e.hidden?null:a.createElement("label",{className:s(e),onClick:e.disabled?null:e.onClick},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label))}function i(e){if(e.hidden)return null;var t={type:"file",value:"",disabled:e.disabled,multiple:e.multiple,onChange:e.onChange};return a.createElement("label",{className:s(e)},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label),a.createElement("input",t))}function s(e){var t=["header-button"];return e.className&&t.push(e.className),e.highlighted&&t.push("highlighted"),e.disabled&&t.push("disabled"),t.join(" ")}function o(e){var t=[];return e.icon&&t.push("fa","fa-"+e.icon),t.join(" ")}var a=n(1),c=a.PropTypes;e.exports=r,e.exports.File=i,n(738),r.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,onClick:c.func},i.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,multiple:c.bool,onChange:c.func}},,,function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(4),s=n(1);s.PropTypes;n(749),e.exports=s.createClass({displayName:"StorySection",propTypes:{},render:function(){var e=["story-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});if(!n)return null;var o=s.Children.toArray(n.props.children);return i.isEmpty(o)?null:s.createElement("div",r({className:e},n.props),o)}})},,,,,,function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(0),a=n(18),c=n(7),l=n(19),u=n(8),d=n(5),p=n(6),h=n(14),m=n(94);n(328),e.exports=a.createClass({displayName:"PersonPage",propTypes:{database:s.instanceOf(c).isRequired,payloads:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired},statics:{parseUrl:function(e){return u.match("//:server/:schema/people/:role/:user/?",e)||u.match("//:server/:schema/people/:role/:user/:date/?",e)||u.match("/:schema/people/:role/:user/?",e)||u.match("/:schema/people/:role/:user/:date/?",e)},getUrl:function(e){var t=e.server,n=e.schema,i=e.role||"all",s=e.user,o=e.date,a=e.search,c=e.storyId,l="/"+n+"/people/"+i+"/"+s+"/";return t&&(l="//"+t+l),o&&(l+=o+"/"),a&&(a=r.replace(encodeURIComponent(a),/%20/g,"+"),l+="?search="+a),c&&(l+="#story-"+c),l},navigation:{top:{dateSelection:!0,roleSelection:!1,textSearch:!0},bottom:{section:"people"}}},renderAsync:function(e){var t=this,s=this.props.route,a=s.parameters.date,c=parseInt(s.parameters.user),l=s.query.search,u=s.parameters.server,d=s.parameters.schema,p=this.props.database.use({server:u,schema:d,by:this}),h={stories:null,currentUser:null,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(f,h),250),p.start().then(function(e){var t={};return t.id=e,p.findOne({schema:"global",table:"user",criteria:t})}).then(function(t){h.currentUser=t,e.show(i.createElement(f,h))}).then(function(){if(a||l){var e={user_ids:[c]};if(a){var i=o(a),s=i.clone().endOf("day"),m=i.toISOString(),f=s.toISOString(),v="["+m+","+f+"]";e.time_range=v}return l?(e.search={lang:t.props.locale.lang,text:l},e.limit=100):e.limit=500,p.find({table:"story",criteria:e})}var e={type:"news",target_user_id:h.currentUser.id,filters:{user_ids:[c]}};return p.findOne({table:"listing",criteria:e}).then(function(e){if(!e)return[];var t={};return t.id=e.story_ids,p.find({table:"story",criteria:t})}).then(function(e){var i=parseInt(r.replace(t.props.route.hash,/\D/g,""));if(i&&!r.find(e,{id:i})){var s={id:i};return p.findOne({table:"story",criteria:s}).then(function(r){if(r){var s=o(r.ptime).format("YYYY-MM-DD"),a=n(47).getUrl({server:u,schema:d,user:c,date:s,storyId:i});return t.props.route.change(a,!0).return([])}return e})}return e})}).then(function(e){return h.stories=e,i.createElement(f,h)})}});var f=e.exports.Sync=i.createClass({displayName:"PersonPage.Sync",mixins:[h],propTypes:{stories:s.arrayOf(s.object),currentUser:s.object,database:s.instanceOf(c).isRequired,payloads:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired},render:function(){return i.createElement("div",{className:"person-page"},this.renderList())},renderList:function(){var e={stories:this.props.stories,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(m,e)}})},function(e,t,n){"use strict";function r(e){var t="scrollable";return e.className&&(t+=" "+e.className),e=i.clone(e),e.className=t,s.createElement("div",e,e.children)}var i=n(4),s=n(1);e.exports=r,n(746)},,,,,,,,,,function(e,t,n){"use strict";function r(e,t){if(!(t instanceof Blob))return t}var i=n(4),s=n(10),o=n(101);t.fetch=function(e,t,n,a){var c=new XMLHttpRequest,l=new s(function(s,l){var u=i.get(a,"username",null),d=i.get(a,"password",null),p=i.get(a,"contentType",null);if("GET"===(e=i.toUpper(e))&&!i.isEmpty(n)){var h=[];i.forIn(n,function(e,t){t=encodeURIComponent(t),void 0!==(e=encodeURIComponent(e))&&h.push(t+"="+e)}),-1===i.indexOf(t,"?")?t+="?":t+="&",t+=i.join(h,"&"),n=null}"json"===p&&(p="application/json"),"application/json"===p&&i.isObject(n)&&(n=JSON.stringify(n,r)),c.timeout=i.get(a,"timeout"),c.withCredentials=i.get(a,"crossSite",!1),c.responseType=i.get(a,"responseType",""),c.open(e,t,!0,u,d),p&&c.setRequestHeader("Content-Type",p),c.send(n),c.onload=function(e){if(c.status>=400){var t=new o(c.status,c.response);l(t)}else{var n=c.response;s(n)}},c.ontimeout=function(e){l(new Error("Request timed out"))},c.onerror=function(e){l(new Error(e.message))},c.onabort=function(e){l(new Error("Transfer aborted"))};var m=i.get(a,"onDownloadProgress"),f=i.get(a,"onUploadProgress");c.onprogress=function(e){m&&m(e)},c.upload.onprogress=function(e){f&&f(e)}});return l.cancel=function(){c.abort()},l}},function(e,t,n){"use strict";function r(e){for(var t in p){var n=p[t];if(n.viewPort===e.target)for(var r=0;r<n.components.length;r++){var i=n.components[r];i.adjustVisibility(n.viewPortRect)}}}function i(e){for(var t in p){var n=p[t];if(n.viewPort){var r=n.viewPort.getBoundingClientRect();if(!c(r,n.viewPort)){n.viewPortRect;n.viewPortRect=r;for(var i=0;i<n.components.length;i++){var s=n.components[i];s.containerNode&&(s.actualHeight=s.containerNode.offsetHeight,s.adjustVisibility(n.viewPortRect))}n.heightEstimate=void 0;for(var i=0;i<n.components.length;i++){var s=n.components[i];s.placeholderNode&&(s.insideViewPort=void 0,s.nearViewPort=void 0,s.actualHeight=void 0,s.estimatedHeight=a(t),s.forceUpdate())}}}}}function s(e,t){var n=p[e];if(n||(n=p[e]={viewPort:null,viewPortRect:null,components:[],heightEstimate:void 0}),n.components.push(t),!n.viewPort){var i=t.containerNode||t.placeholderNode;i&&(n.viewPort=l(i),n.viewPort&&(n.viewPort.addEventListener("scroll",r),n.viewPortRect=n.viewPort.getBoundingClientRect()))}}function o(e,t){var n=p[e];n&&(u.pull(n.components,t),0===n.components.length&&(n.viewPort&&n.viewPort.removeEventListener("scroll",r),p=u.omit(p,e)))}function a(e){var t=p[e];if(t){var n=t.heightEstimate;if(void 0===n){for(var r=0,i=0,s=1;i<t.components.length;i++,s++){var o=t.components[i],a=o.actualHeight;void 0!==a&&(r=r*(s-1)/s+a/s)}t.heightEstimate=n=Math.round(r)}return n}}function c(e,t){return e.left===t.left&&e.top===t.top&&e.right===t.right&&e.bottom===t.bottom}function l(e){for(var t=document.body.parentNode,n=e.parentNode;n!==t;n=n.parentNode){var r=getComputedStyle(n);if("auto"===r.overflowY||"scroll"===r.overflowY)return n;if("auto"===r.overflowX||"scroll"===r.overflowX)return n}return null}var u=n(4),d=n(1);d.PropTypes;e.exports=d.createClass({displayName:"OnDemand",propTypes:{initial:d.PropTypes.bool,children:d.PropTypes.element,type:d.PropTypes.string.isRequired,tag:d.PropTypes.string,className:d.PropTypes.string},getDefaultProps:function(){return{initial:!1,tag:"div"}},getInitialState:function(){return this.containerNode=null,this.placeholderNode=null,this.insideViewPort=void 0,this.nearViewPort=void 0,this.actualHeight=void 0,this.heightEstimate=void 0,{}},shouldRender:function(){return!(!this.props.initial||void 0!==this.actualHeight)||this.nearViewPort},render:function(){var e=this.props.tag,t=this.props.className,n=this.props.id;if(this.shouldRender())return this.placeholderNode=null,d.createElement(e,{id:n,className:t,ref:this.setContainerNode},this.props.children);this.containerNode=null;var r=this.actualHeight||this.estimatedHeight;return r?d.createElement(e,{id:n,className:t,ref:this.setPlaceholderNode,style:{height:r}}):null},componentDidUpdate:function(){if(this.containerNode&&(this.actualHeight=this.containerNode.offsetHeight),void 0===this.nearViewPort){var e=this.props.type,t=p[e];this.adjustVisibility(t.viewPortRect)}},componentDidMount:function(){var e=this.props.type;if(s(e,this),this.containerNode?this.actualHeight=this.containerNode.offsetHeight:this.placeholderNode||(this.estimatedHeight=a(e),this.forceUpdate()),void 0===this.nearViewPort){var t=p[e];this.adjustVisibility(t.viewPortRect,!0)}},componentWillUnmount:function(){o(this.props.type,this)},setContainerNode:function(e){this.containerNode=e},setPlaceholderNode:function(e){this.placeholderNode=e},adjustVisibility:function(e,t){if(!e)return!1;var n=this.containerNode||this.placeholderNode;if(!n)return!1;var r=n.getBoundingClientRect(),i=!1,s=e.top,o=e.bottom,a=e.left,c=e.right;r.left<c&&r.right>a&&r.top<o&&r.bottom>s&&(i=!0),this.insideViewPort=i,this.rect=r;var l=!1,s=e.top-100,o=e.bottom+100,a=e.left-100,c=e.right+100;return r.left<c&&r.right>a&&r.top<o&&r.bottom>s&&(l=!0),!(this.nearViewPort===l||(this.nearViewPort=l,!!this.containerNode===l||t&&this.containerNode))&&(this.forceUpdate(),!0)}});var p={};window.addEventListener("resize",i)},function(e,t,n){"use strict";function r(e){var t=l(e.time);return t.isValid()?p-t>432e5?a.createElement(i,{time:t,locale:e.locale}):a.createElement(d,{time:t,locale:e.locale}):null}function i(e){var t=e.time,n=e.locale,r=t.clone().locale(n.languageCode).format("ll");return a.createElement("span",{className:"time"},r)}function s(){p=l(),o.each(h,function(e){e.update()})}var o=n(4),a=n(1),c=a.PropTypes,l=n(0),u=n(5);e.exports=r,r.propTypes={locale:c.instanceOf(u).isRequired,time:c.string};var d=a.createClass({displayName:"RelativeTime",getInitialState:function(){return{text:this.getText(this.props.time)}},getText:function(e){var t=this.props.locale;return e.clone().locale(t.languageCode).fromNow()},update:function(){var e=this.getText(this.props.time);e!==this.state.text&&this.setState({text:e})},componentWillReceiveProps:function(e){var t=this.getText(e.time);t!==this.state.text&&this.setState({text:t})},render:function(){return a.createElement("span",{className:"time"},this.state.text)},componentDidMount:function(){h.push(this)},componentWillUnmount:function(){o.pull(h,this)}}),p=l(),h=[];setInterval(s,3e4)},,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){if(e.hidden)return null;var t={id:e.id,href:e.url,target:e.target,className:i(e),onClick:e.disabled?null:e.onClick};return o.createElement("a",t,o.createElement("i",{className:s(e)}),o.createElement("span",{className:"label"},e.label))}function i(e){var t=["option-button"];return e.className&&t.push(e.className),e.selected&&t.push("selected"),e.disabled&&t.push("disabled"),t.join(" ")}function s(e){var t=["fa"];return e.icon?t.push("fa-"+e.icon):e.selected?t.push("fa-check-circle"):t.push("fa-circle-o"),t.join(" ")}var o=n(1),a=o.PropTypes;e.exports=r,n(741),r.propTypes={label:a.node,id:a.string,icon:a.string,url:a.string,target:a.string,hidden:a.bool,selected:a.bool,disabled:a.bool,onClick:a.func}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(4),s=n(1);s.PropTypes;n(748),e.exports=s.createClass({displayName:"SettingsSection",propTypes:{},render:function(){var e=["settings-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});return n?s.createElement("div",r({className:e},n.props),n.props.children):null}})},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(4);t.match=function(e,t,n){var s=!0;for(var o in n){var a=n[o];if(t.hasOwnProperty(o)){var c=t[o];if(a instanceof Array){if(c instanceof Array){if(0===i.intersection(a,c).length){s=!1;break}}else if(!i.includes(a,c)){s=!1;break}}else if(c!==a){if("object"===(void 0===c?"undefined":r(c))&&"object"===(void 0===a?"undefined":r(a))){if(!i.isEqual(c,a))return!1}else s=!1;break}}else if("time_range"===o){if(a){var l=a.substr(1,a.length-2).split(","),u=l[0],d=l[1];u<=t.ptime&&t.ptime<d||(s=!1)}}else"exclude_ids"===o&&i.includes(a,t.id)&&(s=!1)}return s}},function(e,t,n){"use strict";function r(e,t,n,s){var o={},c=l.union(l.keys(e),l.keys(t));return l.each(c,function(c){var u,d=e?e[c]:void 0,p=t?t[c]:void 0,h=n?n[c]:void 0;if(l.isEqual(d,p))u=l.cloneDeep(d);else if(l.isEqual(d,h))u=l.cloneDeep(p);else if(l.isEqual(p,h))u=l.cloneDeep(d);else{var m=s?s[c]:void 0;u=a(d)&&a(p)?r(d,p,h,m):"string"==typeof d||"string"==typeof p?i(d,p,h):"function"==typeof m?m(d,p,h):p}void 0!==u&&(o[c]=u)}),o}function i(e,t,n){"string"!=typeof e&&(e=""),"string"!=typeof t&&(t=""),"string"!=typeof n&&(n="");for(var r=u.diffSentences(e,t),i=s(n,t),a=[],c=0;c<r.length;c++){var l=r[c];if(l.removed){var e=l.value,t="";r[c+1]&&r[c+1].added&&(t=r[c+1].value,c++),a.push({a:e,b:t})}else if(l.added){var e="",t=l.value;a.push({a:e,b:t})}else a.push(l.value)}for(var d=0,p=0,h=[],c=0;c<a.length;c++){var m=a[c];"string"==typeof m?(h.push(m),d+=m.length,p+=m.length):(o(p,m.b.length,i)?h.push(m.a):h.push(m.b),d+=m.a.length,p+=m.b.length)}return h.join("")}function s(e,t){for(var n=[],r=u.diffSentences(e,t),i=0,s=0,o=0;o<r.length;o++){var a=r[o],c=a.value.length;a.removed?s+=c:a.added?i+=c:(n.push({index:i,length:c}),s+=c,i+=c)}return n}function o(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(i.index<=e&&e+t<=i.index+i.length)return!0}return!1}function a(e){return"object"===(void 0===e?"undefined":c(e))&&e.constructor===Object}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(4),u=n(477);t.mergeObjects=r,t.mergeStrings=i},function(e,t,n){"use strict";(function(e){function r(e){return e?c.filter(u,{kind:e}):u}function i(e){return r(e).length>0}function s(e,t){"change"===e&&d.push(t)}function o(e,t){"change"===e&&(d=c.pull(d,t))}function a(){return l.try(function(){return navigator.mediaDevices.enumerateDevices()}).then(function(t){u=t,c.each(d,function(t){t.call(e,{type:"change",target:e})})}).catch(function(e){})}var c=n(4),l=n(10);t.getDevices=r,t.hasDevice=i,t.addEventListener=s,t.removeEventListener=o;var u=[],d=[];a().then(function(){navigator.mediaDevices.addEventListener("devicechange",a)})}).call(t,n(92)(e))},,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=(n(18),n(7)),o=n(8),a=n(5),c=n(6),l=n(29),u=n(21),d=n(48),p=n(360);n(695),e.exports=r.createClass({displayName:"UserSelectionDialogBox",propTypes:{show:i.bool,selection:i.arrayOf(i.number).isRequired,disabled:i.arrayOf(i.number),database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onSelect:i.func,onCancel:i.func},getInitialState:function(){return{selection:this.props.selection}},componentWillReceiveProps:function(e){this.props.selection!==e.selection&&this.setState({selection:e.selection})},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return r.createElement(l,e,r.createElement("div",{className:"user-selection-dialog-box"},this.renderList(),this.renderButtons()))},renderList:function(){var e={selection:this.state.selection,disabled:this.props.disabled,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleListSelect};return r.createElement(d,null,r.createElement(p,e))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("selection-cancel"),onClick:this.handleCancelClick},n={label:e("selection-ok"),onClick:this.handleOKClick,emphasized:!0};return r.createElement("div",{className:"buttons"},r.createElement(u,t),r.createElement(u,n))},handleListSelect:function(e){var t=e.selection;_.isEqual(t,this.props.selection)&&(t=this.props.selection),this.setState({selection:t})},handleOKClick:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,selection:this.state.selection})},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})}})},function(e,t,n){"use strict";function r(e){var t=i.flatten(i.map(e,"user_ids"));return i.uniq(t)}var i=n(4),s=(n(10),n(1)),o=s.PropTypes,a=n(18),c=n(22),l=n(7),u=n(19),d=n(8),p=n(5),h=n(6),m=n(14),f=n(59),v=n(143),g=n(138);n(711),e.exports=a.createClass({displayName:"StoryList",propTypes:{showEditors:o.bool,stories:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),pendingStories:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(d).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(h).isRequired},getDefaultProps:function(){return{showEditors:!1}},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,o=t.parameters.schema,a=this.props.database.use({server:n,schema:o,by:this}),c=y(this.props.currentUser),l={authors:c,draftAuthors:c,pendingAuthors:c,reactions:null,respondents:null,recommendations:null,recipients:null,repos:null,showEditors:this.props.showEditors,stories:this.props.stories,draftStories:this.props.draftStories,pendingStories:this.props.pendingStories,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(s.createElement(b,l),250),a.start().then(function(e){var t={id:r(l.stories)};return a.find({schema:"global",table:"user",criteria:t})}).then(function(t){l.authors=t,e.show(s.createElement(b,l))}).then(function(){var e={story_id:i.map(l.stories,"id")};return a.find({table:"reaction",criteria:e})}).then(function(t){l.reactions=t,e.show(s.createElement(b,l))}).then(function(){var e={id:i.uniq(i.map(l.reactions,"user_id"))};return a.find({schema:"global",table:"user",criteria:e})}).then(function(t){l.respondents=t,e.show(s.createElement(b,l))}).then(function(){if(l.draftStories){var e=r(l.draftStories),t=i.difference(e,[l.currentUser.id]);if(t.length>0){var n={id:i.union(t,[l.currentUser.id])};return a.find({schema:"global",table:"user",criteria:n})}}}).then(function(t){t&&(l.draftAuthors=t,e.show(s.createElement(b,l)))}).then(function(){if(l.pendingStories){var e=r(l.pendingStories);if(i.difference(e,[l.currentUser.id]).length>0){var t={id:e};return a.find({schema:"global",table:"user",criteria:t})}}}).then(function(t){t&&(l.pendingAuthors=t,e.show(s.createElement(b,l)))}).then(function(){if(l.currentUser){var e={story_id:i.map(l.stories,"id"),user_ids:[l.currentUser.id]};return a.find({table:"bookmark",criteria:e})}}).then(function(e){return l.recommendations=e,s.createElement(b,l)}).then(function(){if(l.recommendations){var e={id:i.map(l.recommendations,"target_user_id")};return a.find({schema:"global",table:"user",criteria:e})}}).then(function(e){l.recipients=e}).then(function(){var e=i.uniq(i.filter(i.map(l.stories,"repo_id")));if(!i.isEmpty(e)){var t={id:e};return a.find({schema:"global",table:"repo",criteria:t})}}).then(function(e){return l.repos=e,s.createElement(b,l)})}});var b=e.exports.Sync=s.createClass({displayName:"StoryList.Sync",mixins:[m],propTypes:{stories:o.arrayOf(o.object),authors:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),draftAuthors:o.arrayOf(o.object),pendingStories:o.arrayOf(o.object),pendingAuthors:o.arrayOf(o.object),reactions:o.arrayOf(o.object),respondents:o.arrayOf(o.object),recommendations:o.arrayOf(o.object),recipients:o.arrayOf(o.object),currentUser:o.object,repos:o.arrayOf(o.object),database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(d).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(h).isRequired},render:function(){return s.createElement("div",{className:"story-list"},this.renderEditors(),this.renderStories())},renderEditors:function(){var e=this;if(!this.props.showEditors)return null;var t=i.filter(this.props.draftStories,function(e){return!e.published_version_id});return t=E(t,this.props.currentUser),i.find(t,function(t){if(t.user_ids[0]===e.props.currentUser.id)return!0})||(t=i.concat(null,t)),i.map(t,this.renderEditor)},renderEditor:function(e,t){var n=0===t?0:e.id,r=w(this.props.draftAuthors,e),i=R(this.props.recommendations,e),o=N(this.props.recipients,i);e||(r=y(this.props.currentUser));var a={story:e,authors:r,recommendations:i,recipients:o,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,key:n};return s.createElement(g,a)},renderStories:function(){var e=k(this.props.stories,this.props.pendingStories);return i.map(e,this.renderStory)},renderStory:function(e,t){var n=i.find(this.props.draftStories,{published_version_id:e.id});if(n)return this.renderEditor(n);var r=C(this.props.reactions,e),o=w(this.props.authors,e),a=S(this.props.respondents,r),c=R(this.props.recommendations,e),l=N(this.props.recipients,c),u=O(this.props.repos,e),d={story:e,reactions:r,authors:o,respondents:a,recommendations:c,recipients:l,repo:u,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,pending:i.includes(this.props.pendingStories,e),key:e.id},p="story-"+e.id;return s.createElement(f,{key:e.id,id:p,type:"stories",initial:t<10},s.createElement(v,d))}}),y=c(function(e){return[e]}),k=c(function(e,t){return i.isEmpty(t)||(e=i.slice(e),i.each(t,function(t){t.published_version_id||e.push(t)})),i.orderBy(e,[x],["desc"])}),x=function(e){return e.btime||e.ptime},E=c(function(e,t){var n=function(e){return e.user_ids[0]===t.id};return i.orderBy(e,[n,"id"],["desc","desc"])}),C=c(function(e,t){return t?i.filter(e,{story_id:t.id}):[]}),w=c(function(e,t){return t?i.map(t.user_ids,function(t){return i.find(e,{id:t})}):[]}),S=c(function(e,t){var n=i.uniq(i.map(t,"user_id"));return i.map(n,function(t){return i.find(e,{id:t})})}),R=c(function(e,t){if(t){var n=t.published_version_id||t.id;return i.filter(e,{story_id:n})}return[]}),N=c(function(e,t){return i.filter(e,function(e){return i.some(t,{target_user_id:e.id})})}),O=c(function(e,t){return t&&t.repo_id?i.find(e,{id:t.repo_id}):null})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=n(0),c=n(7),l=n(8),u=n(5),d=n(6),p=n(358);n(716),e.exports=o.createClass({displayName:"NotificationsPage",propTypes:{database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},statics:{parseUrl:function(e){return l.match("//:server/:schema/notifications/:date/?",e)||l.match("//:server/:schema/notifications/?",e)||l.match("/:schema/notifications/:date/?",e)||l.match("/:schema/notifications/?",e)},getUrl:function(e){var t=e.server,n=e.schema,i=e.date,s=e.search,o="/"+n+"/notifications/";return t&&(o="//"+t+o),i&&(o+=i+"/"),s&&(s=r.replace(encodeURIComponent(s),/%20/g,"+"),o+="?search="+s),o},navigation:{top:{dateSelection:!0,roleSelection:!1,textSearch:!0},bottom:{section:"notifications"}}},renderAsync:function(e){var t=this,n=this.props.route,r=n.parameters.date,s=n.parameters.server,o=n.parameters.schema,c=n.query.search,l=this.props.database.use({server:s,schema:o,by:this}),u={currentUser:null,reactions:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(h,u),250),l.start().then(function(e){var t={};return t.id=e,l.findOne({schema:"global",table:"user",criteria:t})}).then(function(t){u.currentUser=t,e.show(i.createElement(h,u))}).then(function(){var e={};if(e.target_user_ids=[u.currentUser.id],r){var n=a(r),i=n.clone().endOf("day"),s=n.toISOString(),o=i.toISOString(),d="["+s+","+o+"]";e.time_range=d}return c?(e.search={lang:t.props.locale.lang,text:c},e.limit=100):e.limit=500,l.find({table:"reaction",criteria:e})}).then(function(e){return u.reactions=e,i.createElement(h,u)})}});var h=e.exports.Sync=i.createClass({displayName:"NotificationsPage.Sync",propTypes:{reactions:s.arrayOf(s.object),currentUser:s.object,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},render:function(){return i.createElement("div",{className:"notifications-page"},this.renderList())},renderList:function(){var e={reactions:this.props.reactions,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(p,e)}})},function(e,t,n){"use strict";var r=n(1);r.PropTypes;n(736),e.exports=r.createClass({displayName:"CornerPopUp",getInitialState:function(){return{open:!1}},render:function(){return r.createElement("span",{ref:"container",className:"corner-pop-up"},this.renderIcon(),this.renderMenu())},renderIcon:function(){var e=["fa"];return this.state.open?e.push("fa-chevron-circle-left"):e.push("fa-chevron-circle-down"),r.createElement("span",{className:"button",onClick:this.handleClick},r.createElement("i",{className:e.join(" ")}))},renderMenu:function(){return this.state.open?r.createElement("div",{className:"menu"},this.props.children):null},componentDidUpdate:function(e,t){!t.open&&this.state.open?document.body.addEventListener("mousedown",this.handleBodyMouseDown):t.open&&!this.state.open&&document.body.removeEventListener("mousedown",this.handleBodyMouseDown)},componentWillUnmount:function(){document.body.removeEventListener("mousedown",this.handleBodyMouseDown)},handleClick:function(e){this.setState({open:!this.state.open})},handleBodyMouseDown:function(e){for(var t=this.refs.container,n=!1,r=e.target;r!==document.body.parentNode;r=r.parentNode)if(r===t){n=!0;break}n||this.setState({open:!1})}})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes;e.exports=i.createClass({displayName:"Link",propTypes:{url:s.string,alwaysAsLink:s.bool},getDefaultProps:function(){return{alwaysAsLink:!0}},getInitialState:function(){return{hasFocus:!1}},render:function(){var e=r.omit(this.props,"url","alwaysAsLink");return this.props.url&&(this.props.alwaysAsLink?e.href=this.props.url:(this.state.hasFocus?e.href=this.props.url:e["data-url"]=this.props.url,void 0===e.tabIndex&&(e.tabIndex=0))),e.onFocus=this.handleFocus,e.onBlur=this.handleBlur,i.createElement("a",e,this.props.children)},handleFocus:function(e){this.setState({hasFocus:!0})},handleBlur:function(e){this.setState({hasFocus:!1})}})},function(e,t,n){"use strict";function r(e){var t=["user"],n={user:e.user,theme:e.theme,size:"small"},r=e.locale.pick,i=r(e.user.details.name);return s.createElement("div",{className:t.join(" ")},s.createElement(p,n),s.createElement("span",{className:"name"},i))}var i=n(4),s=n(1),o=s.PropTypes,a=n(5),c=n(6),l=n(29),u=n(21),d=n(48),p=n(31);n(740),e.exports=s.createClass({displayName:"MultipleUserNames",propTypes:{label:o.string,title:o.string,users:o.arrayOf(o.object).isRequired,popupLimit:o.number,locale:o.instanceOf(a),theme:o.instanceOf(c)},getDefaultProps:function(){return{popupLimit:8}},getInitialState:function(){return{showingPopUp:!1,showingDialogBox:!1,renderingDialogBox:!1}},render:function(){var e=["multiple-user-names"];this.props.className&&e.push(this.props.className);var t={className:e.join(" "),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n={className:"label",onClick:this.handleClick};return s.createElement("span",t,s.createElement("span",n,this.props.label),this.renderPopUp(),this.renderDialogBox())},renderPopUp:function(){return this.state.showingPopUp?s.createElement("div",{className:"popup-container"},s.createElement("div",{className:"popup"},this.renderUserList(this.props.popupLimit))):null},renderDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e={show:this.state.showingDialogBox,onBackgroundClick:this.handleDialogBoxClose},t={label:"OK",emphasized:!0,onClick:this.handleDialogBoxClose};return s.createElement(l,e,s.createElement("div",{className:"multiple-user-names-dialog-box"},s.createElement(d,null,s.createElement("div",{className:"list"},this.renderUserList())),s.createElement("div",{className:"buttons"},s.createElement(u,t))))},renderUserList:function(e){var t=this.props.locale.pick,n=i.sortBy(this.props.users,function(e){return t(e.details.name)});if(n.length>e){var r=this.props.locale.translate,o=i.slice(n,e),a=i.map(o,this.renderUser);return a.push(s.createElement("div",{key:0,className:"more"},r("list-$count-more",n.length-o.length))),a}return i.map(n,this.renderUser)},renderUser:function(e,t){var n={user:e,theme:this.props.theme,key:e.id,locale:this.props.locale};return s.createElement(r,n)},handleMouseEnter:function(e){this.setState({showingPopUp:!0})},handleMouseLeave:function(e){this.setState({showingPopUp:!1})},handleClick:function(e){e.target&&this.setState({showingPopUp:!1,showingDialogBox:!0,renderingDialogBox:!0})},handleDialogBoxClose:function(e){var t=this;this.setState({showingDialogBox:!1},function(){setTimeout(function(){t.setState({renderingDialogBox:!1})},1e3)})}})},function(e,t,n){"use strict";function r(e){var t,n=e.locale.pick,s=e.options,o=b.get(e.story,"type"),a=b.get(e.story,"details.markdown",!1);"survey"!==o&&"task-list"!==o||(t=o);var c=n(e.story.details.text,s.languageCode),l=["story-text"];a||l.push("plain-text"),e.className&&l.push(e.className),t?c=i({text:c,type:t,answers:e.answers,voteCounts:e.voteCounts,markdown:a,story:e.story,theme:e.theme,readOnly:e.readOnly,onItemChange:e.onItemChange}):a&&(c=E.parse(c));var u=b.omit(e,b.keys(r.propTypes));return u.className=l.join(" "),u.lang=s.languageCode||e.locale.languageCode,a?y.createElement("div",u,c):y.createElement("p",u,c)}function i(e){var t=x.extract(e.text);if(e.markdown){var n=p(e.story,e.theme),r=b.map(t,function(e,t){return e instanceof Array?b.map(e,function(e){return n.extractBlocks(e.label)}):n.extractBlocks(e)});b.each(t,function(e,t){var i=r[t];e instanceof Array?b.each(i,function(e){n.processInline(e)}):n.processInline(i)});var i=h(e.story,e.theme),a=b.map(t,function(e,t){var n=r[t];return e instanceof Array?b.map(e,function(e,t){var r=b.first(i.render(n[t]));return r&&r.props&&"p"===r.type&&(r=r.props.children),r}):i.render(n)})}var c="survey"===e.type?"radio":"checkbox",l=e.readOnly,u=l?null:e.onItemChange;return b.map(t,function(t,n){if(t instanceof Array){var r=[];return b.each(t,function(t,i){var d,p="list-"+t.list,h=t.key,m=t.checked;if(e.voteCounts){var d;d=e.markdown?a[n][i]:t.label;var f=e.voteCounts[p],v={key:i,label:d,value:h,tally:f};e.markdown?r.push(y.createElement(o,v)):(r.push(t.before),r.push(y.createElement(o,v)),r.push(t.after))}else{var d;if(d=e.markdown?a[n][i]:t.between+t.label,e.answers){var g=e.answers[p];if(void 0!==g)if("radio"===c)m=h===g;else{var b=g[t.key];void 0!==b&&(m=b)}}var v={key:i,type:c,label:d,name:p,value:h,checked:m,readOnly:l,onChange:u};e.markdown?r.push(y.createElement(s,v)):(r.push(t.before),r.push(y.createElement(s,v)),r.push(t.after))}}),e.markdown?y.createElement("div",{key:n},r):r}return e.markdown?a[n]:t})}function s(e){var t=b.omit(e,"label");return y.createElement("label",{className:"list-item"},y.createElement("input",t),e.label)}function o(e){var t=b.get(e.tally,"total",0),n=b.get(e.tally,["answers",e.value],0),r=Math.round(t>0?n/t*100:0)+"%",i=(e.value-1)%10;return y.createElement("label",{className:"list-item vote-count"},y.createElement("span",{className:"label"},e.label),y.createElement("span",{className:"bar"},y.createElement("span",{className:"filled item-"+i,style:{width:r}}),y.createElement("span",{className:"percent"},r),y.createElement("span",{className:"count"},n+"/"+t)))}function a(e,t){var n=t.lang,r=b.get(e,"details.text");r=b.clone(r)||{};var i=b.get(r,n,"");b.trimEnd(i)&&(i=b.trimEnd(i)+"\n\n");var s=e.type,o=t.translate;i+=b.map(b.range(1,4),function(e){return"[ ] "+o(s+"-item-$number",e)}).join("\n"),r[n]=i,e.details=b.clone(e.details),e.details.text=r}function c(e,t){var n=parseInt(t.name.substr(5)),r=parseInt(t.value),i="radio"===t.type,s=t.checked,o=b.mapValues(e.details.text,function(e){return x.update(e,n,r,s,i)});e.details=b.clone(e.details),e.details.text=o}function l(e,t){var n={};if("survey"===e.type){var r=t.pick,i=r(e.details.text),s=x.extract(i);b.each(s,function(e,t){var r="list-"+(t+1);b.each(e,function(e,t){e.checked&&(n[r]=t+1)})})}return n}function u(e){var t=b.get(e,"details.text");return b.some(t,function(e){var t=x.extract(e);return b.some(t,function(e){return e instanceof Array})})}function d(e){var t=b.get(e,"details.text");return b.some(t,function(e){var t=p(),n=t.extractBlocks(e);return b.some(n,function(e){switch(e.type){case"space":return!1;case"paragraph":case"text_block":var n,r=t.inlineLexer;for(r.start(e.markdown);n=r.captureToken();)switch(n.type){case"url":case"text":case"autolink":case"br":break;default:return!0}break;default:return!0}})})}function p(e,t){var n=new E.BlockLexer,r=new E.InlineLexer({links:n.links,findRefLink:m,story:e,theme:t});return new E.Parser({blockLexer:n,inlineLexer:r})}function h(e,t){return new E.Renderer({renderImage:g})}function m(e,t){var n=this.links[e];if(n)return n;var r=f(this.story,e);return r?v(r,this.theme,t):null}function f(e,t){var n=/^(picture|image|video|audio|website)-(\d+)$/.exec(t);if(n){var r=n[1];"picture"===r&&(r="image");var i=parseInt(n[2]),s=i-1,o=b.get(e,"details.resources"),a=b.get(b.filter(o,{type:r}),s);return a||{type:r}}return null}function v(e,t,n){var r;if(n)switch(e.type){case"image":r=t.getImageUrl(e);break;case"video":case"website":r=t.getPosterUrl(e);break;case"audio":return}else switch(e.type){case"image":r=t.getImageUrl(e);break;case"video":r=t.getVideoUrl(e);break;case"website":r=e.url;break;case"audio":return void(r=t.getAudioUrl(e))}return{href:r,title:void 0}}function g(e){var t=e.href,n=e.title,r=e.text;e.ref;return y.createElement("img",{src:t,title:n,alt:r})}var b=n(4),y=n(1),k=y.PropTypes,x=n(400),E=n(110),C=n(5),w=n(6);e.exports=t=r,t.hasLists=u,t.hasMarkdownFormatting=d,t.addListTemplate=a,t.updateList=c,t.getDefaultAnswers=l,n(750),r.propTypes={story:k.object.isRequired,options:k.object,answers:k.objectOf(k.oneOfType([k.number,k.objectOf(k.bool)])),voteCounts:k.object,readOnly:k.bool,locale:k.instanceOf(C).isRequired,theme:k.instanceOf(w).isRequired,onItemChange:k.func},r.defaultProps={options:{}}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(4),s=n(1);s.PropTypes;n(752),e.exports=s.createClass({displayName:"UserSection",propTypes:{},render:function(){var e=["user-section"];return this.props.className&&e.push(this.props.className),s.createElement("div",{className:e.join(" ")},this.renderPart("header"),this.renderPart("subheader"),this.renderPart("body"),this.renderPart("footer"))},renderPart:function(e){var t=s.Children.toArray(this.props.children),n=i.find(t,{type:e});if(!n)return null;var o=s.Children.toArray(n.props.children);return i.isEmpty(o)?null:s.createElement("div",r({className:e},n.props),o)}})},function(e,t,n){"use strict";function r(e,t){var n;switch(e||(e=500),e){case 400:n="Bad Request";break;case 401:n="Unauthorized";break;case 403:n="Forbidden";break;case 404:n="Not Found";break;case 409:n="Conflict";break;case 410:n="Gone";break;case 415:n="Unsupported Media Type";break;case 500:n="Internal Server Error";break;case 501:n="Not Implemented";break;case 502:n="Bad Gateway";break;case 503:n="Service Unavailable";break;case 504:n="Gateway Timeout"}this.statusCode=e,this.message=n,this.body=t}e.exports=r,r.prototype=Object.create(Error.prototype)},function(e,t,n){"use strict";function r(){this.parts=[],this.closed=!1,this.error=null,this.pullResult=null,this.waitResult=null,this.id=null}function i(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}var s=n(4);e.exports=r,r.prototype.toBlob=function(){var e=s.map(this.parts,"blob");if(e.length>1){var t=e[0].type;return new Blob(e,{type:t})}return 1===e.length?e[0]:new Blob},r.prototype.toJSON=function(){return this.id},r.prototype.push=function(e){this.parts.push({blob:e,sent:!1}),this.pullResult&&(this.pullResult.resolve(e),this.pullResult=null)},r.prototype.close=function(){this.closed=!0,s.find(this.parts,{sent:!1})||(this.pullResult&&(this.pullResult.resolve(null),this.pullResult=null),this.waitResult&&(this.waitResult.resolve(),this.waitResult=null))},r.prototype.pull=function(){var e=s.find(this.parts,{sent:!1});return e?Promise.resolve(e.blob):this.closed?Promise.resolve(null):(this.pullResult||(this.pullResult=i()),this.pullResult.promise)},r.prototype.finalize=function(e){var t=s.find(this.parts,{blob:e});if(t&&(t.sent=!0),this.waitResult){!s.find(this.parts,{sent:!1})&&this.closed&&this.waitResult.resolve()}},r.prototype.abandon=function(e){this.error=e,this.waitResult&&this.waitResult.reject(e)},r.prototype.wait=function(){if(this.closed){if(this.error)return Promise.reject(this.error);if(!s.find(this.parts,{sent:!1}))return Promise.resolve()}return this.waitResult||(this.waitResult=i()),this.waitResult.promise}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t,n){var r=0,i=0,s=Math.min(e,t);return"center"!==n&&n||(e>s?r=Math.floor((e-s)/2):t>s&&(i=Math.floor((t-s)/2))),{left:r,top:i,width:s,height:s}}function i(e){return new a(function(t,n){e.getAsString(t)})}function s(e){if(e){var t=document.createElement("DIV");t.innerHTML=e.replace(/<.*?>/g,""),website.title=t.innerText}}var o=n(4),a=n(10),c=n(1),l=c.PropTypes,u=n(392),d=n(398),p=n(399),h=n(389),m=n(5),f=n(6),v=n(19),g=n(14),b=n(145),y=n(344),k=n(341),x=n(346),E=n(390);n(699),e.exports=c.createClass({displayName:"MediaEditor",mixins:[g],propTypes:{resources:l.arrayOf(l.object),locale:l.instanceOf(m).isRequired,theme:l.instanceOf(f).isRequired,payloads:l.instanceOf(v).isRequired,onChange:l.func.isRequired},getInitialState:function(){return{capturing:null,selectedResourceIndex:0}},capture:function(e){this.setState({capturing:e})},importDataItems:function(e){var t=this,n=o.filter(e,function(e){if("string"===e.kind)return/^text\/(html|uri-list)/.test(e.type)}),c={};return o.each(n,function(e){c[e.type]=i(e)}),a.props(c).then(function(e){var t=e["text/html"],n=e["text/uri-list"];if(n){return/<img\b/i.test(t)?u.loadImage(n).then(function(e){return{type:"image",external_url:n,width:e.naturalWidth,height:e.naturalHeight,clip:r(e.naturalWidth,e.naturalHeight)}}):{type:"website",url:n,title:s(t)}}}).then(function(e){if(e)return t.addResources([e])})},getResourceCount:function(){var e=this.props.resources;return e?e.length:0},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1,t=this.state.selectedResourceIndex;return t>e&&(t=e),t},getResourceImageUrl:function(e){var t,n,r=this.props.theme;switch(e.type){case"image":t=r.getImageUrl(o.omit(e,"clip")),n=e.file;break;case"video":case"audio":case"website":t=r.getPosterUrl(o.omit(e,"clip")),n=e.poster_file}return n&&(n===this.imageBlob?t=this.imageBlobUrl:(this.imageBlobUrl&&URL.revokeObjectURL(this.imageBlobUrl),t=this.imageBlobUrl=URL.createObjectURL(n),this.imageBlob=n)),t},render:function(){return c.createElement("div",{className:"media-editor"},this.renderResource(),this.renderNavigation(),this.renderPhotoDialog(),this.renderAudioDialog(),this.renderVideoDialog())},renderResource:function(e){var t=this.getSelectedResourceIndex(),e=o.get(this.props.resources,t);if(!e)return this.props.children;switch(e.type){case"image":case"video":case"website":return this.renderImageCropper(e);case"audio":return c.createElement("div",{className:"audio-placeholder"},c.createElement("i",{className:"fa fa-microphone"}))}},renderNavigation:function(){var e=this.getSelectedResourceIndex(),t=this.getResourceCount();if(0===t)return null;var n={label:"Shift",icon:"chevron-left",disabled:!(e>0),onClick:this.handleShiftClick},r={label:"Remove",icon:"remove",onClick:this.handleRemoveClick},i={index:e,count:t,hidden:!(t>1),onBackwardClick:this.handleBackwardClick,onForwardClick:this.handleForwardClick};return c.createElement("div",{className:"navigation"},c.createElement("div",{className:"left"},c.createElement(b,n),c.createElement(b,r)),c.createElement("div",{className:"right"},c.createElement(b.Direction,i)))},renderImageCropper:function(e){var t=this.getResourceImageUrl(e);if(!t)return c.createElement("div",null,"Loading");var n={url:t,clippingRect:e.clip,onChange:this.handleClipRectChange,onClip:this.handleClipDefault};return c.createElement(E,n)},renderPhotoDialog:function(){var e={show:"image"===this.state.capturing,locale:this.props.locale,onCapture:this.handlePhotoCapture,onCancel:this.handleCaptureCancel};return c.createElement(y,e)},renderVideoDialog:function(){var e={show:"video"===this.state.capturing,payloads:this.props.payloads,locale:this.props.locale,onCapture:this.handleVideoCapture,onCancel:this.handleCaptureCancel};return c.createElement(x,e)},renderAudioDialog:function(){var e={show:"audio"===this.state.capturing,payloads:this.props.payloads,locale:this.props.locale,onCapture:this.handleAudioCapture,onCancel:this.handleCaptureCancel};return c.createElement(k,e)},componentWillUnmount:function(){this.imageBlobUrl&&URL.revokeObjectURL(this.imageBlobUrl)},triggerChangeEvent:function(e){return this.props.onChange({type:"change",target:this,resources:e})},selectResource:function(e){var t=this;return new a(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedResourceIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},addResources:function(e){var t=this;if(o.isEmpty(e))return a.resolve();var n=this.props.resources||[],r=o.concat(n,e),i=n.length;return this.triggerChangeEvent(r).then(function(){return t.selectResource(i)})},importFiles:function(e){var t=this;e=o.slice(e);var n=[];return a.map(e,function(e,t){var i=n[t]=URL.createObjectURL(e),s=o.last(o.split(e.type,"/"));return/^image\//.test(e.type)?u.loadImage(i).then(function(t){return{type:"image",format:s,file:e,width:t.naturalWidth,height:t.naturalHeight,clip:r(t.naturalWidth,t.naturalHeight)}}):/^video\//.test(e.type)?u.loadVideo(i).then(function(t){return h.capture(t).then(function(n){return{type:"video",format:s,file:e,width:t.videoWidth,height:t.videoHeight,clip:r(t.videoWidth,t.videoHeight),duration:t.duration}})}):/^audio\//.test(e.type)?Media.loadAudio(i).then(function(t){return{type:"audio",format:s,file:e,duration:t.duration}}):/^application\/(x-mswinurl|x-desktop)/.test(e.type)?d.loadText(e).then(function(t){var n=p.parse(t);if(n)return{type:"website",url:n.url,title:n.name||o.replace(e.name,/\.\w+$/,"")}}):void 0}).then(function(e){return t.addResources(o.filter(e))}).finally(function(){o.each(n,function(e){URL.revokeObjectURL(e)})})},handlePhotoCapture:function(e){var t=o.clone(e.image);t.type="image",t.clip=r(image.width,image.height),this.addResources([t]),this.handleCaptureCancel(e)},handleVideoCapture:function(e){var t=o.clone(e.video);t.type="video",t.clip=r(video.width,video.height),this.addResources([t]),this.handleCaptureCancel(e)},handleAudioCapture:function(e){var t=o.clone(e.audio);t.type="audio",this.addResources([t]),this.handleCaptureCancel(e)},handleCaptureCancel:function(e){this.setState({capturing:null})},handleClipRectChange:function(e){var t=o.slice(this.props.resources),n=this.getSelectedResourceIndex();return(t[n]=o.clone(t[n])).clip=e.rect,this.triggerChangeEvent(t)},handleShiftClick:function(e){var t=this,n=this.getSelectedResourceIndex();if(n<1)return 0;var r=o.slice(this.props.resources),i=r[n];return r.splice(n,1),r.splice(n-1,0,i),this.triggerChangeEvent(r).then(function(){return t.selectResource(n-1)})},handleRemoveClick:function(e){var t=this,n=this.getSelectedResourceIndex();if(n<0)return n;var r=o.slice(this.props.resources);return r.splice(n,1),this.triggerChangeEvent(r).then(function(){return n>=r.length?t.selectResource(r.length-1):n})},handleBackwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t-1)},handleForwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t+1)}})},function(e,t,n){"use strict";function r(e){return i.some(e,function(e){if(!e.url&&!e.payload_id)return!0})}var i=n(4),s=n(10),o=n(1),a=o.PropTypes,c=n(22),l=n(76),u=n(7),d=n(19),p=n(8),h=n(5),m=n(6),f=n(14),v=n(353),g=n(352),b=n(354),y=n(351),k=n(96);n(703);e.exports=o.createClass({displayName:"StoryEditor",mixins:[f],propTypes:{story:a.object,authors:a.arrayOf(a.object),recommendations:a.arrayOf(a.object),recipients:a.arrayOf(a.object),currentUser:a.object,database:a.instanceOf(u).isRequired,payloads:a.instanceOf(d).isRequired,route:a.instanceOf(p).isRequired,locale:a.instanceOf(h).isRequired,theme:a.instanceOf(m).isRequired},getInitialState:function(){var e={options:x,draft:null};return this.updateDraft(e,this.props),this.updateOptions(e,this.props),this.updateLeadAuthor(e,this.props),e},componentWillReceiveProps:function(e){var t=i.clone(this.state);this.props.story!==e.story&&this.updateDraft(t,e),this.props.currentUser!==e.currentUser&&this.updateLeadAuthor(t,e),this.props.story===e.story&&this.props.recommendations===e.recommendations&&this.props.locale===e.locale||this.updateOptions(t,e);var n=i.shallowDiff(t,this.state);i.isEmpty(n)||this.setState(n)},updateDraft:function(e,t){if(t.story){var n=this.props.story||E(this.props.currentUser),r=e.draft,i=t.story;r!==n&&r&&(i=l.mergeObjects(r,i,n)),e.draft=i}else e.draft=E(t.currentUser)},updateLeadAuthor:function(e,t){if(!e.story){var n=i.get(t.currentUser,"id");e.draft.user_ids&&e.draft.user_ids[0]===n||(e.draft=i.decouple(e.draft,"user_ids",[]),e.draft.user_ids[0]=n)}},updateOptions:function(e,t){var n=e.options;t.story||(n=x),n=e.options=i.clone(n),n.hidePost=!e.draft.public,n.bookmarkRecipients=i.map(t.recommendations,"target_user_id"),n.supplementalEditor||(n.supplementalEditor=this.chooseSupplementalEditor(e.draft)),n.languageCode||(n.languageCode=this.chooseLanguage(e.draft,t.locale))},chooseSupplementalEditor:function(e){return"survey"===e.type||"task-list"===e.type?"preview":i.get(e,"details.markdown",!1)?"preview":""},chooseLanguage:function(e,t){var n=t.languageCode,r=i.get(e,"details.text");if(!i.isEmpty(r)){var s=i.first(i.keys(r));n.substr(0,2)!==s&&(n=s)}return n},render:function(){return"columns-1"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-1"},this.renderTextEditor(),this.renderSupplementalEditor()):"columns-2"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-2"},o.createElement("div",{className:"column-1"},this.renderTextEditor()),o.createElement("div",{className:"column-2"},this.renderSupplementalEditor())):"columns-3"===this.props.theme.mode?o.createElement("div",{className:"story-view columns-3"},o.createElement("div",{className:"column-1"},this.renderTextEditor()),o.createElement("div",{className:"column-2"},this.renderSupplementalEditor()),o.createElement("div",{className:"column-3"},this.renderOptions())):void 0},renderTextEditor:function(){var e={story:this.state.draft,authors:this.props.authors,options:this.state.options,cornerPopUp:this.renderPopUpMenu("main"),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange,onPublish:this.handlePublish,onCancel:this.handleCancel};return o.createElement(v,e)},renderSupplementalEditor:function(){return"preview"===this.state.options.supplementalEditor?this.renderTextPreview():this.renderMediaEditor()},renderTextPreview:function(){var e={story:this.state.draft,options:this.state.options,cornerPopUp:this.renderPopUpMenu("supplemental"),database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange};return o.createElement(b,e)},renderMediaEditor:function(){var e={story:this.state.draft,cornerPopUp:this.renderPopUpMenu("supplemental"),database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleChange};return o.createElement(g,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:o.createElement(k,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,story:this.state.draft,options:this.state.options,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleOptionsChange};return o.createElement(y,n)},changeDraft:function(e){var t=this;return new s(function(n,r){var s=t.state.options;if(!s.supplementalEditor){var o=t.chooseSupplementalEditor(e);o&&(s=i.decoupleSet(s,"supplementalEditor",o))}t.setState({draft:e,options:s},function(){n(e)})})},changeOptions:function(e){var t=this;return new s(function(n,r){t.setState({options:e},function(){n(e)})})},autosaveStory:function(e,t){var n=this;t?(this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveStory(e)},t),this.autosaveUnloadHandler=function(){n.saveStory(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)):this.saveStory(e)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveStory:function(e){var t=this;this.cancelAutosave();var n=(e.details.resources,this.props.payloads);return n.prepare(e).then(function(){var r=t.props.route,i=r.parameters.server,s=r.parameters.schema,o=t.props.database.use({server:i,schema:s,by:t});return o.start().then(function(){return o.saveOne({table:"story"},e).then(function(e){return n.dispatch(e).return(e)})})})},removeStory:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema;return this.props.database.use({server:n,schema:r,by:this}).removeOne({table:"story"},e)},saveBookmarks:function(e){if(i.isEmpty(e))return s.resolve([]);var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,o=this.props.database.use({server:n,schema:r,by:this});return o.start().then(function(){return o.save({table:"bookmark"},e)})},removeBookmarks:function(e){if(i.isEmpty(e))return s.resolve([]);var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,o=this.props.database.use({server:n,schema:r,by:this});return o.start().then(function(){return o.remove({table:"bookmark"},e)})},sendBookmarks:function(e,t){var n=this,r=this.props.recommendations,s=[];i.each(t,function(t){if(!i.some(r,{target_user_id:t})){var o={story_id:e.published_version_id||e.id,user_ids:[n.props.currentUser.id],target_user_id:t};s.push(o)}});var o=[];return i.each(r,function(e){i.includes(t,e.target_user_id)||o.push(e)}),this.saveBookmarks(s).then(function(e){return n.removeBookmarks(o).then(function(t){return i.concat(e,t)})})},handleChange:function(e){var t=this;return this.changeDraft(e.story).then(function(n){var i;switch(e.path){case"details.resources":r(n.details.resources)&&(i=0);break;case"user_ids":i=0;break;default:i=2e3}return t.autosaveStory(n,i),null})},handlePublish:function(e){var t=this,n=i.clone(this.state.draft),r=this.state.options;if(n.type||(n.type="story"),i.isEmpty(n.role_ids)){var s=i.map(this.props.authors,"role_ids");n.role_ids=i.uniq(i.flatten(s))}return n.public=!r.hidePost,n.published=!0,this.changeDraft(n).then(function(){return t.saveStory(n).then(function(e){return t.sendBookmarks(e,r.bookmarkRecipients).then(function(){var e=E(t.props.currentUser);return t.changeDraft(e)})})})},handleCancel:function(e){var t=this,n=this.state.draft,r=E(this.props.currentUser);return this.changeDraft(r).then(function(){return n.id?t.removeStory(n):n})},handleOptionsChange:function(e){return this.changeOptions(e.options)}});var x={languageCode:"",addIssue:!1,hidePost:!1,bookmarkRecipients:[],supplementalEditor:""},E=c(function(e){return{user_ids:[e.id],details:{},public:!0}},{user_ids:[],details:{},public:!0})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=n(7),c=n(19),l=n(8),u=n(5),d=n(6),p=n(356);n(714),e.exports=o.createClass({displayName:"BookmarksPage",propTypes:{database:s.instanceOf(a).isRequired,payloads:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},statics:{parseUrl:function(e){return l.match("/:schema/bookmarks/?",e)||l.match("/:schema/bookmarks/:roles/?",e)||l.match("//:server/:schema/bookmarks/?",e)||l.match("//:server/:schema/bookmarks/:roles/?",e)},getUrl:function(e){var t=e.server,n=e.schema,r=e.roles,i="/"+n+"/bookmarks/";return t&&(i="//"+t+i),r instanceof Array&&(r=r.join("+")),r&&"all"!==r&&(i+=r+"/"),i},navigation:{top:{dateSelection:!1,roleSelection:!0,textSearch:!1},bottom:{section:"bookmarks"}}},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,s=t.parameters.schema,o=(r.filter(r.map(r.split(t.parameters.roles,"+"),Number)),this.props.database.use({server:n,schema:s,by:this})),a={bookmarks:null,currentUserId:null,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(h,a),250),o.start().then(function(e){var t={};return t.id=e,o.findOne({schema:"global",table:"user",criteria:t})}).then(function(t){a.currentUser=t,e.check()}).then(function(){var e={};return e.target_user_id=r.get(a.currentUser,"id",0),o.find({table:"bookmark",criteria:e})}).then(function(e){return a.bookmarks=e,i.createElement(h,a)})}});var h=e.exports.Sync=i.createClass({displayName:"BookmarksPage.Sync",propTypes:{bookmarks:s.arrayOf(s.object),currentUser:s.object,database:s.instanceOf(a).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},render:function(){return i.createElement("div",{className:"bookmarks-page"},this.renderList())},renderList:function(){var e={bookmarks:this.props.bookmarks,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return i.createElement(p,e)}})},function(e,t,n){"use strict";function r(e,t){if(e instanceof Object)for(var n in e)if(r(e[n],t))return!0;var s=i.split(i.toLower(i.trim(e)),/\s+/);return i.every(t,function(e){return i.some(s,function(t){return i.startsWith(t,e)})})}var i=n(4),s=n(1),o=s.PropTypes,a=n(18),c=n(22),l=n(7),u=n(8),d=n(5),p=n(6),h=n(359);n(717),e.exports=a.createClass({displayName:"PeoplePage",propTypes:{database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired},statics:{parseUrl:function(e){return u.match("//:server/:schema/people/:roles/?",e)||u.match("//:server/:schema/people/?",e)||u.match("/:schema/people/:roles/?",e)||u.match("/:schema/people/?",e)},getUrl:function(e){var t=e.server,n=e.schema,r=e.roles,s=e.search,o="/"+n+"/people/";return t&&(o="//"+t+o),r instanceof Array&&(r=r.join("+")),r&&"all"!==r&&(o+=r+"/"),s&&(s=i.replace(encodeURIComponent(s),/%20/g,"+"),o+="?search="+s),o},navigation:{top:{dateSelection:!1,roleSelection:!0,textSearch:!0},bottom:{section:"people"}}},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,o=t.query.search,a=this.props.database.use({server:n,schema:r,by:this}),c={stories:null,currentUserId:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(s.createElement(m,c),250),a.start().then(function(e){var t={};return t.id=e,a.findOne({schema:"global",table:"user",criteria:t})}).then(function(t){c.currentUser=t,e.check()}).then(function(){var e=i.filter(i.map(i.split(t.parameters.roles,"+"),Number)),n={hidden:!1};return i.isEmpty(e)||(n.role_ids=e),a.find({schema:"global",table:"user",criteria:n})}).then(function(e){return o&&(e=f(e,o)),c.users=e,s.createElement(m,c)})}});var m=e.exports.Sync=s.createClass({displayName:"PeoplePageSync",propTypes:{users:o.arrayOf(o.object),listings:o.arrayOf(o.object),stories:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired},render:function(){return s.createElement("div",{className:"people-page"},this.renderList())},renderList:function(){if(!this.props.currentUser||!this.props.users)return null;var e={users:this.props.users,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(h,e)}}),f=c(function(e,t){var n=i.split(i.toLower(t),/\+/);return i.filter(e,function(e){return!!r(e.details.name,n)||(!!r(e.username,n)||(!!r(e.details.email,n)||void 0))})})},function(e,t,n){"use strict";var r=(n(4),n(1)),i=r.PropTypes,s=n(18),o=n(7),a=n(8),c=n(5),l=n(6),u=n(350),d=n(355),p=n(349),h=n(348);n(718),e.exports=s.createClass({displayName:"SettingsPage",propTypes:{database:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},statics:{parseUrl:function(e){return a.match("/:schema/settings/?",e)||a.match("//:server/:schema/settings/?",e)},getUrl:function(e){var t=e.server,n=e.schema,r="/"+n+"/settings/";return t&&(r="//"+t+r),r},navigation:{top:{},bottom:{section:"settings"}}},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,i=this.props.database.use({server:n,by:this}),s={project:null,currentUser:null,stories:null,reactions:null,users:null,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(r.createElement(m,s),250),i.start().then(function(e){return r.createElement(m,s)})}});var m=e.exports.Sync=r.createClass({displayName:"SettingsPage.Sync",propTypes:{database:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},render:function(){return r.createElement("div",{className:"settings-page"},this.renderProjects(),this.renderUserProfile(),this.renderNotificationPreferences(),this.renderLanguages())},renderProjects:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(u,e)},renderUserProfile:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(d,e)},renderNotificationPreferences:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(p,e)},renderLanguages:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(h,e)}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=(n(58),n(22)),o=n(5),a=n(6),c=(n(29),n(145)),l=n(342),u=n(147);n(723),e.exports=r.createClass({displayName:"MediaView",propTypes:{resources:i.arrayOf(i.object).isRequired,locale:i.instanceOf(o).isRequired,theme:i.instanceOf(a).isRequired},getInitialState:function(){return{selectedIndex:0,renderingDialogBox:!1,showingDialogBox:!1}},getResourceCount:function(){return this.props.resources.length},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1;return _.min([this.state.selectedIndex,e])},selectResource:function(e){var t=this;return new Promise(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},render:function(){return r.createElement("div",{className:"media-view"},this.renderResource(),this.renderNavigation(),this.renderDialogBox())},renderNavigation:function(){var e=this.getResourceCount();if(e<=1)return null;var t=_.min([e-1,this.state.selectedIndex]),n={index:t,count:e,onBackwardClick:this.handleBackwardClick,onForwardClick:this.handleForwardClick};return r.createElement("div",{className:"navigation"},r.createElement("div",{className:"right"},r.createElement(c.Direction,n)))},renderDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e=d(this.props.resources),t=this.getSelectedResourceIndex(),n=_.indexOf(e,this.props.resources[t]),i={show:this.state.showingDialogBox,resources:e,selectedIndex:n,locale:this.props.locale,theme:this.props.theme,onClose:this.handleDialogClose};return r.createElement(l,i)},renderResource:function(){var e=this.props.resources.length,t=_.min([e-1,this.state.selectedIndex]),n=this.props.resources[t];switch(n.type){case"image":return this.renderImage(n);case"video":return this.renderVideo(n);case"audio":return this.renderAudio(n);case"website":return this.renderWebsite(n)}},renderImage:function(e){return r.createElement("div",{className:"image",onClick:this.handleImageClick},this.renderImageElement(e))},renderVideo:function(e){return r.createElement("div",{className:"video",onClick:this.handleVideoClick},this.renderImageElement(e,"poster"),r.createElement("i",{className:"fa fa-play-circle-o icon"}))},renderAudio:function(e){},renderWebsite:function(e){return r.createElement("div",{className:"website"},r.createElement("a",{href:e.url,target:"_blank"},this.renderImageElement(e,"poster"),r.createElement("i",{className:"fa fa-external-link icon"})))},renderImageElement:function(e,t){var n,i=e.clip;n=i?Math.round(512*i.height/i.width):Math.round(512*e.height/e.width);var s,o;return"poster"===t?e.poster_url?s=this.props.theme.getPosterUrl(e,{width:512,height:n}):e.poster_file&&(o=e.poster_file):e.url?s=this.props.theme.getImageUrl(e,{width:512,height:n}):e.file&&(o=e.file),s?r.createElement("img",{src:s,width:512,height:n}):o instanceof Blob?(s=URL.createObjectURL(o),r.createElement(u,{url:s,clippingRect:i})):null},handleBackwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t-1)},handleForwardClick:function(e){var t=this.getSelectedResourceIndex();return this.selectResource(t+1)},handleImageClick:function(e){this.setState({showingDialogBox:!0,renderingDialogBox:!0})},handleVideoClick:function(e){this.setState({showingDialogBox:!0,renderingDialogBox:!0})},handleDialogClose:function(e){var t=this;this.setState({showingDialogBox:!1},function(){setTimeout(function(){t.setState({renderingDialogBox:!1})},1e3)})}});var d=s(function(e){return _.filter(e,function(e){switch(e.type){case"image":case"video":return!0}})})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(19),a=n(8),c=n(5),l=n(6),u=n(14),d=n(369),p=n(368),h=n(370),m=n(96);n(728),e.exports=r.createClass({displayName:"StoryView",mixins:[u],propTypes:{story:i.object.isRequired,authors:i.arrayOf(i.object),reactions:i.arrayOf(i.object),respondents:i.arrayOf(i.object),recommendations:i.arrayOf(i.object),recipients:i.arrayOf(i.object),currentUser:i.object.isRequired,repo:i.object,pending:i.bool,database:i.instanceOf(s).isRequired,payloads:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},getDefaultProps:function(){return{pending:!1}},getInitialState:function(){var e={options:f};return this.updateOptions(e,this.props),e},componentWillReceiveProps:function(e){var t=this,n=_.clone(this.state);this.props.story===e.story&&this.props.recommendations===e.recommendations||this.updateOptions(n,e);var r=_.pickBy(n,function(e,n){return t.state[n]!==e});_.isEmpty(r)||this.setState(r)},updateOptions:function(e,t){var n=e.options=_.clone(e.options);n.hidePost=!t.story.public,n.bookmarkRecipients=_.map(t.recommendations,"target_user_id")},render:function(){return"columns-1"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-1"},this.renderContents(),this.renderComments()):"columns-2"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-2"},r.createElement("div",{className:"column-1"},this.renderContents()),r.createElement("div",{className:"column-2"},this.renderComments())):"columns-3"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-3"},r.createElement("div",{className:"column-1"},this.renderContents()),r.createElement("div",{className:"column-2"},this.renderComments()),r.createElement("div",{className:"column-3"},this.renderOptions())):void 0},renderContents:function(){var e={story:this.props.story,authors:this.props.authors,currentUser:this.props.currentUser,reactions:this.props.reactions,repo:this.props.repo,pending:this.props.pending,cornerPopUp:this.renderPopUpMenu("main"),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleStoryChange,onReaction:this.handleStoryReaction};return r.createElement(d,e)},renderComments:function(){var e={story:this.props.story,reactions:this.props.reactions,respondents:this.props.respondents,repo:this.props.repo,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(p,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:r.createElement(m,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,story:this.props.story,currentUser:this.props.currentUser,options:this.state.options,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onChange:this.handleOptionsChange};return r.createElement(h,n)},autosaveStory:function(e,t){var n=this;this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveStory(e)},t),this.autosaveUnloadHandler=function(){n.saveStory(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveStory:function(e){this.cancelAutosave();var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this});return i.start().then(function(){return i.saveOne({table:"story"},e)})},removeStory:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema;return this.props.database.use({server:n,schema:r,by:this}).removeOne({table:"story"},e)},saveReaction:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this});return i.start().then(function(){return i.saveOne({table:"reaction"},e)})},saveBookmarks:function(e){if(_.isEmpty(e))return Promise.resolve([]);var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this});return i.start().then(function(){return i.save({table:"bookmark"},e)})},removeBookmarks:function(e){if(_.isEmpty(e))return Promise.resolve([]);var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this});return i.start().then(function(){return i.remove({table:"bookmark"},e)})},sendBookmarks:function(e,t){var n=this,r=this.props.recommendations,i=[];_.each(t,function(t){if(!_.some(r,{target_user_id:t})){var s={story_id:e.published_version_id||e.id,user_ids:[n.props.currentUser.id],target_user_id:t};i.push(s)}});var s=[];return _.each(r,function(e){_.includes(t,e.target_user_id)||s.push(e)}),this.saveBookmarks(i).then(function(e){return n.removeBookmarks(s).then(function(t){return _.concat(e,t)})})},setOptions:function(e){var t=this,n=this.state.options;this.setState({options:e},function(){if(e.editPost&&!n.editPost){var r=_.omit(t.props.story,"id","published","ptime");r.published_version_id=t.props.story.id,t.saveStory(r)}if(e.removePost&&!n.removePost&&t.removeStory(t.props.story),e.bumpPost&&!n.bumpPost){var i=_.clone(t.props.story);i.bump=!0,t.saveStory(i)}if(e.hidePost!==n.hidePost){var i=_.clone(t.props.story);i.public=!e.hidePost,t.saveStory(i)}_.isEqual(e.bookmarkRecipients,n.bookmarkRecipients)||t.sendBookmarks(t.props.story,e.bookmarkRecipients)})},handleStoryChange:function(e){this.autosaveStory(e.story,1e3)},handleStoryReaction:function(e){this.saveReaction(e.reaction)},handleOptionsChange:function(e){this.setOptions(e.options)}});var f={addIssue:!1,hidePost:!1,editPost:!1,bookmarkRecipients:[]}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1),s=i.PropTypes;n(737),e.exports=i.createClass({displayName:"DropZone",propTypes:{onDrop:s.func},getInitialState:function(){return{active:!1}},render:function(){return i.createElement("div",{className:"drop-zone",onDragEnter:this.handleDragEnter},this.props.children,this.renderOverlay())},renderOverlay:function(){if(!this.state.active)return null;var e={onDragLeave:this.handleDragLeave,onDragOver:this.handleDragOver,onDrop:this.handleDrop};return i.createElement("div",r({className:"overlay"},e))},handleDragEnter:function(e){this.setState({active:!0})},handleDragLeave:function(e){this.setState({active:!1})},handleDragOver:function(e){e.preventDefault()},handleDrop:function(e){return e.preventDefault(),this.state.active&&this.props.onDrop&&this.props.onDrop({type:"drop",files:e.dataTransfer.files,items:e.dataTransfer.items}),this.setState({active:!1}),null}})},function(e,t,n){"use strict";function r(e){return e.hidden?null:a.createElement("label",{className:s(e),onClick:e.disabled?null:e.onClick},a.createElement("i",{className:o(e)}),a.createElement("span",{className:"label"},e.label))}function i(e){if(e.hidden)return null;var t=e.index+1+" / "+e.count;return a.createElement("div",{className:"media-direction"},a.createElement("label",{className:"backward-button",onClick:e.onBackwardClick},a.createElement("i",{className:"fa fa-caret-left"})),a.createElement("span",{className:"position"},t),a.createElement("label",{className:"forward-button",onClick:e.onForwardClick},a.createElement("i",{className:"fa fa-caret-right"})))}function s(e){var t=["media-button"];return e.className&&t.push(e.className),e.disabled&&t.push("disabled"),t.join(" ")}function o(e){var t=[];return e.icon&&t.push("fa","fa-"+e.icon),t.join(" ")}var a=n(1),c=a.PropTypes;e.exports=r,e.exports.Direction=i,n(739),i.propTypes={index:c.number,count:c.number,hidden:c.bool,onBackwardClick:c.func,onForwardClick:c.func},i.propTypes={label:c.string,icon:c.string,hidden:c.bool,highlighted:c.bool,disabled:c.bool,onChange:c.func}},function(e,t,n){"use strict";e.exports=t=["push","merge","issue","milestone","wiki","member","repo","story","survey","task-list"],t.icons={push:n(766),merge:n(759),issue:n(329),"issue.opened":n(329),"issue.closed":n(760),"issue.reopened":n(761),milestone:n(764),wiki:n(758),member:n(330),repo:n(767),story:n(765),survey:n(763),"task-list":n(762)},t.editable=["story","task-list","survey"],t.trackable=["story"],t.git=["push","merge","issue","milestone","wiki","member","repo"]},function(e,t,n){"use strict";function r(e){return new u(function(t,n){var r=document.createElement("IMG");r.src=e,r.onload=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function i(e){var t={responseType:"arraybuffer"};return h.fetch("GET",e,null,t).then(function(e){return new Uint8Array(e)})}function s(e){var t=c(e,6),n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=n*s-r*i;return[s/l,-r/l,-i/l,n/l,(i*a-s*o)/l,-(n*a-r*o)/l]}function o(e,t){var n=c(e,6),r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],u=c(t,2),d=u[0],p=u[1];return[r*d+s*p+a,i*d+o*p+l]}function a(e,t){var n=[t.left,t.top],r=[t.left+t.width,t.top+t.height];return n=o(e,n),r=o(e,r),{width:Math.abs(r[0]-n[0]),height:Math.abs(r[1]-n[1]),left:Math.min(r[0],n[0]),top:Math.min(r[1],n[1])}}var c=function(){function e(e,t){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,s=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(10),d=n(1),p=d.PropTypes,h=n(58),m=n(391),f=n(32);e.exports=d.createClass({displayName:"ImageView",propTypes:{url:p.string,clippingRect:p.object,onLoad:p.func},getInitialState:function(){return this.components=f({canvas:HTMLCanvasElement}),{}},componentWillMount:function(){this.load(this.props.url)},componentWillReceiveProps:function(e){this.props.url!==e.url&&this.load(e.url),this.clippingRect!==e.clippingRect&&this.image&&this.drawImage(e.clippingRect)},render:function(){var e=this.components.setters,t=_.omit(this.props,"onLoad","url","clippingRect");return d.createElement("canvas",l({ref:e.canvas},t))},componentDidMount:function(){this.image&&this.redrawNeeded&&this.drawImage(this.props.clippingRect)},triggerLoadEvent:function(){this.props.onLoad&&this.props.onLoad({type:"load",target:this})},load:function(e){var t=this;return e?u.join(r(e),i(e),function(e,n){var r=m.getOrientation(n)||1;t.image=e,t.orientation=r,r<5?(t.naturalWidth=e.naturalWidth,t.naturalHeight=e.naturalHeight):(t.naturalWidth=e.naturalHeight,t.naturalHeight=e.naturalWidth);var i=t.props.clippingRect;i||(i={left:0,top:0,width:t.naturalWidth,height:t.naturalHeight}),t.width=i.width,t.height=i.height,t.drawImage(i),t.triggerLoadEvent()}):(this.clearCanvas(),u.resolve())},drawImage:function(e){var t=this.image;if(t){var n=this.components.canvas;if(!n)return void(this.redrawNeeded=!0);var r,i=this.orientation,o=t.naturalWidth,c=t.naturalHeight;switch(i){case 1:r=[1,0,0,1,0,0];break;case 2:r=[-1,0,0,1,o,0];break;case 3:r=[-1,0,0,-1,o,c];break;case 4:r=[1,0,0,-1,0,c];break;case 5:r=[0,1,1,0,0,0];break;case 6:r=[0,1,-1,0,c,0];break;case 7:r=[0,-1,-1,0,c,o];break;case 8:r=[0,-1,1,0,0,o]}e||(e={left:0,top:0,width:i<5?o:c,height:i<5?c:o});var l=s(r),u=a(l,e),d=a(l,{left:0,top:0,width:e.width,height:e.height});n.width=d.width,n.height=d.height;var p=n.getContext("2d");p.transform.apply(p,r),p.drawImage(t,u.left,u.top,u.width,u.height,d.left,d.top,d.width,d.height)}},clearCanvas:function(){var e=this.components.canvas;e&&(e.width=0,e.height=0),this.width=0,this.height=0,this.orientation=void 0}})},function(e,t,n){"use strict";function r(e,t){"change"===e&&t&&l.push(t)}function i(e,t){"change"===e&&t&&o.pull(l,t)}function s(e){return e.format("YYYY-MM-DD")}var o=n(4),a=n(0),c=a();t.addEventListener=r,t.removeEventListener=i,t.today=s(c);var l=[];setInterval(function(){var e=a(),n=s(e);if(n!==t.today){t.today=n;var r={type:"change",target:t};o.each(l,function(e){e(r)})}},1e3)},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1),s=(i.PropTypes,n(32));n(754),e.exports=i.createClass({displayName:"AutosizeTextArea",getInitialState:function(){return this.components=s({actual:HTMLTextAreaElement,shadow:HTMLTextAreaElement}),{requiredHeight:void 0}},render:function(){var e=this.components.setters,t=_.extend({height:this.state.requiredHeight},this.props.style),n=_.omit(this.props,"style");return i.createElement("div",{className:"autosize-text-area"},i.createElement("textarea",{ref:e.shadow,style:t,className:"shadow",value:n.value,readOnly:!0}),i.createElement("textarea",r({ref:e.actual,style:t},n)))},componentDidMount:function(){window.removeEventListener("resize",this.handleDocumentResize),this.updateSize()},componentDidUpdate:function(e,t){e.value!==this.props.value&&this.updateSize()},componentWillUnmount:function(){window.removeEventListener("resize",this.handleDocumentResize)},focus:function(){var e=this.components.actual;e&&e.focus()},updateSize:function(){var e=this.components.shadow,t=this.components.actual;if(e&&t){var n=e.offsetHeight,r=e.scrollHeight,i=e.clientHeight,s=t.offsetHeight,o=r+(n-i);if(this.state.height!==o){if(s>o&&s>this.state.requiredHeight)return;this.setState({requiredHeight:o})}}},handleResize:function(e){console.log("resize")},handleDocumentResize:function(e){this.updateSize()}})},function(e,t,n){"use strict";function r(e){var t=e.offsetHeight,n=e.getElementsByClassName("collapsible-container");return _.each(n,function(e){if(t-=e.offsetHeight,parseInt(e.style.height)>0){var n=e.children[0];t+=n.offsetHeight}}),t}var i=n(1),s=(i.PropTypes,n(32));n(755),e.exports=i.createClass({displayName:"CollapsibleContainer",propTypes:{open:i.PropTypes.bool},getInitialState:function(){return this.components=s({container:HTMLDivElement,contents:HTMLDivElement}),{contentHeight:void 0,collapsing:!1,expanding:!1}},componentWillReceiveProps:function(e){this.props.open!==e.open&&(e.open?this.setState({collapsing:!1,expanding:!0}):this.setState({collapsing:!0,expanding:!1}))},render:function(){var e=this.components.setters,t={};this.props.open?t.height=this.state.contentHeight:t.height=0;var n="collapsible-container";return this.state.expanding?n+=" expanding":this.state.collapsing&&(n+=" collapsing"),i.createElement("div",{ref:e.container,className:n,style:t},i.createElement("div",{ref:e.contents,className:"collapsible-contents"},this.props.children))},componentDidMount:function(){this.props.open&&this.componentDidUpdate()},componentDidUpdate:function(e,t){var n=r(this.components.contents);this.state.contentHeight!==n&&this.setState({contentHeight:n})}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(434);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},,,,,function(e,t,n){"use strict";function r(e){for(;e&&"A"!==e.tagName;)e=e.parentNode;return e}var i=n(4),s=n(10),o=n(1),a=(o.PropTypes,n(32)),c=n(101),l=n(397),u=n(385),d=n(7),p=n(393),h=n(8),m=n(395),f=n(19),v=n(387),g=n(5),b=n(394),y=n(6),k=n(363),x=n(37),E=n(140),C=n(47),w=n(95),S=n(139),R=n(141),N=n(362),O=n(382),_=n(375),P=[k,x,E,C,w,S,R,N];n(401),n(688),n(539),e.exports=o.createClass({displayName:"Application",getInitialState:function(){return this.components=a({remoteDataSource:u,routeManager:p,localeManager:v,themeManager:b,uploadManager:m}),{database:null,payloads:null,route:null,locale:null,theme:null,canAccessServer:!1,canAccessSchema:!1,renderingStartPage:!1}},isReady:function(){return!!(this.state.database&&this.state.payloads&&this.state.route&&this.state.locale&&this.state.theme)},isShowingStartPage:function(){return this.state.route.component===k||(!this.state.canAccessServer||!this.state.canAccessSchema)},render:function(){return o.createElement("div",{onClick:this.handleClick},this.renderUserInterface(),this.renderConfiguration())},renderUserInterface:function(){if(!this.isReady())return null;var e={database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme};return this.isShowingStartPage()&&(e.hidden=!0),o.createElement("div",{className:"application"},o.createElement(O,e),o.createElement("section",{className:"page-view-port"},o.createElement("div",{className:"contents"},this.renderCurrentPage())),o.createElement(_,e),this.renderStartPage())},renderCurrentPage:function(){var e=this.state.route.component;if(this.isShowingStartPage())return null;var t={database:this.state.database,route:this.state.route,payloads:this.state.payloads,locale:this.state.locale,theme:this.state.theme};return o.createElement(e,t)},renderStartPage:function(){if(!this.isShowingStartPage()&&!this.state.renderingStartPage)return null;var e={canAccessServer:this.state.canAccessServer,canAccessSchema:this.state.canAccessSchema,database:this.state.database,route:this.state.route,locale:this.state.locale,theme:this.state.theme,onEntry:this.handleStartPageEntry,onExit:this.handleStartPageExit,onAvailableSchemas:this.handleAvailableSchemas};return o.createElement(k,e)},renderConfiguration:function(){var e=this.components.setters,t={ref:e.remoteDataSource,locale:this.state.locale,cacheName:"trambar",defaultProfileImage:n(534),onChange:this.handleDatabaseChange,onAuthorization:this.handleAuthorization,onExpiration:this.handleExpiration,onViolation:this.handleViolation,onAlertClick:this.handleAlertClick},r={ref:e.uploadManager,database:this.state.database,route:this.state.route,onChange:this.handlePayloadsChange},i={ref:e.routeManager,baseUrls:["","/trambar"],pages:P,database:this.state.database,onChange:this.handleRouteChange,onRedirectionRequest:this.handleRedirectionRequest},s={ref:e.localeManager,database:this.state.database,directory:n(388),onChange:this.handleLocaleChange,onModuleRequest:this.handleLanguageModuleRequest},a={ref:e.themeManager,database:this.state.database,modes:{"columns-1":0,"columns-2":700,"columns-3":1300},route:this.state.route,onChange:this.handleThemeChange};return o.createElement("div",null,o.createElement(u,t),o.createElement(m,r),o.createElement(p,i),o.createElement(v,s),o.createElement(b,a))},componentDidUpdate:function(e,t){var n=this;!this.splashScreenHidden&&this.isReady()&&(this.splashScreenHidden=!0,setTimeout(function(){n.hideSplashScreen()},100)),t.route!==this.state.route&&(t.route&&t.route.url===this.state.route.url||l.scrollTo(this.state.route.hash))},loadCredentialsFromCache:function(e){var t=this.state.database.use({by:this,schema:"local"}),n={server:e};return t.findOne({table:"user_credentials",criteria:n})},saveCredentialsToCache:function(e,t){var n=this.state.database.use({by:this,schema:"local"}),r=i.extend({key:e},t);return n.saveOne({table:"user_credentials"},r)},removeCredentialsFromCache:function(e){var t=this.state.database.use({by:this,schema:"local"}),n={key:e};return t.removeOne({table:"user_credentials"},n)},handleDatabaseChange:function(e){var t=new d(e.target);this.setState({database:t})},handleAuthorization:function(e){this.saveCredentialsToCache(e.server,e.credentials),(this.state.route.server||window.location.hostname)===e.server&&this.setState({canAccessServer:!0,canAccessSchema:!0})},handleExpiration:function(e){this.removeCredentialsFromCache(e.server);var t=this.state.route.server||window.location.hostname;e.server===t&&this.setState({canAccessServer:!1,canAccessSchema:!1})},handleViolation:function(e){var t=this.state.route.server||window.location.hostname,n=this.state.route.parameters.schema;e.server===t&&e.schema===n&&this.setState({canAccessSchema:!1})},handlePayloadsChange:function(e){var t=new f(e.target);this.setState({payloads:t})},handleLocaleChange:function(e){var t=new g(e.target);this.setState({locale:t}),document.title=t.translate("app-name")},handleLanguageModuleRequest:function(e){var t=e.languageCode.substr(0,2);return new s(function(e,r){window.Promise||n(10);switch(t){case"en":n.e(5).then(function(){try{e(n(334))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"fi":n.e(4).then(function(){try{e(n(335))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"no":n.e(3).then(function(){try{e(n(336))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"pl":n.e(2).then(function(){try{e(n(337))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"ru":n.e(1).then(function(){try{e(n(338))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;case"zh":n.e(0).then(function(){try{e(n(339))}catch(e){r(e)}}.bind(null,n)).catch(n.oe);break;default:r(new Error("No module for language: "+t))}})},handleRouteChange:function(e){var t=this,n=new h(e.target),r=this.components.remoteDataSource,i=n.parameters.server||location.hostname;r.hasAuthorization(i)?this.setState({route:n,canAccessServer:!0,canAccessSchema:!0}):this.loadCredentialsFromCache(i).then(function(e){e&&r.addAuthorization(i,e),r.hasAuthorization(i)?t.setState({route:n,canAccessServer:!0,canAccessSchema:!0}):t.setState({route:n,canAccessServer:!1,canAccessSchema:!1})})},handleAvailableSchemas:function(e){var t=this.state.route.parameters.schema;i.includes(e.schemas,t)&&this.setState({canAccessSchema:!0})},handleStartPageEntry:function(e){this.setState({renderingStartPage:!0})},handleStartPageExit:function(e){this.setState({renderingStartPage:!1})},handleRedirectionRequest:function(e){var t=this;return s.try(function(){if("/"===e.url){return t.state.database.use({by:t,schema:"local"}).find({table:"project_link"}).then(function(e){var t=i.last(i.sortBy(e,"atime"));return t?x.getUrl({server:t.server,schema:t.schema}):k.getUrl({})})}throw new c(404)}).catch(function(e){var t=e.statusCode||500;return console.error(e),N.getUrl({errorCode:t})})},handleClick:function(e){if(0===e.button){var t=r(e.target);if(t){var n=t.getAttribute("href")||t.getAttribute("data-url");n&&-1===n.indexOf(":")&&(this.state.route.change(n),e.preventDefault(),t.blur())}}},handleThemeChange:function(e){var t=new y(e.target);this.setState({theme:t})},handleAlertClick:function(e){var t=e.alert,r=this.state.route,i=n(37).getUrl({server:r.parameters.server,schema:t.schema,storyId:t.story_id});r.change(i),window.focus()},hideSplashScreen:function(){var e=document.getElementById("splash-screen"),t=document.getElementById("splash-screen-style");e&&(e.className="transition-out",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t)},1e3))}})},,,,,,,function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(110),o=n(5),a=n(6),c=n(29),l=n(21);n(689),e.exports=r.createClass({displayName:"AppComponentDialogBox",propTypes:{show:i.bool,component:i.object.isRequired,locale:i.instanceOf(o).isRequired,theme:i.instanceOf(a).isRequired,onClose:i.func},render:function(){if(!this.props.component)return null;var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(c,e,r.createElement("div",{className:"app-component-dialog-box"},r.createElement("div",{className:"contents"},this.renderPicture(),this.renderText()),this.renderButtons()))},renderPicture:function(){var e=this.props.component;if(e.image){var t=this.props.theme.getImageUrl(e.image);return r.createElement("div",{className:"picture"},r.createElement("img",{src:t}))}var n=e.icon||{},i=n.class||"fa-cubes",s={color:n.color,backgroundColor:n["background-color"]};return r.createElement("div",{className:"picture"},r.createElement("div",{className:"icon",style:s},r.createElement("i",{className:"fa fa-fw "+i})))},renderText:function(){var e=this.props.locale.pick,t=e(this.props.component.text),n=s.parse(t);return r.createElement("div",{className:"text"},n)},renderButtons:function(){var e={label:"OK",onClick:this.props.onClose};return r.createElement("div",{className:"buttons"},r.createElement(l,e))}})},function(e,t,n){"use strict";var r=n(10),i=n(1),s=i.PropTypes,o=n(5),a=n(19),c=n(102),l=n(29),u=n(21);n(690),e.exports=i.createClass({displayName:"AudioCaptureDialogBox",propTypes:{show:s.bool,payloads:s.instanceOf(a).isRequired,locale:s.instanceOf(o).isRequired,onCancel:s.func,onCapture:s.func},getInitialState:function(){return{liveAudioStream:null,liveAudioContext:null,liveAudioProcessor:null,liveAudioSource:null,liveAudioLevel:0,liveAudioUrl:null,liveAudioError:null,liveAudioRecorder:null,mediaRecorder:null,capturedAudio:null,previewUrl:null}},componentWillMount:function(){this.props.show&&this.initializeMicrophone()},componentWillReceiveProps:function(e){var t=this;this.props.show!==e.show&&(e.show?(this.clearCapturedAudio(),this.initializeMicrophone()):setTimeout(function(){t.shutdownMicrophone(),t.clearCapturedAudio()},500))},clearCapturedAudio:function(){this.state.capturedAudio&&(URL.revokeObjectURL(this.state.previewUrl),this.setState({capturedAudio:null,previewUrl:null}))},initializeMicrophone:function(){var e=this;this.createLiveAudioStream().then(function(t){e.setLiveAudioState(null,t)}).catch(function(t){e.setLiveAudioState(t,null)})},shutdownMicrophone:function(){var e=this;this.destroyLiveAudioStream().then(function(){e.setLiveAudioState(null,null)})},setLiveAudioState:function(e,t){var n=this;this.state.liveAudioUrl&&URL.revokeObjectURL(this.state.liveAudioUrl),this.state.liveAudioProcessor&&(this.state.liveAudioSource.disconnect(this.state.liveAudioProcessor),this.state.liveAudioProcessor.disconnect(this.state.liveAudioContext.destination));var r,i,s,o;if(t){r=URL.createObjectURL(t);var i=new AudioContext,s=i.createScriptProcessor(4096,1,1),o=i.createMediaStreamSource(t);s.addEventListener("audioprocess",function(e){for(var t=e.inputBuffer.getChannelData(0),r=0,i=t.length,s=0;s<i;s++){var o=t[s];o>r&&(r=o)}var a=Math.round(100*r);a!==n.state.liveAudioLevel&&n.setState({liveAudioLevel:a})}),o.connect(s),s.connect(i.destination)}this.setState({liveAudioStream:t,liveAudioContext:i,liveAudioProcessor:s,liveAudioSource:o,liveAudioUrl:r,liveAudioError:e}),e&&console.error(e)},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return i.createElement(l,e,i.createElement("div",{className:"audio-capture-dialog-box"},this.renderView(),this.renderButtons()))},renderView:function(){return this.state.capturedAudio?this.renderCapturedAudio():this.renderLiveAudio()},renderLiveAudio:function(){if(!this.state.liveAudioUrl)return null;var e,t={ref:"audio",src:this.state.liveAudioUrl,autoPlay:!0,muted:!0},n=this.state.liveAudioLevel;return e=n<10?"volume-off":n<50?"volume-down":"volume-up",i.createElement("div",{className:"container"},i.createElement("div",{className:"volume-meter"},i.createElement("div",{className:"icon"},i.createElement("i",{className:"fa fa-"+e})),i.createElement("div",{className:"bar-container"},i.createElement("div",{className:"bar"},i.createElement("div",{className:"fill",style:{width:n+"%"}})))),i.createElement("audio",t))},renderCapturedAudio:function(){var e={src:this.state.previewUrl,controls:!0};return i.createElement("div",{className:"container"},i.createElement("audio",e))},renderButtons:function(){var e=this.props.locale.translate;if(this.state.mediaRecorder){var t={label:e("audio-capture-pause"),onClick:this.handlePauseClick,disabled:"paused"===this.state.mediaRecorder.state},n={label:e("audio-capture-stop"),onClick:this.handleStopClick,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(u,t),i.createElement(u,n))}if(this.state.capturedAudio){var r={label:e("audio-capture-rerecord"),onClick:this.handleRerecordClick},s={label:e("audio-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(u,r),i.createElement(u,s))}var o={label:e("audio-capture-cancel"),onClick:this.handleCancelClick},a={label:e("audio-capture-start"),onClick:this.handleStartClick,disabled:!this.state.liveAudioStream,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(u,o),i.createElement(u,a))},componentWillUnmount:function(){this.destroyLiveAudioStream()},createLiveAudioStream:function(){var e=this.audioStreamPromise;if(!e){var t={audio:!0};e=navigator.mediaDevices.getUserMedia(t),this.audioStreamPromise=e}return r.resolve(e)},destroyLiveAudioStream:function(){var e=this.audioStreamPromise;return this.audioStreamPromise=null,r.resolve(e).then(function(e){if(e){var t=e.getTracks();_.each(t,function(e){e.stop()})}})},beginRecording:function(){var e=this;return r.try(function(){var t={audioBitsPerSecond:128e3,mimeType:"audio/webm"},n=new MediaRecorder(e.state.liveAudioStream,t);return n.outputStream=new c,n.addEventListener("dataavailable",function(e){this.outputStream.push(e.data)}),n.addEventListener("stop",function(e){this.outputStream.close()}),n.start(3e3),n})},pauseRecording:function(){var e=this;return r.try(function(){var t=e.state.mediaRecorder;t&&t.pause()})},endRecording:function(){var e=this;return r.try(function(){var t=e.state.mediaRecorder;if(t)return t.stop(),{type:t.mimeType,audio_bitrate:t.audioBitsPerSecond,stream:t.outputStream}})},triggerCaptureEvent:function(e){this.props.onCapture&&this.props.onCapture({type:"capture",target:this,audio:e})},handleStartClick:function(e){var t=this;return this.beginRecording().then(function(e){t.props.payloads.stream(e.outputStream),t.setState({mediaRecorder:e})})},handlePauseClick:function(e){return this.pauseRecording()},handleStopClick:function(e){var t=this;return this.endRecording().then(function(e){var n=e.stream.toBlob(),r=URL.createObjectURL(n);t.setState({capturedAudio:e,previewUrl:r,capturedImage:null,mediaRecorder:null})})},handleRerecordClick:function(e){this.clearCapturedAudio()},handleAcceptClick:function(e){this.triggerCaptureEvent(this.state.capturedAudio)},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})}})},function(e,t,n){"use strict";function r(e){var t=["thumbnail"];return e.selected&&t.push("selected"),s.createElement("div",{className:t.join(" "),id:e.id,onClick:e.onClick},s.createElement("img",{src:e.url}))}var i=n(10),s=n(1),o=s.PropTypes,a=n(5),c=n(6),l=n(29),u=n(21);n(691),e.exports=s.createClass({displayName:"MediaDialogBox",propTypes:{show:o.bool,resources:o.arrayOf(o.object).isRequired,selectedIndex:o.number.isRequired,locale:o.instanceOf(a).isRequired,theme:o.instanceOf(c).isRequired,onClose:o.func},getInitialState:function(){return{selectedIndex:this.props.selectedIndex}},getResourceCount:function(){return this.props.resources.length},getSelectedResourceIndex:function(){var e=this.getResourceCount()-1;return _.min([this.state.selectedIndex,e])},selectResource:function(e){var t=this;return new i(function(n,r){var i=t.getResourceCount();e>=0&&e<i?t.setState({selectedIndex:e},function(){n(e)}):n(t.getSelectedResourceIndex())})},componentWillReceiveProps:function(e){if(this.props.show!==e.show)if(e.show)this.setState({selectedIndex:e.selectedIndex});else{var t=this.refs.video;t&&t.pause()}},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return s.createElement(l,e,s.createElement("div",{className:"media-dialog-box"},this.renderView(),s.createElement("div",{className:"controls"},this.renderThumbnails(),this.renderButtons())))},renderView:function(){var e=this.state.selectedIndex,t=this.props.resources[e];switch(t.type){case"image":return this.renderImage(t);case"video":return this.renderVideo(t)}},renderImage:function(e){var t,n,r=document.body.parentElement,i=r.clientWidth-100,o=r.clientHeight-200;e.width>i?t=i:e.height>o&&(n=o);var a=this.props.theme,c=_.omit(e,"clip"),l={src:a.getImageUrl(c,{width:t,height:n})};return s.createElement("div",{className:"image"},s.createElement("img",l))},renderVideo:function(e){var t=e,n=this.props.theme,r={ref:"video",src:n.getVideoUrl(t),controls:!0,autoPlay:!0};return s.createElement("div",{className:"container"},s.createElement("video",r))},renderThumbnails:function(){var e=this,t=(this.props.locale.translate,this.props.theme),n=this.getSelectedResourceIndex(),i=_.map(this.props.resources,function(i,o){var a,c={width:28,height:28};a="image"===i.type?t.getImageUrl(i,c):t.getPosterUrl(i,c);var l={url:a,selected:o===n,id:o,key:o,onClick:e.handleThumbnailClick};return s.createElement(r,l)});return s.createElement("div",{className:"links"},i)},renderButtons:function(){var e=this.props.locale.translate,t={label:e("media-close"),emphasized:!0,onClick:this.props.onClose};return s.createElement("div",{className:"buttons"},s.createElement(u,t))},handleThumbnailClick:function(e){var t=parseInt(e.currentTarget.id);return this.selectResource(t)}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=(n(18),n(5)),o=n(6),a=n(29),c=n(21),l=n(48),u=n(150);n(692),e.exports=r.createClass({displayName:"MembershipRequestDialogBox",propTypes:{show:i.bool,currentUser:i.object.isRequired,project:i.object.isRequired,member:i.bool.isRequired,pendingMember:i.bool.isRequired,readAccess:i.bool.isRequired,locale:i.instanceOf(s).isRequired,theme:i.instanceOf(o).isRequired,onConfirm:i.func,onClose:i.func,onProceed:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCloseClick},t=["membership-request-dialog-box"];return r.createElement(a,e,r.createElement("div",{className:t.join(" ")},this.renderText(),this.renderButtons()))},renderText:function(){var e,t=this.props.locale.pick,n=this.props.project,i=t(n.details.title)||n.name,s=t(n.details.description),o=_.find(n.details.resources,{type:"image"});if(o){var a=this.props.theme.getImageUrl(o,{width:128});e=r.createElement("img",{src:a})}return r.createElement(l,null,r.createElement("div",{className:"title"},i),this.renderMessage(),r.createElement("div",{className:"description"},e,s))},renderMessage:function(){var e,t=this.props.locale.translate;return this.props.member?e=r.createElement("div",{className:"message accepted"},r.createElement("i",{className:"fa fa-user-circle-o"})," ",t("membership-request-you-are-now-member")):this.props.pendingMember&&(e=r.createElement("div",{className:"message requested"},r.createElement("i",{className:"fa fa-clock-o"})," ",t("membership-request-you-have-requested-membership"))),r.createElement(u,{open:!!e},e)},renderButtons:function(){var e=this.props.locale.translate;if(this.props.readAccess){var t={label:e("membership-request-proceed"),onClick:this.handleProceedClick};return r.createElement("div",{className:"buttons"},r.createElement(c,t))}if(this.props.pendingMember){var n={label:e("membership-request-ok"),onClick:this.handleCloseClick};return r.createElement("div",{className:"buttons"},r.createElement(c,n))}var i={label:e("membership-request-cancel"),onClick:this.handleCloseClick},s={label:e("membership-request-join"),onClick:this.handleConfirmClick,emphasized:!0};return r.createElement("div",{className:"buttons"},r.createElement(c,i),r.createElement(c,s))},handleConfirmClick:function(e){this.props.onConfirm&&this.props.onConfirm({type:"confirm",target:this})},handleCloseClick:function(e){this.props.onClose&&this.props.onClose({type:"cancel",target:this})},handleProceedClick:function(e){this.props.onProceed&&this.props.onProceed({type:"proceed",target:this})}})},function(e,t,n){"use strict";var r=n(10),i=n(1),s=i.PropTypes,o=n(77),a=n(5),c=n(29),l=n(21);n(693),e.exports=i.createClass({displayName:"PhotoCaptureDialogBox",propTypes:{show:s.bool,locale:s.instanceOf(a).isRequired,onCancel:s.func,onCapture:s.func},getInitialState:function(){return{liveVideoStream:null,liveVideoUrl:null,liveVideoError:null,capturedImage:null,previewUrl:null,videoDevices:o.getDevices("videoinput"),selectedDeviceId:null}},componentWillMount:function(){this.props.show&&this.initializeCamera(),o.addEventListener("change",this.handleDeviceChange)},componentWillReceiveProps:function(e){var t=this;this.props.show!==e.show&&(e.show?(this.clearCapturedImage(),this.initializeCamera()):setTimeout(function(){t.shutdownCamera(),t.clearCapturedImage()},500))},clearCapturedImage:function(){this.state.capturedImage&&(URL.revokeObjectURL(this.state.previewUrl),this.setState({capturedImage:null,previewUrl:null}))},initializeCamera:function(){var e=this;this.createLiveVideoStream().then(function(t){e.setLiveVideoState(null,t)}).catch(function(t){e.setLiveVideoState(t,null)})},shutdownCamera:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.setLiveVideoState(null,null)})},reinitializeCamera:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.initializeCamera()})},setLiveVideoState:function(e,t){this.state.liveVideoUrl&&URL.revokeObjectURL(this.state.liveVideoUrl);var n=t?URL.createObjectURL(t):null;this.setState({liveVideoStream:t,liveVideoUrl:n,liveVideoError:e}),e&&console.error(e)},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return i.createElement(c,e,i.createElement("div",{className:"photo-capture-dialog-box"},this.renderView(),i.createElement("div",{className:"controls"},this.renderDeviceSelector(),this.renderButtons())))},renderView:function(){return this.state.capturedImage?this.renderCapturedImage():this.renderLiveVideo()},renderLiveVideo:function(){if(!this.state.liveVideoUrl)return null;var e={ref:"video",src:this.state.liveVideoUrl,autoPlay:!0,muted:!0};return i.createElement("div",{className:"container"},i.createElement("video",e))},renderCapturedImage:function(){var e={src:this.state.previewUrl};return i.createElement("div",{className:"container"},i.createElement("img",e))},renderDeviceSelector:function(){var e=this;if(this.state.videoDevices.length<2)return null;var t=_.map(this.state.videoDevices,function(t,n){var r=t.label;r=_.replace(t.label,/\(\w{4}:\w{4}\)/g,"");var s={key:n,value:t.deviceId,selected:t.deviceId===e.state.selectedDeviceId};return i.createElement("option",s,r)});return i.createElement("div",{className:"device-selector"},i.createElement("select",{onChange:this.handleDeviceSelect},t))},renderButtons:function(){var e=this.props.locale.translate;if(this.state.capturedImage){var t={label:e("photo-capture-retake"),onClick:this.handleRetakeClick},n={label:e("photo-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(l,t),i.createElement(l,n))}var r={label:e("photo-capture-cancel"),onClick:this.handleCancelClick},s={label:e("photo-capture-snap"),onClick:this.handleSnapClick,disabled:!this.state.liveVideoStream,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(l,r),i.createElement(l,s))},componentWillUnmount:function(){this.destroyLiveVideoStream(),this.clearCapturedImage(),o.removeEventListener("change",this.handleDeviceChange)},createLiveVideoStream:function(){var e=this.videoStreamPromise;if(!e){var t;t=this.state.selectedDeviceId?{video:{mandatory:{sourceId:this.state.selectedDeviceId}}}:{video:!0},e=navigator.mediaDevices.getUserMedia(t),this.videoStreamPromise=e}return r.resolve(e)},destroyLiveVideoStream:function(){var e=this.videoStreamPromise;return this.videoStreamPromise=null,r.resolve(e).then(function(e){if(e){var t=e.getTracks();_.each(t,function(e){e.stop()})}})},captureImage:function(){var e=this;return new r(function(t,n){var r=document.createElement("CANVAS"),i=r.getContext("2d"),s=e.refs.video,o=s.videoWidth,a=s.videoHeight;r.width=o,r.height=a,i.drawImage(s,0,0,o,a),r.toBlob(function(e){t({type:"image/jpeg",file:e,width:o,height:a})},"image/jpeg",90)})},triggerCaptureEvent:function(e){this.props.onCapture&&this.props.onCapture({type:"capture",target:this,image:e})},handleSnapClick:function(e){var t=this;this.captureImage().then(function(e){var n=URL.createObjectURL(e.file);t.setState({capturedImage:e,previewUrl:n})})},handleRetakeClick:function(e){this.clearCapturedImage()},handleAcceptClick:function(e){this.triggerCaptureEvent(this.state.capturedImage)},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleDeviceSelect:function(e){var t=this,n=e.currentTarget.value;this.setState({selectedDeviceId:n},function(){t.reinitializeCamera()})},handleDeviceChange:function(e){var t=this,n=o.getDevices("videoinput"),r=this.state.selectedDeviceId,i=!1;r&&(_.some(n,{deviceId:r})||(r=null,i=!0)),this.setState({videoDevices:n,selectedDeviceId:r},function(){i&&t.reinitializeCamera()})}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(5),o=n(29),a=n(21),c=n(378);n(694),e.exports=r.createClass({displayName:"TelephoneNumberDialogBox",propTypes:{show:i.bool,number:i.string,locale:i.instanceOf(s).isRequired,onClose:i.func},render:function(){var e={show:this.props.show,onBackgroundClick:this.props.onClose};return r.createElement(o,e,r.createElement("div",{className:"telephone-number-dialog-box"},this.renderContents(),this.renderButtons()))},renderContents:function(){var e=this.props.number,t="tel:"+e;return r.createElement("div",{className:"contents"},r.createElement(c,{text:t,scale:6}),r.createElement("div",{className:"number"},e))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("telephone-dialog-close"),onClick:this.props.onClose};return r.createElement("div",{className:"buttons"},r.createElement(a,t))}})},function(e,t,n){"use strict";var r=n(10),i=n(1),s=i.PropTypes,o=n(77),a=n(5),c=n(19),l=n(102),u=n(29),d=n(21);n(696),e.exports=i.createClass({displayName:"VideoCaptureDialogBox",propTypes:{show:s.bool,payloads:s.instanceOf(c).isRequired,locale:s.instanceOf(a).isRequired,onCancel:s.func,onCapture:s.func},getInitialState:function(){return{liveVideoStream:null,liveVideoUrl:null,liveVideoError:null,mediaRecorder:null,capturedVideo:null,capturedImage:null,previewUrl:null,videoDevices:o.getDevices("videoinput"),selectedDeviceId:null}},componentWillMount:function(){this.props.show&&this.initializeCamera(),o.addEventListener("change",this.handleDeviceChange)},componentWillReceiveProps:function(e){var t=this;this.props.show!==e.show&&(e.show?(this.clearCapturedVideo(),this.initializeCamera()):setTimeout(function(){t.shutdownCamera(),t.clearCapturedVideo()},500))},clearCapturedVideo:function(){this.state.capturedVideo&&(URL.revokeObjectURL(this.state.previewUrl),this.setState({capturedVideo:null,previewUrl:null}))},initializeCamera:function(){var e=this;return this.createLiveVideoStream().then(function(t){e.setLiveVideoState(null,t)}).catch(function(t){e.setLiveVideoState(t,null)})},shutdownCamera:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.setLiveVideoState(null,null)})},reinitializeCamera:function(){var e=this;this.destroyLiveVideoStream().then(function(){e.initializeCamera()})},setLiveVideoState:function(e,t){this.state.liveVideoUrl&&URL.revokeObjectURL(this.state.liveVideoUrl);var n;t&&(n=URL.createObjectURL(t)),this.setState({liveVideoStream:t,liveVideoUrl:n,liveVideoError:e}),e&&console.error(e)},render:function(){var e={show:this.props.show,onBackgroundClick:this.handleCancelClick};return i.createElement(u,e,i.createElement("div",{className:"video-capture-dialog-box"},this.renderView(),i.createElement("div",{className:"controls"},this.renderDeviceSelector(),this.renderButtons())))},renderView:function(){return this.state.capturedVideo?this.renderCapturedVideo():this.renderLiveVideo()},renderLiveVideo:function(){if(!this.state.liveVideoUrl)return null;var e={ref:"video",src:this.state.liveVideoUrl,autoPlay:!0,muted:!0};return i.createElement("div",{className:"container"},i.createElement("video",e))},renderCapturedVideo:function(){var e={src:this.state.previewUrl,controls:!0};return i.createElement("div",{className:"container"},i.createElement("video",e))},renderDeviceSelector:function(){if(this.state.videoDevices.length<2)return null;var e=_.map(this.state.videoDevices,function(e,t){var n=e.label;n=_.replace(e.label,/\(\w{4}:\w{4}\)/g,"");var r={key:t,value:e.deviceId};return i.createElement("option",r,n)}),t={value:this.state.selectedDeviceId||"",onChange:this.handleDeviceSelect};return i.createElement("div",{className:"device-selector"},i.createElement("select",t,e))},renderButtons:function(){var e=this.props.locale.translate;if(this.state.mediaRecorder){var t={label:e("video-capture-pause"),onClick:this.handlePauseClick,disabled:"paused"===this.state.mediaRecorder.state},n={label:e("video-capture-stop"),onClick:this.handleStopClick,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(d,t),i.createElement(d,n))}if(this.state.capturedVideo){var r={label:e("video-capture-retake"),onClick:this.handleRetakeClick},s={label:e("video-capture-accept"),onClick:this.handleAcceptClick,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(d,r),i.createElement(d,s))}var o={label:e("video-capture-cancel"),onClick:this.handleCancelClick},a={label:e("video-capture-start"),onClick:this.handleStartClick,disabled:!this.state.liveVideoStream,emphasized:!0};return i.createElement("div",{className:"buttons"},i.createElement(d,o),i.createElement(d,a))},componentWillUnmount:function(){this.destroyLiveVideoStream(),this.clearCapturedVideo(),o.removeEventListener("change",this.handleDeviceChange)},createLiveVideoStream:function(){var e=this.videoStreamPromise;if(!e){var t;t=this.state.selectedDeviceId?{video:{mandatory:{sourceId:this.state.selectedDeviceId}}}:{video:!0},e=navigator.mediaDevices.getUserMedia(t),this.videoStreamPromise=e}return r.resolve(e)},destroyLiveVideoStream:function(){var e=this.videoStreamPromise;return this.videoStreamPromise=null,r.resolve(e).then(function(e){if(e){var t=e.getTracks();_.each(t,function(e){e.stop()})}})},captureImage:function(){var e=this;return new r(function(t,n){var r=document.createElement("CANVAS"),i=r.getContext("2d"),s=e.refs.video,o=s.videoWidth,a=s.videoHeight;r.width=o,r.height=a,i.drawImage(s,0,0,o,a),r.toBlob(function(e){t({type:"image/jpeg",file:e,width:o,height:a})},"image/jpeg",90)})},beginRecording:function(){var e=this;return r.try(function(){var t={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5,mimeType:"video/webm"},n=new MediaRecorder(e.state.liveVideoStream,t);return n.outputStream=new l,n.addEventListener("dataavailable",function(e){this.outputStream.push(e.data)}),n.addEventListener("stop",function(e){this.outputStream.close()}),n.start(3e3),n})},pauseRecording:function(){var e=this;return r.try(function(){var t=e.state.mediaRecorder;t&&t.pause()})},endRecording:function(){var e=this;return r.try(function(){var t=e.state.mediaRecorder,n=e.state.capturedImage;if(t)return t.stop(),{width:n.width,height:n.height,poster_file:n.file,format:_.last(_.split(t.mimeType,"/")),audio_bitrate:t.audioBitsPerSecond,video_bitrate:t.videoBitsPerSecond,stream:t.outputStream}})},triggerCaptureEvent:function(e){this.props.onCapture&&this.props.onCapture({type:"capture",target:this,video:e})},handleStartClick:function(e){var t=this;return r.join(this.captureImage(),this.beginRecording(),function(e,n){t.props.payloads.stream(n.outputStream),t.setState({capturedImage:e,mediaRecorder:n})})},handlePauseClick:function(e){return this.pauseRecording()},handleStopClick:function(e){var t=this;return this.endRecording().then(function(e){var n=e.stream.toBlob(),r=URL.createObjectURL(n);t.setState({capturedVideo:e,previewUrl:r,capturedImage:null,mediaRecorder:null})})},handleRetakeClick:function(e){this.clearCapturedVideo()},handleAcceptClick:function(e){this.triggerCaptureEvent(this.state.capturedVideo)},handleCancelClick:function(e){this.props.onCancel&&this.props.onCancel({type:"cancel",target:this})},handleDeviceSelect:function(e){var t=this,n=e.currentTarget.value;this.setState({selectedDeviceId:n},function(){t.reinitializeCamera()})},handleDeviceChange:function(e){var t=this,n=o.getDevices("videoinput"),r=this.state.selectedDeviceId,i=!1;r&&(_.some(n,{deviceId:r})||(r=null,i=!0)),this.setState({videoDevices:n,selectedDeviceId:r},function(){i&&t.reinitializeCamera()})}})},function(e,t,n){"use strict";function r(e){return i.some(e,function(e){if(!e.url&&!e.payload_id)return!0})}var i=n(4),s=n(10),o=n(1),a=o.PropTypes,c=n(22),l=n(77),u=n(32),d=n(7),p=n(19),h=n(8),m=n(5),f=n(6),v=n(14),g=n(149),b=n(21),y=n(38),k=n(31),x=(n(144),n(137));n(697);e.exports=o.createClass({displayName:"CommentEditor",mixins:[v],propTypes:{reaction:a.object,story:a.object.isRequired,currentUser:a.object,database:a.instanceOf(d).isRequired,payloads:a.instanceOf(p).isRequired,route:a.instanceOf(h).isRequired,locale:a.instanceOf(m).isRequired,theme:a.instanceOf(f).isRequired,onFinish:a.func},getInitialState:function(){this.components=u({mediaEditor:x});var e={draft:null,hasCamera:l.hasDevice("videoinput"),hasMicrophone:l.hasDevice("audioinput")};return this.updateDraft(e,this.props),e},componentWillMount:function(){l.addEventListener("change",this.handleDeviceChange)},componentWillReceiveProps:function(e){var t=i.clone(this.state);this.props.reaction!==e.reaction&&this.updateDraft(t,e);var n=i.shallowDiff(t,this.state);i.isEmpty(n)||this.setState(n)},updateDraft:function(e,t){t.reaction?e.draft=t.reaction:e.draft=E(t.story,t.currentUser)},render:function(){return o.createElement("div",{className:"comment-editor"},o.createElement("div",{className:"profile-image-column"},this.renderProfileImage()),o.createElement("div",{className:"editor-column"},o.createElement("div",{className:"controls"},o.createElement("div",{className:"textarea"},this.renderTextArea()),o.createElement("div",{className:"buttons"},this.renderMediaButtons(),this.renderActionButtons())),o.createElement("div",{className:"media"},this.renderMedia())))},renderProfileImage:function(){var e={user:this.props.currentUser,theme:this.props.theme,size:"small"};return o.createElement(k,e)},renderTextArea:function(){var e=this.props.locale.languageCode,t=e.substr(0,2),n=i.get(this.state.draft,["details","text",t],""),r={ref:"textarea",value:n,lang:t,onChange:this.handleTextChange};return o.createElement(g,r)},renderMediaButtons:function(){var e=this.props.locale.translate,t={tooltip:e("story-photo"),icon:"camera",hidden:!this.state.hasCamera,onClick:this.handlePhotoClick},n={tooltip:e("story-video"),icon:"video-camera",hidden:!this.state.hasCamera,onClick:this.handleVideoClick},r={tooltip:e("story-audio"),icon:"microphone",hidden:!this.state.hasMicrophone,onClick:this.handleAudioClick},s={tooltip:e("story-file"),icon:"file",onChange:this.handleFileSelect},a=i.get(this.state.draft,"details.markdown",!1),c={tooltip:e("story-markdown"),icon:"pencil-square",highlighted:a,onClick:this.handleMarkdownClick};return o.createElement("div",{className:"media-buttons"},o.createElement(y,t),o.createElement(y,n),o.createElement(y,r),o.createElement(y.File,s),o.createElement(y,c),this.props.cornerPopUp)},renderActionButtons:function(){var e=this.props.locale.translate,t=i.isEmpty(i.get(this.state.draft,"details.text")),n=i.isEmpty(i.get(this.state.draft,"details.resources")),r=i.get(this.state.draft,"published",!1),s={label:e("story-cancel"),onClick:this.handleCancelClick,disabled:r},a={label:e("story-post"),onClick:this.handlePublishClick,emphasized:!0,disabled:t&&n||r};return o.createElement("div",{className:"action-buttons"},o.createElement(b,s),o.createElement(b,a))},renderMedia:function(){var e=(this.props.locale.translate,{ref:this.components.setters.mediaEditor,resources:i.get(this.state.draft,"details.resources"),locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleResourcesChange});return o.createElement(x,e)},componentWillUnmount:function(){l.removeEventListener("change",this.handleDeviceChange)},focus:function(){var e=this.refs.textarea;e&&e.focus()},changeDraft:function(e){var t=this;return new s(function(n,r){t.setState({draft:e},function(){n(e)})})},autosaveReaction:function(e,t){var n=this;t?(this.cancelAutosave(),this.autosaveTimeout=setTimeout(function(){n.saveReaction(e)},t),this.autosaveUnloadHandler=function(){n.saveReaction(e)},window.addEventListener("beforeunload",this.autosaveUnloadHandler)):this.saveReaction(e)},cancelAutosave:function(){this.autosaveTimeout&&(clearTimeout(this.autosaveTimeout),this.autosaveTimeout=0),this.autosaveUnloadHandler&&(window.removeEventListener("beforeunload",this.autosaveUnloadHandler),this.autosaveUnloadHandler=null)},saveReaction:function(e){var t=this;this.cancelAutosave();var n=this.props.payloads;return n.prepare(e).then(function(){var r=t.props.route,i=r.parameters.server,s=r.parameters.schema,o=t.props.database.use({server:i,schema:s,by:t});return o.start().then(function(){return o.saveOne({table:"reaction"},e).then(function(e){return n.dispatch(e).return(e)})})})},removeReaction:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema;return this.props.database.use({server:n,schema:r,by:this}).removeOne({table:"reaction"},e)},triggerFinishEvent:function(){this.props.onFinish&&this.props.onFinish({type:"finish",target:this})},handleTextChange:function(e){var t=this,n=e.currentTarget.value,r=this.props.locale.languageCode,s=r.substr(0,2),o="details.text."+s,a=i.decoupleSet(this.state.draft,o,n);return this.changeDraft(a).then(function(){return t.autosaveReaction(a,5e3),null})},handlePublishClick:function(e){var t=this,n=i.clone(this.state.draft);return n.published=!0,this.changeDraft(n).then(function(){return t.saveReaction(n)}).then(function(){t.triggerFinishEvent()})},handleCancelClick:function(e){var t=this,n=this.state.draft,r=E(this.props.currentUser);return this.changeDraft(r).then(function(){return n.id?t.removeReaction(n):n}).then(function(){t.triggerFinishEvent()})},handlePhotoClick:function(e){this.components.mediaEditor.capture("image")},handleVideoClick:function(e){this.components.mediaEditor.capture("video")},handleAudioClick:function(e){this.components.mediaEditor.capture("audio")},handleFileSelect:function(e){var t=e.target.files;return this.components.mediaEditor.importFiles(t),null},handleResourcesChange:function(e){var t=this,n=i.decoupleSet(this.state.draft,"details.resources",e.resources);return this.changeDraft(n).then(function(n){var i=5e3;return r(e.resources)&&(i=0),t.autosaveReaction(n,i),null})},handleDeviceChange:function(e){this.setState({hasCamera:l.hasDevice("videoinput"),hasMicrophone:l.hasDevice("audioinput")})}});var E=c(function(e,t){return{type:"comment",story_id:e.id,user_id:t?t.id:null,target_user_ids:e.user_ids,details:{}}})},function(e,t,n){"use strict";var r=n(4),i=(n(10),n(1)),s=i.PropTypes,o=n(7),a=n(8),c=n(5),l=n(6),u=n(14),d=n(74),p=n(73);n(698),e.exports=i.createClass({displayName:"LanguageSettingsEditor",mixins:[u],propTypes:{database:s.instanceOf(o).isRequired,route:s.instanceOf(a).isRequired,locale:s.instanceOf(c).isRequired,theme:s.instanceOf(l).isRequired},getSelectedLanguageCode:function(){var e=r.split(this.props.locale.languageCode,"-");return r.lowerCase(e[0])},getSelectedCountryCode:function(){var e=r.split(this.props.locale.languageCode,"-");return r.lowerCase(e[1])},render:function(){var e=this.props.locale.translate;return i.createElement(d,{className:"language-settings-editor"},i.createElement("header",null,i.createElement("i",{className:"fa fa-language"})," ",e("settings-language")),i.createElement("body",null,this.renderList()))},renderList:function(){var e=r.filter(this.props.locale.directory,{locales:{client:!0}});return r.map(e,this.renderButton)},renderButton:function(e){var t=this.getSelectedLanguageCode(),n={label:[e.name,this.renderCountrySelect(e)],selected:e.code===t,onClick:this.handleLanguageClick,id:e.code,key:e.code};return i.createElement(p,n)},renderCountrySelect:function(e){var t=this.getSelectedLanguageCode(),n=this.getSelectedCountryCode();n||(n=e.defaultCountry);var s,o=r.map(e.countries,function(e,t){return i.createElement("option",{key:t,value:t},e)});return(e.code!==t||r.size(e.countries)<=1)&&(s={visibility:"hidden"}),i.createElement("select",{key:1,value:n,style:s,onChange:this.handleCountryChange},o)},handleLanguageClick:function(e){var t=e.currentTarget.id;if(t!==this.getSelectedLanguageCode()){var n=r.find(this.props.locale.directory,{code:t}),i=n.code+"-"+n.defaultCountry;this.props.locale.change(i)}},handleCountryChange:function(e){var t=e.currentTarget.value;if(t!==this.getSelectedCountryCode()){var n=this.getSelectedLanguageCode(),r=n+"-"+t;this.props.locale.change(r)}}})},function(e,t,n){"use strict";var r=(n(4),n(10),n(1)),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(74);n(700),e.exports=r.createClass({displayName:"NotificationPreferencesEditor",mixins:[l],propTypes:{currentUser:i.arrayOf(i.object).isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){var e=this.props.locale.translate;return r.createElement(u,null,r.createElement("header",null,r.createElement("i",{className:"fa fa-exclamation-circle"})," ",e("settings-notification")),r.createElement("footer",null))}})},function(e,t,n){"use strict";var r=(n(4),n(10),n(1)),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(74),d=n(21);n(701),e.exports=r.createClass({displayName:"ProjectSettingsEditor",mixins:[l],propTypes:{projects:i.arrayOf(i.object).isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){var e=this.props.locale.translate;return r.createElement(u,null,r.createElement("header",null,r.createElement("i",{className:"fa fa-database"})," ",e("settings-projects")),r.createElement("footer",null,this.renderButtons()))},renderButtons:function(){var e={label:"Add..."},t={label:"Remove"};return r.createElement("div",null,r.createElement(d,e),r.createElement(d,t))}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(41),u=n(38),d=n(73),p=n(93);n(702),e.exports=r.createClass({displayName:"StoryEditorOptions",propTypes:{inMenu:i.bool,section:i.oneOf(["main","supplemental","both"]),story:i.object.isRequired,options:i.object.isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onChange:i.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{selectingRecipients:!1,renderingDialogBox:!1}},canHideStory:function(){if(this.props.currentUser){var e=this.props.story,t=this.props.currentUser.type;if("guest"!==t){if("admin"===t)return!0;var n=this.props.currentUser.id;if(_.includes(e.user_ids,n))return!0}}return!1},canAddIssue:function(){if(this.props.currentUser){var e=this.props.currentUser.type;if("member"===e||"admin"===e)return!0}return!1},canSendBookmarks:function(){return!0},render:function(){if(this.props.inMenu)return r.createElement("div",{className:"editor-options in-menu"},this.renderButtons(this.props.section));var e=this.props.locale.translate;return r.createElement(l,{className:"editor-options"},r.createElement("header",null,r.createElement(u,{icon:"chevron-circle-right",label:e("story-options"),disabled:!0})),r.createElement("body",null,this.renderButtons("main"),this.renderButtons("supplemental")))},renderButtons:function(e){var t=this.props.locale.translate,n=this.props.options;if("main"===e){var i=_.get(this.props.currentUser,"id"),s=_.includes(n.bookmarkRecipients,i),o=_.without(n.bookmarkRecipients,i),a={label:t("option-bookmark-story"),selected:s,onClick:this.handleBookmarkClick},c={label:_.isEmpty(o)?t("option-send-bookmarks"):t("option-send-bookmarks-to-$count-users",_.size(o)),hidden:!this.canSendBookmarks(),selected:!_.isEmpty(o),onClick:this.handleSendBookmarkClick},l={label:t("option-add-issue"),selected:n.addIssue,hidden:this.canAddIssue(),onClick:this.handleAddIssueClick},u={label:t("option-hide-post"),selected:n.hidePost,hidden:this.canHideStory(),onClick:this.handleHidePostClick};return r.createElement("div",{className:e},r.createElement(d,a),r.createElement(d,c),r.createElement(d,l),r.createElement(d,u),this.renderUserSelectionDialogBox())}if("supplemental"===e){var p={label:t("option-show-media"),selected:"media"===n.supplementalEditor||!n.supplementalEditor,onClick:this.handleShowMediaClick},h={label:t("option-show-preview"),selected:"preview"===n.supplementalEditor,onClick:this.handleShowPreviewClick};return r.createElement("div",{className:e},r.createElement(d,p),r.createElement(d,h))}},renderUserSelectionDialogBox:function(){var e={show:this.state.selectingRecipients,selection:this.props.options.bookmarkRecipients,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleRecipientsSelect,onCancel:this.handleRecipientsCancel};return r.createElement(p,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,options:e})},openSelectionDialogBox:function(){this.setState({selectingRecipients:!0,renderingDialogBox:!0})},closeSelectionDialogBox:function(){var e=this;this.setState({selectingRecipients:!1}),setTimeout(function(){e.state.selectingRecipients||e.setState({renderingDialogBox:!1})},1e3)},handleBookmarkClick:function(e){var t=_.clone(this.props.options),n=this.props.currentUser.id;_.includes(t.bookmarkRecipients,n)?t.bookmarkRecipients=_.difference(t.bookmarkRecipients,[n]):t.bookmarkRecipients=_.union(t.bookmarkRecipients,[n]),this.triggerChangeEvent(t)},handleSendBookmarkClick:function(e){this.openSelectionDialogBox()},handleAddIssueClick:function(e){var t=_.clone(this.props.options);t.addIssue=!t.addIssue,this.triggerChangeEvent(t)},handleHidePostClick:function(e){var t=_.clone(this.props.options);t.hidePost=!t.hidePost,this.triggerChangeEvent(t)},handleRecipientsSelect:function(e){var t=_.clone(this.props.options);t.bookmarkRecipients=e.selection,this.triggerChangeEvent(t),this.openSelectionDialogBox()},handleRecipientsCancel:function(e){this.openSelectionDialogBox()},handleShowMediaClick:function(e){var t=_.clone(this.props.options);t.supplementalEditor="media",this.triggerChangeEvent(t)},handleShowPreviewClick:function(e){var t=_.clone(this.props.options);t.supplementalEditor="preview",this.triggerChangeEvent(t)}})},function(e,t,n){"use strict";var r=n(4),i=(n(10),n(1)),s=i.PropTypes,o=n(77),a=n(32),c=n(7),l=n(8),u=n(5),d=n(6),p=n(19),h=n(14),m=n(41),f=n(38),v=n(144),g=n(137);n(704),e.exports=i.createClass({displayName:"StoryMediaEditor",mixins:[h],propTypes:{story:s.object.isRequired,cornerPopUp:s.element,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired,payloads:s.instanceOf(p).isRequired,onChange:s.func.isRequired},getInitialState:function(){return this.components=a({mediaEditor:g}),{hasCamera:o.hasDevice("videoinput"),hasMicrophone:o.hasDevice("audioinput")}},componentWillMount:function(){document.addEventListener("paste",this.handlePaste),o.addEventListener("change",this.handleDeviceChange)},render:function(){return i.createElement(m,{className:"media-editor"},i.createElement("header",null,this.renderButtons()),i.createElement("body",null,i.createElement(v,{onDrop:this.handleDrop},this.renderResources())))},renderButtons:function(){var e=this.props.locale.translate,t={label:e("story-photo"),icon:"camera",hidden:!this.state.hasCamera,onClick:this.handlePhotoClick},n={label:e("story-video"),icon:"video-camera",hidden:!this.state.hasCamera,onClick:this.handleVideoClick},r={label:e("story-audio"),icon:"microphone",hidden:!this.state.hasMicrophone,onClick:this.handleAudioClick},s={label:e("story-file"),icon:"file",multiple:!0,onChange:this.handleFileSelect};return i.createElement("div",null,i.createElement(f,t),i.createElement(f,n),i.createElement(f,r),i.createElement(f.File,s),this.props.cornerPopUp)},renderResources:function(){var e=this.props.locale.translate,t={ref:this.components.setters.mediaEditor,resources:r.get(this.props.story,"details.resources"),locale:this.props.locale,theme:this.props.theme,payloads:this.props.payloads,onChange:this.handleResourcesChange};return i.createElement(g,t,i.createElement("div",{className:"message"},e("story-drop-files-here")))},componentWillUnmount:function(){document.removeEventListener("paste",this.handlePaste),o.removeEventListener("change",this.handleDeviceChange)},handlePhotoClick:function(e){this.components.mediaEditor.capture("image")},handleVideoClick:function(e){this.components.mediaEditor.capture("video")},handleAudioClick:function(e){this.components.mediaEditor.capture("audio")},handleFileSelect:function(e){var t=e.target.files;return this.components.mediaEditor.importFiles(t),null},handleDrop:function(e){return this.components.mediaEditor.importFiles(e.files),this.components.mediaEditor.importDataItems(e.items),null},handlePaste:function(e){var t=e.clipboardData.files;return r.isEmpty(t)||(e.preventDefault(),this.components.mediaEditor.importFiles(t)),null},handleResourcesChange:function(e){var t="details.resources",n=r.decoupleSet(this.props.story,t,e.resources);return r.isEmpty(n.details.resources)&&delete n.details.resources,this.props.onChange({type:"change",target:this,story:n,path:t})},handleDeviceChange:function(e){this.setState({hasCamera:o.hasDevice("videoinput"),hasMicrophone:o.hasDevice("audioinput")})}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(402),o=n(7),a=n(8),c=n(5),l=n(6),u=n(14),d=n(41),p=n(98),h=(n(60),n(21)),m=n(31),f=n(93),v=n(149),g=n(99);n(705),e.exports=r.createClass({displayName:"StoryTextEditor",mixins:[u],propTypes:{story:i.object.isRequired,authors:i.arrayOf(i.object),options:i.object.isRequired,cornerPopUp:i.element,database:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired,onChange:i.func,onPublish:i.func,onCancel:i.func},getInitialState:function(){return{selectingCoauthor:!1}},render:function(){return r.createElement(d,{className:"text-editor"},r.createElement("header",null,this.renderProfileImage(),this.renderAuthorNames(),this.props.cornerPopUp),r.createElement("subheader",null,this.renderCoauthoringButtons(),this.renderUserSelectionDialogBox()),r.createElement("body",null,this.renderTextArea()),r.createElement("footer",null,this.renderButtons()))},renderProfileImage:function(){var e={user:_.get(this.props.authors,0),theme:this.props.theme,size:"medium"};return r.createElement(m,e)},renderAuthorNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,i=this.props.authors,s=_.map(i,function(e){return n(e.details.name,e.details.gender)});switch(s.length){case 0:e=" ";break;case 1:e=""+s[0];break;case 2:e=t("story-author-$name1-and-$name2",s[0],s[1]);break;default:var o=_.slice(i,1),a={users:o,label:t("story-author-$count-others",o.length),title:t("story-coauthors"),locale:this.props.locale,theme:this.props.theme,key:1},c=r.createElement(p,a);e=t("story-author-$name-and-$users",s[0],c,o.length)}return r.createElement("span",{className:"name"},e)},renderCoauthoringButtons:function(){var e,t=this.props.locale.translate;return e=t(this.props.story.user_ids.length>1?"story-add-remove-coauthor":"story-add-coauthor"),r.createElement("div",null,r.createElement("span",{className:"button",onClick:this.handleCoauthoringClick},r.createElement("i",{className:"fa fa-plus-square"}),r.createElement("span",{className:"label"},e)))},renderUserSelectionDialogBox:function(){var e={show:this.state.selectingCoauthor,selection:this.props.story.user_ids,disabled:_.slice(this.props.story.user_ids,0,1),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleCoauthoringSelect,onCancel:this.handleCoauthoringCancel};return r.createElement(f,e)},renderTextArea:function(){var e=this.props.options.languageCode,t=e.substr(0,2),n=_.get(this.props.story,["details","text",t],""),i={value:n,lang:t,onChange:this.handleTextChange};return r.createElement(v,i)},renderButtons:function(){var e=this.props.locale.translate,t=_.isEmpty(_.get(this.props.story,"details.text")),n=_.isEmpty(_.get(this.props.story,"details.resources")),i=_.get(this.props.story,"published",!1),s={label:e("story-cancel"),onClick:this.props.onCancel,disabled:t&&n||i},o={label:e("story-post"),onClick:this.props.onPublish,emphasized:!0,disabled:t&&n||i};return r.createElement("div",{className:"buttons"},r.createElement(h,s),r.createElement(h,o))},triggerChangeEvent:function(e,t){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e,path:t})},handleCoauthoringClick:function(e){this.setState({selectingCoauthor:!0})},handleCoauthoringCancel:function(e){this.setState({selectingCoauthor:!1})},handleCoauthoringSelect:function(e){var t=_.decoupleSet(this.props.story,"user_ids",e.selection);this.triggerChangeEvent(t,"user_ids"),this.setState({selectingCoauthor:!1})},handleTextChange:function(e){var t=e.currentTarget.value,n=this.props.options.languageCode,r=n.substr(0,2),i="details.text."+r,o=_.decoupleSet(this.props.story,i,t);o.details.text=_.pickBy(o.details.text,"length"),_.isEmpty(o.details.text)&&(o.details=_.omit(o.details,"text")),void 0===o.details.markdown&&g.hasMarkdownFormatting(o)&&(o.details.markdown=!0),o.type||g.hasLists(o)&&(o.type="task-list"),o.tags=s.findTags(o.details.text),this.triggerChangeEvent(o,i)}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(41),d=n(38),p=n(99);n(706),e.exports=r.createClass({displayName:"StoryTextPreview",mixins:[l],propTypes:{story:i.object.isRequired,authors:i.arrayOf(i.object),options:i.object.isRequired,cornerPopUp:i.element,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onChange:i.func},getInitialState:function(){return{}},render:function(){return r.createElement(u,{className:"text-preview"},r.createElement("header",null,this.renderButtons()),r.createElement("body",null,this.renderText()))},renderButtons:function(){var e=this.props.locale.translate,t=_.get(this.props.story,"type"),n=_.get(this.props.story,"details.markdown",!1),i={label:e("story-markdown"),icon:"pencil-square",highlighted:n,onClick:this.handleMarkdownClick},s={label:e("story-task-list"),icon:"list-ol",highlighted:"task-list"===t,onClick:this.handleTaskListClick},o={label:e("story-survey"),icon:"list-ul",highlighted:"survey"===t,onClick:this.handleSurveyClick};return r.createElement("div",null,r.createElement(d,i),r.createElement(d,s),r.createElement(d,o),this.props.cornerPopUp)},renderText:function(){var e={story:this.props.story,locale:this.props.locale,theme:this.props.theme,options:this.props.options,onItemChange:this.handleItemChange};return r.createElement(p,e)},triggerChangeEvent:function(e,t){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e,path:t})},attachListTemplate:function(e){"task-list"!==e.type&&"survey"!==e.type||p.hasLists(e)||p.addListTemplate(e,this.props.locale)},handleMarkdownClick:function(e){var t=_.decouple(this.props.story,"details");t.details.markdown=!t.details.markdown,this.triggerChangeEvent(t,"story.details.markdown")},handleTaskListClick:function(e){var t=_.clone(this.props.story);t.type="task-list"!==t.type?"task-list":"story",this.attachListTemplate(t),this.triggerChangeEvent(t,"story.details.markdown")},handleSurveyClick:function(e){var t=_.clone(this.props.story);t.type="survey"!==t.type?"survey":"story",this.attachListTemplate(t),this.triggerChangeEvent(t,"story.type")},handleItemChange:function(e){var t=e.target,n=_.clone(this.props.story);p.updateList(n,t),this.triggerChangeEvent(n,"story.details.text")}})},function(e,t,n){"use strict";var r=(n(4),n(10),n(1)),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(74);n(21);n(707),e.exports=r.createClass({displayName:"UserProfileEditor",mixins:[l],propTypes:{currentUser:i.arrayOf(i.object).isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){var e=this.props.locale.translate;return r.createElement(u,null,r.createElement("header",null,r.createElement("i",{className:"fa fa-user-circle"})," ",e("settings-user-profile")),r.createElement("footer",null))}})},function(e,t,n){"use strict";function r(e,t){var n=i.flatten(i.map(e,"user_ids"));return t&&n.push(t.id),i.uniq(n)}var i=n(4),s=(n(10),n(1)),o=s.PropTypes,a=n(18),c=n(22),l=(n(76),n(7)),u=n(19),d=n(8),p=n(5),h=n(6),m=n(14),f=n(59),v=n(365),g=n(143),b=(n(94),n(138));n(708),e.exports=a.createClass({displayName:"BookmarkList",propTypes:{bookmarks:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(d).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(h).isRequired},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,o=t.parameters.schema,a=this.props.database.use({server:n,schema:o,by:this}),c=k(this.props.currentUser),l={stories:null,authors:c,draftStories:null,draftAuthors:c,senders:null,reactions:null,respondents:null,recommendations:null,recipients:null,repos:null,bookmarks:this.props.bookmarks,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(s.createElement(y,l),250),a.start().then(function(e){var t={};return t.id=i.map(l.bookmarks,"story_id"),a.find({table:"story",criteria:t})}).then(function(e){l.stories=e}).then(function(){var e={};return e.id=i.uniq(i.flatten(i.map(l.stories,"user_ids"))),a.find({schema:"global",table:"user",criteria:e})}).then(function(t){l.authors=t,e.show(s.createElement(y,l))}).then(function(){var e={};return e.id=i.flatten(i.map(l.bookmarks,"user_ids")),a.find({schema:"global",table:"user",criteria:e})}).then(function(t){l.senders=t,e.show(s.createElement(y,l))}).then(function(){var e={};return e.story_id=i.map(l.stories,"id"),a.find({table:"reaction",criteria:e})}).then(function(t){l.reactions=t,e.show(s.createElement(y,l))}).then(function(){var e={};return e.id=i.map(l.reactions,"user_id"),a.find({schema:"global",table:"user",criteria:e})}).then(function(t){l.respondents=t,e.show(s.createElement(y,l))}).then(function(){if(l.currentUser){var e={published:!1,user_ids:[l.currentUser.id]};return a.find({table:"story",criteria:e})}}).then(function(t){t&&(l.draftStories=t,e.show(s.createElement(y,l)))}).then(function(){var e=r(l.draftStories,l.currentUser);if(e.length>1){var t={id:e};return a.find({schema:"global",table:"user",criteria:t})}}).then(function(e){e&&(l.draftAuthors=e)}).then(function(){if(l.currentUser){var e={story_id:i.map(l.stories,"id"),user_ids:[l.currentUser.id]};return a.find({table:"bookmark",criteria:e})}}).then(function(t){l.recommendations=t,e.show(s.createElement(y,l))}).then(function(){if(l.recommendations){var e={id:i.map(l.recommendations,"target_user_id")};return a.find({schema:"global",table:"user",criteria:e})}}).then(function(t){l.recipients=t,e.show(s.createElement(y,l))}).then(function(){var e=i.uniq(i.filter(i.map(l.stories,"repo_id")));if(!i.isEmpty(e)){var t={id:e};return a.find({schema:"global",table:"repo",criteria:t})}}).then(function(e){return l.repos=e,s.createElement(y,l)})}});var y=e.exports.Sync=s.createClass({displayName:"BookmarkList.Sync",mixins:[m],propTypes:{bookmarks:o.arrayOf(o.object),senders:o.arrayOf(o.object),stories:o.arrayOf(o.object),authors:o.arrayOf(o.object),draftStories:o.arrayOf(o.object),draftAuthors:o.arrayOf(o.object),reactions:o.arrayOf(o.object),respondents:o.arrayOf(o.object),recommendations:o.arrayOf(o.object),recipients:o.arrayOf(o.object),repos:o.arrayOf(o.object),currentUser:o.object,database:o.instanceOf(l).isRequired,payloads:o.instanceOf(u).isRequired,route:o.instanceOf(d).isRequired,locale:o.instanceOf(p).isRequired,theme:o.instanceOf(h).isRequired,loading:o.bool},render:function(){return s.createElement("div",{className:"story-list"},this.renderBookmarks())},renderBookmarks:function(){var e=x(this.props.bookmarks);return i.map(e,this.renderBookmark)},renderBookmark:function(e,t){var n=E(this.props.stories,e),r=S(this.props.senders,e),i={bookmark:e,senders:r,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(f,{key:e.id,type:"bookmarks",initial:t<10},s.createElement(v,i,this.renderStory(n)))},renderStory:function(e){if(e){var t=i.find(this.props.draftStories,{published_version_id:e.id});if(t)return this.renderEditor(t);var n=C(this.props.reactions,e),r=w(this.props.authors,e),o=R(this.props.respondents,n),a=N(this.props.recommendations,e),c=O(this.props.recipients,a),l=_(this.props.repos,e),u={story:e,reactions:n,authors:r,respondents:o,recommendations:a,recipients:c,repo:l,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(g,u)}},renderEditor:function(e,t){var n=w(this.props.draftAuthors,e),r=N(this.props.recommendations,e),i=O(this.props.recipients,r);e||(n=k(this.props.currentUser));var o={story:e,authors:n,recommendations:r,recipients:i,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(b,o)}}),k=c(function(e){return[e]}),x=c(function(e){return i.orderBy(e,["id"],["desc"])}),E=c(function(e,t){return t?i.find(e,{id:t.story_id}):null}),C=c(function(e,t){return t?i.filter(e,{story_id:t.id}):[]}),w=c(function(e,t){return t?i.filter(i.map(t.user_ids,function(t){return i.find(e,{id:t})})):[]}),S=w,R=c(function(e,t){var n=i.uniq(i.map(t,"user_id"));return i.filter(i.map(n,function(t){return i.find(e,{id:t})}))}),N=c(function(e,t){if(t){var n=t.published_version_id||t.id;return i.filter(e,{story_id:n})}return[]}),O=c(function(e,t){return i.filter(e,function(e){return i.some(t,{target_user_id:e.id})})}),_=c(function(e,t){return t&&t.repo_id?i.find(e,{id:t.repo_id}):null})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(22),a=(n(76),n(7)),c=n(19),l=n(8),u=n(5),d=n(6),p=n(14),h=(n(59),n(366)),m=n(347),f=n(48);n(709),e.exports=i.createClass({displayName:"CommentList",mixins:[p],propTypes:{showingEditor:s.bool,story:s.object.isRequired,reactions:s.arrayOf(s.object),respondents:s.arrayOf(s.object),repo:s.object,currentUser:s.object,database:s.instanceOf(a).isRequired,payloads:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired,onFinish:s.func},getDefaultProps:function(){return{showingEditor:!0}},render:function(){return i.createElement("div",{className:"comment-list"},i.createElement(f,null,this.renderReactions()))},renderReactions:function(){var e=this,t=v(this.props.reactions,this.props.currentUser);if(t=r.filter(t,function(e){return!e.published_version_id}),this.props.showEditor){r.some(this.props.reactions,function(t){if(t.user_id===e.props.currentUser.id&&!t.published)return!0})||t.unshift(null)}return r.map(t,this.renderReaction)},renderReaction:function(e,t,n){var r=!1;return e?e.published||e.user_id===this.props.currentUser.id&&(r=!0):r=!0,r?this.renderEditor(e,0===t):this.renderView(e)},renderView:function(e){var t=b(this.props.respondents,e),n=g(this.props.reactions,e),r={reaction:e,respondent:t,story:this.props.story,repo:this.props.repo,beingEdited:!!n,currentUser:this.props.currentUser,route:this.props.route,locale:this.props.locale,theme:this.props.theme,key:e.id};return i.createElement(h,r)},renderEditor:function(e,t){var n=(g(this.props.reactions,e),{reaction:e,story:this.props.story,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,key:t?0:e.id,ref:t?"last":void 0,onFinish:this.props.onFinish});return i.createElement(m,n)},focus:function(){var e=this.refs.last;e&&e.focus()}});var v=o(function(e,t){var n=function(e){return e.user_id===t};return r.orderBy(e,["published","ptime",n,"id"],["asc","desc","desc","desc"])}),g=o(function(e,t){return t?r.find(e,{published_version_id:t.id}):null}),b=o(function(e,t){return t?r.find(e,{id:t.user_id}):null})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=n(22),c=(n(76),n(7)),l=n(8),u=n(5),d=n(6),p=n(14),h=(n(59),n(367));n(710),e.exports=o.createClass({displayName:"NotificationList",propTypes:{reactions:s.arrayOf(s.object),database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,s=t.parameters.schema,o=this.props.database.use({server:n,schema:s,by:this}),a={respondents:null,stories:null,reactions:this.props.reactions,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(m,a),250),o.start().then(function(e){var t={};return t.id=r.uniq(r.map(a.reactions,"user_id")),o.find({schema:"global",table:"user",criteria:t})}).then(function(t){a.respondents=t,e.show(i.createElement(m,a))}).then(function(){var e={};return e.id=r.uniq(r.map(a.reactions,"story_id")),o.find({table:"story",criteria:e})}).then(function(e){return a.stories=e,i.createElement(m,a)})}});var m=e.exports.Sync=i.createClass({displayName:"NotificationList.Sync",mixins:[p],propTypes:{reactions:s.arrayOf(s.object),respondents:s.arrayOf(s.object),stories:s.arrayOf(s.object),database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},render:function(){var e=f(this.props.reactions);return i.createElement("div",{className:"notification-list"},r.map(e,this.renderReaction))},renderReaction:function(e){var t=g(this.props.respondents,e),n=v(this.props.stories,e),r={reaction:e,respondent:t,story:n,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,key:e.id};return i.createElement(h,r)}}),f=a(function(e){return r.orderBy(e,["ptime"],["desc"])}),v=a(function(e,t){return t?r.find(e,{id:t.story_id}):null}),g=a(function(e,t){return t?r.find(e,{id:t.user_id}):null})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=n(22),c=n(0),l=n(7),u=n(8),d=n(5),p=n(6),h=n(14),m=n(59),f=n(374);n(712),e.exports=o.createClass({displayName:"UserList",propTypes:{users:s.arrayOf(s.object).isRequired,currentUser:s.object.isRequired,database:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,s=t.parameters.schema,o=this.props.database.use({server:n,schema:s,by:this}),a={roles:null,dailyActivities:null,listings:null,stories:null,users:this.props.users,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return e.show(i.createElement(v,a),250),o.start().then(function(e){var t=r.flatten(r.map(a.users,"role_ids")),n={id:r.uniq(t)};return o.find({schema:"global",table:"role",criteria:n})}).then(function(t){a.roles=t,e.show(i.createElement(v,a))}).then(function(){var e=c(),t=e.clone().endOf("month"),n=e.clone().startOf("month").subtract(1,"month"),i="["+n.toISOString()+","+t.toISOString()+"]",s={type:"daily-activities",filters:r.map(a.users,function(e){return{user_ids:[e.id],time_range:i}})};return o.find({table:"statistics",criteria:s})}).then(function(t){a.dailyActivities=t,e.show(i.createElement(v,a))}).then(function(){var e={type:"news",target_user_id:a.currentUser.id,filters:r.map(a.users,function(e){return{user_ids:[e.id]}})};return o.find({table:"listing",criteria:e})}).then(function(e){a.listings=e}).then(function(){var e=r.flatten(r.map(a.listings,"story_ids")),t={id:r.uniq(e)};return o.find({table:"story",criteria:t})}).then(function(e){return a.stories=e,i.createElement(v,a)})}});var v=e.exports.Sync=i.createClass({displayName:"UserList.Sync",mixins:[h],propTypes:{users:s.arrayOf(s.object).isRequired,roles:s.arrayOf(s.object),dailyActivities:s.arrayOf(s.object),listings:s.arrayOf(s.object),stories:s.arrayOf(s.object),currentUser:s.object.isRequired,database:s.instanceOf(l).isRequired,route:s.instanceOf(u).isRequired,locale:s.instanceOf(d).isRequired,theme:s.instanceOf(p).isRequired,loading:s.bool},render:function(){var e=g(this.props.users,this.props.locale);return i.createElement("div",{className:"user-list"},r.map(e,this.renderUser))},renderUser:function(e,t){var n=b(this.props.roles,e),r=y(this.props.dailyActivities,e),s=k(this.props.listings,e),o=x(this.props.stories,s),a={user:e,roles:n,dailyActivities:r,stories:o,currentUser:this.props.currentUser,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,key:e.id};return i.createElement(m,{key:e.id,type:"users",initial:t<10},i.createElement(f,a))}}),g=a(function(e,t){var n=t.pick,i=function(e){return n(e.details.name)};return r.orderBy(e,[i],["asc"])}),b=a(function(e,t){return t?r.filter(r.map(t.role_ids,function(t){return r.find(e,{id:t})})):[]}),y=a(function(e,t){return t?r.find(e,function(e){return e.filters.user_ids[0]===t.id}):null}),k=a(function(e,t){return t?r.find(e,function(e){if(e.filters.user_ids[0]===t.id)return!0}):null}),x=a(function(e,t){if(t){var n=r.keyBy(e,"id");return r.filter(r.map(t.story_ids,function(e){return n[e]}))}return[]})},function(e,t,n){"use strict";function r(e){var t=e.locale.pick,n=["user"];e.selected&&n.push("selected"),e.disabled&&n.push("disabled");var r=t(e.user.details.name),i={className:n.join(" "),"data-user-id":e.user.id,onClick:e.disabled?null:e.onClick},o={user:e.user,theme:e.theme,size:"small"};return s.createElement("div",i,s.createElement(h,o),s.createElement("span",{className:"name"},r),s.createElement("i",{className:"fa fa-check-circle"}))}var i=n(4),s=n(1),o=s.PropTypes,a=n(18),c=n(22),l=n(7),u=n(8),d=n(5),p=n(6),h=n(31);n(713),e.exports=a.createClass({displayName:"UserSelectionList",propTypes:{selection:o.arrayOf(o.number),disabled:o.arrayOf(o.number),database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired,onSelect:o.func},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this}),o={users:null,selection:this.props.selection,disabled:this.props.disabled,locale:this.props.locale,theme:this.props.theme,onSelect:this.props.onSelect,loading:!0};return e.show(s.createElement(m,o),250),i.start().then(function(e){var t={hidden:!1};return i.find({schema:"global",table:"user",criteria:t})}).then(function(e){return o.users=e,o.loading=!1,s.createElement(m,o)})}});var m=e.exports.Sync=s.createClass({displayName:"UserSelectionList.Sync",propTypes:{users:o.arrayOf(o.object),selection:o.arrayOf(o.number),disabled:o.arrayOf(o.number),locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired,onSelect:o.func},render:function(){var e=f(this.props.users,this.props.locale);return s.createElement("div",{className:"user-selection-list"},i.map(e,this.renderUser))},renderUser:function(e){var t={user:e,selected:i.includes(this.props.selection,e.id),disabled:i.includes(this.props.disabled,e.id),locale:this.props.locale,theme:this.props.theme,onClick:this.handleUserClick,key:e.id};return s.createElement(r,t)},triggerSelectEvent:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,selection:e})},handleUserClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-user-id")),n=this.props.selection;n=i.includes(n,t)?i.difference(n,[t]):i.union(n,[t]),this.triggerSelectEvent(n)}}),f=c(function(e,t){var n=t.pick,r=function(e){return n(e.details.name)};return i.orderBy(e,[r],["asc"])})},function(e,t,n){"use strict";function r(e){var t=document.getElementById("app-container");if(!t)throw new Error("Unable to find app element in DOM");var n=i.createElement(o);s.render(n,t)}var i=n(1),s=n(72),o=n(333);window.addEventListener("load",r)},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6);n(715),e.exports=r.createClass({displayName:"ErrorPage",propTypes:{database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},statics:{parseUrl:function(e){return o.match("/error/:errorCode/?",e)},getUrl:function(e){return"/error/"+e.errorCode+"/"}},render:function(){var e=this.props.route.parameters.errorCode;return r.createElement("div",null,e)}})},function(e,t,n){"use strict";function r(e){switch(e){case"facebook":return"facebook-official";default:return e}}var i=n(10),s=n(1),o=s.PropTypes,a=n(18),c=(n(58),n(22)),l=n(7),u=n(8),d=n(5),p=n(6),h=n(48),m=n(343);n(719),e.exports=a.createClass({displayName:"StartPage",propTypes:{canAccessServer:o.bool,canAccessSchema:o.bool,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired,onEntry:o.func,onExit:o.func,onAvailableSchemas:o.func},statics:{parseUrl:function(e){return u.match("//:server/start/?",e)||u.match("/start/?",e)},getUrl:function(e){var t=e.server,n="/start/";return t&&(n="//${server}"+n),n}},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,r=this.props.database.use({server:n,schema:"global",by:this}),i={currentUser:null,system:null,providers:null,projects:null,canAccessServer:this.props.canAccessServer,canAccessSchema:this.props.canAccessSchema,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onEntry:this.props.onEntry,onExit:this.props.onExit,onAvailableSchemas:this.props.onAvailableSchemas,onOAuthEnd:this.handleOAuthEnd};if(this.props.canAccessServer){e.show(s.createElement(f,i));var o;return r.start().then(function(e){o=e;var t={};return r.findOne({table:"system",criteria:t})}).then(function(t){i.system=t,e.show(s.createElement(f,i),250)}).then(function(){var e={};return r.find({table:"project",criteria:e})}).then(function(t){i.projects=t,e.show(s.createElement(f,i))}).then(function(){var e={id:o};return r.findOne({table:"user",criteria:e})}).then(function(e){return i.currentUser=e,s.createElement(f,i)})}return e.show(s.createElement(f,i),250),r.beginAuthorization("client").then(function(e){return i.system=e.system,i.providers=e.providers,s.createElement(f,i)})},handleOAuthEnd:function(){var e=this.props.route,t=e.parameters.server;this.props.database.use({server:t,by:this}).checkAuthorizationStatus()}});var f=e.exports.Sync=s.createClass({displayName:"StartPage.Sync",propTypes:{currentUser:o.object,system:o.object,providers:o.arrayOf(o.object),projects:o.arrayOf(o.object),canAccessServer:o.bool,canAccessSchema:o.bool,database:o.instanceOf(l).isRequired,route:o.instanceOf(u).isRequired,locale:o.instanceOf(d).isRequired,theme:o.instanceOf(p).isRequired,onEntry:o.func,onExit:o.func,onAvailableSchemas:o.func},getInitialState:function(){return{transition:null,selectedProjectId:0,newProjectNames:[]}},isMember:function(e){var t=this.props.currentUser;return!!t&&_.includes(e.user_ids,t.id)},isPendingMember:function(e){var t=this.props.currentUser;return!!t&&_.includes(t.requested_project_ids,e.id)},hasReadAccess:function(e){if(this.isMember(e))return!0;if(this.isPendingMember(e)){var t=_.get(e.settings,"access_control",{}),n=this.props.currentUser.type;if("member"===n)return t.grant_team_members_read_only;if("guest"===n)return currentUser.approved?t.grant_approved_guest_read_only:t.grant_unapproved_guest_read_only}return!1},render:function(){var e,t=this.props.locale.translate;if(this.props.system){var n=_.get(this.props.system,"details.resources"),r=_.find(n,{type:"image"});if(r){e={backgroundImage:"url("+this.props.theme.getImageUrl(r,{width:1024,quality:40})+")"}}}var i=["start-page"];return this.state.transition&&i.push(this.state.transition),s.createElement("div",{className:i.join(" "),style:e},s.createElement("div",{className:"bar"},s.createElement("h1",{className:"welcome"},t("start-welcome")),s.createElement("div",{className:"content-area"},this.renderDescription(),this.renderButtons())),this.renderProjectDialog())},renderDescription:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.system;if(!n)return null;var r=t(n.details.title)||e("start-system-title-default"),i=t(n.details.description);return s.createElement("div",{className:"section description"},s.createElement("h2",null,r),s.createElement("p",null,i))},renderButtons:function(){return this.props.canAccessServer?this.renderProjectButtons():this.renderOAuthButtons()},renderOAuthButtons:function(){var e=this.props.locale.translate,t=this.props.providers;return t?s.createElement("div",{className:"section buttons"},s.createElement("h2",null,e("start-social-login")),s.createElement("p",null,_.map(t,this.renderOAuthButton))):null},renderOAuthButton:function(e,t){var n=this.props.locale.translate,i=this.props.locale.pick,o=i(e.details.title)||n("server-type-"+e.type),a=r(e.type);return s.createElement("a",{key:t,className:"oauth-button",href:e.url,onClick:this.handleOAuthButtonClick},s.createElement("i",{className:"fa fa-fw fa-"+a}),s.createElement("span",{className:"label"},o))},renderProjectButtons:function(){var e=this.props.locale.translate,t=v(this.props.projects,this.props.locale);return t?s.createElement("div",{className:"section buttons"},s.createElement("h2",null,e("start-projects")),s.createElement(h,null,_.map(t,this.renderProjectButton))):null},renderProjectButton:function(e,t){var r,i=(this.props.locale.translate,this.props.locale.pick),o=i(e.details.title)||e.name,a=i(e.details.description),c=_.get(e,"details.resources"),l=_.find(c,{type:"image"});if(l){var u=this.props.theme.getImageUrl(l,{width:56,height:56});r=s.createElement("img",{src:u})}else{var d=n(757),p=e.id%5+1;r=s.createElement("div",{className:"default v"+p},s.createElement(d,null))}var h;this.isMember(e)?h=s.createElement("i",{className:"fa fa-user-circle-o badge"}):this.isPendingMember(e)&&(h=s.createElement("i",{className:"fa fa-clock-o badge"}));var m={key:t,"data-project-id":e.id,className:"project-button"};return this.hasReadAccess(e)?m.href=n(37).getUrl({server:this.props.route.parameters.server,schema:e.name}):m.onClick=this.handleProjectButtonClick,s.createElement("a",m,s.createElement("div",{className:"icon"},r),s.createElement("div",{className:"text"},h,s.createElement("div",{className:"title"},o),s.createElement("div",{className:"description"},s.createElement("div",{className:"contents"},a,s.createElement("div",{className:"ellipsis"},"...")))))},renderProjectDialog:function(){if(!this.state.renderingProjectDialog)return null;var e=_.find(this.props.projects,{id:this.state.selectedProjectId});if(!e)return null;var t={show:this.state.showingProjectDialog,currentUser:this.props.currentUser,project:e,member:this.isMember(e),pendingMember:this.isPendingMember(e),readAccess:this.hasReadAccess(e),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onConfirm:this.handleMembershipRequestConfirm,onClose:this.handleMembershipRequestClose,onProceed:this.handleMembershipRequestProceed};return s.createElement(m,t)},componentDidUpdate:function(t,n){var r=this;if(t.projects!==this.props.projects||t.currentUser!==this.props.currentUser){var i=_.filter(this.props.projects,function(e){return r.hasReadAccess(e)});_.isEmpty(i)||this.props.onAvailableSchemas&&this.props.onAvailableSchemas({type:"available_schema",target:this,schemas:_.map(i,"name")})}t.route===this.props.route&&t.canAccessServer===this.props.canAccessServer&&t.canAccessSchema===this.props.canAccessSchema||this.props.route.component!==e.exports&&this.props.canAccessSchema&&this.props.canAccessServer&&this.transitionOut()},componentDidMount:function(){this.props.onEntry&&this.props.onEntry({type:"entry",target:this})},transitionOut:function(){var e=this,t="fast",n=1300,r=this.props.route.parameters.schema;_.includes(this.state.newProjectNames,r)&&(t="slow",n=3700),this.setState({transition:"transition-out-"+t},function(){setTimeout(function(){e.props.onExit&&e.props.onExit({type:"exit",target:e})},n)})},openPopUpWindow:function(e){return new i(function(t,n){var r={width:800,height:600,left:window.screenLeft+Math.round((window.outerWidth-800)/2),top:window.screenTop+Math.round((window.outerHeight-600)/2),toolbar:"no",menubar:"no",status:"no"},i=_.map(r,function(e,t){return t+"="+e}),s=window.open(e,"login",i.join(","));if(s){s.location=e;var o=setInterval(function(){s.closed&&(clearInterval(o),t())},50)}else n(new Error("Unable to open popup"))})},triggerOAuthEndEvent:function(){this.props.onOAuthEnd&&this.props.onOAuthEnd({type:"oauthended",target:this})},handleOAuthButtonClick:function(e){var t=this,n=e.currentTarget.getAttribute("href");return e.preventDefault(),this.openPopUpWindow(n).then(function(){t.triggerOAuthEndEvent()})},handleProjectButtonClick:function(e){var t=parseInt(e.currentTarget.getAttribute("data-project-id"));this.setState({selectedProjectId:t,showingProjectDialog:!0,renderingProjectDialog:!0})},handleMembershipRequestConfirm:function(e){var t=this,n=this.state.selectedProjectId,r=_.find(this.props.projects,{id:n}),i=this.props.currentUser.requested_project_ids,s={id:this.props.currentUser.id,requested_project_ids:_.union(i,[n])},o=this.props.route,a=o.parameters.server;return this.props.database.use({server:a,by:this}).saveOne({schema:"global",table:"user"},s).then(function(){var e=_.union(t.state.newProjectNames,[r.name]);t.setState({newProjectNames:e})})},handleMembershipRequestClose:function(e){var t=this;this.setState({showingProjectDialog:!1}),setTimeout(function(){t.setState({renderingProjectDialog:!1})},500)},handleMembershipRequestProceed:function(e){this.setState({showingProjectDialog:!1,renderingProjectDialog:!1});var t=this.state.selectedProjectId,r=_.find(this.props.projects,{id:t}),i=n(37).getUrl({server:this.props.route.parameters.server,schema:r.name});this.props.route.change(i)}}),v=c(function(e,t){var n=t.pick;return _.sortBy(e,function(e){return n(e.details.title)||e.name})})},function(e,t,n){"use strict";var r=(n(4),n(1)),i=r.PropTypes,s=n(110),o=n(6),a=n(5);n(720),e.exports=r.createClass({displayName:"AppComponent",propTypes:{component:i.object.isRequired,theme:i.instanceOf(o),locale:i.instanceOf(a),onSelect:i.func},render:function(){return r.createElement("div",{className:"app-component",onClick:this.handleClick},this.renderPicture(),this.renderText())},renderPicture:function(){var e=this.props.component;if(e.image){var t=this.props.theme.getImageUrl(e.image);return r.createElement("div",{className:"picture"},r.createElement("img",{src:t}))}var n=e.icon||{},i=n.class||"fa-cubes",s={color:n.color,backgroundColor:n["background-color"]};return r.createElement("div",{className:"picture"},r.createElement("div",{className:"icon",style:s},r.createElement("i",{className:"fa fa-fw "+i})))},renderText:function(){var e=this.props.locale.pick,t=e(this.props.component.text),n=s.parse(t);return r.createElement("div",{className:"text"},r.createElement("div",{className:"text-contents"},n,r.createElement("div",{className:"ellipsis"},"...")))},handleClick:function(e){this.props.onSelect&&this.props.onSelect({type:"select",target:this,component:this.props.component})}})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(7),a=n(8),c=n(5),l=n(6),u=n(98);n(721),e.exports=i.createClass({displayName:"BookmarkView",propTypes:{bookmark:s.object,senders:s.arrayOf(s.object),currentUser:s.object,database:s.instanceOf(o).isRequired,route:s.instanceOf(a).isRequired,locale:s.instanceOf(c).isRequired,theme:s.instanceOf(l).isRequired},render:function(){return i.createElement("div",{className:"bookmark-view"},i.createElement("div",{className:"title"},this.renderSenderNames(),this.renderCloseButton()),i.createElement("div",{className:"contents"},this.props.children))},renderSenderNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,s=r.get(this.props.currentUser,"id"),o=r.some(this.props.senders,{id:s}),a=r.filter(this.props.senders,function(e){return e.id!==s});if(o)switch(a.length){case 0:e=t("bookmark-you-bookmarked-it");break;case 1:var c=n(a[0].details.name,a[0].details.gender);e=t("bookmark-you-bookmarked-it-and-$name-recommends-it",c);break;default:var l={users:a,label:t("bookmark-$count-users",a.length),title:t("bookmark-recommendations"),locale:this.props.locale,theme:this.props.theme,key:1},d=i.createElement(u,l);e=t("bookmark-you-bookmarked-it-and-$users-recommends-it",d,a.length)}else switch(a.length){case 1:var c=n(a[0].details.name,a[0].details.gender);e=t("bookmark-$name-recommends-this",c);break;case 2:var p=n(a[0].details.name,a[0].details.gender);n(a[1].details.name,a[1].details.gender);e=t("bookmark-$name1-and-$name2-recommend-this",p);break;default:var c=n(a[0].details.name,a[0].details.gender),h=r.slice(a,1),l={users:h,label:t("bookmark-$count-other-users",h.length),title:t("bookmark-recommendations"),locale:this.props.locale,theme:this.props.theme,key:1},d=i.createElement(u,l);e=t("bookmark-$name-and-$users-recommend-this",c,d,h.length)}return i.createElement("span",{className:"name"},e)},renderCloseButton:function(){return i.createElement("div",{className:"close-btn",onClick:this.handleCloseClick},i.createElement("i",{className:"fa fa-close"}))},removeBookmark:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema;return this.props.database.use({server:n,schema:r,by:this}).removeOne({table:"bookmark"},e)},handleCloseClick:function(e){this.removeBookmark(this.props.bookmark)}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(8),o=n(5),a=n(6),c=n(14),l=n(31),u=n(142),d=n(60);n(722),e.exports=r.createClass({displayName:"CommentView",mixins:[c],propTypes:{reaction:i.object.isRequired,respondent:i.object,story:i.object.isRequired,currentUser:i.object.isRequired,repo:i.object,route:i.instanceOf(s).isRequired,locale:i.instanceOf(o).isRequired,theme:i.instanceOf(a).isRequired},render:function(){return r.createElement("div",{className:"comment-view"},r.createElement("div",{className:"profile-image-column"},this.renderProfileImage()),r.createElement("div",{className:"contents-column"},r.createElement("div",{className:"text"},this.renderTime(),this.renderText()),this.renderMedia()))},renderProfileImage:function(){var e={user:this.props.respondent,theme:this.props.theme,size:"small"};if(this.props.respondent)var t=this.props.route,i=n(47).getUrl({server:t.parameters.server,schema:t.parameters.schema,user:this.props.respondent.id});return r.createElement("a",{href:i},r.createElement(l,e))},renderText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=t(_.get(this.props.respondent,"details.name"));if(!this.props.reaction.published)return r.createElement("span",{className:"in-progress"},e("comment-$user-is-typing",n));switch(this.props.reaction.type){case"like":return r.createElement("span",{className:"like"},e("comment-$user-likes-this",n));case"comment":var i=_.get(this.props.reaction,"details.text");return r.createElement("span",{className:"comment"},n,": ",t(i));case"vote":return r.createElement("span",{className:"vote"},e("comment-$user-cast-a-vote",n));case"task-completion":return r.createElement("span",{className:"task-completion"},e("comment-$user-completed-a-task",n));case"note":var s,o=this.props.story.type,a=_.get(this.props.repo,"details.web_url");if(a){var c=this.props.reaction.external_id;switch(o){case"push":case"merge":s=a+"/commit/"+this.props.reaction.details.commit_id+"/";break;case"issue":var l=this.props.story.details.number;s=a+"/issues/"+l+"#note_"+c;break;case"merge-request":s=a+"/merge_requests/"+this.props.story.details.number+"#note_"+c}}return r.createElement("a",{className:"note",href:s,target:"_blank"},e("comment-$user-commented-on-"+o,n));case"assignment":var s,a=_.get(this.props.repo,"details.web_url");if(a){var l=this.props.story.details.number;s=a+"/issues/"+l}return r.createElement("a",{className:"issue-assignment",href:s,target:"_blank"},e("comment-$user-is-assigned-to-issue",n))}},renderTime:function(){var e={time:this.props.reaction.ptime,locale:this.props.locale};return r.createElement(d,e)},renderMedia:function(){var e=_.get(this.props.reaction,"details.resources");if(_.isEmpty(e))return null;var t={locale:this.props.locale,theme:this.props.theme,resources:e};return r.createElement("div",{className:"media"},r.createElement(u,t))}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(97),d=n(60),p=n(31);n(724),e.exports=r.createClass({displayName:"NotificationView",mixins:[l],propTypes:{reaction:i.object.isRequired,story:i.object,respondent:i.object,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){var e={className:"notification-view "+this.props.theme.mode,url:n(37).getUrl({server:this.props.route.parameters.server,schema:this.props.route.parameters.schema,storyId:this.props.reaction.story_id})};return r.createElement(u,e,r.createElement("div",{className:"event"},this.renderProfileImage(),this.renderText()),r.createElement("div",{className:"date"},this.renderTime(),this.renderIcon()))},renderProfileImage:function(){var e={user:this.props.respondent,theme:this.props.theme,size:"small"};return r.createElement(p,e)},renderText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,i=this.props.respondent,s=i?n(i.details.name,i.details.gender):"",o=_.get(this.props.reaction,"type"),a=_.get(this.props.story,"type")||"story";switch(o){case"like":e=t("notification-$user-likes-your-"+a,s);break;case"comment":e=t("notification-$user-commented-on-your-"+a,s);break;case"vote":e=t("notification-$user-voted-in-your-survey",s);break;case"task-completion":e=t("notification-$user-completed-task",s)}return r.createElement("span",{className:"text"},e)},renderTime:function(){var e={time:this.props.reaction.ptime,locale:this.props.locale};return r.createElement(d,e)},renderIcon:function(){var e,t=_.get(this.props.reaction,"type");switch(t){case"like":e="thumbs-up";break;case"comment":e="comment";break;case"vote":e="check-square-o";break;case"task-completion":e="star"}var n=["fa","fa-"+e];return r.createElement("i",{className:n.join(" ")})}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(19),a=n(8),c=n(5),l=n(6),u=n(14),d=n(41),p=n(38),h=n(357);n(725),e.exports=r.createClass({displayName:"StoryComments",mixins:[u],propTypes:{story:i.object.isRequired,currentUser:i.object.isRequired,reactions:i.arrayOf(i.object),respondents:i.arrayOf(i.object),repo:i.object,database:i.instanceOf(s).isRequired,payloads:i.instanceOf(o).isRequired,route:i.instanceOf(a).isRequired,locale:i.instanceOf(c).isRequired,theme:i.instanceOf(l).isRequired},getInitialState:function(){return{expanded:this.shouldExpandAutomatically(this.props),editing:_.some(this.props.reactions,{user_id:this.props.currentUserId,published:!1})}},shouldExpandAutomatically:function(e){if(e.reactions&&e.respondents){var t=_.get(this.props.currentUser,"id");return!!_.includes(e.story.user_ids,t)||!!_.some(e.reactions,{user_id:t})}},componentWillReceiveProps:function(e){if(void 0===this.state.expanded){var t=this.shouldExpandAutomatically(e);void 0!==t&&this.setState({expanded:t})}},render:function(){return r.createElement(d,{className:"comments"},r.createElement("header",null,this.renderButtons()),r.createElement("body",null,this.renderReactions()))},renderButtons:function(){var e=this.props.locale.translate,t={icon:"thumbs-up",label:e("story-like"),highlighted:!!this.getCurrentUserLike(),onClick:this.handleLikeClick},n={icon:"comment",label:e("story-comment"),highlighted:this.getCurrentUserComments().length>0||this.state.editing,onClick:this.handleCommentClick},i={className:"show-btn",hidden:!0,label:e("story-$count-user-reacted-to-story",_.size(this.props.respondents)),onClick:this.handleShowClick};return"columns-1"!==this.props.theme.mode||this.state.expanded||_.isEmpty(this.props.reactions)||(i.hidden=!1),r.createElement("div",null,r.createElement(p,t),r.createElement(p,n),r.createElement(p,i))},renderReactions:function(){if("columns-1"===this.props.theme.mode&&!this.state.expanded)return null;var e={showEditor:this.state.editing,story:this.props.story,reactions:this.props.reactions,respondents:this.props.respondents,repo:this.props.repo,currentUser:this.props.currentUser,database:this.props.database,payloads:this.props.payloads,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onFinish:this.handleCommentFinish,ref:"list"};return r.createElement(h,e)},getCurrentUserLike:function(){return _.find(this.props.reactions,{type:"like",user_id:_.get(this.props.currentUser,"id")})},getCurrentUserComments:function(){return _.filter(this.props.reactions,{type:"comment",user_id:_.get(this.props.currentUser,"id")})},handleLikeClick:function(e){var t=this.props.route,n=t.parameters.server,r=t.parameters.schema,i=this.props.database.use({server:n,schema:r,by:this}),s=this.getCurrentUserLike();s?i.removeOne({table:"reaction"},s):(s={type:"like",story_id:_.get(this.props.story,"id"),user_id:_.get(this.props.currentUser,"id"),target_user_ids:_.get(this.props.story,"user_ids"),published:!0},i.saveOne({table:"reaction"},s))},handleCommentClick:function(e){var t=this;this.setState({expanded:!0,editing:!0},function(){var e=t.refs.list;e&&setTimeout(function(){e.focus()},50)})},handleShowClick:function(e){this.setState({expanded:!0})},handleCommentFinish:function(e){var t=this;_.some(this.props.reactions,function(e){if(!e.published&&e.user_id===t.props.currentUser.id)return!0})||this.setState({editing:!1})}})},function(e,t,n){"use strict";function r(e){if(e=_.trim(e)){return o(e).format("ll")}}var i=n(1),s=i.PropTypes,o=n(0),a=n(22),c=n(7),l=n(8),u=n(5),d=n(6),p=n(146),h=n(14),m=n(41),f=n(99),v=n(31),g=n(142),b=n(98),y=n(364),k=n(340),x=n(48),E=n(60),C=n(21);n(726),e.exports=i.createClass({displayName:"StoryContents",mixins:[h],propTypes:{story:s.object.isRequired,authors:s.arrayOf(s.object),currentUser:s.object.isRequired,reactions:s.arrayOf(s.object),repo:s.object,pending:s.bool.isRequired,cornerPopUp:s.element,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired,onChange:s.func,onReaction:s.func},getInitialState:function(){return{userAnswers:f.getDefaultAnswers(this.props.story,this.props.locale),voteSubmitted:!1,selectedComponent:null,showingComponentDialog:!1,renderingComponentDialog:!1}},componentWillReceiveProps:function(e){this.props.story!==e.story&&"task-list"===this.props.story.type&&this.setState({userAnswers:f.getDefaultAnswers(e.story,e.locale)})},isCurrentUserAuthor:function(){var e=this.props.story.user_ids,t=this.props.currentUser.id;return _.includes(e,t)},hasUserVoted:function(){if(null!==this.props.reactions){return!!S(this.props.reactions,this.props.currentUser)}},render:function(){return i.createElement(m,{className:"contents"},i.createElement("header",null,this.renderProfileImage(),this.renderAuthorNames(),this.props.cornerPopUp),i.createElement("subheader",null,this.renderTime(),this.renderGraphic()),i.createElement("body",null,this.renderContents()),i.createElement("footer",null,this.renderButtons()))},renderProfileImage:function(){var e=_.get(this.props.authors,0),t={user:e,theme:this.props.theme,size:"medium"};if(e)var r=this.props.route,s=n(47).getUrl({server:r.parameters.server,schema:r.parameters.schema,user:e.id});return i.createElement("a",{href:s},i.createElement(v,t))},renderAuthorNames:function(){var e,t=this.props.locale.translate,n=this.props.locale.name,r=this.props.authors,s=_.map(r,function(e){return n(e.details.name,e.details.gender)});switch(_.size(r)){case 0:e=" ";break;case 1:e=""+s[0];break;case 2:e=t("story-author-$name1-and-$name2",s[0],s[1]);break;default:var o=_.slice(r,1),a={users:o,label:t("story-author-$count-others",o.length),title:t("story-coauthors"),locale:this.props.locale,theme:this.props.theme,key:1},c=i.createElement(b,a);e=t("story-author-$name-and-$users",s[0],c,o.length)}return i.createElement("span",{className:"name"},e)},renderTime:function(){if(this.props.pending){var e=this.props.locale.translate;return i.createElement("span",{className:"time"},e("story-pending"))}var t={time:this.props.story.ptime,locale:this.props.locale};return i.createElement(E,t)},renderGraphic:function(){var e=this.props.story.type,t="graphic";if(!_.includes(p.git,e))return null;t+=" git";var n=p.icons[e];if("issue"===e){var r=this.props.story.details.state;n=p.icons[e+"."+r]}return n?i.createElement("div",{className:t},i.createElement(n,{className:e})):null},renderContents:function(){return i.createElement("div",null,this.renderText(),this.renderMedia(),this.renderAppComponents())},renderText:function(){this.props.locale.translate,this.props.locale.pick;switch(this.props.story.type){case"repo":return this.renderRepoText();case"member":return this.renderMemberText();case"push":case"merge":return this.renderPushText();case"issue":return this.renderIssueText();case"milestone":return this.renderMilestoneText();case"wiki":return this.renderWikiText();default:return this.renderStoryText()}},renderStoryText:function(){var e={story:this.props.story,locale:this.props.locale,theme:this.props.theme,answers:this.state.userAnswers,readOnly:!this.isCurrentUserAuthor(),onItemChange:this.handleItemChange};return"survey"===this.props.story.type&&this.hasUserVoted()&&(e.voteCounts=w(this.props.reactions)),i.createElement(f,e)},renderRepoText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.story,r=n.details.action,s=t(_.get(this.props.repo,"details.title"))||_.get(this.props.repo,"name"),o=_.get(this.props.repo,"details.web_url");return i.createElement("div",{className:"repo"},i.createElement("p",null,i.createElement("a",{href:o,target:"_blank"},e("story-repo-"+r+"-$name",s))))},renderMemberText:function(){var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.story,r=n.details.action,s=t(_.get(this.props.repo,"details.title"))||_.get(this.props.repo,"name"),o=_.get(this.props.repo,"details.web_url");return i.createElement("div",{className:"member"},i.createElement("p",null,i.createElement("a",{href:o,target:"_blank"},e("story-member-"+r+"-$repo",s))))},renderIssueText:function(){for(var e=this.props.locale.translate,t=this.props.locale.pick,n=this.props.story,r=n.details.number,s=n.details.title,o=n.details.state,a=this.props.repo,c=_.map(n.details.labels,function(e,t){var n;if(a){var r=_.indexOf(a.details.labels,e),s=_.get(a.details.label_colors,r);s&&(n={backgroundColor:s})}return i.createElement("span",{key:t,className:"tag",style:n},e)}),l=1;l<c.length;l+=2)c.splice(l,0," ");var u,d=_.get(this.props.repo,"details.web_url");if(d){u=d+"/issues/"+this.props.story.external_id}return i.createElement("div",{className:"issue"},i.createElement("p",null,i.createElement("a",{href:u,target:"_blank"},e("story-issue-opened-$number-$title",r,t(s)))),i.createElement("p",{className:"status-"+o},i.createElement("span",null,e("story-issue-current-status"))," ",i.createElement("span",null,e("story-issue-status-"+o))),i.createElement("p",null,c))},renderMilestoneText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,s=this.props.story,o=(s.details.state,s.details.title),a=r(s.details.due_date),c=r(s.details.start_date)||"-",l=_.get(this.props.repo,"details.web_url");if(l){e=l+"/milestones/"+this.props.story.external_id}return i.createElement("div",{className:"milestone"},i.createElement("p",null,i.createElement("a",{href:e,target:"_blank"},t("story-milestone-created-$name",n(o)))),i.createElement("p",{className:"start-date"},i.createElement("span",null,t("story-milestone-start-date"))," ",i.createElement("span",null,c)),i.createElement("p",{className:"due-date"},i.createElement("span",{className:"label"},t("story-milestone-due-date"))," ",i.createElement("span",null,a)))},renderWikiText:function(){var e=this.props.locale.translate,t=this.props.story,n=t.details.url,r=_.capitalize(t.details.title),s=t.details.action+"d";return"deleted"===s&&(n=void 0),i.createElement("div",{className:"wiki"},i.createElement("p",null,i.createElement("a",{href:n,target:"_blank"},e("story-wiki-"+s+"-page-with-$title",r))))},renderPushText:function(){var e,t=this.props.locale.translate,n=this.props.locale.pick,r=this.props.story,s=_.get(this.props.story,"details.files"),o=_.get(this.props.story,"details.lines"),a=(_.get(this.props.story,"details.commit_ids.length"),n(_.get(this.props.repo,"details.title"))||_.get(this.props.repo,"name")),c=r.details.branch,l=["added","removed","modified","renamed"],u=_.transform(l,function(e,n,r){var o=s[n];o>0&&e.push(i.createElement("li",{key:r,className:n},t("story-push-"+n+"-$count-files",o)))},[]),d=["added","removed"],p=_.transform(d,function(e,n,r){var s=o[n];s>0&&e.push(i.createElement("li",{key:r,className:n},t("story-push-"+n+"-$count-lines",s)))},[]),h=_.get(this.props.repo,"details.web_url");if(h){var m=r.details.commit_id_before,f=r.details.commit_id_after;e=1===r.details.commit_ids.length?h+"/commit/"+f:h+"/compare/"+m+"..."+f}var v;if("push"===r.type)v=t("story-push-pushed-to-$branch-of-$repo",c,a);else if("merge"===r.type){var g=r.details.source_branches;v=t("story-push-merged-$branches-into-$branch-of-$repo",g,c,a)}return i.createElement("div",{className:"push"},i.createElement("p",null,i.createElement("a",{href:e,target:"_blank"},v)),i.createElement("div",null,i.createElement("ul",{className:"files"},u),i.createElement("ul",{className:"lines"},p)))},renderButtons:function(){if("survey"!==this.props.story.type)return null;if(!1!==this.hasUserVoted())return null;var e=this.props.locale.translate,t={label:e("story-vote-submit"),emphasized:!_.isEmpty(this.state.userAnswers),disabled:this.state.voteSubmitted||_.isEmpty(this.state.userAnswers),onClick:this.handleVoteSubmitClick};return i.createElement("div",{className:"buttons"},i.createElement(C,t))},renderMedia:function(){var e=_.get(this.props.story,"details.resources");if(_.isEmpty(e))return null;var t={locale:this.props.locale,theme:this.props.theme,resources:e};return i.createElement(g,t)},renderAppComponents:function(){var e=_.get(this.props.story,"details.components");return _.isEmpty(e)?null:i.createElement("div",{className:"impact"},i.createElement("p",null,"The following components were impacted:"),i.createElement(x,null,_.map(e,this.renderAppComponent)),this.renderAppComponentDialog())},renderAppComponent:function(e,t){var n={key:t,component:e,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleComponentSelect};return i.createElement(y,n)},renderAppComponentDialog:function(){if(!this.state.renderingComponentDialog)return null;var e={show:this.state.showingComponentDialog,component:this.state.selectedComponent,locale:this.props.locale,theme:this.props.theme,onClose:this.handleComponentDialogClose};return i.createElement(k,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,story:e})},triggerReactionEvent:function(e){this.props.onReaction&&this.props.onReaction({type:"reaction",target:this,reaction:e})},handleItemChange:function(e){var t=e.currentTarget;if("task-list"===this.props.story.type){if(!this.isCurrentUserAuthor())return!1;var n=t.name,r=t.value,i=t.checked,s=_.decoupleSet(this.state.userAnswers,[n,r],i);this.setState({userAnswers:s});var o=_.clone(this.props.story);f.updateList(o,t),this.triggerChangeEvent(o)}else if("survey"===this.props.story.type){var n=t.name,a=parseInt(t.value),s=_.decoupleSet(this.state.userAnswers,[n],a);this.setState({userAnswers:s})}},handleVoteSubmitClick:function(e){var t=this.props.story,n={type:"vote",story_id:t.id,user_id:this.props.currentUser.id,target_user_ids:t.user_ids,published:!0,details:{answers:this.state.userAnswers}};this.triggerReactionEvent(n),this.setState({voteSubmitted:!0})},handleComponentSelect:function(e){this.setState({renderingComponentDialog:!0,showingComponentDialog:!0,selectedComponent:e.component})},handleComponentDialogClose:function(e){var t=this;this.setState({showingComponentDialog:!1},function(){setTimeout(function(){t.state.showingComponentDialog||t.setState({renderingComponentDialog:!1,selectedComponent:null})},500)})}});var w=a(function(e){var t={};return _.each(e,function(e){"vote"===e.type&&_.forIn(e.details.answers,function(e,n){var r=[n,"total"],i=_.get(t,r,0)+1;_.set(t,r,i);var s=[n,"answers",e],o=_.get(t,s,0)+1;_.set(t,s,o)})}),t}),S=a(function(e,t){return t?_.find(e,{type:"vote",user_id:t.id}):null})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(0),o=n(146),a=n(7),c=n(8),l=n(5),u=n(6),d=n(41),p=n(38),h=n(73),m=n(93);n(727),e.exports=r.createClass({displayName:"StoryViewOptions",propTypes:{inMenu:i.bool,section:i.oneOf(["main","supplemental","both"]),story:i.object.isRequired,currentUser:i.object.isRequired,options:i.object.isRequired,database:i.instanceOf(a).isRequired,route:i.instanceOf(c).isRequired,locale:i.instanceOf(l).isRequired,theme:i.instanceOf(u).isRequired,onChange:i.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{selectingRecipients:!1,renderingDialogBox:!1}},canHideStory:function(){var e=this.props.story,t=this.props.currentUser.type;if("guest"!==t){if("admin"===t)return!0;var n=this.props.currentUser.id;if(_.includes(e.user_ids,n))return!0}return!1},canEditStory:function(){var e=this.props.story;if(_.includes(o.editable,e.type)){var t=this.props.currentUser.id;if(_.includes(e.user_ids,t)&&s()<s(e.ptime).add(3,"day"))return!0}return!1},canRemoveStory:function(){var e=this.props.story,t=this.props.currentUser.id,n=this.props.currentUser.type;return!(!_.includes(e.user_ids,t)&&"admin"!==n||!(s()<s(e.ptime).add(3,"day")))},canBumpStory:function(){var e=this.props.story,t=this.props.currentUser.id,n=this.props.currentUser.type;return!(!_.includes(e.user_ids,t)&&"admin"!==n||!(s()>s(e.btime||e.ptime).add(1,"day")))},canAddIssue:function(){var e=this.props.story;if(_.includes(o.trackable,e.type)){var t=this.props.currentUser.type;if("member"===t||"admin"===t)return!0}return!1},canSendBookmarks:function(){return!0},render:function(){if(this.props.inMenu)return r.createElement("div",{className:"view-options in-menu"},this.renderButtons(this.props.section));var e=this.props.locale.translate;return r.createElement(d,{className:"view-options"},r.createElement("header",null,r.createElement(p,{icon:"chevron-circle-right",label:e("story-options"),disabled:!0})),r.createElement("body",null,this.renderButtons("main")))},renderButtons:function(e){var t=this.props.locale.translate,n=this.props.options;if("main"===e){var i=this.props.currentUser.id,s=_.includes(n.bookmarkRecipients,i),o=_.without(n.bookmarkRecipients,i),a={label:t("option-bookmark-story"),selected:s,onClick:this.handleBookmarkClick},c={label:_.isEmpty(o)?t("option-send-bookmarks"):t("option-send-bookmarks-to-$count-users",_.size(o)),hidden:!this.canSendBookmarks(),selected:!_.isEmpty(o),onClick:this.handleSendBookmarkClick},l={label:t("option-add-issue"),hidden:!this.canAddIssue(),selected:n.addIssue,onClick:this.handleAddIssueClick},u={label:t("option-hide-post"),hidden:!this.canHideStory(),selected:n.hidePost,onClick:this.handleHidePostClick},d={label:t("option-edit-post"),hidden:!this.canEditStory(),selected:n.editPost,onClick:this.handleEditPostClick},p={label:t("option-remove-post"),hidden:!this.canRemoveStory(),selected:n.removePost,onClick:this.handleRemovePostClick},m={label:t("option-bump-post"),hidden:!this.canBumpStory(),selected:n.bumpPost,onClick:this.handleBumpPostClick};return r.createElement("div",{className:e},r.createElement(h,a),r.createElement(h,c),r.createElement(h,l),r.createElement(h,u),r.createElement(h,d),r.createElement(h,p),r.createElement(h,m),this.renderUserSelectionDialogBox())}},renderUserSelectionDialogBox:function(){if(!this.state.renderingDialogBox)return null;var e={show:this.state.selectingRecipients,selection:this.props.options.bookmarkRecipients,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme,onSelect:this.handleRecipientsSelect,onCancel:this.handleRecipientsCancel};return r.createElement(m,e)},triggerChangeEvent:function(e){this.props.onChange&&this.props.onChange({type:"change",target:this,options:e})},openSelectionDialogBox:function(){this.setState({selectingRecipients:!0,renderingDialogBox:!0})},closeSelectionDialogBox:function(){var e=this;this.setState({selectingRecipients:!1}),setTimeout(function(){e.state.selectingRecipients||e.setState({renderingDialogBox:!1})},1e3)},handleBookmarkClick:function(e){var t=_.clone(this.props.options),n=this.props.currentUser.id;_.includes(t.bookmarkRecipients,n)?t.bookmarkRecipients=_.difference(t.bookmarkRecipients,[n]):t.bookmarkRecipients=_.union(t.bookmarkRecipients,[n]),this.triggerChangeEvent(t)},handleSendBookmarkClick:function(e){this.openSelectionDialogBox()},handleAddIssueClick:function(e){var t=_.clone(this.props.options);t.addIssue=!t.addIssue,this.triggerChangeEvent(t)},handleHidePostClick:function(e){var t=_.clone(this.props.options);t.hidePost=!t.hidePost,this.triggerChangeEvent(t)},handleEditPostClick:function(e){var t=_.clone(this.props.options);t.editPost=!0,this.triggerChangeEvent(t)},handleRemovePostClick:function(e){var t=_.clone(this.props.options);t.removePost=!0,this.triggerChangeEvent(t)},handleBumpPostClick:function(e){var t=_.clone(this.props.options);t.bumpPost=!0,this.triggerChangeEvent(t)},handleRecipientsSelect:function(e){var t=_.clone(this.props.options);t.bookmarkRecipients=e.selection,this.triggerChangeEvent(t),this.closeSelectionDialogBox()},handleRecipientsCancel:function(e){this.closeSelectionDialogBox()}})},function(e,t,n){"use strict";function r(e){return s.createElement("div",{className:"item"},s.createElement("svg",{className:"ct-chart-bar",viewBox:"0 0 10 10",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{className:"ct-series ct-series-"+e.series},s.createElement("line",{className:"ct-bar",x1:0,y1:5,x2:10,y2:5}))),s.createElement("span",{className:"label"},e.label))}var i=n(4),s=n(1),o=s.PropTypes,a=n(403),c=n(0),l=n(148),u=n(22),d=n(7),p=n(8),h=n(5),m=n(6),f=n(100),v=n(38);n(729),e.exports=s.createClass({displayName:"UserStatistics",propTypes:{user:o.object.isRequired,dailyActivities:o.object,database:o.instanceOf(d).isRequired,route:o.instanceOf(p).isRequired,locale:o.instanceOf(h).isRequired,theme:o.instanceOf(m).isRequired},getInitialState:function(){var e=g[this.props.user.id];return e||{chartType:"bar",showingContents:!1}},isShowingContents:function(){return!(!this.state.showingContents&&"columns-1"===this.props.theme.mode)},render:function(){return s.createElement(f,{className:"statistics"},s.createElement("header",null,this.renderButtons()),s.createElement("body",null,this.renderLegend(),this.renderChart()))},renderButtons:function(){var e=this.props.locale.translate,t=this.isShowingContents(),n={label:e("statistics-bar"),icon:"bar-chart",highlighted:t&&"bar"===this.state.chartType,onClick:this.handleBarChartClick},r={label:e("statistics-line"),icon:"line-chart",highlighted:t&&"line"===this.state.chartType,onClick:this.handleLineChartClick},i={label:e("statistics-pie"),icon:"pie-chart",highlighted:t&&"pie"===this.state.chartType,onClick:this.handlePieChartClick};return s.createElement("div",null,s.createElement(v,n),s.createElement(v,r),s.createElement(v,i))},renderLegend:function(){if(!this.isShowingContents())return null;var e=this.props.locale.translate,t=i.get(this.props.dailyActivities,"details",{}),n=b(l.today,14),o=k(t,n),a=i.map(o,function(t,n){var i={series:String.fromCharCode("a".charCodeAt(0)+t),label:e("user-statistics-legend-"+n),key:t};return s.createElement(r,i)});return i.isEmpty(a)&&(a=" "),s.createElement("div",{className:"legend"},a)},renderChart:function(){if(!this.isShowingContents())return null;switch(this.state.chartType){case"bar":return this.renderBarChart();case"line":return this.renderLineChart();case"pie":return this.renderPieChart()}},renderBarChart:function(){var e=i.get(this.props.dailyActivities,"details",{}),t=b(l.today,14),n=x(e,t),r=E(n,!0),o=C(t,this.props.locale.languageCode),c={type:"bar",data:{labels:o,series:n},options:{stackBars:!0,axisY:{labelInterpolationFnc:function(e){return e}},high:r,low:0}};return s.createElement(a,c)},renderLineChart:function(){var e=i.get(this.props.dailyActivities,"details",{}),t=b(l.today,14),n=x(e,t),r=E(n,!1),o=C(t,this.props.locale.languageCode),c={type:"line",data:{labels:o,series:n},options:{fullWidth:!0,chartPadding:{right:10},showPoint:!1,high:r,low:0}};return s.createElement(a,c)},renderPieChart:function(){var e=i.get(this.props.dailyActivities,"details",{}),t=b(l.today,14),n=x(e,t),r=i.map(n,i.sum),o={type:"pie",data:{series:r},options:{labelInterpolationFnc:function(e){if(e)return e}}};return s.createElement(a,o)},componentDidMount:function(){l.addEventListener("change",this.handleDateChange)},componentWillUnmount:function(){l.removeEventListener("change",this.handleDateChange),g[this.props.user.id]=this.state},handleBarChartClick:function(e){this.setState({chartType:"bar",showingContents:!0})},handleLineChartClick:function(e){this.setState({chartType:"line",showingContents:!0})},handlePieChartClick:function(e){this.setState({chartType:"pie",showingContents:!0})},handleDateChange:function(e){this.forceUpdate()}});var g={},b=function(e,t){var n=c(e),r=i.times(t,function(){var e=n.format("YYYY-MM-DD");return n.subtract(1,"day"),e});return i.reverse(r)},y=["push","merge","issue","wiki","milestone","story","survey","task-list"],k=u(function(e,t){var n={};i.each(t,function(t){var r=e[t];i.forIn(r,function(e,t){e&&(n[t]=!0)})});var r={};return i.each(y,function(e,t){n[e]&&(r[e]=t)}),r}),x=u(function(e,t){return i.map(y,function(n){var r=!0,s=i.map(t,function(t){var s=i.get(e,[t,n],0);return s&&(r=!1),s});return r?[]:s})}),E=u(function(e,t){var n=0;if(t){var r=[];i.each(e,function(e){i.each(e,function(e,t){r[t]=r[t]?r[t]+e:e})}),i.isEmpty(r)||(n=i.max(r))}else i.each(e,function(e){var t=i.max(e);t>n&&(n=t)});return n<=20?20:n<=50?50:100*Math.ceil(n/100)}),C=u(function(e,t){return i.map(e,function(e){return c(e).format("dd")})})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(100),d=n(31),p=n(60),h=n(97);n(730),e.exports=r.createClass({displayName:"UserSummary",mixins:[l],propTypes:{user:i.object.isRequired,roles:i.arrayOf(i.object),stories:i.arrayOf(i.object),cornerPopUp:i.element,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},getUrl:function(e){var t=this.props.route,r=t.parameters.server,i=t.parameters.schema,s=this.props.user;return n(47).getUrl({server:r,schema:i,user:s.id,storyId:e?e.id:0})},render:function(){return r.createElement(u,{className:"summary"},r.createElement("header",null,this.renderProfileImage(),this.renderRoles(),this.props.cornerPopUp),r.createElement("subheader",null,this.renderName(),this.renderTag()),r.createElement("body",null,this.renderRecentActivities()),r.createElement("footer",null,this.renderMoreLink()))},renderProfileImage:function(){var e={user:this.props.user,theme:this.props.theme,size:"large"};return r.createElement(d,e)},renderRoles:function(){var e=this.props.locale.pick,t=_.map(this.props.roles,function(t){return e(t.details.title)||t.name});return r.createElement("span",{className:"roles"},t.join(", ")||" ")},renderName:function(){var e=this.props.locale.pick,t=this.props.user,n=e(t.details.name);return r.createElement("h2",{className:"name"},n)},renderTag:function(){var e=(this.props.locale.translate,this.props.user),t="@"+e.username;return r.createElement("h3",{className:"tag",ref:"tag",onClick:this.handleTagClick},t)},renderRecentActivities:function(){var e=_.slice(this.props.stories).reverse();return e=_.slice(e,0,5),r.createElement("div",null,_.map(e,this.renderActivity))},renderActivity:function(e){var t,n=this.props.locale.translate,i=this.props.locale.pick,s=i(this.props.user.details.name);switch(e.type){case"push":t=n("user-summary-$name-pushed-code",s);break;case"merge":t=n("user-summary-$name-merged-code",s);break;case"issue":t=n("user-summary-$name-opened-an-issue",s);break;case"milestone":t=n("user-summary-$name-created-a-milestone",s);break;case"wiki":t=n("user-summary-$name-edited-wiki-page",s);break;case"member":case"repo":t=n("user-summary-$name-"+e.details.action+"-repo",s);break;case"story":var o=e.details.resources;t=_.some(o,{type:"image"})?n("user-summary-$name-posted-a-picture",s):_.some(o,{type:"video"})?n("user-summary-$name-posted-a-video-clip",s):_.some(o,{type:"audio"})?n("user-summary-$name-posted-an-audio-clip",s):_.some(o,{type:"website"})?n("user-summary-$name-posted-a-link",s):n("user-summary-$name-wrote-a-post",s);break;case"survey":t=n("user-summary-$name-started-survey",s);break;case"task-list":t=n("user-summary-$name-started-task-list",s)}var a=this.getUrl(e);return r.createElement("div",{className:"activity",key:e.id},r.createElement(h,{url:a},t),r.createElement(p,{time:e.ptime,locale:this.props.locale}))},renderMoreLink:function(){if(_.isEmpty(this.props.stories))return null;var e=this.props.locale.translate,t=this.getUrl();return r.createElement(h,{url:t},e("user-summary-more"))},handleTagClick:function(e){var t=document.createRange();t.selectNode(this.refs.tag),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(100),u=n(38),d=n(73),p=n(345);n(731),e.exports=r.createClass({displayName:"UserViewOptions",propTypes:{inMenu:i.bool,section:i.oneOf(["main","supplemental","both"]),user:i.object.isRequired,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired,onChange:i.func},getDefaultProps:function(){return{inMenu:!1,section:"both"}},getInitialState:function(){return{showingPhoneDialog:!1,renderingPhoneDialog:!1}},render:function(){if(this.props.inMenu)return r.createElement("div",{className:"view-options in-menu"},this.renderButtons(this.props.section),this.renderPhoneDialog());var e=this.props.locale.translate;return r.createElement(l,{className:"view-options"},r.createElement("header",null,r.createElement(u,{icon:"chevron-circle-right",label:e("user-actions"),disabled:!0})),r.createElement("body",null,this.renderButtons("main"),this.renderPhoneDialog()))},renderButtons:function(e){var t=this.props.locale.translate,n=this.props.user.details;if("main"===e){var i={label:t("action-contact-by-phone"),icon:"phone-square",url:"tel:"+n.phone,hidden:!n.phone,onClick:this.handlePhoneClick},s={label:t("action-contact-by-email"),icon:"envelope",url:"mailto:"+n.email,hidden:!n.email},o={label:t("action-contact-by-skype"),icon:"skype",url:"skype:"+n.skype_username,hidden:!n.phone},a={label:t("action-contact-by-slack"),icon:"slack",url:"slack://user?team="+n.slack_team_id+"&id="+n.slack_user_id,hidden:!n.slack_user_id},c={label:t("action-contact-by-ichat"),icon:"apple",url:"ichat:"+n.ichat_username,hidden:!n.ichat_username},l={label:t("action-contact-by-twitter"),icon:"apple",url:"https://twitter.com/"+n.twitter_username,target:"_blank",hidden:!n.twitter_username},u={label:t("action-view-gitlab-page"),icon:"gitlab",url:n.gitlab_url,target:"_blank",hidden:!n.gitlab_url},p={label:t("action-view-github-page"),icon:"github",url:n.github_url,target:"_blank",hidden:!n.linkedin_username},h={label:t("action-view-linkedin-page"),icon:"linkedin",url:n.linkedin_url,target:"_blank",hidden:!n.linkedin_url},m={label:t("action-view-stackoverflow-page"),icon:"stack-overflow",url:n.stackoverflow_url,target:"_blank",hidden:!n.stackoverflow_url};return r.createElement("div",{className:e},r.createElement(d,i),r.createElement(d,s),r.createElement(d,o),r.createElement(d,a),r.createElement(d,c),r.createElement(d,l),r.createElement(d,u),r.createElement(d,p),r.createElement(d,h),r.createElement(d,m))}},renderPhoneDialog:function(){if(!this.state.renderingPhoneDialog)return null;var e={show:this.state.showingPhoneDialog,number:this.props.user.details.phone,locale:this.props.locale,onClose:this.handlePhoneDialogClose};return r.createElement(p,e)},handlePhoneClick:function(e){e.preventDefault(),this.setState({renderingPhoneDialog:!0,showingPhoneDialog:!0})},handlePhoneDialogClose:function(e){var t=this;this.setState({showingPhoneDialog:!1},function(){setTimeout(function(){t.state.showingPhoneDialog||t.setState({renderingPhoneDialog:!1})},500)})}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(7),o=n(8),a=n(5),c=n(6),l=n(14),u=n(372),d=n(371),p=n(373),h=n(96);n(732),e.exports=r.createClass({displayName:"UserView",mixins:[l],propTypes:{user:i.object.isRequired,stories:i.arrayOf(i.object),currentUser:i.object.isRequired,dailyActivities:i.object,database:i.instanceOf(s).isRequired,route:i.instanceOf(o).isRequired,locale:i.instanceOf(a).isRequired,theme:i.instanceOf(c).isRequired},render:function(){return"columns-1"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-1"},this.renderSummary(),this.renderStatistics()):"columns-2"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-2"},r.createElement("div",{className:"column-1"},this.renderSummary()),r.createElement("div",{className:"column-2"},this.renderStatistics())):"columns-3"===this.props.theme.mode?r.createElement("div",{className:"story-view columns-3"},r.createElement("div",{className:"column-1"},this.renderSummary()),r.createElement("div",{className:"column-2"},this.renderStatistics()),r.createElement("div",{className:"column-3"},this.renderOptions())):void 0},renderSummary:function(){var e={user:this.props.user,roles:this.props.roles,stories:this.props.stories,cornerPopUp:this.renderPopUpMenu("main"),database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(u,e)},renderStatistics:function(){var e={user:this.props.user,story:this.props.story,dailyActivities:this.props.dailyActivities,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(d,e)},renderPopUpMenu:function(e){return"columns-3"===this.props.theme.mode?null:r.createElement(h,null,this.renderOptions(!0,e))},renderOptions:function(e,t){var n={inMenu:e,section:t,user:this.props.user,database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return r.createElement(p,n)}})},function(e,t,n){"use strict";function r(e){var t=["button"];return e.className&&t.push(e.className),e.active&&t.push("active"),i.createElement(f,{className:t.join(" "),url:e.url},i.createElement("i",{className:"fa fa-"+e.icon})," ",i.createElement("span",{className:"label"},e.label))}var i=n(1),s=i.PropTypes,o=n(7),a=n(8),c=n(5),l=n(6),u=n(37),d=n(140),p=n(95),h=n(139),m=n(141),f=n(97);n(733),e.exports=i.createClass({displayName:"BottomNavigation",propTypes:{hidden:s.bool,database:s.instanceOf(o).isRequired,route:s.instanceOf(a).isRequired,locale:s.instanceOf(c).isRequired,theme:s.instanceOf(l).isRequired},getInitialState:function(){return{height:this.props.hidden?0:"auto"}},componentWillReceiveProps:function(e){var t=this;if(this.props.hidden!==e.hidden){var n=this.refs.container,r=n.offsetHeight;e.hidden?(this.setState({height:r}),setTimeout(function(){t.props.hidden&&t.setState({height:0})},0)):(this.setState({height:r}),setTimeout(function(){t.props.hidden||t.setState({height:"auto"})},1e3))}},render:function(){var e={height:this.state.height};return i.createElement("footer",{className:"bottom-navigation",style:e},this.renderButtons())},renderButtons:function(){var e=this.props.locale.translate,t=_.pick(this.props.route.parameters,"server","schema"),n=_.get(this.props.route.component,"navigation.bottom.section"),s={label:e("bottom-nav-news"),icon:"newspaper-o",active:"news"===n,url:u.getUrl(t),onClick:this.handleButtonClick},o={label:e("bottom-nav-notifications"),icon:"comments",active:"notifications"===n,url:p.getUrl(t),onClick:this.handleButtonClick},a={label:e("bottom-nav-bookmarks"),icon:"bookmark",active:"bookmarks"===n,url:h.getUrl(t),onClick:this.handleButtonClick},c={label:e("bottom-nav-people"),icon:"users",active:"people"===n,url:d.getUrl(t),onClick:this.handleButtonClick},l={label:e("bottom-nav-settings"),icon:"gears",active:"settings"===n,url:m.getUrl(t),onClick:this.handleButtonClick};return i.createElement("div",{ref:"container",className:"container"},i.createElement(r,s),i.createElement(r,o),i.createElement(r,a),i.createElement(r,c),i.createElement(r,l))}})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=n(0),c=n(7),l=n(8),u=n(5),d=n(37),p=n(95),h=n(47),m=(n(14),n(377));n(734),e.exports=o.createClass({displayName:"CalendarBar",propTypes:{selection:s.string,database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired},renderAsync:function(e){var t,n=this.props.route,s=n.parameters.server,o=n.parameters.schema,c=this.props.database.use({server:s,schema:o,by:this}),l={projectRange:null,dailyActivities:null,route:this.props.route,locale:this.props.locale};return e.show(i.createElement(f,l),250),c.start().then(function(e){var n={type:"story-date-range",filters:{}};return t=e,c.findOne({table:"statistics",criteria:n})}).then(function(t){l.projectRange=t,e.show(i.createElement(f,l))}).then(function(){var e=r.get(l.projectRange,"details.start_time"),i=r.get(l.projectRange,"details.end_time");if(e&&i){for(var s=a(e).startOf("month"),o=a(i).endOf("month"),u=[],m=s.clone();m.month()<=o.month();m.add(1,"month")){var f=m.toISOString(),v=m.clone().endOf("month").toISOString(),g="["+f+","+v+"]";u.push(g)}var b={};if(n.component===d)b.type="daily-activities",b.filters=r.map(u,function(e){return{time_range:e}});else if(n.component===p)b.type="daily-reactions",b.filters=r.map(u,function(e){return{target_user_ids:[t],time_range:e}});else if(n.component===h){var y=parseInt(n.parameters.userId);b.type="daily-activities",b.filters=r.map(u,function(e){return{user_ids:[y],time_range:e}})}return c.find({table:"statistics",criteria:b})}}).then(function(e){return l.dailyActivities=e,i.createElement(f,l)})}});var f=e.exports.Sync=i.createClass({displayName:"CalendarBar.Sync",propTypes:{projectRange:s.object,dailyActivities:s.arrayOf(s.object),route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired},render:function(){var e=this,t=a().endOf("month"),n=[],s=!1,o=r.get(this.props.projectRange,"details.start_time"),c=r.get(this.props.projectRange,"details.end_time");if(o&&c){var l=a(o).startOf("month"),u=a(c).endOf("month");l.year()!=u.year()&&(s=!0),t>u&&(u=t);for(var d=l.clone();d<=u;d.add(1,"month")){var p=void 0;if(this.props.dailyActivities){var h=d.toISOString(),f=d.clone().endOf("month").toISOString(),v="["+h+","+f+"]",g=r.find(this.props.dailyActivities,function(e){return e.filters.time_range===v});g&&(p=g.details)}n.push({year:d.year(),month:d.month()+1,activities:p})}}else n.push({year:t.year(),month:t.month()+1});n.reverse();var b=r.map(n,function(t,n){var r={year:t.year,month:t.month,showYear:s,selection:e.props.selection,dailyActivities:t.activities,locale:e.props.locale,onDateClick:e.handleDateClick,key:n};return i.createElement(m,r)});return i.createElement("div",{className:"calendar-bar"},b)},handleDateClick:function(e){var t=this.props.route,n=r.clone(t.parameters);n.date=e.date;var i=t.component.getUrl(n);t.change(i,!0)}})},function(e,t,n){"use strict";function r(e,t,n){return e+"-"+i(t)+"-"+i(n)}function i(e){var t=String(e);return 1===t.length&&(t="0"+t),t}var s=n(1),o=s.PropTypes,a=n(0),c=n(148),l=n(5);n(735),e.exports=s.createClass({displayName:"Calendar",propTypes:{year:o.number.isRequired,month:o.number.isRequired,showYear:o.bool,dailyActivities:o.object,selection:o.string,locale:o.instanceOf(l).isRequired,onDateClick:o.func},getDefaultProps:function(){return{showYear:!1}},render:function(){var e=a.localeData(this.props.locale.languageCode),t=this.props.year,n=this.props.month,o=this.props.dailyActivities,l=this.props.selection,u=a(r(t,n,1)),d=e.firstDayOfWeek(),p=u.daysInMonth(),h=u.day(),m=[[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null],[null,null,null,null,null,null,null]],f=0,v=h-d;v<0&&(v+=7);for(var g=1;g<=p;g++)m[f][v++]=g,v>=7&&(v=0,f++);for(var b=e.weekdaysShort(),y=[!0,!1,!1,!1,!1,!1,!0],k=0;k<d;k++)b.push(b.shift()),y.push(y.shift());var x=this.props.showYear?"MMMM YYYY":"MMMM",E=u.format(x),C=_.map(b,function(e,t){var n=[y[t]?"weekend":"workweek"];return s.createElement("th",{className:n.join(" "),key:t},e)}),w=_.map(m,function(e){return _.map(e,function(e,r){var a,u,d,p=[y[r]?"weekend":"workweek"];e?(d=t+"-"+i(n)+"-"+i(e),o&&(u=o[d]),a=e):a=" ",l&&l===d?p.push("selected"):u||p.push("disabled"),d===c.today&&p.push("today");var h={className:p.join(" "),"data-date":d,key:r};return s.createElement("td",h,a)})});return s.createElement("table",{className:"calendar",onClick:this.handleClick},s.createElement("thead",null,s.createElement("tr",{className:"title"},s.createElement("th",{colSpan:7},E)),s.createElement("tr",{className:"headings"},C)),s.createElement("tbody",null,s.createElement("tr",{className:"dates"},w[0]),s.createElement("tr",{className:"dates"},w[1]),s.createElement("tr",{className:"dates"},w[2]),s.createElement("tr",{className:"dates"},w[3]),s.createElement("tr",{className:"dates"},w[4]),s.createElement("tr",{className:"dates"},w[5])))},handleClick:function(e){var t=e.target.getAttribute("data-date");t&&this.props.onDateClick&&this.props.onDateClick({type:"dateclick",target:this,date:t})}})},function(e,t,n){"use strict";var r=n(1),i=r.PropTypes,s=n(564);e.exports=r.createClass({displayName:"QRCode",propTypes:{text:i.string.isRequired,scale:i.number},getDefaultProps:function(){return{scale:4}},render:function(){return r.createElement("canvas",{ref:"canvas",className:"qr-code"})},componentDidMount:function(){this.redraw()},componentDidUpdate:function(e,t){this.redraw()},redraw:function(){var e=this.refs.canvas,t={scale:this.props.scale};s.toCanvas(e,this.props.text,t,function(e){e&&console.error(e)})}})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(18),a=(n(0),n(22)),c=n(7),l=n(8),u=n(5),d=n(6),p=(n(14),n(380));n(744),e.exports=o.createClass({displayName:"RoleFilterBar",propTypes:{database:s.instanceOf(c).isRequired,route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},renderAsync:function(e){var t=this.props.route,n=t.parameters.server,s=t.parameters.schema,o=this.props.database.use({server:n,schema:s,by:this}),a={roles:null,users:null,project:null,locale:this.props.locale,route:this.props.route,theme:this.props.theme};return e.show(i.createElement(h,a),250),o.start().then(function(e){var t={name:s};return o.findOne({schema:"global",table:"project",criteria:t})}).then(function(e){a.project=e}).then(function(){var e={id:a.project.user_ids};return o.find({schema:"global",table:"user",criteria:e})}).then(function(e){a.users=e}).then(function(){var e=r.flatten(r.map(a.users,"role_ids")),t={id:r.uniq(e)};return o.find({schema:"global",table:"role",criteria:t})}).then(function(e){return a.roles=e,i.createElement(h,a)})}});var h=e.exports.Sync=i.createClass({displayName:"RoleFilterBar.Sync",propTypes:{project:s.object,roles:s.arrayOf(s.object),users:s.arrayOf(s.object),route:s.instanceOf(l).isRequired,locale:s.instanceOf(u).isRequired,theme:s.instanceOf(d).isRequired},getRoleIds:function(){var e=this.props.route,t=r.map(r.split(e.parameters.roles,"+"),Number);return r.filter(t)},render:function(){return i.createElement("div",{className:"role-filter-bar"},this.renderButtons())},renderButtons:function(){var e=this.props.roles;if(r.isEmpty(e)){var t={role:null!==e?null:void 0,locale:this.props.locale,theme:this.props.theme};return i.createElement(p,t)}return r.map(e,this.renderButton)},renderButton:function(e){var t=this.getRoleIds(),n=m(this.props.users,e),s={role:e,users:n,locale:this.props.locale,theme:this.props.theme,selected:r.includes(t,e.id),onRoleClick:this.handleRoleClick,key:e.id};return i.createElement(p,s)},handleRoleClick:function(e){var t=e.role,n=this.getRoleIds();r.includes(n,t.id)?r.pull(n,t.id):n.push(t.id);var i=this.props.route,s=r.clone(i.parameters);s.roles=n;var o=i.component.getUrl(s);i.change(o,!0)}}),m=a(function(e,t){return r.filter(e,function(e){return r.includes(e.role_ids,t.id)})})},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=n(5),a=n(6),c=n(31);n(745),e.exports=i.createClass({displayName:"RoleFilterButton",propTypes:{role:s.object,users:s.arrayOf(s.object),selected:s.bool,locale:s.instanceOf(o).isRequired,theme:s.instanceOf(a).isRequired,onRoleClick:s.func},render:function(){var e="role-filter-button";return this.props.selected&&(e+=" selected"),this.props.role||(e+=" no-roles"),i.createElement("div",{className:e,onClick:this.handleClick},i.createElement("div",{className:"contents"},this.renderImageRow(0,4),this.renderImageRow(0,0),this.renderImageRow(4,4),this.renderTitle()))},renderImageRow:function(e,t){var n=r.filter(this.props.users,function(e){return r.some(e.details.resources,{type:"image"})});return n=r.slice(n,e,t),i.createElement("div",{className:"row"},r.map(n,this.renderProfileImage))},renderProfileImage:function(e,t){return i.createElement(c,{key:t,user:e,size:"medium",theme:this.props.theme})},renderTitle:function(){if(!this.props.role)return this.renderMessage();var e=this.props.locale.pick,t=this.props.role;return i.createElement("div",{className:"band"},i.createElement("div",{className:"title"},e(t.details.title)||t.name,this.renderUserCount()))},renderMessage:function(){if(void 0===this.props.role)return null;var e=this.props.locale.translate;return i.createElement("div",{className:"message"},e("role-filter-no-roles"))},renderUserCount:function(){if(!this.props.users)return null;var e=this.props.users.length;return i.createElement("div",{className:"user-count"},i.createElement("i",{className:"fa fa-male"}),i.createElement("span",{className:"number"},e))},handleClick:function(e){if(!this.props.role)return null;this.props.onRoleClick&&this.props.onRoleClick({type:"roleclick",target:this,role:this.props.role})}})},function(e,t,n){"use strict";function r(e){return e=i.replace(e,/\+/g,""),e=i.replace(e,/\s+/g," "),i.split(e).join(" ")}var i=n(4),s=n(1),o=s.PropTypes,a=n(8),c=n(5);n(14);n(747),e.exports=s.createClass({displayName:"SearchBar",propTypes:{route:o.instanceOf(a),locale:o.instanceOf(c)},getInitialState:function(){return{keywords:this.props.route.query.search||""}},componentWillReceiveProps:function(e){if(this.props.route!==e.route){var t=e.route,n=this.state.keyboards,s=t.query.search||"";i.isEqual(r(n),r(s))&&this.setState({keywords:s})}},render:function(){var e=this.props.locale.translate,t={type:"text",value:this.state.keywords,onChange:this.handleChange,onKeyDown:this.handleKeyDown};return s.createElement("div",{className:"search-bar"},s.createElement("label",null,e("search-bar-keywords")),s.createElement("input",t))},performSearch:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null);var e=this.props.route,t=i.clone(e.parameters);t.search=r(this.state.keywords);var n=e.component.getUrl(t);e.change(n,!0)},handleChange:function(e){var t=e.target.value;this.setState({keywords:t}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.performSearch,800)},handleKeyDown:function(e){13===e.keyCode&&this.performSearch()}})},function(e,t,n){"use strict";function r(e){var t=["button"],n=e.onClick;return e.className&&t.push(e.className),e.active&&t.push("active"),e.disabled&&(t.push("disabled"),n=null),s.createElement("div",{className:t.join(" "),onClick:n},s.createElement("i",{className:"fa fa-"+e.icon}))}var i=n(4),s=n(1),o=s.PropTypes,a=n(7),c=n(8),l=n(5),u=n(6),d=n(150),p=n(376),h=n(379),m=n(381);n(751),e.exports=s.createClass({displayName:"TopNavigation",propTypes:{hidden:o.bool,database:o.instanceOf(a).isRequired,route:o.instanceOf(c).isRequired,locale:o.instanceOf(l).isRequired,theme:o.instanceOf(u).isRequired},getInitialState:function(){var e=this.props.route,t=null;return e.query.search?t="search":e.parameters.date?t="calendar":e.parameters.roles&&"all"!==e.parameters.roles&&(t="filter"),{selectedControl:t,expanded:!!t,height:this.props.hidden?0:"auto"}},componentWillReceiveProps:function(e){var t=this;if(this.props.hidden!==e.hidden){var n=this.refs.container,r=n.offsetHeight;e.hidden?(this.setState({height:r}),setTimeout(function(){t.props.hidden&&t.setState({height:0})},0)):(this.setState({height:r}),setTimeout(function(){t.props.hidden||t.setState({height:"auto"})},1e3))}},render:function(){var e={height:this.state.height};return s.createElement("header",{className:"top-navigation",style:e},s.createElement("div",{ref:"container",className:"container"},this.renderSpacerBar(),this.renderButtonBar(),this.renderCollapsibleControl()))},renderSpacerBar:function(){return null},renderButtonBar:function(){var e=i.get(this.props.route.component,"navigation.top",{}),t=this.state.expanded?this.state.selectedControl:"",n={icon:"calendar",className:"calendar-btn",disabled:!e.dateSelection,active:"calendar"===t,onClick:this.handleCalendarClick},o={icon:"filter",className:"filter-btn",disabled:!e.roleSelection,active:"filter"===t,onClick:this.handleFilterClick},a={icon:"search",className:"search-btn",disabled:!e.textSearch,active:"search"===t,onClick:this.handleSearchClick};return s.createElement("div",null,s.createElement(r,n),s.createElement(r,o),s.createElement(r,a))},renderCollapsibleControl:function(){return s.createElement(d,{open:this.state.expanded},this.renderControl())},renderControl:function(){switch(this.state.selectedControl){case"calendar":return this.renderCalendarBar();case"filter":return this.renderRoleFilterBar();case"search":return this.renderSearchBar()}},renderCalendarBar:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,onSelect:this.handleCalendarSelect};return s.createElement(p,e)},renderRoleFilterBar:function(){var e={database:this.props.database,route:this.props.route,locale:this.props.locale,theme:this.props.theme};return s.createElement(h,e)},renderSearchBar:function(){var e={route:this.props.route,locale:this.props.locale};return s.createElement(m,e)},toggleControl:function(e){var t=this;this.state.expanded&&e===this.state.selectedControl?this.setState({expanded:!1},function(){t.clearRouteParameters()}):this.setState({selectedControl:e,expanded:!0})},clearRouteParameters:function(){var e=this.props.route,t=i.omit(e.parameters,"date","roleIds"),n=e.component.getUrl(t);e.change(n,!0)},handleCalendarClick:function(e){this.toggleControl("calendar")},handleFilterClick:function(e){this.toggleControl("filter")},handleSearchClick:function(e){this.toggleControl("search")}})},function(e,t,n){"use strict";function r(e,t){return e+"/"+("0000000000"+t).slice(-10)}function i(e,t){return e+"/"+t}var s=n(4),o=n(1),a=o.PropTypes,c=n(75);e.exports=o.createClass({displayName:"IndexedDBCache",propTypes:{databaseName:a.string.isRequired},statics:{isAvailable:function(){return!!window.indexedDB}},getInitialState:function(){return{database:null}},find:function(e){return this.open().then(function(t){return new Promise(function(n,i){var o=e.server||"",a=e.schema,l=e.table,u="local"===a,d=u?"local-data":"remote-data",p=t.transaction(d,"readonly"),h=o+"/"+a+"/"+l,m=p.objectStore(d),f=[],v=e.criteria;if(v&&void 0!==v.id&&1===s.size(v)){var g=v.id;if(g instanceof Array)if(s.isEmpty(g))n(f);else{var b=s.max(g),y=s.min(g),k=r(h,b),x=r(h,y),E=IDBKeyRange.bound(x,k),C=m.openCursor(E);C.onsuccess=function(e){var t=e.target.result;if(t){var r=t.value,i=r.data;if(s.includes(g,i.id)){var o=s.sortedIndexBy(f,i,"id");f.splice(o,0,i)}t.continue()}else n(f)},C.onerror=function(e){n(f)}}else{var w=r(h,g),C=m.get(w);C.onsuccess=function(e){var t=e.target.result;t&&f.push(t.data),n(f)},C.onerror=function(e){n(f)}}}else{var S=m.index("location"),C=S.openCursor(h);C.onsuccess=function(e){var t=e.target.result;if(t){var r=t.value,i=r.data;if(c.match(l,i,v)){var o=s.sortedIndexBy(f,i,"id");f.splice(o,0,i)}t.continue()}else n(f)}}})})},save:function(e,t){return this.open().then(function(n){return new Promise(function(o,a){var c=e.server||"",l=e.schema,u=e.table,d="local"===l,p=d?"local-data":"remote-data",h=n.transaction(p,"readwrite"),m=c+"/"+l+"/"+u,f=h.objectStore(p);h.oncomplete=function(e){o(t)},h.onerror=function(e){a(new Error(e.message))},s.each(t,function(e){var t=d?i(m,e.key):r(m,e.id),n={server:c,location:m,data:e};f.put(n,t)})})})},remove:function(e,t){return this.open().then(function(n){return new Promise(function(o,a){var c=e.server||"",l=e.schema,u=e.table,d="local"===l,p=d?"local-data":"remote-data",h=n.transaction(p,"readwrite"),m=c+"/"+l+"/"+u,f=h.objectStore(p);h.oncomplete=function(e){o(t)},h.onerror=function(e){a(new Error(e.message))},s.each(t,function(e){var t=d?i(m,e.key):r(m,e.id);f.delete(t)})})})},clean:function(e){return this.open().then(function(t){return new Promise(function(n,r){var i=t.transaction("remote-data","readwrite"),s=i.objectStore("remote-data");if(void 0!==e.server){var o=s.index("server"),a=o.openCursor(e.server),c=0;a.onsuccess=function(e){var t=e.target.result;t?(c++,t.delete(),t.continue()):n(c)}}else if(void 0!==e.count){var o=s.index("rtime"),a=o.openCursor(),c=0;a.onsuccess=function(t){var r=t.target.result;r?(c++,r.delete(),c<e.count?r.continue():n(c)):n(c)}}else if(void 0!==e.before){var o=s.index("rtime"),a=o.openCursor(),c=0;a.onsuccess=function(t){var r=t.target.result;if(r){r.value.data.rtime<e.before?(c++,r.delete(),r.continue()):n(c)}else n(c)}}})})},open:function(){var e=this;return this.databasePromise||(this.databasePromise=new Promise(function(t,n){var r=window.indexedDB.open(e.props.databaseName,1);r.onsuccess=function(e){t(e.target.result)},r.onerror=function(e){n(new Error(e.message))},r.onupgradeneeded=function(e){var t=e.target.result;t.onerror=function(e){n(new Error(e.message))},t.createObjectStore("local-data").createIndex("location","location",{unique:!1});var r=t.createObjectStore("remote-data");r.createIndex("location","location",{unique:!1}),r.createIndex("server","server",{unique:!1}),r.createIndex("rtime","data.rtime",{unique:!1})}})),this.databasePromise},render:function(){return o.createElement("div",null)}})},function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}function i(e,t){var n=a.sortedIndexBy(e,{id:t},"id"),r=e[n];if(r&&r.id===t)return r}function s(e,t){var n=a.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id?e[n]=t:e.splice(n,0,t)}function o(e,t){var n=a.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id&&e.splice(n,1)}var a=n(4),c=n(10),l=n(1),u=l.PropTypes,d=n(75);e.exports=l.createClass({displayName:"LocalStorageCache",propTypes:{databaseName:u.string.isRequired},statics:{isAvailable:function(){return!!window.localStorage}},getInitialState:function(){var e=localStorage.getItem(this.props.databaseName);return this.localData=r(e)||{},this.remoteData={},{}},getRows:function(e,t,n){var r="local"===t?this.localData:this.remoteData,i=[e,t,n],s=a.get(r,i);return s||(s=[],a.set(r,i,s)),s},saveRows:function(e,t,n){if("local"===t){var r=JSON.stringify(this.localData);localStorage.setItem(this.props.databaseName,r)}},find:function(e){var t,n=e.server||"",r=e.schema,s=e.table,o=e.criteria,l=this.getRows(n,r,s);if(o&&void 0!==o.id&&1===a.size(o)){var u=o.id;u instanceof Array||(u=[u]),t=a.filter(a.map(u,function(e){return i(l,e)}))}else t=a.filter(l,function(e){return d.match(s,e,o)});return c.resolve(t)},save:function(e,t){var n=e.server||"",r=e.schema,i=e.table,o=this.getRows(n,r,i);return a.each(t,function(e){s(o,a.cloneDeep(e))}),this.saveRows(n,r,i),c.resolve(t)},remove:function(e,t){var n=e.server||"",r=e.schema,i=e.table,s=this.getRows(n,r,i);return a.each(t,function(e){o(s,e)}),this.saveRows(n,r,i),c.resolve(t)},clean:function(e){var t=this.remoteData,n=0;if(void 0!==e.server){var r=e.server,i=a.get(t,r);a.each(i,function(e){a.each(e,function(e){n+=e.length})}),a.set(t,r,void 0)}else if(void 0!==e.count){var s=[];a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=0;t<e.length;t++)s.push(e[t])})})}),s.sort(function(e,t){return e.rtime<t.rtime?-1:e.rtime>t.rtime?1:0}),s.splice(e.count),a.each(t,function(e){a.each(e,function(e){a.each(e,function(e){for(var t=e.length-1;t>=0;t--){var r=e[t];-1!==s.indexOf(r)&&(e.splice(t,1),n++)}})})})}else void 0!==e.before&&a.each(t,function(t){a.each(t,function(t){a.each(t,function(t){for(var r=t.length-1;r>=0;r--){t[r].rtime<e.before&&(t.splice(r,1),n++)}})})});return c.resolve(n)},render:function(){return l.createElement("div",null)}})},function(e,t,n){"use strict";function r(e,t,n){var r=[];return g.each(e,function(e,i){var s=t[i],o=g.sortedIndexBy(n,{id:e},"id"),a=n?n[o]:null;a&&a.id===e&&a.gn===s||r.push(e)}),r}function i(e,t,n){var r=[];return g.each(n,function(t){g.includes(e,t.id)||r.push(t.id)}),r}function s(e,t){return g.isEmpty(t)?e:(e=g.slice(e),g.each(t,function(t){var n=g.sortedIndexBy(e,{id:t},"id"),r=e?e[n]:null;r&&r.id===t&&e.splice(n,1)}),e)}function o(e,t){var n=[];return g.each(t,function(t){var r=g.sortedIndexBy(e,{id:t},"id"),i=e[r];i&&i.id===t&&n.push(i)}),n}function a(e,t){return e=g.slice(e),g.each(t,function(t){var n=g.sortedIndexBy(e,t,"id"),r=e[n];r&&r.id===t.id?e[n]=t:e.splice(n,0,t)}),e}function c(){return(new Date).toISOString()}function l(e,t){if(!e)return 1/0;if(!t)return 0;var n="string"==typeof e?new Date(e):e;return("string"==typeof t?new Date(t):t)-n}function u(e){return g.pick(e,"protocol","server","schema","table")}function d(e){return g.pick(e,"protocol","server","schema","table","criteria","minimum")}function p(e){var t=U[e];return t||(t=U[e]={}),t}function h(e){U[e]=null}function m(e){return f("id")||f("filters")}function f(e,t){var n=e[t];if(void 0!=n)return n instanceof Array?n.length:1}var v,g=n(4),b=n(10),y=n(1),k=y.PropTypes,x=n(58),E=n(101),C=n(75),w=n(5),S=n(383),R=n(386),N=n(384);S.isAvailable()?v=S:R.isAvailable()?v=R:N.isAvailable()&&(v=N);var O=n(396),_=O||null,P=n(32);e.exports=y.createClass({displayName:"RemoteDataSource",propTypes:{refreshInterval:k.number,cacheName:k.string.isRequired,urlPrefix:k.string,retrievalFlags:k.object,defaultProfileImage:k.string,locale:k.instanceOf(w),onChange:k.func,onAuthorization:k.func,onExpiration:k.func,onViolation:k.func,onAlertClick:k.func},components:P({cache:v,notifier:_}),getDefaultProps:function(){return{refreshInterval:900,urlPrefix:""}},getInitialState:function(){return{recentSearchResults:[],recentStorageResults:[],recentRemovalResults:[]}},beginAuthorization:function(e,t){var n=p(e.server);if(!n.authorizationPromise){var r=e.server,i=e.protocol,s=i+"//"+r+"/auth/session",o={responseType:"json",contentType:"json"};n.authorizationPromise=x.fetch("POST",s,{area:t},o).then(function(e){return n.authentication=e.authentication,{system:e.system,providers:e.providers}}).catch(function(e){throw n.authorizationPromise=null,e})}return n.authorizationPromise},checkAuthorizationStatus:function(e){var t=this,n=p(e.server),r=n.authentication.token,i=e.server,s=e.protocol,o=s+"//"+i+"/auth/session/"+r,a={responseType:"json"};return x.fetch("GET",o,{},a).then(function(e){var r=e.authorization;return!!r&&(n.authorization=r,t.triggerAuthorizationEvent(i,r),!0)}).catch(function(e){throw n.authorizationPromise=null,e})},submitPassword:function(e,t,n){var r=this,i=p(e.server),s=i.authentication.token,o=e.server,a=e.protocol,c=a+"//"+o+"/auth/htpasswd",l={token:s,username:t,password:n},u={responseType:"json",contentType:"json"};return x.fetch("POST",c,l,u).then(function(e){var t=e.authorization;return!!t&&(i.authorization=t,r.triggerAuthorizationEvent(o,t),!0)}).catch(function(e){throw i.authorizationPromise=null,e})},endAuthorization:function(e){var t=this,n=p(e.server),r=n.authorization.token,i=e.server,s=e.protocol,o=s+"//"+i+"/auth/session/"+r+"/end",a={responseType:"json",contentType:"json"};return x.fetch("POST",o,{},a).then(function(){return n.authentication=null,n.authorizationPromise=null,n.authorization=null,t.cleanCachedObjects(e),t.triggerExpirationEvent(i),!0})},getActivationUrl:function(e,t){var n=p(e.server),r=n.authorization.token,i=e.server,s=e.protocol,o="activation=1&sid="+t.id+"&token="+r;return s+"//"+i+"/auth/"+t.type+"?"+o},hasAuthorization:function(e){return!!p(e).authorization},addAuthorization:function(e,t){p(e).authorization=t},start:function(e){var t=this;return b.resolve().then(function(){if("local"===e.schema)return 0;var n=p(e.server);if(n.authorization){var r=t.components.notifier;if(r){var i=e.protocol,s=e.server,o=n.authorization.token;r.connect(i,s,o).catch(function(e){console.error("Unable to establish WebSocket connection: "+s)})}return n.authorization.user_id}throw new E(401)})},find:function(e){var t=g.get(e,"by.constructor.displayName");e=d(e);var n=this.findRecentSearch(e,t);return n?(this.checkSearchFreshness(n),n.promise):this.addSearch(e,t).promise},save:function(e,t){var n=this,r=c(),i=g.get(e,"by.constructor.displayName");return e=u(e),"local"===e.schema?this.storeLocalObjects(e,t):this.storeRemoteObjects(e,t).then(function(t){var s=c();g.each(t,function(e){e.startTime=r}),n.updateCachedObjects(e,t),n.updateRecentSearchResults(e,t),n.triggerChangeEvent();var o=g.clone(n.state.recentStorageResults);for(o.unshift({start:r,finish:s,duration:l(r,s),results:t,by:i});o.length>32;)o.pop();return n.setState({recentStorageResults:o}),t})},remove:function(e,t){var n=this,r=c(),i=g.get(e,"by.constructor.displayName");return e=u(e),"local"===e.schema?this.removeLocalObjects(e,t):(t=g.map(t,function(e){return{id:e.id,deleted:!0}}),this.storeRemoteObjects(e,t).then(function(t){var s=c();n.removeCachedObjects(e,t),n.removeFromRecentSearchResults(e,t),n.triggerChangeEvent();var o=g.clone(n.state.recentRemovalResults);for(o.unshift({start:r,finish:s,duration:l(r,s),results:t,by:i});o.length>32;)o.pop();return n.setState({recentRemovalResults:o}),t}))},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerAuthorizationEvent:function(e,t){if(this.props.onAuthorization)return this.props.onAuthorization({type:"authorization",target:this,server:e,credentials:t})},triggerExpirationEvent:function(e){if(this.props.onExpiration)return this.props.onExpiration({type:"expiration",target:this,server:e})},triggerViolationEvent:function(e,t){if(this.props.onViolation)return this.props.onViolation({type:"violation",target:this,server:e,schema:t})},findRecentSearch:function(e,t){var n=g.findIndex(this.state.recentSearchResults,function(t){var n=d(t);return g.isEqual(e,n)});if(-1!==n){var r=g.slice(this.state.recentSearchResults),i=r[n];return t&&(g.includes(i.by,t)||i.by.push(t)),r.splice(n,1),r.unshift(i),this.setState({recentSearchResults:r}),i}return null},addSearch:function(e,t){var n=this,r=g.extend({},e,{start:null,finish:null,results:null,promise:null,by:t?[t]:[],dirty:!1});r.promise=this.searchLocalCache(r).then(function(){return n.checkSearchValidity(r)?r.results:n.searchRemoteDatabase(r).then(function(){return r.results})});var i=g.slice(this.state.recentSearchResults);for(i.unshift(r);i.length>256;)i.pop();return this.setState({recentSearchResults:i}),r},checkSearchFreshness:function(e){var t=this;if("local"===e.schema)return!0;if(!e.dirty){if(!(l(e.finish,new Date)>1e3*this.props.refreshInterval))return!0}return this.searchRemoteDatabase(e).then(function(e){return e&&t.triggerChangeEvent(),null}).catch(function(e){}),!1},checkSearchValidity:function(e){var t=this;if("local"===e.schema)return!0;var n="number"==typeof e.minimum?e.minimum:1,r=m(e.criteria);n<r&&(n=r);var i=e.results.length;if(i<n)return!1;var s=!1;if(i===r){var o=1e3*this.props.refreshInterval,a=g.map(e.results,"rtime"),c=g.min(a);if(c<T)s=!0;else{l(c,new Date)>o?s=!0:(e.finish=c,s=!1)}}else s=!0;return s&&this.searchRemoteDatabase(e).then(function(e){return e&&t.triggerChangeEvent(),null}).catch(function(e){}),!0},searchRemoteDatabase:function(e){var t=this,n=u(e),p=d(e);return e.start=c(),this.discoverRemoteObjects(p).then(function(c){var l=c.ids,u=c.gns,d=r(l,u,e.results),p=i(l,u,e.results);if(!g.isEmpty(p)){var h=o(e.results,p);t.removeCachedObjects(e,h)}if(g.isEmpty(d)){if(g.isEmpty(p))return null;return s(e.results,p)}return t.retrieveRemoteObjects(n,d).then(function(t){var n=t,r=a(e.results,n);return r=s(r,p)})}).then(function(r){r&&(e.results=r,e.promise=b.resolve(r)),e.finish=c(),e.duration=l(e.start,e.finish),e.dirty=!1;var i=g.slice(t.state.recentSearchResults);t.setState({recentSearchResults:i});var s=e.finish;return g.each(e.results,function(e){e.rtime=s}),t.updateCachedObjects(n,e.results),!!r})},discoverRemoteObjects:function(e){var t=u(e);return this.performRemoteAction(t,"discovery",e.criteria)},retrieveRemoteObjects:function(e,t){return this.performRemoteAction(e,"retrieval",{ids:t})},storeRemoteObjects:function(e,t){return this.performRemoteAction(e,"storage",{objects:t})},performRemoteAction:function(e,t,n){var r=this,i=e.server,s=e.protocol,o=this.props.urlPrefix,a=e.schema,c=e.table,l=s+"//"+i+o+"/data/"+t+"/"+a+"/"+c+"/",u=p(e.server);n=g.clone(n),n.token=u.authorization.token,"retrieval"!==t&&"storage"!==t||g.assign(n,this.props.retrievalFlags);var d={contentType:"json",responseType:"json"};return x.fetch("POST",l,n,d).then(function(e){return e}).catch(function(t){throw 401===t.statusCode?(h(e.server),r.cleanCachedObjects(e),r.triggerExpirationEvent(e.server)):403==t.statusCode&&(r.cleanCachedObjects(e),r.triggerViolationEvent(e.server,e.schema)),t})},storeLocalObjects:function(e,t){var n=this.components.cache;if(!n)throw new Error("No local cache");return n.save(e,t)},removeLocalObjects:function(e,t){var n=this.components.cache;if(!n)throw new Error("No local cache");return n.remove(e,t)},searchLocalCache:function(e){var t=this.components.cache;if(!t)return!1;d(e);return t.find(e).then(function(t){return e.results=t,!0}).catch(function(e){return console.error(e),!1})},updateCachedObjects:function(e,t){var n=this.components.cache;return n?n.save(e,t).then(function(e){return!0}).catch(function(e){return console.error(e),!1}):b.resolve(!1)},removeCachedObjects:function(e,t){var n=this.components.cache;return n?n.remove(e,t).then(function(e){return!0}).catch(function(e){return console.error(e),!1}):b.resolve(!1)},cleanCachedObjects:function(e){var t=this.components.cache;return t?t.clean({server:e.server}):b.resolve(0)},updateRecentSearchResults:function(e,t){var n=this.getRelevantRecentSearches(e);g.each(n,function(e){g.each(t,function(t){var n=g.sortedIndexBy(e.results,t,"id"),r=e.results[n],i=r&&r.id===t.id,s=C.match(e.table,t,e.criteria);(r||s)&&(e.results=g.slice(e.results),s&&i?e.results[n]=t:s&&!i?e.results.splice(n,0,t):!s&&i&&e.results.splice(n,1),e.promise=b.resolve(e.results))})})},removeFromRecentSearchResults:function(e,t){var n=this.getRelevantRecentSearches(e);g.each(n,function(e){g.each(t,function(t){var n=g.sortedIndexBy(e.results,t,"id"),r=e.results[n];r&&r.id===t.id&&(e.results=g.slice(e.results),e.results.splice(n,1),e.promise=b.resolve(e.results))})})},getRelevantRecentSearches:function(e){return g.filter(this.state.recentSearchResults,function(t){var n=u(t);if(t.results&&g.isEqual(e,n))return!0})},render:function(){return y.createElement("div",null,this.renderLocalCache(),this.renderNotifier())},renderLocalCache:function(){var e=this.components.setters,t={ref:e.cache,databaseName:this.props.cacheName};return y.createElement(v,t)},renderNotifier:function(){var e=this.components.setters;if(_.isAvailable()){var t={ref:e.notifier,locale:this.props.locale,defaultProfileImage:this.props.defaultProfileImage,onNotify:this.handleChangeNotification,onAlertClick:this.props.onAlertClick};return y.createElement(_,t)}},componentDidMount:function(){this.triggerChangeEvent()},handleChangeNotification:function(e){var t=this,n=!1;g.forIn(e.changes,function(r,i){var s=g.split(i,"."),o={protocol:e.protocol,server:e.server,schema:s[0],table:s[1]};console.log("Change notification: ",o.table,r);var a=t.getRelevantRecentSearches(o);g.each(a,function(e){var t=!1;m(e.criteria)===e.results.length?g.each(r,function(n){var r=g.sortedIndexBy(e.results,{id:n},"id"),i=e.results[r];if(i&&i.id===n)return t=!0,!1}):t=!0,t&&(e.dirty=!0,n=!0)})}),n&&this.triggerChangeEvent()}});var U={},T=(new Date).toISOString()},function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(e){return null}}var i=n(4),s=n(10),o=n(1),a=o.PropTypes,c=n(75),l=window.openDatabase;window.sqlitePlugin&&(l=window.sqlitePlugin.openDatabase),e.exports=o.createClass({displayName:"SQLiteCache",propTypes:{databaseName:a.string.isRequired},statics:{isAvailable:function(){return!!l}},find:function(e){var t,n,s=e.server||"",o=e.schema,a=e.table,l=e.criteria;if("local"===o)t="\n                SELECT json FROM local_data\n                WHERE table_name = ?\n            ",n=[a],l&&void 0!==l.key&&1===i.size(l)&&(t+=" AND key = ?",n.push(l.key),l=null),t+=" ORDER BY key";else{if(t="\n                SELECT json FROM remote_data\n                WHERE server_name = ?\n                AND schema_name = ?\n                AND table_name = ?\n            ",n=[s,o,a],l&&void 0!==l.id&&1===i.size(l)){var u=l.id;u instanceof Array?(t+=" AND id IN ("+i.fill(i.clone(u),"?").join(",")+")",n.push.apply(n,u)):(t+=" AND id = ?",n.push(u)),l=null}t+=" ORDER BY id"}return this.query(t,n).then(function(e){for(var t=[],n=0;n<e.length;n++){var i=r(e[n].json);i&&(l&&!c.match(a,i,l)||t.push(i))}return t})},save:function(e,t){var n=e.server||"",r=e.schema,s=e.table,o=[],a=[];return i.each(t,function(e){var t=JSON.stringify(e);if("local"===r)o.push("\n                    INSERT OR REPLACE INTO local_data\n                    (table_name, key, json)\n                    VALUES (?, ?, ?)\n                "),a.push([s,e.key,t]);else{var i=new Date(e.rtime).getTime();o.push("\n                    INSERT OR REPLACE INTO remote_data\n                    (server_name, schema_name, table_name, id, json, rtime)\n                    VALUES (?, ?, ?, ?, ?, ?)\n                "),a.push([n,r,s,e.id,t,i])}}),this.execute(o,a).return(t)},remove:function(e,t){var n=this,r=e.server||"",i=e.schema,o=e.table;return s.mapSeries(t,function(e){var t,s;return"local"===i?(t="\n                    DELETE FROM local_data\n                    WHERE table_name = ? AND key = ?\n                ",s=[o,e.key]):(t="\n                    DELETE FROM remote_data\n                    WHERE server_name = ?\n                    AND schema_name = ?\n                    AND table_name = ?\n                    AND id = ?\n                ",s=[r,i,o,e.id]),n.execute(t,s)})},clean:function(e){var t,n;if(void 0!==e.server)t="\n                DELETE FROM remote_data\n                WHERE server_name = ?\n            ",n=[e.server];else if(void 0!==e.count)t="\n                DELETE FROM remote_data\n                WHERE rowid IN (\n                    SELECT rowid FROM remote_data ORDER BY rtime LIMIT ?\n                )\n            ",n=[e.count];else if(void 0!==e.before){var r=new Date(e.before).getTime();t="\n                DELETE FROM remote_data\n                WHERE rtime < ?\n            ",n=[r]}return this.execute(t,n)},query:function(e,t){return this.open().then(function(n){return new s(function(r,i){var s=function(e){i(new Error(e.message))};n.transaction(function(n){n.executeSql(e,t,function(e,t){for(var n=[],i=0;i<t.rows.length;i++)n.push(t.rows.item(i));r(n)})},s)})})},execute:function(e,t){return this.open().then(function(n){return new s(function(r,i){var s=function(e){i(new Error(e.message))},o=function(){r(a)},a=0,c=function(e,t){a+=t.rowsAffected};n.transaction(function(n){if(e instanceof Array)for(var r=0;r<e.length;r++)n.executeSql(e[r],t[r],c);else n.executeSql(e,t,c)},s,o)})})},open:function(){var e=this;return this.databasePromise||(this.databasePromise=s.try(function(){var t=l(e.props.databaseName,"1.0","",52428800),n=["\n                        CREATE TABLE IF NOT EXISTS remote_data (\n                            server_name text,\n                            schema_name text,\n                            table_name text,\n                            id int,\n                            json text,\n                            rtime datetime\n                        )\n                    ","\n                        CREATE UNIQUE INDEX IF NOT EXISTS remote_data_idx_id\n                        ON remote_data (\n                            server_name,\n                            schema_name,\n                            table_name,\n                            id\n                        )\n                    ","\n                        CREATE INDEX IF NOT EXISTS remote_data_idx_location\n                        ON remote_data (\n                            server_name,\n                            schema_name,\n                            table_name\n                        )\n                    ","\n                        CREATE INDEX IF NOT EXISTS remote_data_idx_rtime\n                        ON remote_data (\n                            rtime\n                        )\n                    ","\n                        CREATE TABLE IF NOT EXISTS local_data (\n                            table_name text,\n                            key text,\n                            json text\n                        )\n                    ","\n                        CREATE UNIQUE INDEX IF NOT EXISTS local_data_idx_key\n                        ON local_data (\n                            table_name,\n                            key\n                        )\n                    "];return new s(function(e,r){var s=function(e){r(new Error(e.message))};t.transaction(function(e){i.each(n,function(t){e.executeSql(t)})},s,e)}).return(t)})),this.databasePromise},render:function(){return o.createElement("div",null)}})},function(e,t,n){"use strict";function r(){function e(e){void 0===n&&e&&e.length>=2&&(n=i.toLower(e))}i.each(navigator.languages,e);var t=["language","browserLanguage","systemLanguage","userLanguage"];i.each(t,function(t){e(navigator[t])});var n;return n}var i=n(4),s=n(1),o=s.PropTypes,a=n(7);e.exports=s.createClass({displayName:"LocaleManager",propTypes:{defaultLanguageCode:o.string,database:o.instanceOf(a),directory:o.arrayOf(o.object),onChange:o.func,onModuleRequest:o.func},getDefaultProps:function(){return{defaultLanguageCode:"en"}},getInitialState:function(){return{languageCode:"",phraseTable:{},missingPhrases:[]}},getLanguageCode:function(){return this.state.languageCode},getDirectory:function(){return this.props.directory},translate:function(e){var t=this.state.phraseTable[e];if(null!=t){if("function"==typeof t){var n=i.slice(arguments,1);return t.apply(this,n)}return t}return e},pick:function(e,t){if("string"==typeof e)return e;var n=this.state.languageCode.substr(0,2);t&&(n=t.substr(0,2));var r="",s="",o=this.props.defaultLanguageCode.substr(0,2),a="";for(var c in e){var l=e[c],u=i.toLower(c);u===n&&(r=l),s||(s=l),u===o&&(a=l)}return r||(a||s)},change:function(e){var t=this;return e=i.toLower(e),e===this.state.languageCode?Promise.resolve(!0):this.load(e).then(function(n){var r;r="function"==typeof n?n(e):n;var i={languageCode:e,phraseTable:r};return t.setState(i,function(){t.triggerChangeEvent()}),!0})},load:function(e){var t=c[e];return t?Promise.resolve(t):this.triggerModuleRequest(e).then(function(t){return c[e]=t,t})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerModuleRequest:function(e){return this.props.onModuleRequest?this.props.onModuleRequest({type:"module_request",target:this,languageCode:e}):Promise.reject("onModuleRequest is not set")},render:function(){return null},componentDidMount:function(){var e=this,t=r()||this.props.defaultLanguageCode;this.change(t).catch(function(t){e.change(e.props.defaultLanguageCode)})},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var r=this.props.database.use({by:this,schema:"local"});r.start().then(function(){return r.findOne({table:"settings",key:"language"})}).then(function(e){e&&e.selectedLanguageCode&&n.change(e.selectedLanguageCode)})}}});var c={}},function(e,t,n){"use strict";e.exports=[{name:"Čeština",code:"cz",direction:"ltr",countries:{cz:"Česko",pl:"Polsko",sk:"Slovensko"},defaultCountry:"cz"},{name:"Dansk",code:"da",direction:"ltr",countries:{dk:"Danmark",fo:"Færøerne",gl:"Grønland",de:"Tyskland"},defaultCountry:"dk"},{name:"Deutsch",code:"de",direction:"ltr",countries:{at:"Österreich",be:"Belgien",de:"Deutschland",lu:"Luxemburg",ch:"Schweiz"},defaultCountry:"de"},{name:"Ελληνικά",code:"el",direction:"ltr",countries:{gr:"Ελλάδα",cy:"Κύπρος"},defaultCountry:"gr"},{name:"English",code:"en",direction:"ltr",countries:{au:"Australia",ca:"Canada",hk:"Hong Kong",ie:"Ireland",sg:"Singapore",gb:"United Kingdom",us:"United States"},defaultCountry:"us",locales:{admin:!0,client:!0}},{name:"Español",code:"es",direction:"ltr",countries:{ar:"Argentina",bo:"Bolivia",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",es:"España",ec:"Ecuador",sv:"El Salvador",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"México",ni:"Nicaragua",pa:"Panamá",py:"Paraguay",pe:"Perú",pr:"Puerto Rico",do:"República Dominicana",uy:"Uruguay",ve:"Venezuela"},defaultCountry:"es"},{name:"Français",code:"fr",direction:"ltr",countries:{be:"Belgique",bj:"Bénin",bf:"Burkina Faso",bi:"Burundi",cm:"Cameroun",ca:"Canada",cg:"Congo",ci:"Côte d'Ivoire",dj:"Djibouti",gq:"Guinée équatoriale",fr:"France",ga:"Gabon",gn:"Guinée",ht:"Haïti",lu:"Luxembourg",mg:"Madagascar",ml:"Mali",ne:"Niger",rw:"Rwanda",cf:"République centrafricaine",cd:"République démocratique du Congo",sn:"Sénégal",sc:"Seychelles",ch:"Suisse",td:"Tchad",tg:"Togo"},defaultCountry:"fr"},{name:"한국어",code:"ko",direction:"ltr",countries:{kr:"한국",cn:"중국"},defaultCountry:"kr"},{name:"Hrvatski",code:"hr",direction:"ltr",countries:{ba:"Bosna i Hercegovina",hr:"Hrvatska",rs:"Srbija"},defaultCountry:"hr"},{name:"Italiano",code:"it",direction:"ltr",countries:{it:"Italia",ch:"Svizzera",hr:"Croazia",si:"Slovenia"},defaultCountry:"it"},{name:"Magyar",code:"hu",countries:{hr:"Magyarország",ro:"Románia"},defaultCountry:"hu"},{name:"Nederlands",code:"nl",countries:{be:"België",nl:"Nederland",sr:"Suriname"},defaultCountry:"nl"},{name:"日本語",code:"jp",direction:"ltr",countries:{jp:"日本"},defaultCountry:"jp"},{name:"Norsk",code:"no",direction:"ltr",countries:{no:"Norge"},defaultCountry:"no",locales:{admin:!0,client:!0}},{name:"Polski",code:"pl",direction:"ltr",countries:{by:"Białoruś",lt:"Litwa",pl:"Polska",ua:"Ukraina"},defaultCountry:"pl",locales:{admin:!0,client:!0}},{name:"Português",code:"pt",direction:"ltr",countries:{ao:"Angola",br:"Brasil",tl:"Timor Leste",gq:"Guiné Equatorial",gw:"Guiné-Bissau",mz:"Moçambique",mo:"Macao",pt:"Portugal"},defaultCountry:"pt"},{name:"Русский",code:"ru",direction:"ltr",countries:{am:"Армения",by:"Беларусь",ge:"Грузия",lv:"Латвия",kz:"Казахстан",kg:"Киргизия",lt:"Литва",ru:"Россия",tj:"Таджикистан",ua:"Украина",uz:"Узбекистан",es:"Эстония"},defaultCountry:"ru",locales:{admin:!0,client:!0}},{name:"Srpski",code:"sr",direction:"ltr",countries:{rs:"Srbija",hr:"Hrvatska",ba:"Bosna i Hercegovina"},defaultCountry:"sr"},{name:"Suomi",code:"fi",direction:"ltr",countries:{fi:"Suomi",se:"Ruotsi"},defaultCountry:"fi",locales:{admin:!0,client:!0}},{name:"Slovenčina",code:"sk",countries:{cz:"Česko",sk:"Slovensko"},defaultCountry:"sk"},{name:"Svenska",code:"sv",direction:"ltr",countries:{fi:"Finland",se:"Sverige"},defaultCountry:"se"},{name:"Tiếng Việt",code:"vi",direction:"ltr",countries:{vn:"Việt Nam"},defaultCountry:"vn"},{name:"Türkçe",code:"tr",direction:"ltr",countries:{cy:"Kıbrıs",tr:"Türkiye"},defaultCountry:"tr"},{name:"中文",code:"zh",direction:"ltr",countries:{cn:"中国",hk:"香港",mo:"澳門",sg:"新加坡",tw:"台灣"},defaultCountry:"cn",locales:{admin:!0,client:!0}}]},function(e,t,n){"use strict";function r(e,t){return t||(t=0),new i(function(n,r){function i(t){var n=l*u*3;t.size/n>.02?o(t):((!h||h.size<t.size)&&(h=t),p>10?o(h):(e.currentTime+=1e3,p++))}function s(t){try{d.getContext("2d").drawImage(e,0,0,l,u),d.toBlob(i,"image/jpeg",75)}catch(e){a(e)}}function o(e){c(),n(e)}function a(e){c(),h?n(h):r(e)}function c(){e.removeEventListener("seeked",s),clearTimeout(m)}var l=e.videoWidth,u=e.videoHeight,d=document.createElement("CANVAS");d.width=l,d.height=u;var p=1,h=null;e.addEventListener("seeked",s),e.addEventListener("ended",function(){a(new Error("Unable to obtain an image before video ended"))}),e.currentTime=t;var m=setTimeout(function(){a(new Error("Unable to obtain an image within time limit"))},1e3)})}var i=(n(4),n(10));t.capture=r},function(e,t,n){"use strict";function r(e,t,n){e.left<0?e.left=0:e.left+e.width>t&&(e.left=t-e.width),e.top<0?e.top=0:e.top+e.height>n&&(e.top=n-e.height)}var i=(n(10),n(1)),s=i.PropTypes,o=(n(72),n(32)),a=n(147);n(753),e.exports=i.createClass({displayName:"ImageDisplay",propTypes:{url:s.string.isRequired,clippingRect:s.object,aspectRatio:s.number,onChange:s.func,onLoad:s.func},getDefaultProps:function(){return{aspectRatio:1}},getInitialState:function(){return this.components=o({container:HTMLElement,image:a}),{clippingRect:this.props.clippingRect}},componentWillReceiveProps:function(e){this.props.url===e.url&&this.props.clippingRect===e.clippingRect||(this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.props.url!==e.url&&this.triggerChangeEvent(this.state.clippingRect)),this.setState({clippingRect:e.clippingRect}))},render:function(){var e=this.components.setters,t={ref:e.container,className:"image-cropper",onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onWheel:this.handleMouseWheel},n={ref:e.image,url:this.props.url,clippingRect:this.state.clippingRect,onLoad:this.props.onLoad};return i.createElement("div",t,i.createElement(a,n))},componentWillUnmount:function(){this.dragStart&&this.handleMouseUp(),this.zoomChangeTimeout&&(clearTimeout(this.zoomChangeTimeout),this.triggerChangeEvent(this.state.clippingRect))},triggerChangeEvent:function(e){_.isEqual(this.props.clippingRect,e)||this.props.onChange&&this.props.onChange({type:"change",target:this,rect:e})},handleMouseDown:function(e){var t=this.components.image,n=this.components.container;if(t&&n&&this.state.clippingRect){var r=n.getBoundingClientRect();this.dragStart={clippingRect:this.state.clippingRect,pageX:e.pageX,pageY:e.pageY,scale:{x:t.width/r.width,y:t.height/r.height}},document.addEventListener("mousemove",this.handleMouseMove)}},handleMouseMove:function(e){if(e.preventDefault(),this.dragStart){var t={x:e.pageX-this.dragStart.pageX,y:e.pageY-this.dragStart.pageY},n=this.components.image,i=_.clone(this.dragStart.clippingRect);i.left-=Math.round(t.x*this.dragStart.scale.x),i.top-=Math.round(t.y*this.dragStart.scale.y),r(i,n.naturalWidth,n.naturalHeight),this.setState({clippingRect:i})}},handleMouseUp:function(e){this.dragStart&&(document.removeEventListener("mousemove",this.handleMouseMove),this.triggerChangeEvent(this.state.clippingRect),this.dragStart=null)},handleMouseWheel:function(e){var t=this;e.preventDefault();var n=this.components.image,i=this.components.container;if(n&&i&&this.state.clippingRect){var s=i.getBoundingClientRect(),o={x:n.width/s.width,y:n.height/s.height},a=e.deltaY*o.y/4,c=_.clone(this.state.clippingRect);c.width+a>n.naturalWidth&&(a=n.naturalWidth-c.width),c.height+a>n.naturalHeight&&(a=n.naturalHeight-c.height),c.width+=a,c.height+=a;var l={x:e.pageX-s.left,y:e.pageY-s.top},u={x:l.x*(a/n.width),y:l.y*(a/n.height)};c.left-=Math.round(u.x*o.x),c.top-=Math.round(u.y*o.y),r(c,n.naturalWidth,n.naturalHeight),this.setState({clippingRect:c},function(){t.zoomChangeTimeout&&clearTimeout(t.zoomChangeTimeout),t.zoomChangeTimeout=setTimeout(function(){t.triggerChangeEvent(c),t.zoomChangeTimeout=0},1e3)}),this.dragStart&&(this.dragStart={clippingRect:c,pageX:e.pageX,pageY:e.pageY,scale:o})}}})},function(e,t,n){"use strict";function r(e,t){return e<<8|t}function i(e,t){return t<<8|e}function s(e,t,n,r){return e<<24|t<<16|n<<8|r}function o(e,t,n,r){return r<<24|n<<16|t<<8|e}function a(e,t){var n=e.length,i=0;if(65496==r(e[i++],e[i++]))for(;i<n;){var s=r(e[i++],e[i++]),o=r(e[i++],e[i++]);if(65498==s)break;var a=t(s,i,o);if(void 0!==a&&!1!==a)return a;i+=o-2}return-1}function c(e){return a(e,function(t,n){if(65517==t&&80==e[n++]&&104==e[n++]&&111==e[n++]&&116==e[n++]&&111==e[n++]&&115==e[n++]&&104==e[n++]&&111==e[n++]&&112==e[n++]&&32==e[n++]&&51==e[n++]&&46==e[n++]&&48==e[n++])return n})}function l(e,t){for(var n=e.length,i=null,s=t;s+4<n;)if(56==e[s+0]&&66==e[s+1]&&73==e[s+2]&&77==e[s+3]){s+=4;for(var o=r(e[s++],e[s++]),a=e[s++],c="",l=0;l<a;l++)c+=String.fromCharCode(e[s++]);s++;var d=(r(e[s++],e[s++]),r(e[s++],e[s++]));o>=1999&&o<=2998&&(i||(i={}),i[c]=u(e,s,d)),s+=d}else s++;return i}function u(e,t,n){for(var i=n/26,o=0,a=[],c=[],l=t,u=0;u<i;u++){switch(r(e[l++],e[l++])){case 0:case 3:o=r(e[l++],e[l++]),l+=22;break;case 1:case 2:case 4:case 5:for(var d=0;d<3;d++){var p=s(e[l++],e[l++],e[l++],e[l++]),h=s(e[l++],e[l++],e[l++],e[l++]);p>=2147483648?p=(2147483647-p)/16777216:p/=16777216,h>=2147483648?h=(2147483647-h)/16777216:h/=16777216,c.push({x:h,y:p})}o--,0==o&&(c.push(c.shift()),c.push(c[0]),a.push(c),c=[]);break;default:l+=24}}return a}t.getDimensions=function(e){var t=a(e,function(e,t,n){if(65472===e||65474===e)return t});if(t>0){var n=(e[t++],r(e[t++],e[t++]));return{width:r(e[t++],e[t++]),height:n}}},t.getOrientation=function(e){var t=r,n=s,c=a(e,function(r,s,a){if(65505===r){var c=s,l=s+a;if(69==e[c++]&&120==e[c++]&&105==e[c++]&&102==e[c++]&&0==e[c++]&&0==e[c++]){var u=c;"II"===String.fromCharCode(e[c++])+String.fromCharCode(e[c++])&&(t=i,n=o);if(42!==t(e[c++],e[c++]))return;do{var d=n(e[c++],e[c++],e[c++],e[c++]);if(0===d)break;c=u+d;for(var p=t(e[c++],e[c++]),h=0;h<p;h++){var m=t(e[c++],e[c++]),f=t(e[c++],e[c++]),v=n(e[c++],e[c++],e[c++],e[c++]);if(274===m&&3===f&&1===v)return c;c+=4}}while(c<l)}}});if(c>0){return t(e[c++],e[c++])}},t.extractPaths=function(e){var t=c(e);return-1!==t?l(e,t):null}},function(e,t,n){"use strict";function r(e){return new o(function(t,n){var r=document.createElement("IMG");r.src=e,r.onload=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function i(e){return new o(function(t,n){var r=document.createElement("VIDEO");r.src=e,r.preload=!0,r.onloadeddata=function(e){t(r)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}function s(e){return new o(function(t,n){var r=document.createElement("AUDIO");r.src=e,r.preload=!0,r.onloadeddata=function(e){t(video)},r.onerror=function(t){n(new Error("Unable to load "+e))}})}var o=n(10);t.loadImage=r,t.loadVideo=i,t.loadAudio=s},function(e,t,n){"use strict";function r(e){var t={},n=s.split(e,"&");return s.each(n,function(e){var n=s.split(e,"="),r=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]||"");i=s.replace(i,/\+/g," "),t[r]=i}),t}function i(e){return e.pathname+e.search+e.hash}var s=n(4),o=n(1),a=o.PropTypes,c=n(7);e.exports=o.createClass({displayName:"RouteManager",propTypes:{pages:a.array.isRequired,database:a.instanceOf(c),baseUrls:a.arrayOf(a.string).isRequired,onChange:a.func,onRedirectionRequest:a.func},getInitialState:function(){return{baseUrl:this.getBaseUrl(),url:null,component:null,parameters:null,query:null,hash:""}},getBaseUrl:function(){var e=window.location.pathname,t=s.find(this.props.baseUrls,function(t){if(/\/$/.test(t))throw new Error("Base URL should not end a slash");if(e.substr(0,t.length)===t)return!0});return void 0===t&&console.error("Page is not hosted at one of the expected base URLs ("+this.props.baseUrls+")"),t},getUrl:function(){return this.state.url},getComponent:function(){return this.state.component},getParameters:function(){return this.state.parameters},getQuery:function(){return this.state.query},getHash:function(){return this.state.hash},goTo:function(e,t){var n=this.state.baseUrl;if(void 0!==n){var r=i(window.location);if(r.substr(0,n.length)===n&&"/"===r.charAt(n.length))return r=r.substr(n.length),this.change(r,t)}return Promise.reject(new Error("Cannot route to location not at the base URL"))},find:function(e){var t=e,n="",i=t.indexOf("#");-1!==i&&(n=t.substr(i+1),t=t.substr(0,i));var o={},a=t.indexOf("?");-1!==a&&(o=r(t.substr(a+1)),t=t.substr(0,a));var c=[];s.each(this.props.pages,function(e){if("function"!=typeof e.parseUrl){var r=s.get(e,"displayName","Page");throw new Error(r+" does not implement the static function parseUrl()")}var i=e.parseUrl(t);if(i){var a=e.getUrl(s.assign({},i,o));n&&(a+="#"+n),l={url:a,component:e,parameters:i,query:o,hash:n},c.push(l)}}),c=s.sortBy(c,"route.parameters.match.length");var l=s.last(c)||null;return l},change:function(e,t,n){var r=this;if(this.state.url===e)return Promise.resolve();var i=this.find(e);return i?(this.setState(i,function(){var e=r.state.baseUrl+i.url;t?history.replaceState({},"",e):history.pushState({},"",e),r.triggerChangeEvent()}),Promise.resolve(!0)):n?Promise.reject(new Error("Unable to find page")):this.triggerRedirectionRequest(e).then(function(e){return r.change(e,t,!0)})},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},triggerRedirectionRequest:function(e){return this.props.onRedirectionRequest?this.props.onRedirectionRequest({type:"route_request",target:this,url:e}):Promise.reject(new Error("Unable to route URL to a page: "+e))},render:function(){return null},componentDidMount:function(){this.props.database&&this.goTo(window.location,!0).catch(function(e){console.error(e)}),window.addEventListener("popstate",this.handlePopState)},componentDidUpdate:function(e,t){!e.database&&this.props.database&&this.goTo(window.location,!0).catch(function(e){console.error(e)})},componentWillUnmount:function(){window.removeEventListener("popstate",this.handlePopState)},handlePopState:function(e){var t=this,n=i(window.location),r=this.find(n);r&&this.setState(r,function(){t.triggerChangeEvent()})}})},function(e,t,n){"use strict";function r(e){var t;if(t=/^(\d+)\s*vw/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetWidth/100)}if(t=/^(\d+)\s*vh/.exec(e)){var n=parseInt(t[1]);return Math.round(n*document.body.offsetHeight/100)}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(4),o=n(1),a=o.PropTypes,c=n(7),l=n(8);e.exports=o.createClass({displayName:"ThemeManager",propTypes:{modes:a.object,database:a.instanceOf(c),route:a.instanceOf(l),onChange:a.func},getInitialState:function(){return{mode:this.selectMode(),devicePixelRatio:window.devicePixelRatio,details:null,server:window.location.hostname}},getMode:function(){return this.state.mode},getModes:function(){var e=s.sortBy(s.toPairs(this.props.modes),1);s.map(e,0);return s.keys(this.props.modes)},getDetails:function(){return this.state.details},getImageUrl:function(e,t){var n,s=this.state.server,o=[],a=t?t.noClipping:void 0,c=t?t.width:void 0,l=t?t.height:void 0,u=t?t.quality:void 0;if("object"===(void 0===e?"undefined":i(e))){if(n=e.url,e.clip&&!a){var d=[e.clip.left,e.clip.top,e.clip.width,e.clip.height];o.push("cr"+d.join("-"))}}else{if("string"!=typeof e)return;n=e}if(n){"string"==typeof c&&(c=r(c)),"string"==typeof l&&(l=r(l)),1!==this.state.devicePixelRatio&&(c=Math.round(c*this.state.devicePixelRatio),l=Math.round(l*this.state.devicePixelRatio)),void 0!==c&&void 0!==l?o.push("re"+c+"-"+l):void 0===c&&void 0!==l?o.push("h"+l):void 0===l&&void 0!==c&&o.push("w"+c),void 0!==u&&o.push("q"+u);var p="";return o.length>0&&(p="/"+o.join("+")),"http://"+s+n+p}},getVideoUrl:function(e,t){var n,r=this.state.server;if("object"===(void 0===e?"undefined":i(e)))n=e.url;else{if("string"!=typeof e)return;n=e}return"http://"+r+n},getPosterUrl:function(e,t,n){var r={url:e.poster_url,width:e.width,height:e.height,clip:e.clip};return this.getImageUrl(r,t,n)},selectMode:function(){var e=document.body.parentNode.offsetWidth,t="";for(var n in this.props.modes){e>=this.props.modes[n]&&(t=n)}return t},change:function(e){var t=this;return s.isEqual(this.state.details,e)?Promise.resolve(!0):(this.setState({details:e},function(){t.triggerChangeEvent()}),Promise.resolve(!0))},componentWillReceiveProps:function(e){var t=this;if(this.props.route!==e.route){var n=s.get(this.props.route,"parameters.server"),r=s.get(e.route,"parameters.server");"~"===r&&(r=window.location.hostname),n!==r&&this.setState({server:r},function(){t.triggerChangeEvent()})}},componentWillMount:function(){window.addEventListener("resize",this.handleWindowResize)},render:function(){return null},componentDidMount:function(){this.change(u)},componentDidUpdate:function(e,t){var n=this;if(!e.database&&this.props.database){var r=this.props.database.use({by:this,schema:"local"});r.start().then(function(){return r.findOne({table:"settings",key:"theme"})}).then(function(e){e&&e.theme&&n.change(e.theme)})}},componentWillUnmount:function(){window.removeEventListener("resize",this.handleWindowResize)},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})},handleWindowResize:function(e){var t=this,n={},r=this.selectMode();this.state.mode!==r&&(n.mode=r),this.state.devicePixelRatio!==window.devicePixelRatio&&(n.devicePixelRatio=window.devicePixelRatio),s.isEmpty(n)||this.setState(n,function(){t.triggerChangeEvent()})}});var u={}},function(e,t,n){"use strict";var r=n(4),i=n(10),s=n(1),o=s.PropTypes,a=n(0),c=n(58),l=n(102),u=n(136),d=n(7),p=n(8);e.exports=s.createClass({displayName:"PayloadManager",propTypes:{database:o.instanceOf(d),route:o.instanceOf(p),onChange:o.func},getInitialState:function(){return{payloads:[]}},getBaseUrl:function(){var e=this.getDatabase(),t=e.context.server;return e.context.protocol+"//"+t},getDatabase:function(){var e=this.props.route,t=e.parameters.server,n=e.parameters.schema||"global";return this.props.database.use({server:t,schema:n,by:this})},getSchema:function(){return this.getDatabase().context.schema},queue:function(e,t){var n=this,s=this.getAction(e);return s?this.createTask(s,t).then(function(t){var i=r.pick(e,"file","poster_file","stream","external_url","external_poster_url","url"),s=r.assign({payload_id:t.id,action:t.action,token:t.token,start:a(),transferred:0,total:0,promise:null},i),o=r.concat(n.state.payloads,s);return n.setState({payloads:o},function(){n.triggerChangeEvent()}),s.payload_id}):i.resolve(null)},getAction:function(e){switch(e.type){case"image":if(!e.url){if(e.file instanceof Blob)return"upload image";if(e.stream)return"copy image";if(e.external_url)return"copy image"}break;case"audio":if(!e.url){if(e.file instanceof Blob)return"upload and transcode audio";if(e.external_url)return"copy and transcode audio";if(e.stream)return"copy and transcode audio"}break;case"video":if(!e.url){if(e.file instanceof Blob)return"upload and transcode video";if(e.external_url)return"copy and transcode video";if(e.stream)return"copy and transcode video"}break;case"website":if(!e.poster_url&&e.url)return"generate website poster"}},createTask:function(e,t){var n=this.getDatabase();return n.start().then(function(r){var i={action:e,options:t,user_id:r};return n.saveOne({table:"task"},i)})},find:function(e){var t,n=this,i=r.keys(e);return r.each(i,function(i){return!(t=r.find(n.state.payloads,r.pick(e,i)))}),t},send:function(e){var t=this,n=r.find(this.state.payloads,{payload_id:e});if(n&&!n.promise){var i={responseType:"json",onProgress:function(n){t.updatePayloadStatus(e,{transferred:n.loaded,total:n.total})}},s=this.getFormData(n),o=this.getUrl(n),a=c.fetch("POST",o,s,i).then(function(n){var i=r.assign({done:!0},n);t.updatePayloadStatus(e,i)});n.promise=a}},getFormData:function(e){var t=new FormData,n=r.pick(e,"file","poster_file","stream","external_url","external_poster_url","url");return r.forIn(n,function(e,n){e instanceof l&&(e=e.id),t.append(n,e)}),t},getUrl:function(e){var t=this.getSchema(),n=this.getBaseUrl(),r=e.payload_id;switch(e.action){case"upload image":case"copy image":n+="/media/images/upload/"+t+"/"+r;break;case"copy and transcode video":case"upload and transcode video":n+="/media/videos/upload/"+t+"/"+r;break;case"copy and transcode audio":case"upload and transcode audio":n+="/media/audios/upload/"+t+"/"+r;break;case"generate website poster":n+="/media/html/screenshot/"+t+"/"+r;break;default:return}return n+="?token="+e.token},stream:function(e){var t=this.getBaseUrl(),n=0,r=!1;u.do(function(){return e.pull().then(function(n){t+="/media/stream",e.id&&(t+="/"+e.id);var i=new FormData;n?i.append("file",n):r=!0;var s={responseType:"json"};return c.fetch("POST",t,i,s).then(function(t){e.id||(e.id=t.id),n&&e.finalize(n)})}).catch(function(e){if(++n<1)return i.delay(5e3);throw e})}),u.while(function(){return!r}),u.end().catch(function(t){e.abandon(t)})},updatePayloadStatus:function(e,t){var n=this,i=r.map(this.state.payloads,function(n){return n.payload_id===e?r.assign({},n,t):n});this.setState({payloads:i},function(){n.triggerChangeEvent()})},render:function(){return null},componentDidUpdate:function(e){!e.database&&this.props.database&&this.triggerChangeEvent()},triggerChangeEvent:function(){this.props.onChange&&this.props.onChange({type:"change",target:this})}})},function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(e){}}function i(){return new o(function(e,t){Notification.requestPermission(function(n){"granted"===n?e():t(new Error("Unable to gain permission"))})})}var s=n(4),o=n(10),a=n(1),c=a.PropTypes,l=n(660),u=n(136),d=n(5);e.exports=a.createClass({displayName:"WebsocketNotifier",propTypes:{initialReconnectionDelay:c.number,maximumReconnectionDelay:c.number,defaultProfileImage:c.string,locale:c.instanceOf(d),onNotify:c.func,onAlertClick:c.func},statics:{isAvailable:function(){return!0}},getDefaultProps:function(){return{initialReconnectionDelay:500,maximumReconnectionDelay:3e4}},getInitialState:function(){return{protocol:"",server:"",socket:null,showingAlert:!1}},connect:function(e,t,n){var i=this;if(this.state.protocol===e&&this.state.server===t)return o.resolve(!0);if(this.state.socket){var a=this.state.socket;this.setState({socket:null,protocol:"",server:""},function(){a.close()})}var c=this.connectionAttempt;if(c&&c.server===t)return c.promise;c=this.connectionAttempt={server:t};var l=!1,d=this.props.initialReconnectionDelay,p=this.props.maximumReconnectionDelay;return u.do(function(){return i.createSocket(e,t,n).then(function(o){if(c===i.connectionAttempt){var a=s.get(i.props.locale,"languageCode","en"),u={authorization:{token:n,locale:a}};o.send(JSON.stringify(u)),o.onmessage=function(e){if(i.state.socket===o){var t=r(e.data);t.changes?i.triggerNotifyEvent(t.changes):t.alert&&i.showAlert(t.alert)}},o.onclose=function(){i.state.socket===o&&i.setState({socket:null,server:""},function(){i.connect(e,t,n)})},i.setState({socket:o,protocol:e,server:t})}l=!0}).catch(function(e){return d*=2,d>p&&(d=p),o.delay(d)})}),u.while(function(){return c===i.connectionAttempt&&!l}),u.return(function(){return l}),c.promise=u.end(),c.promise},createSocket:function(e,t,n){return new o(function(n,r){var i=e+"//"+t+"/socket",s=new l(i),o=!1;s.onopen=function(e){o||(o=!0,n(s))},s.onclose=function(){o||r(new Error("Unable to establish a connection"))},s.onerror=function(e){o||(o=!0,r(new Error(e.message)))}})},triggerNotifyEvent:function(e){this.props.onNotify&&this.props.onNotify({type:"notify",target:this,protocol:this.state.protocol,server:this.state.server,changes:e})},triggerAlertClickEvent:function(e){this.props.onAlertClick&&this.props.onAlertClick({type:"alertclick",target:this,alert:e})},componentWillMount:function(){var e=this;i().then(function(){e.setState({showingAlert:!0})}).catch(function(e){})},showAlert:function(e){var t=this;if(this.state.showingAlert){var n={},r=this.state.server,i=this.state.protocol;e.profile_image?n.icon=i+"//"+r+e.profile_image:n.icon=this.props.defaultProfileImage,e.message?n.body=e.message:e.attached_image&&(n.image=i+"//"+r+e.attached_image),console.log(n),n.lang=this.props.locale.languageCode;var s=new Notification(e.title,n);s.addEventListener("click",function(){t.triggerAlertClickEvent(e),s.close()})}},render:function(){return null}})},function(e,t,n){"use strict";function r(e){s&&clearInterval(s),s=null,o=e||null,a=void 0,c=0,l=0,o&&(i(),s=setInterval(i,50))}function i(){var e=document.getElementById(o);if(e){var t=e.getBoundingClientRect();t.top!==a?(e.scrollIntoView(),a=t.top,c=0,l=0):++c>=10&&(clearInterval(s),s=null)}else++l>=50&&(clearInterval(s),s=null)}t.scrollTo=r;var s,o,a,c,l},function(e,t,n){"use strict";function r(e){return i(e).then(function(e){return new Uint8Array(e)})}function i(e){return new o(function(t,n){var r=new FileReader;r.onload=function(e){t(r.result)},r.onerror=function(e){n(new Error("Unable to load blob"))},r.readAsArrayBuffer(e)})}function s(e){return new o(function(t,n){var r=new FileReader;r.onload=function(e){t(r.result)},r.onerror=function(e){n(new Error("Unable to load blob"))},r.readAsText(e)})}var o=n(10);t.loadUint8Array=r,t.loadArrayBuffer=i,t.loadText=s},function(e,t,n){"use strict";function r(e){var t={},n=i.split(e,/[\r\n]+/);return i.each(n,function(e){var n=/^(\w+)\s*=\s*(.*)/.exec(e);if(n){var r=i.lowerCase(n[1]),s=i.trim(n[2]);t[r]=s}}),console.log(t),t.url?t:null}var i=n(4);t.parse=r},function(e,t,n){"use strict";function r(e){for(var t,n=[],r=0,i=null,s=1,c=1;t=a.exec(e);){var l=e.substring(r,t.index);if(l)if(i)if(o.trim(l))i=null,c++,n.push(l);else{var u=o.last(i);u.after+=l}else n.push(l);var d=t[1],p=t[2],h=!!o.trim(p),m=t[3],f=t[4],v=t[5],g={label:f,checked:h,answer:p,before:d,between:m,after:v,list:c,key:s};i?i.push(g):(i=[g],n.push(i)),r=t.index+t[0].length,s++}var b=e.substring(r);return b&&n.push(b),n}function i(e,t,n,i,a){var c=r(e);c=o.flattenDeep(c);var l=o.filter(c,{list:t});return o.each(l,function(e){e.key===n?(e.checked=i,s(e)):i&&a&&(e.checked=!1,s(e))}),o.reduce(c,function(e,t){return t instanceof Object?e+t.before+"["+t.answer+"]"+t.between+t.label+t.after:e+t},"")}function s(e){if(e.checked)switch(e.answer.length){case 0:case 1:case 2:e.answer="x";break;case 3:e.answer=" x "}else switch(e.answer.length){case 0:e.answer="";break;case 1:e.answer=" ";break;case 2:e.answer="  ";break;case 3:e.answer="   "}}var o=n(4);t.extract=r,t.update=i;var a=/^([ \t]*)\[([ x]{0,3})\]([ \t]*)(.*?)([ \t]*?)$/gim},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(4),s={};i.mixin({decouple:function(e,t,n){"string"==typeof t?t=i.split(t,"."):t instanceof Array||(t=[t]),n||(n=s);var r=i.clone(e);r instanceof Object||(r={});for(var o=r,a=e,c=0;c<t.length;c++){var l=t[c],u=a?a[l]:void 0,d=i.clone(u);c===t.length-1?d instanceof n.constructor||(d=n):d instanceof Object||(d={}),o[l]=d,o=d,a=u}return r},decoupleSet:function(e,t,n){if("string"==typeof t?t=i.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var r=i.slice(t,0,-1),s=i.decouple(e,r,{});return i.set(s,t,n),s},decoupleUnset:function(e,t){if("string"==typeof t?t=i.split(t,"."):t instanceof Array||(t=[t]),t.length<0)throw new Error("Empty path");var n=i.slice(t,0,-1),r=i.decouple(e,n,{});return i.unset(r,t),r},decouplePush:function(e,t){for(var n=i.decouple(e,t,[]),r=i.get(n,t),s=arguments.length,o=Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];return Array.prototype.push.apply(r,o),n},shallowDiff:function(e,t){return i.pickBy(e,function(e,n){return t[n]!==e})},obscure:function(e,t){var n=i.clone(e);return i.each(t,function(e){var t=i.get(n,e);switch(void 0===t?"undefined":r(t)){case"number":t=0;break;case"string":t=i.repeat("x",t.length);break;case"boolean":t=!1;break;default:return}i.set(n,e,t)}),n}})},function(e,t,n){"use strict";function r(e){var t;return"string"==typeof e?t=e.match(a):e instanceof Object&&(t=s.flatten(s.map(e,function(e){return String(e).match(a)}))),s.map(s.uniq(t),s.toLower).sort()}function i(e){return c.test(e)}var s=n(4);t.findTags=r,t.isTag=i;var o="[@#][a-zA-Z][0-9a-zA-Z]*",a=new RegExp(""+o,"g"),c=new RegExp("^"+o+"$")},function(e,t,n){"use strict";var r=n(4),i=n(1),s=i.PropTypes,o=(n(72),n(404)),a=n(32);n(687),e.exports=i.createClass({displayName:"Chartist",propTypes:{type:s.oneOf(["line","bar","pie"]).isRequired,data:s.object.isRequired,className:s.string,options:s.object,responsiveOptions:s.array,style:s.object,onDraw:s.func},getInitialState:function(){return this.components=a({container:HTMLDivElement}),{}},componentWillReceiveProps:function(e){this.props.onDraw!==e.onDraw&&(this.chartist?this.chartist.off(this.props.onDraw):this.chartist.on(e.onDraw))},render:function(){var e=["ct-chart"];this.props.className&&e.push(this.props.className);var t={ref:this.components.setters.container,className:e.join(" "),style:this.props.style};return i.createElement("div",t)},componentDidUpdate:function(e,t){e.type!==this.props.type?(this.destroyChart(),this.createChart()):e.data===this.props.data&&e.options===this.props.options&&e.responsiveOptions===this.props.responsiveOptions||this.updateChart()},componentDidMount:function(){this.createChart()},createChart:function(){var e=o[r.upperFirst(this.props.type)],t=this.components.container;this.chartist=new e(t,this.props.data,this.props.options,this.props.responsiveOptions),this.props.onDraw&&this.chartist.on("draw",this.props.onDraw)},updateChart:function(){this.chartist.update(this.props.data,this.props.options,this.props.responsiveOptions)},destroyChart:function(){this.chartist&&this.chartist.detach();var e=this.components.container;if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}}),e.exports.Interpolation=o.Interpolation,e.exports.Svg=o.Svg},,,function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"* {\n  box-sizing: border-box;\n  font-family: sans-serif; }\n  *:focus {\n    outline-color: #fca326; }\n\nbody {\n  overflow: hidden; }\n\n.application {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  bottom: 0px;\n  height: 100%;\n  width: 100%; }\n\n.page-view-port {\n  flex-grow: 1;\n  flex-shrink: 1;\n  flex-basis: auto;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  position: relative;\n  background-color: #4d3936;\n  overflow-y: auto;\n  overflow-x: hidden;\n  z-index: 0; }\n  .page-view-port::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: transparent; }\n  .page-view-port::-webkit-scrollbar {\n    width: 14px;\n    background-color: transparent; }\n  .page-view-port::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: rgba(0, 0, 0, 0.2); }\n  .page-view-port .contents {\n    width: 100%;\n    max-width: 125em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".app-component-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  width: 80%;\n  max-width: 40em;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #999999;\n  margin: auto;\n  padding: 0.5em 0.5em 0.5em 0.5em; }\n  .app-component-dialog-box .contents {\n    flex-grow: 1;\n    flex-shrink: 1;\n    overflow: auto;\n    padding: 0.5em 0.5em 0.25em 0.5em;\n    margin-bottom: 0.25em; }\n    .app-component-dialog-box .contents .picture {\n      float: left;\n      margin-right: 1em;\n      margin-bottom: 0.5em; }\n      .app-component-dialog-box .contents .picture .icon {\n        display: inline-block;\n        color: #000000;\n        background-color: #fca326;\n        height: 8em;\n        width: 8em;\n        padding-top: 2em;\n        text-align: center; }\n        .app-component-dialog-box .contents .picture .icon .fa {\n          font-size: 4em; }\n      .app-component-dialog-box .contents .picture IMG {\n        width: auto;\n        height: 8em; }\n    .app-component-dialog-box .contents .text H1:first-child,\n    .app-component-dialog-box .contents .text H2:first-child,\n    .app-component-dialog-box .contents .text H3:first-child,\n    .app-component-dialog-box .contents .text H4:first-child,\n    .app-component-dialog-box .contents .text H5:first-child,\n    .app-component-dialog-box .contents .text H6:first-child,\n    .app-component-dialog-box .contents .text P:first-child {\n      margin-top: 0.1em; }\n    .app-component-dialog-box .contents::-webkit-scrollbar-track {\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: transparent; }\n    .app-component-dialog-box .contents::-webkit-scrollbar {\n      width: 10px;\n      background-color: transparent; }\n    .app-component-dialog-box .contents::-webkit-scrollbar-thumb {\n      border-radius: 2px;\n      -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n      background-color: rgba(0, 0, 0, 0.1); }\n  .app-component-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".audio-capture-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .audio-capture-dialog-box .container {\n    flex: 1 1 auto;\n    overflow: hidden;\n    padding-bottom: 0.2em; }\n    .audio-capture-dialog-box .container .volume-meter {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      width: 20em; }\n      .audio-capture-dialog-box .container .volume-meter .icon {\n        flex: 0 1 auto;\n        font-size: 2em;\n        width: 0.75em;\n        line-height: 100%;\n        margin: 0em 0.2em 0em 0.2em; }\n      .audio-capture-dialog-box .container .volume-meter .bar-container {\n        flex: 1 1 auto;\n        margin: 0.2em 0.2em 0.2em 0.2em; }\n        .audio-capture-dialog-box .container .volume-meter .bar-container .bar {\n          padding: 2px 2px 2px 2px;\n          border: 1px solid #666666; }\n          .audio-capture-dialog-box .container .volume-meter .bar-container .bar .fill {\n            height: 1em;\n            background-color: #666666; }\n  .audio-capture-dialog-box .buttons {\n    flex: 1 0 auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".media-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .media-dialog-box .container {\n    flex: 1 1 auto;\n    overflow: hidden;\n    padding-bottom: 0.2em; }\n    .media-dialog-box .container IMG {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n    .media-dialog-box .container VIDEO {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n  .media-dialog-box .controls {\n    display: flow-root;\n    flex: 1 0 auto;\n    padding: 0.4em 0 0.2em 0;\n    border-top: 1px solid #666666; }\n    .media-dialog-box .controls .links {\n      float: left; }\n    .media-dialog-box .controls .buttons {\n      float: right; }\n  .media-dialog-box .thumbnail {\n    float: left;\n    margin-right: 0.2em;\n    width: 2em;\n    cursor: pointer;\n    border: 2px solid #333333; }\n    .media-dialog-box .thumbnail:hover, .media-dialog-box .thumbnail.selected {\n      border: 2px solid #e24329; }\n    .media-dialog-box .thumbnail IMG {\n      display: block;\n      width: 100%; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".membership-request-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 40em;\n  width: 80%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .membership-request-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n  .membership-request-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n  .membership-request-dialog-box .title {\n    font-size: 1.4em;\n    font-weight: bold;\n    margin-bottom: 0.3em; }\n  .membership-request-dialog-box .description {\n    margin-top: 0.5em;\n    margin-bottom: 0.5em;\n    white-space: pre-line; }\n    .membership-request-dialog-box .description img {\n      float: left;\n      width: 8em;\n      margin-right: 0.5em;\n      margin-bottom: 0.3em; }\n  .membership-request-dialog-box .collapsible-container {\n    transition-duration: 1s; }\n  .membership-request-dialog-box .message {\n    font-size: 0.9em;\n    padding: 0.35em 0.35em 0.35em 0.35em;\n    color: #000000; }\n    .membership-request-dialog-box .message.accepted {\n      background-color: #66cc66; }\n    .membership-request-dialog-box .message.requested {\n      background-color: #dddd66; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".photo-capture-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .photo-capture-dialog-box .container {\n    flex: 1 1 auto;\n    overflow: hidden;\n    padding-bottom: 0.2em; }\n    .photo-capture-dialog-box .container VIDEO, .photo-capture-dialog-box .container IMG {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n  .photo-capture-dialog-box .controls {\n    display: flow-root;\n    flex: 1 0 auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    border-top: 1px solid #666666; }\n    .photo-capture-dialog-box .controls .device-selector {\n      float: left; }\n      .photo-capture-dialog-box .controls .device-selector SELECT {\n        color: #666666;\n        background-color: #4d3936;\n        border: 0;\n        padding: 0.3em; }\n        .photo-capture-dialog-box .controls .device-selector SELECT:hover, .photo-capture-dialog-box .controls .device-selector SELECT:focus {\n          color: #eeeeee;\n          background-color: #806666; }\n    .photo-capture-dialog-box .controls .buttons {\n      float: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".telephone-number-dialog-box {\n  display: flex;\n  flex-direction: column;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #cccccc;\n  margin: auto;\n  padding: 0.4em 0.5em 0.4em 0.5em; }\n  .telephone-number-dialog-box .contents {\n    padding-bottom: 0.5em; }\n    .telephone-number-dialog-box .contents .qr-code {\n      float: left;\n      width: 198px;\n      height: 198px; }\n    .telephone-number-dialog-box .contents .number {\n      overflow: hidden;\n      padding: 0.5em 0.25em 0.25em 0.5em;\n      font-size: 3em; }\n  .telephone-number-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.5em 0 0.2em 0.2em;\n    border-top: 1px solid #666666;\n    text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".user-selection-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .user-selection-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n  .user-selection-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".video-capture-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 100%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .video-capture-dialog-box .container {\n    flex: 1 1 auto;\n    overflow: hidden;\n    padding-bottom: 0.2em; }\n    .video-capture-dialog-box .container VIDEO {\n      max-width: 100%;\n      max-height: 100%;\n      display: block; }\n  .video-capture-dialog-box .controls {\n    display: flow-root;\n    flex: 1 0 auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    border-top: 1px solid #666666; }\n    .video-capture-dialog-box .controls .device-selector {\n      float: left; }\n      .video-capture-dialog-box .controls .device-selector SELECT {\n        color: #666666;\n        background-color: #4d3936;\n        border: 0;\n        padding: 0.3em; }\n        .video-capture-dialog-box .controls .device-selector SELECT:hover, .video-capture-dialog-box .controls .device-selector SELECT:focus {\n          color: #eeeeee;\n          background-color: #806666; }\n    .video-capture-dialog-box .controls .buttons {\n      float: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".comment-editor {\n  display: flex;\n  flex-direction: row;\n  padding: 0.1em 0.1em 0.1em 0.1em; }\n  .comment-editor .profile-image-column {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .comment-editor .profile-image-column .profile-image {\n      margin: 0 0.4em 0 0.2em; }\n  .comment-editor .editor-column {\n    flex-grow: 1;\n    flex-shrink: 1; }\n    .comment-editor .editor-column .media {\n      max-width: 300px;\n      padding: 0em 1em 0.25em 1em; }\n    .comment-editor .editor-column .controls .buttons {\n      display: flow-root; }\n      .comment-editor .editor-column .controls .buttons .media-buttons {\n        padding-top: 0.30em;\n        float: left; }\n      .comment-editor .editor-column .controls .buttons .action-buttons {\n        float: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".language-settings-editor .option-button SELECT {\n  color: #666666;\n  background-color: #4d3936;\n  border: 0;\n  padding: 0.3em;\n  margin-left: 0.5em; }\n  .language-settings-editor .option-button SELECT:hover, .language-settings-editor .option-button SELECT:focus {\n    color: #eeeeee;\n    background-color: #806666; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".media-editor {\n  position: relative;\n  width: 100%; }\n  .media-editor .navigation {\n    position: absolute;\n    width: 100%;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    opacity: 1;\n    transition: opacity .5s; }\n    .media-editor .navigation .left {\n      float: left; }\n    .media-editor .navigation .right {\n      float: right; }\n    .media-editor .navigation.hidden {\n      opacity: 0; }\n  .media-editor .image-cropper {\n    max-width: 600px;\n    width: 100%; }\n  .media-editor .audio-placeholder {\n    font-size: 4em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section.editor-options .supplemental {\n  margin-top: 0.5em;\n  padding-top: 0.4em;\n  border-top: 1px dotted #404040; }\n\n.editor-options.in-menu .main {\n  width: 15em; }\n\n.editor-options.in-menu .supplemental {\n  width: 15em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section.media-editor {\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n  .story-section.media-editor .header {\n    flex: 0 1 auto; }\n  .story-section.media-editor .body {\n    flex: 1 1 auto;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    position: relative; }\n    .story-section.media-editor .body .drop-zone {\n      width: 100%; }\n  .story-section.media-editor .message {\n    border: 2px dashed #666666;\n    padding: 2em;\n    color: #666666;\n    margin: 0 2em 0 2em;\n    text-align: center; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section.text-editor .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.story-section.text-editor .header .name {\n  color: #eeeeee; }\n\n.story-section.text-editor .subheader .button {\n  font-size: 0.9em;\n  color: #666666;\n  cursor: pointer; }\n  .story-section.text-editor .subheader .button .label {\n    margin-left: 0.2em; }\n  .story-section.text-editor .subheader .button:hover {\n    color: #eeeeee; }\n\n.story-section.text-editor .body .autosize-text-area TEXTAREA {\n  font-size: 1em;\n  min-height: 5em;\n  max-height: 50vh;\n  background-color: #eeeeee;\n  border: 1px inset #666666; }\n\n.story-section.text-editor .footer {\n  text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".comment-list .scrollable {\n  display: flex;\n  flex-direction: column-reverse;\n  max-height: 24em;\n  padding-right: 0.25em; }\n\n.comment-list .comment-view, .comment-list .comment-editor {\n  flex-grow: 0;\n  flex-shrink: 0; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".notification-list {\n  padding-top: 0.5em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".user-selection-list {\n  min-width: 14em;\n  padding-bottom: 0.1em; }\n  .user-selection-list .user {\n    position: relative;\n    cursor: pointer;\n    padding: 0.2em 0.2em 0.2em 0.2em;\n    filter: grayscale(50%); }\n    .user-selection-list .user .name {\n      margin-left: 0.2em;\n      margin-right: 2em;\n      vertical-align: middle; }\n    .user-selection-list .user .fa {\n      position: absolute;\n      right: 0.3em;\n      top: 0;\n      bottom: 0;\n      margin: auto;\n      height: 1em;\n      font-size: 1.2em;\n      color: #e24329;\n      opacity: 0;\n      transition: opacity 0.5s;\n      vertical-align: middle; }\n    .user-selection-list .user:hover {\n      color: #cccccc;\n      filter: none; }\n    .user-selection-list .user.selected {\n      background-color: #211a1a;\n      color: #eeeeee;\n      filter: none; }\n      .user-selection-list .user.selected .fa {\n        opacity: 1; }\n    .user-selection-list .user.disabled {\n      cursor: default; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".start-page {\n  display: flex;\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-color: #4d3936;\n  background-repeat: no-repeat;\n  background-position: center center;\n  background-attachment: fixed;\n  background-size: cover;\n  background-blend-mode: soft-light; }\n  .start-page .bar {\n    display: flex;\n    align-self: center;\n    flex-direction: column;\n    flex: 1 0 auto;\n    background-color: rgba(77, 57, 54, 0.97);\n    width: 100%;\n    min-height: 25vh;\n    position: relative;\n    color: #cccccc;\n    overflow: hidden; }\n    .start-page .bar .content-area {\n      align-self: center;\n      text-align: center;\n      flex: 1 1 auto;\n      width: 90%;\n      max-width: 80em;\n      padding-bottom: 1.4em;\n      z-index: 1; }\n      .start-page .bar .content-area .section {\n        display: inline-block;\n        text-align: left;\n        width: 48%;\n        min-width: 30em;\n        vertical-align: top;\n        padding-left: 1em;\n        padding-right: 1em; }\n        .start-page .bar .content-area .section .scrollable {\n          margin-top: 1em;\n          max-height: 60vh; }\n        .start-page .bar .content-area .section.description .scrollable {\n          white-space: pre-line; }\n    .start-page .bar .welcome {\n      position: absolute;\n      left: 0px;\n      right: 0px;\n      top: 0px;\n      bottom: 0px;\n      text-align: center;\n      margin: auto;\n      height: 1em;\n      z-index: 0;\n      opacity: 0; }\n  .start-page .oauth-button {\n    display: block;\n    font-size: 1.2em;\n    border: 1px solid #cccccc;\n    padding: 0.5em 0.5em 0.5em 1em;\n    max-width: 15em;\n    cursor: pointer;\n    margin-top: 0.5em;\n    vertical-align: middle; }\n    .start-page .oauth-button .fa {\n      font-size: 1.2em;\n      vertical-align: middle;\n      margin-left: 1.5em;\n      margin-right: 0.75em;\n      vertical-align: middle; }\n    .start-page .oauth-button .label {\n      display: inline-block;\n      max-width: 8.5em;\n      vertical-align: middle; }\n    .start-page .oauth-button:link, .start-page .oauth-button:visited {\n      text-decoration: none;\n      color: #cccccc; }\n    .start-page .oauth-button:hover {\n      background-color: #fca326;\n      color: #000000; }\n  .start-page .project-button {\n    display: block;\n    border: 1px solid #cccccc;\n    max-width: 34em;\n    cursor: pointer;\n    margin-bottom: 0.5em;\n    vertical-align: middle;\n    height: calc(3.5em + 2px); }\n    .start-page .project-button .icon {\n      float: left; }\n      .start-page .project-button .icon .default {\n        text-align: center;\n        width: 3.5em;\n        height: 3.5em; }\n        .start-page .project-button .icon .default.v1 {\n          background-color: #ff9900; }\n        .start-page .project-button .icon .default.v2 {\n          background-color: #00cc33; }\n        .start-page .project-button .icon .default.v3 {\n          background-color: #3399ff; }\n        .start-page .project-button .icon .default.v4 {\n          background-color: #ff6666; }\n        .start-page .project-button .icon .default.v5 {\n          background-color: #cc66ff; }\n        .start-page .project-button .icon .default svg {\n          margin-top: 0.5em;\n          height: 2.25em; }\n    .start-page .project-button .text {\n      overflow: hidden; }\n      .start-page .project-button .text .title {\n        font-size: 1em;\n        margin: 0.25em 0.25em 0 0.35em;\n        font-weight: bold;\n        font-variant: small-caps; }\n      .start-page .project-button .text .description {\n        font-size: 0.8em;\n        margin: 0.1em 0.25em 0 0.40em;\n        white-space: pre-line;\n        overflow: hidden;\n        height: calc(2em + 5px); }\n        .start-page .project-button .text .description .contents {\n          width: calc(100% - 1em);\n          position: relative;\n          display: block;\n          max-height: 3em; }\n          .start-page .project-button .text .description .contents .ellipsis {\n            position: absolute;\n            right: -1em;\n            top: calc(4em + 2px - 100%);\n            text-align: left; }\n      .start-page .project-button .text .badge {\n        color: #606060;\n        margin-top: 0.2em;\n        margin-right: 0.2em;\n        float: right; }\n    .start-page .project-button:link, .start-page .project-button:visited {\n      text-decoration: none;\n      color: #cccccc; }\n    .start-page .project-button:hover {\n      background-color: #fca326;\n      color: #000000; }\n  .start-page.transition-out-fast {\n    transition: opacity 0.7s linear 0.55s;\n    opacity: 0; }\n    .start-page.transition-out-fast .bar {\n      transition: min-height 0.7s;\n      min-height: 100vh; }\n      .start-page.transition-out-fast .bar .content-area {\n        opacity: 0; }\n  .start-page.transition-out-slow {\n    transition: opacity 0.7s linear 3s;\n    opacity: 0; }\n    .start-page.transition-out-slow .bar {\n      transition: min-height 0.7s, background-color 0.5s;\n      min-height: 100vh;\n      background-color: #4d3936; }\n      .start-page.transition-out-slow .bar .content-area {\n        opacity: 0; }\n      .start-page.transition-out-slow .bar .welcome {\n        transition: opacity 0.6s linear 1s, color 0.5s linear 2.5s;\n        opacity: 1;\n        color: rgba(255, 255, 255, 0); }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".app-component {\n  display: flex;\n  flex-direction: row;\n  border: 1px solid #211a1a;\n  margin: 0 0.25em 0.5em 0.25em;\n  background-color: #cccccc;\n  cursor: pointer; }\n  .app-component .picture {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .app-component .picture .icon {\n      display: inline-block;\n      color: #000000;\n      background-color: #fca326;\n      height: 4em;\n      width: 4em;\n      padding-top: 1em;\n      text-align: center; }\n      .app-component .picture .icon .fa {\n        font-size: 2em; }\n    .app-component .picture IMG {\n      display: block;\n      width: auto;\n      height: 4em; }\n  .app-component .text {\n    flex-grow: 1;\n    flex-shrink: 1;\n    color: #333333;\n    font-size: 1em;\n    margin: 0.25em 0.25em 0 0.40em;\n    overflow: hidden;\n    height: calc(3em + 8px); }\n    .app-component .text .text-contents {\n      width: calc(100% - 1em);\n      position: relative;\n      display: block;\n      max-height: 4em; }\n      .app-component .text .text-contents .ellipsis {\n        position: absolute;\n        right: -1em;\n        top: calc(6em + 6px - 100%);\n        text-align: left; }\n      .app-component .text .text-contents H1, .app-component .text .text-contents H2, .app-component .text .text-contents H3, .app-component .text .text-contents H4, .app-component .text .text-contents H5 {\n        font-size: 1em;\n        margin-top: 0;\n        margin-bottom: 0.2em; }\n      .app-component .text .text-contents P {\n        margin-top: 0; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".bookmark-view {\n  border: 2px solid #111;\n  background-color: #111;\n  margin: 1em 1em 1em 1em; }\n  .bookmark-view .title {\n    color: #eeeeee; }\n    .bookmark-view .title .name {\n      display: inline-block;\n      padding: 0.2em 0.1em 0.4em 0.4em;\n      font-size: 0.9em; }\n    .bookmark-view .title .close-btn {\n      display: inline-block;\n      float: right;\n      padding: 0.2em 0.3em 0.2em 0.3em;\n      cursor: pointer; }\n  .bookmark-view .contents {\n    clear: both; }\n    .bookmark-view .contents .story-view {\n      margin: 0;\n      border: 0; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".comment-view {\n  display: flex;\n  flex-direction: row;\n  padding: 0.1em 0.1em 0.1em 0.1em; }\n  .comment-view .profile-image-column {\n    flex-grow: 0;\n    flex-shrink: 0; }\n    .comment-view .profile-image-column .profile-image {\n      margin: 0 0.4em 0 0.2em; }\n  .comment-view .contents-column {\n    flex-grow: 1;\n    flex-shrink: 1; }\n    .comment-view .contents-column .text {\n      padding: 0.25em 0 0.25em 0; }\n      .comment-view .contents-column .text .note:link, .comment-view .contents-column .text .note:visited, .comment-view .contents-column .text .issue-assignment:link, .comment-view .contents-column .text .issue-assignment:visited {\n        color: #cccccc;\n        text-decoration: none;\n        cursor: pointer; }\n      .comment-view .contents-column .text .note:hover, .comment-view .contents-column .text .issue-assignment:hover {\n        color: #ffffff; }\n      .comment-view .contents-column .text .in-progress {\n        color: #666666; }\n    .comment-view .contents-column .time {\n      display: block;\n      float: right;\n      color: #666666;\n      font-size: 0.9em;\n      margin: 0 0 0.5em 1em; }\n    .comment-view .contents-column .media {\n      padding: 0.5em 1em 1em 1em;\n      max-width: 300px; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".media-view {\n  position: relative; }\n  .media-view IMG, .media-view CANVAS {\n    display: block;\n    width: 100%;\n    height: auto; }\n  .media-view .image {\n    cursor: pointer; }\n  .media-view .video {\n    cursor: pointer; }\n  .media-view .navigation {\n    position: absolute;\n    width: 100%;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5); }\n    .media-view .navigation .left {\n      float: left; }\n    .media-view .navigation .right {\n      float: right; }\n  .media-view .icon {\n    font-size: 10em;\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n    width: 1em;\n    height: 1em;\n    text-align: center;\n    opacity: 0; }\n  .media-view:hover .icon {\n    opacity: 0.25; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".notification-view {\n  display: flow-root;\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  margin: 0.5em 1em 0.5em 1em;\n  padding: 0.4em 0.4em 0.3em 0.4em;\n  color: #cccccc;\n  cursor: pointer; }\n  .notification-view .event {\n    float: left; }\n    .notification-view .event .profile-image {\n      margin: 0 0.4em 0 0; }\n    .notification-view .event .text {\n      vertical-align: middle; }\n  .notification-view .date {\n    float: right;\n    margin: 0.1em 0 0 2em;\n    color: #666666; }\n    .notification-view .date .time {\n      vertical-align: middle; }\n    .notification-view .date .fa {\n      margin-left: 0.4em; }\n\n.notification-view.columns-1 {\n  margin: 0.5em 0.5em 0.5em 0.5em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section.comments .header .show-btn {\n  float: right; }\n\n.story-section.comments .body {\n  padding: 0.2em 0.2em 0.2em 0.2em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section.contents .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.story-section.contents .header .name {\n  color: #eeeeee; }\n\n.story-section.contents .subheader .time {\n  color: #666666;\n  font-size: 0.9em; }\n\n.story-section.contents .subheader .graphic {\n  float: right; }\n  .story-section.contents .subheader .graphic svg {\n    fill: #211a1a;\n    margin-top: 0.2em;\n    height: 3em; }\n\n.story-section.contents .body .issue .status-opened, .story-section.contents .body .issue .status-reopened {\n  color: #99ff66; }\n\n.story-section.contents .body .issue .status-closed {\n  color: #ff3333; }\n\n.story-section.contents .body .issue .tag {\n  font-size: 0.9em;\n  color: #ffffff;\n  background-color: #444444;\n  padding: 0.2em 0.4em 0.2em 0.4em;\n  border-radius: 0.25em; }\n\n.story-section.contents .body .milestone .start-date {\n  color: #99ff66; }\n\n.story-section.contents .body .milestone .due-date {\n  color: #ff3333; }\n\n.story-section.contents .body .push .files, .story-section.contents .body .push .lines {\n  display: inline-block;\n  list-style-type: none;\n  vertical-align: top;\n  margin: 0;\n  padding: 0; }\n  .story-section.contents .body .push .files .added, .story-section.contents .body .push .lines .added {\n    color: #99ff66; }\n  .story-section.contents .body .push .files .removed, .story-section.contents .body .push .lines .removed {\n    color: #ff3333; }\n  .story-section.contents .body .push .files .modified, .story-section.contents .body .push .lines .modified {\n    color: #6666ff; }\n  .story-section.contents .body .push .files .renamed, .story-section.contents .body .push .lines .renamed {\n    color: #ffff66; }\n\n.story-section.contents .body .push .files {\n  margin-right: 2em; }\n\n.story-section.contents .body .push A:link, .story-section.contents .body .push A:visited, .story-section.contents .body .milestone A:link, .story-section.contents .body .milestone A:visited, .story-section.contents .body .repo A:link, .story-section.contents .body .repo A:visited, .story-section.contents .body .member A:link, .story-section.contents .body .member A:visited, .story-section.contents .body .issue A:link, .story-section.contents .body .issue A:visited, .story-section.contents .body .wiki A:link, .story-section.contents .body .wiki A:visited, .story-section.contents .body .merge-request A:link, .story-section.contents .body .merge-request A:visited {\n  text-decoration: none;\n  color: #cccccc; }\n\n.story-section.contents .body .push A:hover, .story-section.contents .body .milestone A:hover, .story-section.contents .body .repo A:hover, .story-section.contents .body .member A:hover, .story-section.contents .body .issue A:hover, .story-section.contents .body .wiki A:hover, .story-section.contents .body .merge-request A:hover {\n  color: #ffffff; }\n\n.story-section.contents .body .impact .scrollable {\n  margin-top: -0.25em;\n  max-height: 24em; }\n\n.story-section.contents .footer .buttons {\n  text-align: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".view-options.in-menu .main {\n  width: 15em; }\n\n.view-options.in-menu .supplemental {\n  width: 15em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-view {\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  margin: 1em 1em 1em 1em; }\n\n.story-view.columns-1 {\n  margin: 1em 0.5em 1em 0.5em; }\n\n.story-view.columns-2 {\n  display: flex;\n  flex-direction: row; }\n  .story-view.columns-2 .column-1 {\n    flex: 1; }\n  .story-view.columns-2 .column-2 {\n    flex: 1; }\n\n.story-view.columns-3 {\n  display: flex;\n  flex-direction: row; }\n  .story-view.columns-3 .column-1 {\n    flex: 5; }\n  .story-view.columns-3 .column-2 {\n    flex: 5; }\n  .story-view.columns-3 .column-3 {\n    flex: 5; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".ct-chart {\n  height: 12.8em; }\n  .ct-chart .ct-label {\n    color: #999999; }\n  .ct-chart .ct-grids line {\n    stroke: #444444; }\n\n.user-section.statistics .legend {\n  text-align: right;\n  font-size: 0.8em; }\n  .user-section.statistics .legend .item {\n    display: inline-block;\n    white-space: nowrap;\n    margin-left: 0.6em; }\n    .user-section.statistics .legend .item .ct-chart-bar {\n      width: 0.8em;\n      height: 0.8em;\n      vertical-align: middle;\n      margin-right: 0.3em; }\n    .user-section.statistics .legend .item .label {\n      vertical-align: middle; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".user-section.summary .header .profile-image {\n  float: left;\n  margin: 0 0.5em 0.4em 0; }\n\n.user-section.summary .header .roles {\n  color: #eeeeee; }\n\n.user-section.summary .subheader .name {\n  font-size: 1.5em;\n  margin-top: 0.4em;\n  margin-bottom: 0.2em;\n  color: #eeeeee; }\n\n.user-section.summary .subheader .tag {\n  margin-top: 0.2em;\n  margin-bottom: 0.4em;\n  color: #666666;\n  display: inline-block; }\n\n.user-section.summary .body {\n  clear: both; }\n  .user-section.summary .body .activity {\n    margin-bottom: 0.15em; }\n    .user-section.summary .body .activity .time {\n      float: right;\n      color: #666666;\n      font-size: 0.9em; }\n\n.user-section.summary .footer {\n  padding-top: 0.6em;\n  text-align: right; }\n\n.user-section.summary A {\n  color: #999999;\n  cursor: pointer; }\n  .user-section.summary A:link, .user-section.summary A:visited {\n    color: #999999;\n    text-decoration: none; }\n  .user-section.summary A:hover {\n    color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".view-options.in-menu .main {\n  width: 15em; }\n\n.view-options.in-menu .supplemental {\n  width: 15em; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,"",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".bottom-navigation {\n  flex-grow: 0;\n  flex-shrink: 0;\n  flex-basis: auto;\n  display: flex;\n  align-items: flex-start;\n  transition: height 0.7s;\n  z-index: 2; }\n  .bottom-navigation .container {\n    display: flex;\n    flex-direction: row;\n    background-color: #262626;\n    border-top: 1px solid #323232;\n    padding-left: 4px;\n    padding-right: 4px;\n    width: 100%; }\n  .bottom-navigation .button {\n    display: block;\n    flex: 1 1 auto;\n    text-align: center;\n    padding: 6px 6px 6px 6px;\n    cursor: pointer;\n    color: #888888; }\n    .bottom-navigation .button .fa {\n      font-size: 1.4em; }\n    .bottom-navigation .button .label {\n      font-size: 0.8em;\n      vertical-align: 0.2em;\n      color: #666666; }\n    .bottom-navigation .button:link, .bottom-navigation .button:visited {\n      color: #888888;\n      text-decoration: none; }\n    .bottom-navigation .button:hover, .bottom-navigation .button:hover .label {\n      color: #eeeeee; }\n    .bottom-navigation .button.active, .bottom-navigation .button.active .label {\n      color: #ffffff; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".calendar-bar {\n  padding: 4px 4px 4px 4px;\n  overflow-x: auto;\n  white-space: nowrap;\n  display: flex;\n  width: 100%;\n  flex-direction: row-reverse; }\n  .calendar-bar .calendar {\n    flex-grow: 0;\n    flex-shrink: 0; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".calendar {\n  display: inline-block;\n  border-collapse: collapse;\n  border-spacing: 0;\n  direction: ltr;\n  margin-left: 0.2em;\n  margin-right: 0.2em; }\n  .calendar .title TH {\n    font-size: 0.8em;\n    font-weight: bold;\n    color: #999999;\n    border: 1px solid #444444;\n    padding: 0.25em 0.1em 0.2em 0.1em; }\n  .calendar .headings TH {\n    font-size: 0.6em;\n    font-weight: normal;\n    color: #999999;\n    border: 1px solid #444444;\n    padding: 0.2em 0 0.2em 0; }\n  .calendar .headings TH.weekend {\n    background-color: #333333; }\n  .calendar .dates TD {\n    width: 1.6em;\n    height: 1.4em;\n    font-size: 0.8em;\n    color: #cccccc;\n    text-align: center;\n    border: 1px solid #444444;\n    cursor: pointer; }\n  .calendar .dates TD.weekend {\n    background-color: #333333; }\n  .calendar .dates TD.disabled {\n    color: #666666;\n    cursor: default; }\n  .calendar .dates TD.today {\n    color: #eeeeee; }\n  .calendar .dates TD.selected {\n    color: #000000;\n    background-color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".corner-pop-up {\n  position: relative;\n  float: right; }\n  .corner-pop-up .button {\n    color: #666666;\n    cursor: pointer; }\n    .corner-pop-up .button:hover {\n      color: #eeeeee; }\n    .corner-pop-up .button .label {\n      font-size: 0.9em;\n      margin-left: 0.3em; }\n  .corner-pop-up .menu {\n    position: absolute;\n    border: 1px solid black;\n    padding: 0.5em 0.5em 0.5em 0.5em;\n    background-color: #fff;\n    box-shadow: 3px 3px 3px 0px rgba(0, 0, 0, 0.75);\n    right: 0.4em;\n    top: 1.5em;\n    z-index: 1000; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".drop-zone {\n  position: relative; }\n  .drop-zone .overlay {\n    position: absolute;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    border: 3px solid #fca326; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,'.header-button {\n  display: inline-block;\n  color: #666666;\n  margin-right: 0.5em;\n  cursor: pointer; }\n  .header-button:hover {\n    color: #eeeeee; }\n  .header-button.disabled {\n    cursor: default; }\n    .header-button.disabled:hover {\n      color: #666666; }\n  .header-button.highlighted {\n    color: #e24329; }\n  .header-button .label {\n    font-size: 0.9em;\n    margin-left: 0.3em; }\n  .header-button INPUT[type="file"] {\n    position: absolute;\n    z-index: -50000;\n    width: 1px;\n    height: 1px; }\n',""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".media-button {\n  display: inline-block;\n  color: #666666;\n  padding: 0.45em 0.5em 0.3em 0.5em;\n  margin-left: 0.2em;\n  margin-right: 0.1em;\n  cursor: pointer; }\n  .media-button:hover {\n    color: #eeeeee; }\n  .media-button.disabled {\n    cursor: default; }\n    .media-button.disabled:hover {\n      color: #666666; }\n  .media-button .label {\n    font-size: 0.9em;\n    margin-left: 0.3em; }\n\n.media-direction {\n  padding: 0.2em 0.3em 0.1em 0.3em; }\n  .media-direction .backward-button, .media-direction .forward-button {\n    display: inline-block;\n    font-size: 1.2em;\n    color: #666666;\n    padding: 0.1em 0.5em 0.1em 0.5em;\n    cursor: pointer;\n    vertical-align: middle; }\n  .media-direction .position {\n    display: inline-block;\n    font-size: 0.9em;\n    vertical-align: middle; }\n  .media-direction:hover .backward-button, .media-direction:hover .forward-button {\n    color: #eeeeee; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".multiple-user-names {\n  position: relative; }\n  .multiple-user-names .label {\n    cursor: pointer; }\n  .multiple-user-names .popup-container {\n    position: absolute;\n    left: 0.5em;\n    top: 1.5em;\n    width: 100vw;\n    z-index: 500; }\n    .multiple-user-names .popup-container .popup {\n      display: inline-block;\n      border: 1px solid black;\n      padding: 0.3em 0.3em 0.1em 0.3em;\n      background-color: #fff;\n      box-shadow: 2px 2px 2px 0px rgba(0, 0, 0, 0.5); }\n      .multiple-user-names .popup-container .popup .user {\n        margin-bottom: 0.2em; }\n        .multiple-user-names .popup-container .popup .user .name {\n          color: #333;\n          margin-left: 0.2em;\n          vertical-align: middle; }\n        .multiple-user-names .popup-container .popup .user .profile-image {\n          float: none;\n          margin: 0; }\n      .multiple-user-names .popup-container .popup .more {\n        color: #bbb;\n        font-size: 0.8em;\n        text-align: right;\n        border-top: 1px solid #eee; }\n\n.multiple-user-names-dialog-box {\n  display: flex;\n  flex-direction: column;\n  max-height: 80%;\n  max-width: 100%;\n  background-color: #362a2a;\n  box-shadow: 2px 2px 2px #000000;\n  color: #666666;\n  margin: auto;\n  padding: 0.4em 0.4em 0.4em 0.4em; }\n  .multiple-user-names-dialog-box .scrollable {\n    flex-grow: 1;\n    flex-shrink: 1;\n    flex-basis: auto; }\n    .multiple-user-names-dialog-box .scrollable .list {\n      min-width: 14em;\n      padding-bottom: 0.1em; }\n      .multiple-user-names-dialog-box .scrollable .list .user {\n        margin-bottom: 0.2em; }\n        .multiple-user-names-dialog-box .scrollable .list .user .profile-image {\n          float: none;\n          margin: 0; }\n        .multiple-user-names-dialog-box .scrollable .list .user .name {\n          margin-left: 0.2em;\n          vertical-align: middle; }\n  .multiple-user-names-dialog-box .buttons {\n    flex-grow: 0;\n    flex-shrink: 0;\n    flex-basis: auto;\n    padding: 0.4em 0 0.2em 0.2em;\n    text-align: right;\n    border-top: 1px solid #666666; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".option-button {\n  display: block;\n  cursor: pointer;\n  color: #666666;\n  margin-bottom: 0.2em; }\n  .option-button:link, .option-button:visited {\n    text-decoration: none; }\n  .option-button .fa {\n    width: 1em;\n    margin-right: 0.2em;\n    vertical-align: middle; }\n  .option-button.selected, .option-button:hover {\n    color: #eeeeee; }\n  .option-button .label {\n    font-size: 0.9em;\n    vertical-align: middle; }\n\n.in-menu .option-button.selected, .in-menu .option-button:hover {\n  color: #000000; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".profile-image {\n  vertical-align: middle; }\n  .profile-image.small {\n    width: 1.5em;\n    height: 1.5em; }\n  .profile-image.medium {\n    width: 3em;\n    height: 3em; }\n  .profile-image.large {\n    width: 6em;\n    height: 6em; }\n\nsvg.profile-image {\n  background-color: #999999; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".push-button {\n  min-width: 5em;\n  margin-left: 0.4em;\n  margin-bottom: 0.1em;\n  padding: 0.4em 1em 0.4em 1em;\n  color: #666666;\n  background-color: #4d3936;\n  border: 2px solid #4d3936; }\n  .push-button:not(:disabled).emphasized, .push-button:not(:disabled):hover, .push-button:not(:disabled):active {\n    color: #eeeeee;\n    background-color: #806666;\n    border: 2px solid #806666; }\n  .push-button:not(:disabled):active {\n    border: 2px inset #4d3936; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".role-filter-bar {\n  padding: 4px 4px 4px 4px;\n  overflow-x: auto;\n  white-space: nowrap; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".role-filter-button {\n  display: inline-block;\n  margin-right: 0.5em;\n  vertical-align: top;\n  cursor: pointer; }\n  .role-filter-button .contents {\n    position: relative;\n    border: 1px solid #444444;\n    margin: 1px;\n    overflow: hidden; }\n    .role-filter-button .contents .row {\n      width: 12em;\n      height: 3em; }\n      .role-filter-button .contents .row .profile-image {\n        display: inline-block; }\n    .role-filter-button .contents .band {\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      left: 0;\n      right: 0;\n      top: 3em;\n      background-color: #1a1a1a;\n      color: #eeeeee;\n      padding: 0.25em 0.25em 0.25em 0.25em;\n      min-height: 3em; }\n      .role-filter-button .contents .band .title {\n        width: 100%;\n        text-align: center;\n        line-height: 1.25em; }\n        .role-filter-button .contents .band .title .user-count {\n          float: right;\n          line-height: 0.5em;\n          padding-top: 0.2em; }\n          .role-filter-button .contents .band .title .user-count .number {\n            font-size: 0.6em;\n            vertical-align: -2px;\n            margin-left: 2px; }\n  .role-filter-button.selected .contents {\n    border: 2px solid #eeeeee;\n    margin: 0; }\n  .role-filter-button.selected .band {\n    background-color: #eeeeee;\n    color: #000000; }\n  .role-filter-button.no-roles {\n    cursor: default; }\n    .role-filter-button.no-roles .message {\n      color: #444444;\n      position: absolute;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: center;\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".scrollable {\n  overflow: auto; }\n  .scrollable::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: transparent; }\n  .scrollable::-webkit-scrollbar {\n    width: 10px;\n    background-color: transparent; }\n  .scrollable::-webkit-scrollbar-thumb {\n    border-radius: 2px;\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    background-color: rgba(0, 0, 0, 0.1); }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".search-bar {\n  padding: 4px 9px 8px 4px;\n  text-align: right; }\n  .search-bar label {\n    color: #999999;\n    margin-right: 0.35em; }\n  .search-bar input {\n    font-size: 1em;\n    min-width: 20em;\n    max-width: 40em;\n    width: 28%;\n    color: #eeeeee;\n    background-color: #333333;\n    border: 1px inset #444444;\n    padding: 4px 3px 3px 3px; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".settings-section {\n  margin: 0 0 0 0;\n  background-color: #362a2a;\n  border: 2px solid #211a1a;\n  margin: 1em 1em 1em 1em;\n  max-width: 25em; }\n  .settings-section .header {\n    font-size: 1.2em;\n    color: #eeeeee;\n    background-color: #211a1a;\n    padding: 0.5em 0.5em 0.4em 0.5em; }\n    .settings-section .header .fa {\n      margin-right: 0.2em; }\n  .settings-section .subheader {\n    padding: 0.25em 0.5em 0.1em 0.5em; }\n  .settings-section .body {\n    color: #cccccc;\n    padding: 0.2em 0.5em 0.3em 0.5em;\n    clear: both; }\n  .settings-section .footer {\n    padding: 0.0em 0.5em 0.4em 0.5em;\n    text-align: right;\n    clear: both; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-section {\n  margin: 0 0 0 0; }\n  .story-section .header {\n    background-color: #211a1a;\n    padding: 0.5em 0.5em 0.4em 0.5em; }\n  .story-section .subheader {\n    padding: 0.25em 0.5em 0.1em 0.5em; }\n  .story-section .body {\n    color: #cccccc;\n    padding: 0.2em 0.5em 0.3em 0.5em;\n    clear: left; }\n  .story-section .footer {\n    padding: 0.0em 0.5em 0.4em 0.5em;\n    clear: both; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".story-text .list-item {\n  display: block; }\n  .story-text .list-item H1, .story-text .list-item H2, .story-text .list-item H3, .story-text .list-item H4, .story-text .list-item H5, .story-text .list-item H6 {\n    display: inline-block;\n    margin-top: 0;\n    margin-bottom: 0; }\n  .story-text .list-item IMG {\n    vertical-align: top; }\n  .story-text .list-item.vote-count .label {\n    display: block;\n    margin-bottom: 0.1em; }\n  .story-text .list-item.vote-count .bar {\n    display: block;\n    position: relative;\n    border: 1px solid #aaaaaa;\n    font-size: 0.8em;\n    height: 1.5em;\n    margin-bottom: 0.4em; }\n    .story-text .list-item.vote-count .bar .percent {\n      position: absolute;\n      display: block;\n      left: 0.2em;\n      top: 0.1em;\n      color: #333333; }\n    .story-text .list-item.vote-count .bar .count {\n      position: absolute;\n      display: block;\n      right: 0.2em;\n      top: 0.1em;\n      color: #cccccc; }\n    .story-text .list-item.vote-count .bar .filled {\n      display: block;\n      position: absolute;\n      left: 0;\n      top: 0;\n      bottom: 0; }\n      .story-text .list-item.vote-count .bar .filled.item-0 {\n        background-color: #d70206; }\n      .story-text .list-item.vote-count .bar .filled.item-1 {\n        background-color: #f05b4f; }\n      .story-text .list-item.vote-count .bar .filled.item-2 {\n        background-color: #f4c63d; }\n      .story-text .list-item.vote-count .bar .filled.item-3 {\n        background-color: #d17905; }\n      .story-text .list-item.vote-count .bar .filled.item-4 {\n        background-color: #59922b; }\n      .story-text .list-item.vote-count .bar .filled.item-5 {\n        background-color: #f05b4f; }\n      .story-text .list-item.vote-count .bar .filled.item-6 {\n        background-color: #dda458; }\n      .story-text .list-item.vote-count .bar .filled.item-7 {\n        background-color: #eacf7d; }\n      .story-text .list-item.vote-count .bar .filled.item-8 {\n        background-color: #b2c326; }\n      .story-text .list-item.vote-count .bar .filled.item-9 {\n        background-color: #6188e2; }\n\n.story-text.plain-text {\n  white-space: pre-wrap; }\n  .story-text.plain-text .list-item {\n    display: inline-block; }\n    .story-text.plain-text .list-item.vote-count {\n      width: 100%; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".top-navigation {\n  flex-grow: 0;\n  flex-shrink: 0;\n  flex-basis: auto;\n  display: flex;\n  align-items: flex-end;\n  transition: height 0.7s;\n  z-index: 2; }\n  .top-navigation .container {\n    background-color: #262626;\n    border-bottom: 1px solid #171717;\n    padding-left: 4px;\n    padding-right: 4px;\n    width: 100%; }\n    .top-navigation .container .collapsible-container {\n      clear: both; }\n  .top-navigation .button {\n    font-size: 1.4em;\n    width: 1.8em;\n    text-align: center;\n    padding: 6px 6px 6px 6px;\n    cursor: pointer;\n    color: #888888; }\n    .top-navigation .button:hover {\n      color: #cccccc; }\n    .top-navigation .button.active {\n      color: #eeeeee; }\n    .top-navigation .button.disabled {\n      color: #333333;\n      cursor: not-allowed; }\n    .top-navigation .button.calendar-btn, .top-navigation .button.filter-btn {\n      float: left; }\n    .top-navigation .button.search-btn {\n      float: right; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".user-section .header {\n  background-color: #211a1a;\n  padding: 0.5em 0.5em 0.4em 0.5em; }\n  .user-section .header:empty {\n    display: none; }\n\n.user-section .subheader {\n  padding: 0.25em 0.5em 0.1em 0.5em; }\n  .user-section .subheader:empty {\n    display: none; }\n\n.user-section .body {\n  color: #cccccc;\n  padding: 0.2em 0.5em 0.3em 0.5em;\n  clear: both; }\n  .user-section .body:empty {\n    display: none; }\n\n.user-section .footer {\n  padding: 0.0em 0.5em 0.4em 0.5em;\n  clear: both; }\n  .user-section .footer:empty {\n    display: none; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".image-cropper {\n  overflow: hidden; }\n  .image-cropper CANVAS {\n    width: 100%;\n    display: block; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".autosize-text-area {\n  position: relative; }\n  .autosize-text-area TEXTAREA {\n    width: 100%;\n    resize: vertical; }\n  .autosize-text-area .shadow {\n    position: absolute;\n    top: 0;\n    left: 0;\n    min-height: 1em !important;\n    max-height: 1em !important;\n    visibility: hidden; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".collapsible-container {\n  transition: height .25s;\n  overflow: hidden; }\n  .collapsible-container .collapsible-contents {\n    overflow: hidden; }\n",""])},function(e,t,n){t=e.exports=n(2)(void 0),t.push([e.i,".overlay {\n  position: fixed;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  overflow: hidden;\n  z-index: 5000; }\n  .overlay .background {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: #000;\n    transition: opacity 0.5s;\n    z-index: -100; }\n  .overlay .foreground {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 90%;\n    transition: opacity 0.25s, top 0.25s; }\n  .overlay.show .background {\n    opacity: 0.75; }\n  .overlay.show .foreground {\n    opacity: 1; }\n  .overlay.hide .background {\n    opacity: 0; }\n  .overlay.hide .foreground {\n    top: -30px;\n    opacity: 0; }\n",""])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"be613ad3c1fb13a04edca971d584e375.png"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r=n(406);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(407);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(408);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(409);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(410);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(411);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(412);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(413);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(414);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(415);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(416);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(417);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(418);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(419);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(420);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(421);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(422);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(423);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(424);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(425);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(426);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(427);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(428);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(429);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(430);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(431);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(432);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(433);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(435);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(436);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(437);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(438);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(439);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(440);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(441);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(442);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(443);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(444);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(445);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(446);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(447);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(448);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(449);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(450);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(451);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(452);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(453);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(454);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(455);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(456);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(457);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(458);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(459);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(460);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(461);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(462);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(463);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(464);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(465);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(466);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(467);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(468);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(469);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(470);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(471);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(472);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(473);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(474);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){var r=n(475);"string"==typeof r&&(r=[[e.i,r,""]]);var i={};i.transform=void 0;n(3)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){function r(e){return i.createElement("svg",e,[i.createElement("defs",{className:"ClipPathGroup",key:0},i.createElement("clipPath",{clipPathUnits:"userSpaceOnUse"},i.createElement("rect",{x:"1000",y:"1000",width:"5080",height:"6299"}))),i.createElement("defs",{className:"TextShapeIndex",key:1}),i.createElement("defs",{className:"EmbeddedBulletChars",key:2},[i.createElement("path",{d:"M0.3-0.6L0.6-0.3 0.3 0 0-0.3 0.3-0.6Z",key:0}),i.createElement("path",{d:"M0-0.6L0.6-0.6 0.6 0 0 0 0-0.6Z",key:1}),i.createElement("path",{d:"M0.1 0L0.3-0.4 0.1-0.7 0.7-0.4 0.1 0ZM1358 739L309 1346 659 739 1358 739Z",key:2}),i.createElement("path",{d:"M1-0.4L0.6 0 0.4 0 0.6-0.3 0.1-0.3 0.1-0.5 0.6-0.5 0.4-0.7 0.6-0.7 1-0.4Z",key:3}),i.createElement("path",{d:"M0 0C0 0 0 0 0 0L0.2-0.3C0.1-0.4 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.1-0.5 0.2-0.5 0.2-0.5 0.2-0.5L0.2-0.5 0.2-0.4 0.4-0.5 0.4-0.5 0.4-0.5C0.4-0.5 0.4-0.5 0.5-0.5 0.4-0.5 0.4-0.4 0.4-0.4 0.4-0.4 0.3-0.3 0.3-0.3L0.4-0.1C0.4-0.1 0.4-0.1 0.3-0.1L0.4-0.1C0.4 0 0.3 0 0.3 0 0.3 0 0.3-0.1 0.2-0.2L0.1 0C0.1 0.1 0.1 0.1 0 0.1 0 0.1 0 0.1 0 0 0 0 0 0 0 0 0 0 0 0 0 0Z",key:4}),i.createElement("path",{d:"M0.1 0C0.1 0 0.1 0 0-0.1 0-0.1 0-0.2 0-0.2 0-0.3 0-0.3 0-0.3 0.1-0.4 0.1-0.4 0.1-0.4 0.1-0.4 0.2-0.4 0.2-0.3L0.2-0.2C0.2-0.2 0.2-0.2 0.2-0.2L0.6-0.5C0.6-0.6 0.6-0.6 0.6-0.6 0.6-0.6 0.6-0.5 0.6-0.5L0.6-0.5C0.6-0.5 0.6-0.4 0.6-0.4L0.2 0C0.2 0 0.2 0 0.1 0Z",key:5}),i.createElement("path",{d:"M0.4 0C0.3 0 0.2 0 0.2-0.1 0.1-0.1 0.1-0.2 0.1-0.3 0.1-0.4 0.1-0.4 0.2-0.5 0.2-0.6 0.3-0.6 0.4-0.6 0.5-0.6 0.6-0.6 0.6-0.5 0.7-0.4 0.7-0.4 0.7-0.3 0.7-0.2 0.7-0.1 0.6-0.1 0.6 0 0.5 0 0.4 0Z",key:6}),i.createElement("path",{d:"M0.2-0.2C0.1-0.2 0.1-0.2 0.1-0.3 0-0.3 0-0.3 0-0.4 0-0.4 0-0.4 0.1-0.4 0.1-0.5 0.1-0.5 0.2-0.5 0.2-0.5 0.2-0.5 0.3-0.4 0.3-0.4 0.3-0.4 0.3-0.4 0.3-0.3 0.3-0.3 0.3-0.3 0.2-0.2 0.2-0.2 0.2-0.2Z",key:7}),i.createElement("path",{d:"M0-0.2L0.6-0.2 0.6-0.3 0-0.3 0-0.2Z",key:8})]),i.createElement("defs",{className:"TextEmbeddedBitmaps",key:3}),i.createElement("g",{className:"SlideGroup",key:4},i.createElement("g",{className:"Slide",clipPath:"url(#presentation_clip_path)"},i.createElement("g",{className:"Page"},i.createElement("g",{className:"com.sun.star.drawing.ClosedBezierShape"},[i.createElement("rect",{className:"BoundingBox",x:"1000",y:"1000",width:"5082",height:"6301",fill:"none",key:0}),i.createElement("path",{d:"M1655 2259L5444 2259 6080 2890 6080 3520 5233 3520 5233 3099 1847 3099 1847 3918 1847 4758 1847 5619 1847 6459 5233 6459 5233 5619 4809 5619 4809 4989 6080 4989 6080 6669 5444 7299 1635 7299 1000 6669 1000 2890 1655 2259ZM3116 6459L3116 4569 3963 4569 3963 6459 3116 6459ZM3540 3520C3780 3520 3963 3701 3963 3939 3963 4178 3780 4360 3540 4360 3300 4360 3116 4178 3116 3939 3116 3701 3300 3520 3540 3520ZM3116 3520L3116 3520ZM3964 4361L3964 4361ZM3328 2259L3328 1419 2693 1419 2693 1000 4387 1000 4387 1419 3752 1419 3752 2259 3328 2259Z",fill:"rgb(0,0,0)",key:1})]))))])}var i=n(1);r.displayName="TrambarLogo",r.defaultProps={viewBox:"1000 1000 5080 6299",preserveAspectRatio:"xMidYMid",style:{strokeLinejoin:"round",strokeWidth:"30"}},e.exports=r,r.default=r}],[361]);